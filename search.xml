<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ã€å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ã€‘åŸºäºè‡ªåŠ¨åˆ†ç»„çš„ä»·å€¼å‡½æ•°åˆ†è§£</title>
    <url>/2023/11/22/MARL_%E8%87%AA%E5%8A%A8%E5%88%86%E7%BB%84/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h2 id="automatic-grouping-for-marl">Automatic Grouping for MARL</h2>
<p>è®ºæ–‡æ ‡é¢˜ï¼š</p>
<p><strong>ã€ŠVast: Value function factorization with variable agent
sub-teamsã€‹</strong></p>
<p><strong>ã€ŠAutomatic Grouping for Efficient Cooperative Multi-Agent
Reinforcement Learningã€‹</strong></p>
<p>è®ºæ–‡ä»£ç ï¼š<a
href="https://github.com/zyfsjycc/GoMARL">https://github.com/zyfsjycc/GoMARL</a></p>
<h2 id="ä»·å€¼å‡½æ•°åˆ†è§£">ä»·å€¼å‡½æ•°åˆ†è§£</h2>
<p>ä»·å€¼å‡½æ•°çš„æå‡ºæ˜¯ä¸ºäº†ç¼“è§£åœ¨ä¼ ç»Ÿçš„ä¸­å¿ƒåŒ–è®­ç»ƒå’Œå»ä¸­å¿ƒåŒ–æ‰§è¡Œä¸­çš„Criticç½‘ç»œå‡ºç°çš„éš¾ä»¥è®­ç»ƒçš„é—®é¢˜ï¼ŒåŒæ—¶ä¼ ç»Ÿçš„åˆä½œå‹å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ çš„æ–¹æ³•éš¾ä»¥è§£å†³ä¿¡ç”¨åˆ†é…çš„é—®é¢˜ï¼Œå³å¦‚ä½•ç¡®å®šæŸä¸ªæ™ºèƒ½ä½“<strong>å¯¹äºå…¨å±€ä»»åŠ¡è€Œè¨€çš„è´¡çŒ®ç¨‹åº¦</strong>ã€‚</p>
<h3 id="ä¸»ä½“ç ”ç©¶æ¡†æ¶">ä¸»ä½“ç ”ç©¶æ¡†æ¶ï¼š</h3>
<p><span class="math display">\[
Q_{tot} (Ï„,a)â‰ˆÎ¨([Q_i (Ï„_i,a_i)]_{i=1}^N)
\]</span></p>
<p>ç›®çš„å°±æ˜¯å­¦ä¹ åˆ°è¿™æ ·ä¸€ä¸ªåˆ†è§£ç®—å­ <span
class="math inline">\(Î¨\)</span>ï¼Œèƒ½å¤Ÿå°†å±€éƒ¨çš„ä»·å€¼å‡½æ•° <span
class="math inline">\(Q_i\)</span> æ‹Ÿåˆæˆå…¨å±€çš„ä»·å€¼å‡½æ•° <span
class="math inline">\(Q_{tot}\)</span>ï¼Œè€Œè¿™æ ·çš„æ‹Ÿåˆè¿‡ç¨‹å­¦ä¹ åˆ°çš„åˆ†è§£ç®—å­<span
class="math inline">\(Î¨\)</span>åº”å½“æ»¡è¶³ä»¥ä¸‹çš„çº¦æŸæ¡ä»¶ï¼š <span
class="math display">\[
\underset{\boldsymbol{a}}{\arg \max } Q_{\text {tot
}}(\boldsymbol{\tau}, \boldsymbol{a})=\left(\begin{array}{c}
\operatorname{argmax}_{a_1} Q_1\left(\tau_1, a_1\right) \\
\vdots \\
\operatorname{argmax}_{a_N} Q_N\left(\tau_N, a_N\right)
\end{array}\right)
\]</span>
è¿™ä¸ªå…¬å¼çš„æœ¬è´¨æ˜¯å¸Œæœ›åˆ†è§£ä¹‹åçš„å±€éƒ¨å’Œå…¨å±€çš„æœ€ä¼˜åŠ¨ä½œèƒ½å¤Ÿæœ€ä¼˜ä¸€è‡´ï¼Œæ‰èƒ½ä¿è¯è¿™æ ·çš„ç®—å­åˆ†è§£æ–¹æ³•æ˜¯æœ‰æ•ˆæœçš„ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122215614627.png"
alt="ä»·å€¼å‡½æ•°åˆ†è§£çš„åŸºæœ¬æ€æƒ³" />
<figcaption aria-hidden="true">ä»·å€¼å‡½æ•°åˆ†è§£çš„åŸºæœ¬æ€æƒ³</figcaption>
</figure>
<h2 id="å¯å˜å­å›¢é˜Ÿçš„ä»·å€¼å‡½æ•°åˆ†è§£">å¯å˜å­å›¢é˜Ÿçš„ä»·å€¼å‡½æ•°åˆ†è§£</h2>
<h4 id="ç ”ç©¶åŠ¨æœº">ç ”ç©¶åŠ¨æœºï¼š</h4>
<ol type="1">
<li><strong>å¤§éƒ¨åˆ†</strong>ä»·å€¼å‡½æ•°æ–¹æ³•å¯¹<strong>å°‘é‡æ™ºèƒ½ä½“</strong>çš„ä»»åŠ¡æ•ˆæœå¥½</li>
<li><strong>VFF</strong>æ–¹æ³•è¿‡äºæ‰å¹³ï¼Œå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Œæ²¡æœ‰è€ƒè™‘ç¾¤ç»„ä¹‹é—´çš„ä¸€ä¸ªå…³ç³»ï¼Œæ¯”è¾ƒæœ´ç´ ä¸”ç›´æ¥</li>
<li>å¿½ç•¥æ™ºèƒ½ä½“ä¹‹é—´å…³ç³»å¯¼è‡´æ™ºèƒ½ä½“è®­ç»ƒä¿¡æ¯ä¸è¶³</li>
</ol>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122202659835.png" alt="æœ´ç´ çš„ä»·å€¼å‡½æ•°åˆ†è§£æ–¹æ³•" style="zoom:60%;" /><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122202712624.png" alt="è‡ªåŠ¨åˆ†ç»„ä¹‹åçš„ä»·å€¼å‡½æ•°åˆ†è§£æ–¹æ³•" style="zoom:60%;" /></p>
<p>å› æ­¤ï¼Œä¸ºäº†èƒ½å¤Ÿç¼“è§£æœ´ç´ çš„ä»·å€¼å‡½æ•°åˆ†è§£æ–¹æ³•ä¸­çš„<strong>ç¼ºä¹ç¾¤ç»„ä¿¡æ¯çš„ç¼ºé™·</strong>ï¼Œæ–‡ä¸­æå‡ºèƒ½å¤Ÿåˆ†ç»„å¤„ç†å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„å·¥ä½œVASTï¼Œèƒ½å¤ŸåŠ¨æ€å¤„ç†ç¾¤ç»„åˆ’åˆ†çš„ç®—å­æ¥ç»™å‡ºåŸºäºåˆ†ç»„çš„æ™ºèƒ½ä½“ä»·å€¼å‡½æ•°æ–¹æ³•ã€‚</p>
<h3 id="ä¸»è¦è´¡çŒ®">ä¸»è¦è´¡çŒ®ï¼š</h3>
<ol type="1">
<li>åŸºäº <span class="math inline">\(K â‰¤ N = |D|\)</span>
çš„åˆ†è§£å­å›¢é˜Ÿå€¼<span
class="math inline">\(Q_{t,k}^G\)</span>ï¼Œçº¿æ€§åˆ†è§£æ¯ä¸ªå­å›¢é˜Ÿæˆå‘˜$jG_{t,k}âŠ†D
$ å±€éƒ¨å€¼<span class="math inline">\(Q_j\)</span></li>
<li>æå‡ºäº†ä¸€ç§åˆ†è§£æ–¹å¼åŠ¨æ€å¹¶éšæ—¶é—´å˜åŒ–ï¼ŒåŒæ—¶ä¿æŒVFFæ–¹æ³•çš„å»ä¸­å¿ƒæ€§æ‰§è¡Œçš„ç‰¹ç‚¹</li>
<li>æä¾›äº†<strong>å…ƒæ¢¯åº¦</strong>æ–¹æ³•æ¥ä¼˜åŒ–å­å›¢é˜Ÿåˆ†ç»„ç­–ç•¥</li>
</ol>
<h3 id="å®ç°æ–¹æ³•">å®ç°æ–¹æ³•ï¼š</h3>
<h4 id="å­å›¢é˜Ÿåˆ†ç»„ç­–ç•¥">å­å›¢é˜Ÿåˆ†ç»„ç­–ç•¥ï¼š</h4>
<p>åˆ†ç»„ç­–ç•¥çš„æœ¬è´¨æ˜¯å­¦ä¹ ä¸€ä¸ª<strong>æ¦‚ç‡åˆ†å¸ƒ</strong><span
class="math inline">\(\mathcal{X}(kâˆ£i,Ï„_(t,i),s_t
)\)</span>ï¼Œæ¦‚ç‡åˆ†å¸ƒçš„æœ¬è´¨æ€æƒ³æ˜¯èƒ½å¤Ÿé€šè¿‡æ¯ä¸ªæ™ºèƒ½ä½“çš„çŠ¶æ€ä»¥åŠå†å²æ•°æ®ä¿¡æ¯ç»™å‡ºæ™ºèƒ½ä½“
<span class="math inline">\(i\)</span> æ‰€åœ¨çš„ç»„åˆ« <span
class="math inline">\(k\)</span></p>
<h4 id="å…ƒæ¢¯åº¦çš„æ›´æ–°æ–¹å¼">å…ƒæ¢¯åº¦çš„æ›´æ–°æ–¹å¼ï¼š</h4>
<p><span class="math display">\[
ğ‘”=ğ´Â Ì‚(ğ‘˜,ğ‘–,ğœ_{ğ‘¡,ğ‘–},ğ‘ _ğ‘¡ ) âˆ‡_ğœƒ logâ¡ğ’³_{MetaGrad}  (ğ‘˜âˆ£ğ‘–,ğœ_{ğ‘¡,ğ‘–},ğ‘ _ğ‘¡ )
\]</span></p>
<ul>
<li>å‚è€ƒå€Ÿé‰´äº†å¼ºåŒ–å­¦ä¹ çš„ç­–ç•¥æ¢¯åº¦æ›´æ–°çš„æ–¹å¼</li>
<li>åœ¨å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ä¸­åˆ©ç”¨<strong>å¼ºåŒ–å­¦ä¹ </strong>çš„æ–¹æ³•å­¦ä¹ ä¸€ä¸ªç»„åˆ«çš„åˆ†ç»„å™¨</li>
</ul>
<p><span class="math display">\[
ğ´Â Ì‚(ğ‘˜,ğ‘–,ğœ_{ğ‘¡,ğ‘–},ğ‘ _ğ‘¡ )=ğ‘„Â Ì‚(ğ‘˜,ğ‘–,ğœ_{ğ‘¡,ğ‘–},ğ‘ _ğ‘¡ )âˆ’ğ‘‰Â Ì‚(ğ‘–,ğœ_{ğ‘¡,ğ‘–},ğ‘ _ğ‘¡ )
\]</span></p>
<p><span class="math display">\[
ğ‘‰Â Ì‚(ğ‘–,ğœ_{ğ‘¡,ğ‘–},ğ‘ _ğ‘¡ )=âˆ‘_(ğ‘_{ğ‘¡,ğ‘–}âˆˆğ’œ_ğ‘–) ğœ‹_ğ‘– (ğ‘_{ğ‘¡,ğ‘–}âˆ£ğœ_{ğ‘¡,ğ‘–} ) ğ‘„_ğ‘–
(ğœ_{ğ‘¡,ğ‘–},ğ‘_{ğ‘¡,ğ‘–} )
\]</span></p>
<ul>
<li>ç­–ç•¥æ¢¯åº¦æ›´æ–°çš„æ–¹å¼æ˜¯åŸºäºä¼˜åŠ¿å‡½æ•°çš„æ–¹æ³•è¿›è¡Œæ›´æ–°åˆ†ç»„å™¨</li>
</ul>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122220849824.png"
alt="ä¸åŒåˆ†ç±»å™¨çš„å¯¹æ¯”" />
<figcaption aria-hidden="true">ä¸åŒåˆ†ç±»å™¨çš„å¯¹æ¯”</figcaption>
</figure>
<p>è¿™é‡Œè¿˜é‡‡ç”¨äº†ä¸åŒçš„åˆ†ç»„å™¨æ–¹æ³•åŠ å…¥å®éªŒçš„å¯¹æ¯”</p>
<h4 id="ç®—æ³•æ€è·¯">ç®—æ³•æ€è·¯</h4>
<ul>
<li><p>å°†D åˆ†æˆ<span class="math inline">\(K= âŒˆÎ·NâŒ‰â‰¤ N =
|D|\)</span>ä¸ªå­å›¢é˜Ÿ<span class="math inline">\(G_{t,k}\)</span>
å…¶ä¸­æ¯”ä¾‹<span class="math inline">\(Î· âˆˆ [
1â„N,1]\)</span>ï¼Œæ‰€æœ‰çš„å›¢é˜Ÿé›†åˆ <span
class="math inline">\(G_t=âŸ¨G_{t,1},â€¦,G_{t,K} âŸ©\)</span>ï¼Œ</p></li>
<li><p>åˆ†ç»„ï¼š<span class="math inline">\(G_{t,k}âŠ†D,G_{t,k}âˆ©G_{t,kâ€²}=âˆ…
;D=U_{k=1}^Kâ€Š G_{t,k}\)</span></p></li>
<li><p>ç»„å†…è”åˆåŠ¨ä½œï¼š<span class="math inline">\(a_{t,k}^G=a{t,j}
_jâˆˆG_{t,k}\)</span></p></li>
<li><p>é€‰æ‹©<span
class="math inline">\(Î¨_{VDN}\)</span>ç®—å­åˆ†è§£(æ»¡è¶³IGM)ï¼š</p>
<p><span class="math display">\[
Q_{t,k}^G (Ï„_{t,k}^G,a_{t,k}^G )=Î¨_{VDN} (â‹…)=âˆ‘_{jâˆˆG_{t,k}} Q_j
(Ï„_{t,j},a_{t,j})
\]</span></p></li>
<li><p>æœ€ç»ˆçš„å…¨å±€è”åˆä»·å€¼å‡½æ•°è¿‘ä¼¼ï¼š</p></li>
</ul>
<p><span class="math display">\[
Q_{tot} (Ï„_t,a_t )=Î¨(Q_{t,1}^G (Ï„_{t,1}^G,a_{t,1}^G ),â€¦,Q_{t,K}^G
(Ï„_{t,K}^G,a_{t,K}^G ))
\]</span>
<img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122221728761.png" alt="å¯å˜å­å›¢é˜Ÿçš„ä¼ªä»£ç " style="zoom:67%;" /></p>
<h4 id="igmæ¡ä»¶ä¿æŒ">IGMæ¡ä»¶ä¿æŒ</h4>
<p>å¦‚æœä»¥ç¾¤ç»„ä¸ºå•ä½çš„ä»·å€¼å‡½æ•°åˆ†è§£çš„æ–¹å¼èƒ½å¤Ÿä¿è¯IGMæ¡ä»¶ï¼š <span
class="math display">\[
argmax_(ğ‘_{ğ‘¡,ğ‘˜}^ğºâˆˆğ’œ)â¡ã€–ğ‘„_{tot}(ğœ_ğ‘¡,ğ‘_ğ‘¡)ã€—=
âŸ¨argmax_(âŸ¨ğš_{ğ­,ğ¤}^ğ† âŸ©_(ğº_{ğ‘¡,ğ‘˜}âˆˆğ’¢_ğ‘¡ ))â¡ğ‘„_{ğ‘¡,ğ‘˜}^ğº (ğœ_{ğ‘¡,ğ‘˜}^ğº,ğ‘_{ğ‘¡,ğ‘˜}^ğº
)âŸ©_(ğº_{ğ‘¡,ğ‘˜}âˆˆğ’¢_ğ‘¡)
\]</span> å¸Œæœ›èƒ½å¤Ÿæ»¡è¶³å¯¹äºå±€éƒ¨æ™ºèƒ½ä½“åˆ°å…¨å±€ä»·å€¼å‡½æ•°çš„IGMæ¡ä»¶çš„ä¿æŒ <span
class="math display">\[
argmax_(ğ‘_ğ‘¡âˆˆğ’œ)â¡ğ‘„_{tot}(ğœ_ğ‘¡,ğ‘_ğ‘¡ )=
âŸ¨argmax_(ğ‘_{ğ‘¡,ğ‘–}âˆˆğ’œ_ğ‘– )â¡ğ‘„_ğ‘– (ğœ_{ğ‘¡,ğ‘–},ğ‘_{ğ‘¡,ğ‘–})âŸ©_(ğ‘–âˆˆğ’Ÿ)
\]</span> æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼š <span class="math display">\[
\begin{aligned}
&amp; Q_{t, k}^G\left(\tau_{t, k}^G, a_{t, k}^G\right)=\sum_{j \in G_{t,
k}} Q_j\left(\tau_{t, j}, a_{t, j}\right) ; \operatorname{argmax}_{a_t
\in G_{t, k}} Q_{t, k}^G\left(\tau_{t, k}^G, a_{t,
k}^G\right)=\left\langle\operatorname{argmax}_{a_{t, i} \in
\mathcal{A}_i} Q_i\left(\tau_{t, i}, a_{t, i}\right)\right\rangle_{i \in
G_{t, k}} \\
&amp; a_t \stackrel{\Psi}{=}\left\langle a_{t, k}^G\right\rangle_{G_{t,
k} \in \mathcal{G}_t} \stackrel{\Psi_{V D
N}}{=}\left\langle\left\langle\bar{a}_{t, i}\right\rangle_{i \in G_{t,
k}}\right\rangle_{G_{t, k} \in \mathcal{G}_t}
\stackrel{\mathcal{D}=G_{t, 1} \cup \cdots \cup G_{t,
K}}{=}\left\langle\bar{a}_{t, i}\right\rangle_{i \in \mathcal{D}}
\end{aligned}
\]</span></p>
<h2 id="è‡ªé€‚åº”åˆ†ç»„çš„marl">è‡ªé€‚åº”åˆ†ç»„çš„MARL</h2>
<h3 id="ç ”ç©¶åŠ¨æœº-1">ç ”ç©¶åŠ¨æœº</h3>
<ul>
<li>é€šè¿‡ä»»åŠ¡åˆ†é…å®ç°éšå¼åˆ†ç»„çš„æ–¹æ³•ä»…è§£å†³ç»“æ„æ¸…æ™°çš„ä»»åŠ¡ï¼Œå¹¶ä¸”éœ€è¦é¢†åŸŸçŸ¥è¯†æˆ–å…ˆéªŒè®¾ç½®</li>
<li>VAST ç ”ç©¶å­å›¢é˜Ÿå¯¹ä»·å€¼åˆ†è§£çš„å½±å“ï¼Œä½†éœ€è¦å…ˆéªŒçš„ç»„æ•°ï¼ŒROMA
çš„å­¦ä¹ ä¾èµ–äºæ™ºèƒ½ä½“è§‚å¯Ÿçš„åŠ¨æ€è§’è‰²</li>
</ul>
<h3 id="gomarlç®—æ³•çš„ä¼˜åŠ¿">GoMARLç®—æ³•çš„ä¼˜åŠ¿</h3>
<ul>
<li>ç®—æ³•ä¸ä¾èµ–å…ˆéªŒé¢†åŸŸçŸ¥è¯†</li>
<li>åŠ¨æ€è°ƒæ•´ï¼šåœ¨åˆ†ç»„å­¦ä¹ è¿‡ç¨‹ä¸­æ ¹æ®æ™ºèƒ½ä½“çš„è¡¨ç°<strong>é€æ­¥è°ƒæ•´</strong>åˆ†ç»„åˆ’åˆ†ã€‚åˆ©ç”¨<strong>ç¾¤ä½“ä¿¡æ¯</strong>æ¥ä¿ƒè¿›ç­–ç•¥ä¸“ä¸šåŒ–å’Œé«˜æ•ˆçš„å›¢é˜Ÿåˆä½œ</li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122222736852.png" alt="å¼•å…¥ç¾¤ç»„åˆ’åˆ†æ¿å—çš„åˆ†è§£æ–¹æ³•" style="zoom:67%;" /></p>
<h3 id="ä¸ªä½“ä¸ç¾¤ç»„å…³ç³»å‡è®¾">ä¸ªä½“ä¸ç¾¤ç»„å…³ç³»å‡è®¾</h3>
<ul>
<li><strong>æ‰€æœ‰æ™ºèƒ½ä½“é›†åˆï¼š</strong><span
class="math inline">\(A={a_1,â€¦,a_n }\)</span></li>
<li><strong>åˆ†ç»„é›†åˆ</strong>: <span class="math inline">\(G={g_1,â€¦,g_m
}ï¼Œ1â‰¤mâ‰¤n\)</span></li>
<li>æ¯ä¸ª<span
class="math inline">\(g_i\)</span><strong>åŒ…å«</strong><span
class="math inline">\(n_j
(1â‰¤n_jâ‰¤n)\)</span><strong>ä¸ªä¸åŒçš„æ™ºèƒ½ä½“ï¼Œæœ‰</strong><span
class="math inline">\(g_i={a_(j_1 ),â€¦,a_(j_(n_j )
)}\)</span>ï¼Œ<strong>ä¸”æœ‰</strong><span
class="math inline">\(g_jâˆ©g_k=âˆ…\)</span>ï¼Œ<strong>ä¸”æœ‰</strong><span
class="math inline">\(â‹ƒ_jg_j =Aï¼Œj,kâˆˆ{1,2,â€¦,m}\)</span></li>
</ul>
<h3 id="è‡ªåŠ¨åˆ†ç»„å®ç°æ–¹æ³•">è‡ªåŠ¨åˆ†ç»„å®ç°æ–¹æ³•</h3>
<p>è‡ªåŠ¨åˆ†ç»„çš„åŸºæœ¬é€»è¾‘æ˜¯å­¦ä¹ <span
class="math inline">\(f_g:Aâ†¦G\)</span>ï¼Œè¿™æ ·çš„ç®—å­çš„ç›®æ ‡æ˜¯èƒ½å¤Ÿå­¦ä¹ åˆ°ç³»æ•°æƒé‡
<span class="math display">\[
Q_G^{tot} (s_t,u_t )=E_(s_{t+1:âˆ},u_{t+1:âˆ} ) [âˆ‘_(k=0)^âˆâ€ŠÎ³^k
r_{t+k}âˆ£s_t,u_t;G]
\]</span> è®©æ€»ä½“çš„è”åˆåŠ¨ä½œä»·å€¼å‡½æ•°çš„å€¼æœ€å¤§ï¼Œåˆ†ç»„çš„ä»·å€¼å‡½æ•°ä¸ºï¼š <span
class="math display">\[
ğ‘„^{ğ‘”_ğ‘—}=ğ‘“(ğ‘„^{ğ‘—_1} (ğœ^{ğ‘—_1},ğ‘¢^{ğ‘—_1}),â‹¯,ğ‘„^{ğ‘—_{ğ‘›_ğ‘—}} (ğœ^{ğ‘—_(ğ‘›_ğ‘—
)},ğ‘¢^{ğ‘—_{ğ‘›_ğ‘—}};ğ‘¤_1^{ğ‘”_ğ‘—})
\]</span> å­¦ä¹ åˆ°çš„è´¡çŒ®ç¨‹åº¦ä¸ºï¼š<span
class="math inline">\(ğ‘¤_1^{ğ‘”_ğ‘—}\)</span>ï¼Œè®­ç»ƒçš„ç›®æ ‡å‡½æ•°ä¸ºï¼š <span
class="math display">\[
â„’_ğ‘” (ğœƒ_{w_1})=ğ”¼_((ğ³,ğ®,ğ‘Ÿ,ğ³â€²)âˆ¼â„¬âˆ‘_ğ‘–(âˆ¥ğ‘“_(w_1)^ğ‘– (ğœ^ğ‘– (ğ‘§^ğ‘–,ğ‘¢^ğ‘– );ğœƒ_(w_1)^ğ‘–
)âˆ¥_{ğ‘™_1})
\]</span>
æ ¹æ®æ¯æ¬¡åœ¨åˆ†ç»„ä¸­çš„è´¡çŒ®æƒé‡æ¥ä¾æ¬¡è°ƒæ•´æ™ºèƒ½ä½“çš„åˆ†ç»„ï¼Œå½“è´¡çŒ®çš„æƒé‡è¿‡å°çš„è¯ï¼Œå°±è®¤ä¸ºæ™ºèƒ½ä½“ä¸å±äºåˆ†ç»„ä¸­ï¼Œè¿›å…¥ä¸‹ä¸€è½®çš„åˆ†ç»„è°ƒæ•´ä¸­ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122223325635.png"
alt="è‡ªåŠ¨åˆ†ç»„çš„é€»è¾‘å›¾" />
<figcaption aria-hidden="true">è‡ªåŠ¨åˆ†ç»„çš„é€»è¾‘å›¾</figcaption>
</figure>
<h3 id="agent-networkçš„ä¼˜åŒ–">Agent Networkçš„ä¼˜åŒ–</h3>
<ul>
<li><p>æ™ºèƒ½ä½“å†…åµŒä¿¡æ¯ç½‘ç»œè·å–çš„ç¾¤ç»„ç›¸å…³ä¿¡æ¯<span
class="math inline">\(e_i\)</span></p></li>
<li><p><strong>Similarity-Diversity
objective</strong>ï¼šæ¥è‡ªåŒä¸€ç»„çš„æ™ºèƒ½ä½“çš„ä¿¡æ¯æ˜¯ç›¸ä¼¼çš„ï¼Œæ¥è‡ªä¸åŒç¾¤ä½“çš„æ™ºèƒ½ä½“ä¿¡æ¯ä¹‹é—´ä¿æŒå¤šæ ·æ€§ï¼š
<span class="math display">\[
\begin{gathered}
\mathcal{L}_{S
D}\left(\theta_e\right)=\mathbb{E}_{\mathcal{B}}\left(\sum_{i \neq j}
I(i, j) \cdot \operatorname{cosine}\left(f_e\left(h^i ; \theta_e\right),
f_e\left(h^j ; \theta_e\right)\right)\right) \\
\text { where } I(i, j)=\left\{\begin{array}{cc}
-1, &amp; a^i, a^j \in g^k \\
1, &amp; a^i \in g^k, a^j \in g^l, k \neq l
\end{array}\right.
\end{gathered}
\]</span>
å¾ˆç›´è§‚çš„ç†è§£ï¼Œå¯¹äºåˆä½œå‹çš„å¼ºåŒ–å­¦ä¹ ä»»åŠ¡è€Œè¨€ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªä»»åŠ¡åŸŸå†…å¼ºåŒ–ç­–ç•¥çš„åˆä½œï¼Œè€Œä¸åŒçš„ä»»åŠ¡åŸŸå†…çš„ç­–ç•¥åº”å½“ä¿æŒå¤šæ ·æ€§ï¼Œèƒ½å¤Ÿè®©å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¢ç´¢æ›´å¤šçš„å¯èƒ½æ€§ï¼Œé˜²æ­¢é™·å…¥å±€éƒ¨æœ€ä¼˜çš„æƒ…å†µã€‚</p></li>
<li><p><strong>Agent Networkç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å¤šæ ·åŒ–çš„ç­–ç•¥ï¼Œéƒ¨åˆ†å…±äº«å‚æ•°çš„ç­–ç•¥å»ä¸­å¿ƒåŒ–</li>
<li>è¶…ç½‘ç»œ<span
class="math inline">\(f_d\)</span>å°†æå–çš„æ™ºèƒ½ä½“ä¿¡æ¯eé›†æˆåˆ°ç­–ç•¥æ¢¯åº¦ä¸­</li>
</ul></li>
<li><p>åˆç†æ€§è¡¨ç¤ºï¼š <span class="math display">\[
ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡}/(ğœ•ğœƒ_â„ )=(ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡})/(ğœ•ğ‘„^ğ‘ )  (ğœ•ğ‘„^ğ‘)/(ğœ•ğœƒ_â„ )=(ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡})/(ğœ•ğ‘„^ğ‘
)  (ğœ•ğ‘„^ğ‘)/(ğœ•ğ‘£_â„^ğ‘ )  (ğœ•ğ‘£_â„^ğ‘)/(ğœ•ğœƒ_â„ )=ğ‘“_ğ‘‘ (ğ‘’^ğ‘ )â‹…(ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡})/(ğœ•ğ‘„^ğ‘
)  (ğœ•ğ‘£_â„^ğ‘)/(ğœ•ğœƒ_â„ )
\]</span></p></li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122225119182.png" alt="Agent Networkä¼˜åŒ–æ–¹å¼" style="zoom:67%;" /></p>
<h3 id="æ•´ä½“çš„è®­ç»ƒæ¡†æ¶">æ•´ä½“çš„è®­ç»ƒæ¡†æ¶</h3>
<h6 id="åŒå±‚æ··åˆç½‘ç»œ">åŒå±‚æ··åˆç½‘ç»œ</h6>
<ul>
<li><p>ç¾¤ä½“çŠ¶æ€ä¸‹çš„ç¾¤ä½“è¡ŒåŠ¨ä»·å€¼ä¿¡æ¯ï¼Œå°†å…¨å±€çš„çŠ¶æ€åˆ†è§£æˆå±€éƒ¨çš„çŠ¶æ€ä¿¡æ¯ç”¨äºè®­ç»ƒï¼Œè¿™éƒ¨åˆ†çš„å±€éƒ¨çŠ¶æ€ä¿¡æ¯æ˜¯åŸºäºç¾¤ç»„åˆ’åˆ†ä¹‹åçš„çŠ¶æ€ä¿¡æ¯</p></li>
<li><p><span class="math inline">\(s^{g_j}\)</span> æ˜¯åˆ†ç»„å<span
class="math inline">\(e_t^i (a_iâˆˆg_j
)\)</span>æŒ‰ç»„åˆ«èåˆï¼Œå»ºç«‹åˆ†ç»„å™¨æ˜ å°„</p>
<p><span class="math display">\[
f_{w_2}(s^g )ï¼šs^gâ†’w_2^g
\]</span></p></li>
<li><p>é›†ä¸­åˆ°ç­–ç•¥æ¢¯åº¦ä¸­ï¼Œå†…åµŒç¾¤ç»„çŠ¶æ€ä¿¡æ¯æ½œåœ¨ä¿ƒè¿›ç»„å†…åˆä½œï¼š <span
class="math display">\[
ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡}/(ğœ•ğœƒ_â„ )=(ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡})/(ğœ•ğ‘„^ğ‘ )  (ğœ•ğ‘„^ğ‘)/(ğœ•ğœƒ_â„ )=(ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡})/(ğœ•ğ‘„^ğ‘
)  (ğœ•ğ‘„^ğ‘)/(ğœ•ğ‘£_â„^ğ‘ )  (ğœ•ğ‘£_â„^ğ‘)/(ğœ•ğœƒ_â„ )=ğ‘“_ğ‘‘ (ğ‘’^ğ‘ )â‹…(ğœ•ğ‘„^{ğ‘¡ğ‘œğ‘¡})/(ğœ•ğ‘„^ğ‘
)  (ğœ•ğ‘£_â„^ğ‘)/(ğœ•ğœƒ_â„ )
\]</span></p></li>
<li><p>æŒ‰ç…§å…¨æ–‡çš„æ€»å…±æ–¹æ³•çš„æ€»è¿°å¯ä»¥å¾—åˆ°å…¨å±€åˆ†è§£ç›®æ ‡ï¼š <span
class="math display">\[
â„’(ğœƒ)=â„’_ğ‘‡ğ· (ğœƒ)+ğœ†_ğ‘” â„’_ğ‘” (ğœƒ_(w_1 ) )+ğœ†_ğ‘†ğ· â„’_ğ‘†ğ· (ğœƒ_ğ‘’ )
\]</span></p></li>
</ul>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122225354328.png"
alt="æ€»ä½“è®­ç»ƒæ¡†æ¶" />
<figcaption aria-hidden="true">æ€»ä½“è®­ç»ƒæ¡†æ¶</figcaption>
</figure>
<h3 id="section"></h3>
<h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3>
<p>GoMARLä»£ç çš„å®ç°æ˜¯åŸºäºpymarlå¤šæ™ºèƒ½ä½“çš„è®­ç»ƒæ¡†æ¶è¿›è¡Œæ”¹è¿›çš„ï¼Œè¿™é‡Œä¸»è¦å¯¹å…¶ä¸­
<code>learning</code> <code>mixing</code>çš„ç½‘ç»œéƒ¨åˆ†è¿›è¡Œå±•å¼€å™è¿°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> buffer.can_sample(args.batch_size):<br>      next_episode = episode + args.batch_size_run<br>      <span class="hljs-keyword">if</span> args.accumulated_episodes <span class="hljs-keyword">and</span> next_episode % args.accumulated_episodes != <span class="hljs-number">0</span>:<br>               <span class="hljs-keyword">continue</span><br><br>      episode_sample = buffer.sample(args.batch_size)<br>      max_ep_t = episode_sample.max_t_filled()<br>      episode_sample = episode_sample[:, :max_ep_t]<br>      <span class="hljs-keyword">if</span> episode_sample.device != args.device:<br>          episode_sample.to(args.device)<br><br>      learner.train(episode_sample, runner.t_env, episode)<br>      <span class="hljs-keyword">del</span> episode_sample<br><br></code></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸€æ­¥ä¸­é€šè¿‡è°ƒç”¨
<code>learner.train(episode_sample, runner.t_env, episode)</code>æ¥å¯¹è‡ªåŠ¨åˆ†ç»„çš„å­¦ä¹ å™¨è¿›è¡Œå¼ºåŒ–å­¦ä¹ </p>
<p>åœ¨<code>learner</code>ä¸­ï¼Œé€šè¿‡ä½¿ç”¨å…¶ä¸­çš„<code>mixer</code>
å¯¹è”åˆçš„åŠ¨ä½œä»·å€¼å‡½æ•°è¿›è¡Œå­¦ä¹ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Pick the Q-Values for the actions taken by each agent</span><br>        chosen_action_qvals = th.gather(mac_out[:, :-<span class="hljs-number">1</span>], dim=<span class="hljs-number">3</span>, index=actions).squeeze(<span class="hljs-number">3</span>)<br><br> <span class="hljs-comment"># Mixer</span><br>        chosen_action_qvals, w1_avg_list, sd_loss = self.mixer(chosen_action_qvals, batch[<span class="hljs-string">&quot;state&quot;</span>][:, :-<span class="hljs-number">1</span>], mac_hidden[:, :-<span class="hljs-number">1</span>], mac_group_state[:, :-<span class="hljs-number">1</span>], <span class="hljs-string">&quot;eval&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯¦ç»†ä»‹ç» <code>mixer</code>å‡½æ•°éƒ¨åˆ†çš„å®ç°</p>
<p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯å¯¹è¶…å‚æ•°çš„é¢„è®¾ï¼Œä»<code>yaml</code>æ–‡ä»¶ä¸­è¯»å–äº†é¢„è®¾çš„è¶…å‚æ•°çš„æ•°å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">self.args = args<br>    self.<span class="hljs-built_in">abs</span> = <span class="hljs-built_in">abs</span><br>    self.n_agents = args.n_agents<br>    self.embed_dim = args.mixing_embed_dim<br>    self.hypernet_dim = args.hypernet_embed<br>    self.grouping_hypernet_dim = args.grouping_hypernet_embed<br>    <br>    self.group = args.group<br>    <span class="hljs-keyword">if</span> self.group <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        self.group = [[_ <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.n_agents)]]<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥æ˜¯è®¡ç®—å‡ºæ•´ä¸ªçŠ¶æ€ç©ºé—´çš„å…¨éƒ¨ç»´åº¦=4<em>4 </em>10</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">self.state_dim = <span class="hljs-built_in">int</span>(np.prod(args.state_shape))<br></code></pre></td></tr></table></figure>
<h4 id="å®šä¹‰ç½‘ç»œç»“æ„">å®šä¹‰ç½‘ç»œç»“æ„</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">self.hyper_w1 = nn.ModuleList(nn.Sequential(nn.Linear(self.a_h_dim, self.grouping_hypernet_dim),<br>                                        nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                        nn.Linear(self.grouping_hypernet_dim, self.embed_dim))<br>                                        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.n_agents))<br>self.hyper_b1 = nn.ModuleList([nn.Sequential(nn.Linear(self.a_h_dim, self.embed_dim))])<br><br>self.hyper_w2 = nn.ModuleList([nn.Sequential(nn.Linear(self.hypernet_dim, self.hypernet_dim),<br>                                        nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                        nn.Linear(self.hypernet_dim, self.embed_dim))])<br>        <br>self.hyper_b2 = nn.ModuleList([nn.Sequential(nn.Linear(self.hypernet_dim, self.embed_dim),<br>                                        nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                        nn.Linear(self.embed_dim, <span class="hljs-number">1</span>))])<br>self.hyper_w3 = nn.Sequential(nn.Linear(self.hypernet_dim, self.hypernet_dim),<br>                                        nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                        nn.Linear(self.hypernet_dim, self.embed_dim))<br>self.hyper_b3 = nn.Sequential(nn.Linear(self.hypernet_dim, self.embed_dim))<br>self.hyper_w4 = nn.Sequential(nn.Linear(self.state_dim, self.hypernet_dim),<br>                                        nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                        nn.Linear(self.hypernet_dim, self.embed_dim))<br>self.hyper_b4 = nn.Sequential(nn.Linear(self.state_dim, self.embed_dim),<br>                            nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br></code></pre></td></tr></table></figure>
<p>MyModule ç±»ä¸­æœ‰ä¸€ä¸ªåä¸º linears çš„ <code>nn.ModuleList</code>
å±æ€§ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªç”±äº”ä¸ª nn.Linear å±‚ç»„æˆçš„åˆ—è¡¨ã€‚å½“ forward
æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè¾“å…¥ x ä¼šè¢«åºåˆ—åŒ–åœ°é€šè¿‡è¿™äº”ä¸ªçº¿æ€§å±‚ã€‚</p>
<p><code>nn.Sequential</code>
çš„å¥½å¤„æ˜¯ï¼Œå®ƒç®€åŒ–äº†æ¨¡å—çš„é¡ºåºç®¡ç†ï¼Œä½ ä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™å¤æ‚çš„
<code>forward</code>
æ–¹æ³•æ¥å¤„ç†æ•°æ®é€šè¿‡æ¯ä¸ªæ¨¡å—çš„è¿‡ç¨‹ã€‚<code>nn.Sequential</code>
ä¼šè‡ªåŠ¨ä¸ºä½ å®Œæˆè¿™ä¸ªè¿‡ç¨‹</p>
<p>æ¯æ¬¡å¢åŠ åˆ†ç»„éƒ½ä¼šäº§ç”Ÿæ–°çš„æ¨¡å—éœ€è¦æ–°çš„ <code>mixing network</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_new_net</span>(<span class="hljs-params">self</span>):<br>        self.hyper_b1.append(nn.Sequential(nn.Linear(self.a_h_dim, self.embed_dim)))<br><br>        self.hyper_w2.append(nn.Sequential(nn.Linear(self.hypernet_dim, self.hypernet_dim),<br>                                           nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                           nn.Linear(self.hypernet_dim, self.embed_dim)))<br>        <br>        self.hyper_b2.append(nn.Sequential(nn.Linear(self.hypernet_dim, self.embed_dim),<br>                                           nn.ReLU(inplace=<span class="hljs-literal">True</span>),<br>                                           nn.Linear(self.embed_dim, <span class="hljs-number">1</span>)))<br>        <span class="hljs-keyword">if</span> self.args.use_cuda:<br>            self.hyper_b1.cuda()<br>            self.hyper_w2.cuda()<br>            self.hyper_b2.cuda()<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;New Mixer Size:&quot;</span>)<br>        <span class="hljs-built_in">print</span>(get_parameters_num(self.parameters()))<br></code></pre></td></tr></table></figure>
<p>åŒæ ·å¯¹åº”çš„å°±æ˜¯åˆ é™¤æŸä¸ªç»„çš„æŸä¸ªç½‘ç»œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">ef del_net(self, idx):<br>        <span class="hljs-keyword">del</span> self.hyper_b1[idx]<br>        <span class="hljs-keyword">del</span> self.hyper_w2[idx]<br>        <span class="hljs-keyword">del</span> self.hyper_b2[idx]<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Del Group &#123;&#125; Network Mixer Size:&quot;</span>.<span class="hljs-built_in">format</span>(idx))<br>        <span class="hljs-built_in">print</span>(get_parameters_num(self.parameters()))<br></code></pre></td></tr></table></figure>
<h4 id="åˆ’åˆ†æˆç»„ä¸ºå•ä½">åˆ’åˆ†æˆç»„ä¸ºå•ä½</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> group_index, group_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.group):<br>            group_state = all_group_state[:, group_i, :]<br>            group_state = th.<span class="hljs-built_in">max</span>(group_state, dim=<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]<br>            group_state_list.append(group_state)<br></code></pre></td></tr></table></figure>
<h4 id="ç”Ÿæˆæœ€å¼€å§‹çš„-w_1æƒé‡">ç”Ÿæˆæœ€å¼€å§‹çš„ <span
class="math inline">\(w_1\)</span>æƒé‡</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.n_agents):<br>            w1 = self.hyper_w1[i](a_h[:, i, :])<br>            <span class="hljs-keyword">if</span> self.<span class="hljs-built_in">abs</span>:<br>                w1 = w1.<span class="hljs-built_in">abs</span>()<br>            w1_list.append(w1)<br>        <br>        w1 = th.stack(w1_list, dim=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<h4 id="è®¡ç®—sd-loss">è®¡ç®—SD Loss</h4>
<p>è¿™éƒ¨åˆ†ä¸»è¦æ˜¯åœ¨è®¡ç®—ç»„å†…ç›¸ä¼¼æ€§ å’Œç»„é—´ç›¸ä¼¼æ€§ä»è€Œå¾—å‡ºSD lossçš„æŸå¤±å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">sd_loss = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> group_index, group_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.group):<br>            group_n = <span class="hljs-built_in">len</span>(group_i)<br>            group_qs = qvals[:, :, group_i]<br>            group_qs = group_qs.reshape(b * t, <span class="hljs-number">1</span>, group_n)<br><br>            group_a_h = a_h[:, group_i, :]<br><br>            group_w1 = w1[:, group_i, :]<br><br>            b1 = self.hyper_b1[group_index](group_a_h)<br>            b1 = th.<span class="hljs-built_in">sum</span>(b1, dim=<span class="hljs-number">1</span>, keepdim=<span class="hljs-literal">True</span>)<br>            <br>            group_j = []<br>            <span class="hljs-keyword">for</span> group_tmp <span class="hljs-keyword">in</span> self.group:<br>                <span class="hljs-keyword">if</span> group_tmp != group_i:<br>                    group_j += group_tmp<br><br>            <span class="hljs-keyword">for</span> agent_i <span class="hljs-keyword">in</span> group_i:<br>                group_state_agent_i = all_group_state[:, agent_i, :].unsqueeze(<span class="hljs-number">1</span>)<br>                group_state_sim = all_group_state[:, group_i, :]<br>                group_state_div = all_group_state[:, group_j, :]<br>                group_state_agent_i_sim = group_state_agent_i.expand_as(group_state_sim)<br>                group_state_agent_i_div = group_state_agent_i.expand_as(group_state_div)<br><br>                sim_loss = th.<span class="hljs-built_in">sum</span>(group_state_agent_i_sim * group_state_sim, dim=-<span class="hljs-number">1</span>) / \<br>                                ((th.<span class="hljs-built_in">sum</span>(group_state_agent_i_sim ** <span class="hljs-number">2</span>, dim=-<span class="hljs-number">1</span>) ** <span class="hljs-number">0.5</span>) * (th.<span class="hljs-built_in">sum</span>(group_state_sim ** <span class="hljs-number">2</span>, dim=-<span class="hljs-number">1</span>) ** <span class="hljs-number">0.5</span>))<br>                div_loss = th.<span class="hljs-built_in">sum</span>(group_state_agent_i_div * group_state_div, dim=-<span class="hljs-number">1</span>) / \<br>                                ((th.<span class="hljs-built_in">sum</span>(group_state_agent_i_div ** <span class="hljs-number">2</span>, dim=-<span class="hljs-number">1</span>) ** <span class="hljs-number">0.5</span>) * (th.<span class="hljs-built_in">sum</span>(group_state_div ** <span class="hljs-number">2</span>, dim=-<span class="hljs-number">1</span>) ** <span class="hljs-number">0.5</span>))<br><br>                sd_loss -= th.<span class="hljs-built_in">sum</span>(sim_loss, dim=-<span class="hljs-number">1</span>)<br>                sd_loss += th.<span class="hljs-built_in">sum</span>(div_loss, dim=-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<h4 id="ç”Ÿæˆç»„åˆ«ä¸ºå•ä½çš„ä»·å€¼å‡½æ•°">ç”Ÿæˆç»„åˆ«ä¸ºå•ä½çš„ä»·å€¼å‡½æ•°</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">group_state = group_state_list[group_index]<br>w2 = self.hyper_w2[group_index](group_state).view(b*t, self.embed_dim, <span class="hljs-number">1</span>)<br>b2 = self.hyper_b2[group_index](group_state).view(b*t, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> self.<span class="hljs-built_in">abs</span>:<br>      w2 = w2.<span class="hljs-built_in">abs</span>()<br>            <br>group_w1_avg = th.mean(th.mean(group_w1, dim=<span class="hljs-number">2</span>, keepdim=<span class="hljs-literal">False</span>), dim=<span class="hljs-number">0</span>, keepdim=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">if</span> self.group_turn_now == group_index:<br>      w1_avg_list.append(group_w1_avg)<br>    	hidden = F.elu(th.matmul(group_qs, group_w1) + b1)<br>      q_group = th.matmul(hidden, w2) + b2<br>      group_q_list.append(q_group.view(b*t, <span class="hljs-number">1</span>))<br></code></pre></td></tr></table></figure>
<h4 id="ç”Ÿæˆæ€»çš„ä»·å€¼å‡½æ•°">ç”Ÿæˆæ€»çš„ä»·å€¼å‡½æ•°</h4>
<p>ä¸‹é¢è¿™ä¸€æ­¥æ˜¯åŸºäºæŒ‰ç…§ç»„åˆ’åˆ†å¾—åˆ°çš„ä»·å€¼å‡½æ•°ç”Ÿæˆæ€»çš„è”åˆåŠ¨ä½œä»·å€¼å‡½æ•°çš„è¿‡ç¨‹</p>
<p>å…¶ä¸­ç”¨åˆ°äº†ä¸¤ä¸ªç”Ÿæˆå‚æ•°çš„æœºå™¨ w3å’Œw4ä»¥åŠb3ï¼Œb4
å…¶å®ç»“æ„å’Œä¹‹å‰çš„æ˜¯ä¸€æ ·çš„</p>
<p>æœ€åè¿”å›å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">group_tot_q = th.stack(group_q_list, dim=-<span class="hljs-number">1</span>)<br>        group_state_stack = th.stack(group_state_list, dim=<span class="hljs-number">1</span>)<br>        w3 = self.hyper_w3(group_state_stack)<br>        b3 = self.hyper_b3(group_state_stack)<br>        b3 = th.<span class="hljs-built_in">sum</span>(b3, dim=<span class="hljs-number">1</span>, keepdim=<span class="hljs-literal">True</span>)<br><br>        w4 = self.hyper_w4(states).view(b*t, self.embed_dim, <span class="hljs-number">1</span>)<br>        b4 = self.hyper_b4(states).view(b*t, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><br>        <span class="hljs-keyword">if</span> self.<span class="hljs-built_in">abs</span>:<br>            w3 = w3.<span class="hljs-built_in">abs</span>()<br>            w4 = w4.<span class="hljs-built_in">abs</span>()<br>        <br>        tot_hidden = F.elu(th.matmul(group_tot_q, w3) + b3)<br>        tot_q = th.matmul(tot_hidden, w4) + b4<br></code></pre></td></tr></table></figure>
<p>è¿”å›çš„ä¸œè¥¿åˆ†åˆ«æ˜¯ï¼šæ€»çš„è”åˆåŠ¨ä½œä»·å€¼å‡½æ•°ã€w1æƒé‡çš„å¹³å‡å€¼å°±æ˜¯ç”Ÿæˆw1åˆ†ç±»å™¨çš„å¥½åã€SDloss</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">return</span> tot_q.view(b, t, -<span class="hljs-number">1</span>) , w1_avg_list, sd_loss.view(b, t, -<span class="hljs-number">1</span>) / (self.n_agents * self.n_agents)<br></code></pre></td></tr></table></figure>
<h4 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h4>
<p>è¿™ä¸ªåœ°æ–¹åˆ©ç”¨äº†ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆçš„æŸå¤±å‡½æ•°æ¥è®¡ç®—æœ€ç»ˆçš„æŸå¤±</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># lasso loss</span><br>        lasso_loss = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(w1_avg_list)):<br>            group_w1_sum = th.<span class="hljs-built_in">sum</span>(w1_avg_list[i])<br>            lasso_loss += group_w1_sum * lasso_alpha[i]<br>        <br>        sd_loss = sd_loss * mask<br>        sd_loss = self.args.sd_alpha * sd_loss.<span class="hljs-built_in">sum</span>() / mask.<span class="hljs-built_in">sum</span>()<br><br>        td_error = (chosen_action_qvals - targets.detach())<br>        td_error = <span class="hljs-number">0.5</span> * td_error.<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>)<br><br><br>        mask = mask.expand_as(td_error)<br>        masked_td_error = td_error * mask<br>        td_loss = masked_td_error.<span class="hljs-built_in">sum</span>() / mask.<span class="hljs-built_in">sum</span>()<br><br>        loss = td_loss + lasso_loss + sd_loss<br></code></pre></td></tr></table></figure>
<h4 id="æ”¹å˜åˆ†ç»„çš„è¿‡ç¨‹">æ”¹å˜åˆ†ç»„çš„è¿‡ç¨‹</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> change_group_i == self.args.change_group_batch_num - <span class="hljs-number">1</span>:<br> self.agent_w1_avg /= self.args.change_group_batch_num<br>            group_now = copy.deepcopy(self.mixer.group)<br>            group_nxt = copy.deepcopy(self.mixer.group)<br>            <span class="hljs-keyword">for</span> group_index, group_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(group_now):<br>                group_w1_avg = self.agent_w1_avg[group_i]<br><br>                group_avg = th.mean(group_w1_avg)<br>                relative_lasso_threshold = group_avg * self.args.change_group_value<br>                indices = th.where(group_w1_avg &lt; relative_lasso_threshold)[<span class="hljs-number">0</span>]<br><br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(group_i) &lt; <span class="hljs-number">3</span>:<br>                    <span class="hljs-keyword">continue</span><br>                <br>                <span class="hljs-keyword">if</span> group_index+<span class="hljs-number">1</span> == <span class="hljs-built_in">len</span>(group_now) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(indices) != <span class="hljs-number">0</span>:<br>                    tmp = []<br>                    group_nxt.append(tmp)<br>                    self.mixer.add_new_net()<br>                    self.target_mixer.add_new_net()<br>                <br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indices)-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>                    idx = group_now[group_index][indices[i]]<br>                    group_nxt[group_index+<span class="hljs-number">1</span>].append(idx)<br>                    <span class="hljs-keyword">del</span> group_nxt[group_index][indices[i]]<br>                    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> self.mixer.hyper_w1[idx]:<br>                        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(m) != nn.ReLU:<br>                            m.reset_parameters()<br>            <br>            whether_group_changed = <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span> group_now != group_nxt <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span><br>            <br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> whether_group_changed:<br>                <span class="hljs-keyword">return</span><br>            <br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(group_nxt)-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>                <span class="hljs-keyword">if</span> group_nxt[i] == []:<br>                    <span class="hljs-keyword">del</span> group_nxt[i]<br>                    self.mixer.del_net(i)<br>                    self.target_mixer.del_net(i)<br>            <br>            self.mixer.update_group(group_nxt)<br>            self.target_mixer.update_group(group_nxt)<br>            self._update_targets()<br></code></pre></td></tr></table></figure>
<h3 id="å®éªŒç»“æœ">å®éªŒç»“æœ</h3>
<p>åœ¨æ˜Ÿé™…äº‰éœ¸çš„ç¯å¢ƒä¸­çš„è®­ç»ƒç»“æœ</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122225759954.png"
alt="SMACè®­ç»ƒç»“æœ" />
<figcaption aria-hidden="true">SMACè®­ç»ƒç»“æœ</figcaption>
</figure>
<p>æ¶ˆèå®éªŒ</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122225941711.png"
alt="æ¶ˆèå®éªŒå¯¹æ¯”" />
<figcaption aria-hidden="true">æ¶ˆèå®éªŒå¯¹æ¯”</figcaption>
</figure>
<p>è°·æ­Œè¶³çƒçš„è®­ç»ƒç»“æœ</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231122225826734.png"
alt="GRFçš„è®­ç»ƒç»“æœä¸å¯è§†åŒ–" />
<figcaption aria-hidden="true">GRFçš„è®­ç»ƒç»“æœä¸å¯è§†åŒ–</figcaption>
</figure>
]]></content>
      <categories>
        <category>å¼ºåŒ–å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>å¼ºåŒ–å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åŸºç¡€å·¥å…·ã€‘Anacondaå‘½ä»¤é›†</title>
    <url>/2023/10/22/conda_list/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h2 id="condaå®‰è£…">Condaå®‰è£…</h2>
<h3 id="ç›´æ¥å®‰è£…">ç›´æ¥å®‰è£…</h3>
<p>å®‰è£…ç½‘å€https://www.anaconda.com/ï¼Œä½†æ˜¯ä¸‹è½½é€Ÿåº¦å¾ˆæ…¢</p>
<h3 id="é•œåƒå®‰è£…">é•œåƒå®‰è£…</h3>
<p>æ¸…åæºç½‘å€https://mirrors.tuna.tsinghua.edu.cn/anaconda/</p>
<p>ä¸‹è½½é€Ÿåº¦ä¼šæ¯”è¾ƒå¿«</p>
<p>å¦‚æœè§‰å¾—anacodnaçš„åŒ…éå¸¸å¤§ï¼Œå¯ä»¥é€‰æ‹©å®‰è£…miniconda
https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/</p>
<h2 id="conda-å¸¸ç”¨å‘½ä»¤">Conda å¸¸ç”¨å‘½ä»¤</h2>
<h3 id="æŸ¥çœ‹condaç‰ˆæœ¬">æŸ¥çœ‹condaç‰ˆæœ¬</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda --version/ conda -V<br></code></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹å·²æœ‰ç¯å¢ƒ">æŸ¥çœ‹å·²æœ‰ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda info --envs<br>conda env <span class="hljs-built_in">list</span><br>conda info -e<br></code></pre></td></tr></table></figure>
<h3 id="è¿›é€€ç¯å¢ƒ">è¿›é€€ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda activate  [name]<span class="hljs-comment"># é‡æ–°è¿›å…¥è™šæ‹Ÿç¯å¢ƒ</span><br>conda deactivate  <span class="hljs-comment"># é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</span><br></code></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºæ–°çš„ç¯å¢ƒ">åˆ›å»ºæ–°çš„ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda create -n *** python=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<h3 id="åˆ é™¤ç¯å¢ƒ">åˆ é™¤ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda remove -n old_name --<span class="hljs-built_in">all</span> <span class="hljs-comment"># åˆ é™¤ç¯å¢ƒold_name</span><br></code></pre></td></tr></table></figure>
<h3 id="æ¿€æ´»ç¯å¢ƒ">æ¿€æ´»ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda activate xxxx <span class="hljs-comment"># æ¿€æ´»xxxxç¯å¢ƒ</span><br></code></pre></td></tr></table></figure>
<h3 id="å…³é—­ç¯å¢ƒ">å…³é—­ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda deactivate <span class="hljs-comment"># å…³é—­ç¯å¢ƒ</span><br></code></pre></td></tr></table></figure>
<h3 id="å…‹éš†ç¯å¢ƒ">å…‹éš†ç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda create -n [new_name] --clone [old_name]<br></code></pre></td></tr></table></figure>
<h3 id="å‡çº§ç‰ˆæœ¬">å‡çº§ç‰ˆæœ¬</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda update -n base conda <span class="hljs-comment">#updateæœ€æ–°ç‰ˆæœ¬çš„condaï¼›</span><br>conda update --<span class="hljs-built_in">all</span> <span class="hljs-comment">#æ›´æ–°æ‰€æœ‰åŒ…</span><br></code></pre></td></tr></table></figure>
<h3 id="pipç®¡ç†çš„å¸¸ç”¨åŒ…">Pipç®¡ç†çš„å¸¸ç”¨åŒ…</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">pip search package_name <br>pip show package_name <br>pip uninstallï½œï½œpackage_name<br>pip <span class="hljs-built_in">list</span><br></code></pre></td></tr></table></figure>
<h3 id="åˆ é™¤ç¯å¢ƒä¸­çš„åŒ…">åˆ é™¤ç¯å¢ƒä¸­çš„åŒ…</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda remove package <span class="hljs-comment">#åˆ é™¤å½“å‰ç¯å¢ƒä¸­çš„åŒ…</span><br>conda remove -- name env_name package <span class="hljs-comment">#åˆ é™¤æŒ‡å®šç¯å¢ƒä¸­çš„åŒ…</span><br></code></pre></td></tr></table></figure>
<h3 id="æŒ‡å®šç¯å¢ƒä¸­å®‰è£…åŒ…">æŒ‡å®šç¯å¢ƒä¸­å®‰è£…åŒ…</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda install --name env_name package_name <br></code></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆcondaç¯å¢ƒä¾èµ–åŒ…çš„ç‰ˆæœ¬">ç”ŸæˆCondaç¯å¢ƒä¾èµ–åŒ…çš„ç‰ˆæœ¬</h3>
<p>åœ¨åšå®éªŒçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è¾“å‡ºä¸€ä¸ªå…³äºå½“å‰ç¯å¢ƒçš„ç‰ˆæœ¬ä¾èµ–æ–‡ä»¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è¿›è¡Œè¾“å‡º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">pip list --format=freeze&gt; requirements.txt<br></code></pre></td></tr></table></figure>
<h3 id="condaç¯å¢ƒçš„pythonç‰ˆæœ¬éæŒ‡å®š">Condaç¯å¢ƒçš„pythonç‰ˆæœ¬éæŒ‡å®š</h3>
<p>æŒ‡å®šè™šæ‹Ÿç¯å¢ƒxçš„pythonç‰ˆæœ¬æ˜¯3.8ï¼Œbaseç¯å¢ƒæ˜¯3.11ï¼›conda
activateæ¿€æ´»xä¹‹åpythonç‰ˆæœ¬ä»ä¸º3.11ã€‚</p>
<p><strong>åŸå› ï¼š</strong>åœ¨baseç¯å¢ƒä¸­ä¿®æ”¹äº†.zshrcæ–‡ä»¶ä¸­çš„pythonåªå®šè·¯å¾„ï¼Œè®©æ¯æ¬¡è™šæ‹Ÿç¯å¢ƒä¸­çš„pythonæ‰¾åˆ°çš„pythonéƒ½åªèƒ½æŒ‰ç…§æŒ‡å®šçš„pythonè·¯å¾„è¿›è¡Œå¯»æ‰¾ï¼Œä»è€Œå¯¼è‡´condaç¯å¢ƒä¸­çš„pythonç‰ˆæœ¬ä¸èƒ½åˆ¶å®šã€‚</p>
<p><strong>ä¿®æ”¹æ–¹å¼ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">vim .zshrc<br></code></pre></td></tr></table></figure>
<p>è¿›å…¥
.zshrcç¯å¢ƒä¸­è¿›è¡Œä¿®æ”¹ï¼Œå¦‚æœå‘ç°ä¸€ç±»è¯¸å¦‚å…¶ä»–pythonç‰ˆæœ¬æŒ‡å®šçš„è·¯å¾„çš„è¯ï¼Œéœ€è¦è¿›è¡Œåˆ é™¤ï¼Œåªéœ€è¦ä¿ç•™æœ€åŸå§‹çš„å…³äºanacondaçš„å‘½ä»¤åˆå§‹åŒ–ï¼Œå®Œæˆä¹‹åè¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.zshrc<br></code></pre></td></tr></table></figure>
<p>è§£å†³é—®é¢˜</p>
<h3 id="é•œåƒæºå®‰è£…">é•œåƒæºå®‰è£…</h3>
<p>åœ¨condaç¯å¢ƒä¸­æ”¹å˜é»˜è®¤çš„ä¸‹è½½é•œåƒæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">pip config <span class="hljs-built_in">set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple <br></code></pre></td></tr></table></figure>
<p>åŠ ä¸Šè¿™å¥è¯ä¹‹åå°±ä¼šå‡ºç°ä»¥ä¸‹çš„å†™æ–‡ä»¶</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><code class="hljs arduino">Writing to /home/user/.config/pip/pip.conf<br></code></pre></td></tr></table></figure>
<p><strong>ä¸‹è½½ä½¿ç”¨æ¸…åæºåŠ ä¸Šï¼š -i
https://pypi.tuna.tsinghua.edu.cn/simple</strong></p>
<blockquote>
<p><strong>æ¸…åï¼š<code>https://pypi.tuna.tsinghua.edu.cn/simple/</code></strong></p>
<p><strong>é˜¿é‡Œäº‘ï¼š<code>http://mirrors.aliyun.com/pypi/simple/</code></strong></p>
<p><strong>ä¸­å›½ç§‘æŠ€å¤§å­¦
ï¼š<code>https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple/</code></strong></p>
<p><strong>è±†ç“£ï¼š<code>http://pypi.doubanio.com/simple/</code></strong></p>
</blockquote>
<p>å¦‚æœæ˜¯ç»™condaæ·»åŠ é•œåƒï¼šæ¸…åæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/win-64/<br></code></pre></td></tr></table></figure>
<p>æ·»åŠ é˜¿é‡Œæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda config --add channels https://mirrors.aliyun.com/pypi/simple/<br></code></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å·²ç»æ·»åŠ çš„é•œåƒæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda config --show channels<br></code></pre></td></tr></table></figure>
<p>ç§»é™¤å…¶ä¸­çš„æŒ‡å®šçš„é•œåƒæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda config --remove channels + é•œåƒçš„åç§°<br></code></pre></td></tr></table></figure>
<h3 id="condaæ— æ³•è‡ªåŠ¨æ›´æ–°">Condaæ— æ³•è‡ªåŠ¨æ›´æ–°</h3>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206113335958.png"
alt="image-20231206113335958" />
<figcaption aria-hidden="true">image-20231206113335958</figcaption>
</figure>
<p>åŸå› ï¼š<a
href="https://so.csdn.net/so/search?q=conda&amp;spm=1001.2101.3001.7020">conda</a>å’Œpipç­‰ç›¸å…³åŒ…çš„ç‰ˆæœ¬å¤ªä½ï¼Œè‡ªåŠ¨æ›´æ–°ä¸èƒ½ç”¨ï¼Œè§£å†³æ–¹æ¡ˆï¼šåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda clean --all<br>conda update --all<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºç¡€å·¥å…·</category>
      </categories>
      <tags>
        <tag>åŸºç¡€å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€è‡ªåŠ¨é©¾é©¶ã€‘RSS Model for Autonomous Driving</title>
    <url>/2023/10/21/RSS-Model/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h2 id="rss-model-for-autonomous-driving"><strong>RSS Model for
Autonomous Driving</strong></h2>
<h4
id="è®ºæ–‡on-a-formal-model-of-safe-and-scalable-self-driving-cars">è®ºæ–‡ï¼šã€ŠOn
a Formal Model of Safe and Scalable Self-driving Carsã€‹</h4>
<h4 id="contribution"><strong>Contributionï¼š</strong></h4>
<ul>
<li>Safety (RSS model) Reasonable care, Responsibility, agile driving
policy</li>
<li>Semantic (Semantic language) :Defined Q function over the Semantic
space</li>
<li>PAC sensing modelï¼šSafety and Comfort of driving ï¼›tied to the Q
function;</li>
</ul>
<h4 id="safety-concept"><strong>1. Safety Concept</strong></h4>
<p>Functional versus nominal safety åŠŸèƒ½å®‰å…¨ä¸åä¹‰å®‰å…¨</p>
<p>Functional Safetyï¼ŒFuSa æ˜¯æŒ‡ç”µå­ç”µè·¯ä¸­æ“ä½œçš„å®Œæ•´æ€§</p>
<p>åä¹‰å®‰å…¨æ˜¯åœ¨å‡è®¾HWå’ŒSWç³»ç»Ÿè¿è¡Œæ— å·®é”™(å³åœ¨åŠŸèƒ½ä¸Šæ˜¯å®‰å…¨çš„)çš„æƒ…å†µä¸‹ï¼ŒAVæ˜¯å¦æ­£åœ¨åšå‡ºå®‰å…¨çš„é€»è¾‘å†³ç­–ã€‚</p>
<p>Senseï¼ŒPlanï¼ŒAct æ„ŸçŸ¥ è®¡åˆ’ è¡ŒåŠ¨</p>
<h4 id="ç°æœ‰çš„è‡ªåŠ¨é©¾é©¶æ±½è½¦çš„å†³ç­–æ–¹æ¡ˆ"><strong>2.
ç°æœ‰çš„è‡ªåŠ¨é©¾é©¶æ±½è½¦çš„å†³ç­–æ–¹æ¡ˆ</strong></h4>
<ul>
<li>Miles driven ï¼šåŸºäºç»Ÿè®¡çš„è®ºç‚¹ï¼ŒåŒæ—¶éœ€è¦è¾ƒå¤§çš„ç»Ÿè®¡é‡æ•°æ®</li>
<li>disengagementsï¼ˆè„±ç¦»ï¼‰ï¼šè¢«å®šä¹‰ä¸ºäººç±»å®‰å…¨é©¾é©¶äººå› ä¸ºåšå‡ºä¸å®‰å…¨çš„å†³å®šè€Œä¸å¾—ä¸å¹²é¢„AVçš„è¿è¡Œï¼Œä»è€Œå¯¼è‡´äº‹æ•…çš„æƒ…å†µã€‚</li>
<li>simulationï¼šå»ºç«‹è™šæ‹Ÿä¸–ç•Œæ¨¡æ‹Ÿå™¨ï¼Œæ¨¡æ‹Ÿå™¨å’Œæ˜¾ç¤ºä¸–ç•Œçš„å·®è·ï¼Œæ— æ³•å»ºæ¨¡å…¨éƒ¨çš„ç­–ç•¥</li>
<li>scenario based testing
ï¼šæšä¸¾ç°å®ä¸–ç•Œçš„é©¾é©¶åœºæ™¯ï¼Œè¿‡åº¦æ‹Ÿåˆå’Œæ³›åŒ–çš„é—®é¢˜</li>
<li>proprietary approaches</li>
</ul>
<h4
id="rssresponsibility-sensitive-safety-model-for-multi-agent-safety"><strong>3.
RSS(Responsibility-Sensitive-Safety) Model for Multi-agent
Safety</strong></h4>
<ul>
<li><p>ç›®æ ‡ï¼š</p>
<ul>
<li>åšä¸åˆ°ç»å¯¹å®‰å…¨ï¼Œéœ€è¦æœ‰Reasonableçš„å“åº”</li>
<li>éµå¾ªRSSèƒ½åšåˆ°ä¹Œæ‰˜é‚¦Utopia</li>
<li>æ•æ·è€Œéé˜²å¾¡ï¼Œä¸åº”å½“è¿‡äºè°¨æ…è€Œå½±å“å…¶ä»–é©¾é©¶</li>
<li>æ³•å¾‹è§£é‡Šçš„æ„ä¹‰</li>
</ul></li>
<li><p>å½¢å¼åŒ–çš„è§„åˆ™ï¼š</p>
<ol type="1">
<li>Do not hit someone from behind.</li>
<li>Do not cut-in recklessly.</li>
<li><strong>Right-of-way is given, not taken.</strong>
é“è·¯é€šè¡Œæƒæ˜¯ç»™äºˆçš„è€Œä¸æ˜¯å ç”¨çš„</li>
<li>Be careful of areas with limited visibility
å°å¿ƒæœ‰é™å¯è§†åŒ–çš„èŒƒå›´</li>
<li>If you can avoid an accident without causing another one, you must
do it.</li>
</ol></li>
</ul>
<h5 id="single-land-road-å•å‘é“è·¯çš„æƒ…å†µ"><strong>3.1 Single Land Road
å•å‘é“è·¯çš„æƒ…å†µ</strong></h5>
<ul>
<li><p>ä¸è€ƒè™‘å‰è½¦å€’é€€çš„æƒ…å†µï¼Œåè½¦æ’ä¸Šå‰è½¦é‚£ä¹ˆåè½¦è´Ÿè´£ï¼Œåè½¦æœ‰è´£ä»»å’Œå‰è½¦ä¿æŒè·ç¦»</p></li>
<li><p><span class="math inline">\(c_r\)</span>è¡¨ç¤ºå‰è½¦ï¼Œ<span
class="math inline">\(c_f\)</span>è¡¨ç¤ºåè½¦ï¼Œ<span
class="math inline">\(\rho\)</span>è¡¨ç¤ºçš„æ˜¯å‰è½¦çš„ååº”æ—¶é—´ï¼Œ<span
class="math inline">\(a_{max,break}\)</span>è¡¨ç¤ºçš„æ˜¯å‰è½¦çš„æœ€å¤§åŠ é€Ÿåº¦ï¼Œ<span
class="math inline">\(a_{max,accel}\)</span>è¡¨ç¤ºçš„æ˜¯æœ€å¤šçš„åŠ é€Ÿåˆ¶åŠ¨ï¼Œ<span
class="math inline">\(a_{min,break}\)</span>è¡¨ç¤ºçš„æ˜¯åè½¦çš„æœ€å°åˆ¶åŠ¨åŠ é€Ÿåº¦æ¥ä¿è¯ä¸ä¼šæ’åˆ°å‰è½¦</p></li>
<li><p><strong>åŒæ–¹å‘è¡Œé©¶</strong>çš„å®‰å…¨è·ç¦»</p>
<p>ç»™å‡ºæœ€å°çš„å®‰å…¨çºµå‘è·ç¦»ï¼š <span class="math display">\[
d_{min}=max\{v_r\rho+1/2a_{max,accel}\rho^2+((v_r+\rho
a_{max,accel})^2)/2a_{min,break}-v_f^2/2a_{max,break},0\}
\]</span></p></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915172320331.png"
alt="Definition 1" />
<figcaption aria-hidden="true">Definition 1</figcaption>
</figure></li>
<li><p><span class="math inline">\(t_b\)</span> dangerous timeï¼›<span
class="math inline">\([t_b,t_b+\rho]\)</span> è¡¨ç¤ºä¸€å®šçš„ååº”æ—¶é—´
åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…åœ¨ç»™å®šçš„åŠ é€Ÿåº¦èŒƒå›´ä¹‹å†… æ‰§è¡Œproper response</p></li>
<li><p>Proper Response
ï¼šè¡¨ç¤ºæˆ‘ä»¬å…è®¸æ‰§è¡Œçš„æœ€å¤§åŠ é€Ÿåº¦çš„é™åˆ¶ï¼Œå¹¶å–æœ€å°å€¼çº¦æŸä¿è¯æ»¡è¶³æ‰€æœ‰çš„çº¦æŸ</p></li>
<li><p>å®‰å…¨çºµå‘è·ç¦»å’ŒProper Responseå–å†³äºå‚æ•°ï¼š<span
class="math inline">\(\rho,a_{max,sccel},a_{min,brake},a_{max,brake}\)</span>
å‚æ•°ä¿è¯äº†å¯¹æ™ºèƒ½ä½“è¡Œä¸ºçš„å‡è®¾ï¼Œé€‰æ‹©é€‚å½“çš„å‚æ•°</p></li>
<li><p>Utopia is possible
å¦‚æœæ‰€æœ‰æ™ºèƒ½ä½“è½¦è¾†éƒ½èƒ½å¤Ÿéµå¾ªåˆç†çš„å“åº”ï¼Œé‚£ä¹ˆèƒ½å½’çº³è¯æ˜å¯ä»¥è§„é¿äº‹æ•…çš„å‘ç”Ÿ</p></li>
</ul>
<h5 id="a-lane-based-coordinate-system-åŸºäºè½¦é“çš„åæ ‡ç³»"><strong>3.2 A
Lane-Based Coordinate System åŸºäºè½¦é“çš„åæ ‡ç³»</strong></h5>
<ul>
<li><p>è½¦é“ä¸­å¿ƒæ˜¯å¹³é¢ä¸Šä¸€æ¡å¹³æ»‘æœ‰å‘çš„æ›²çº¿ <span
class="math inline">\(r\)</span> ,å…¶ä¸­æ‰€æœ‰éƒ¨åˆ†å¯ä»¥è¡¨ç¤ºä¸º <span
class="math inline">\(r^{(1)},...,r^{(k)}\)</span>
å³å¯ä»¥æ˜¯çº¿æ€§çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼§å½¢çš„</p></li>
<li><p>æ„é€  <span class="math inline">\(R-&gt;R^2\)</span>çš„å˜æ¢ä¸º <span
class="math inline">\(\phi\)</span>
å°±æ˜¯æ¨ªçºµåæ ‡ï¼Œä»è€Œæ¥ä¿è¯åœ¨é€»è¾‘ä¸Šçš„å‰åè½¦è¾†çš„å…³ç³»</p></li>
<li><p>å…·ä½“çš„æ˜ å°„çš„æ–¹å¼å¯ä»¥è¡¨ç¤ºä¸ºå¦‚ä¸‹ï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915172406204.png"
alt="é“è·¯æ˜ å°„çš„æ–¹å¼" />
<figcaption aria-hidden="true">é“è·¯æ˜ å°„çš„æ–¹å¼</figcaption>
</figure></li>
<li><p>æ¨ªçºµé€Ÿåº¦/åŠ é€Ÿåº¦
çš„è®¡ç®—å°±å¯ä»¥é€šè¿‡è¿™æ ·çš„åæ ‡ç³»å®šä¹‰ä¹‹ä¸‹å¾—åˆ°çš„ä¸€é˜¶/äºŒé˜¶çš„å¯¼æ•°è®¡ç®—å¾—åˆ°</p></li>
</ul>
<h5
id="longitudinal-safe-distance-and-proper-response-çºµå‘çº¦æŸ"><strong>3.3
Longitudinal Safe Distance and Proper Response çºµå‘çº¦æŸ</strong></h5>
<ul>
<li><p>ç»™å‡ºå®‰å…¨è·ç¦»çš„å®šä¹‰ï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915172437378.png"
alt="Definition 2" />
<figcaption aria-hidden="true">Definition 2</figcaption>
</figure>
<p>å®‰å…¨è·ç¦»å®šä¹‰çš„æƒ³æ³•æ˜¯ï¼Œå¦‚æœä¸¤è¾†è½¦éƒ½èƒ½å¯¹è¿åå®‰å…¨è·ç¦»çš„è¡Œä¸ºåšå‡ºâ€œé€‚å½“â€ååº”ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‘ç”Ÿç¢°æ’ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªæ²¡æœ‰â€œæ­£ç¡®â€ååº”ï¼Œé‚£ä¹ˆå®ƒå°±åº”å¯¹äº‹æ•…è´Ÿè´£ã€‚</p></li>
<li><p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦çŸ¥é“å±é™©å‘ç”Ÿçš„æ—¶é—´ï¼Œå®šä¹‰è¿™æ ·ä¸€ä¸ªæ—¶åˆ»<strong>Dangerous
Longitudinal Situation and Danger Threshold</strong></p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915172501683-20231022115917321.png"
alt="çœŸæ­£çš„å±é™©æ—¶é—´" />
<figcaption aria-hidden="true">çœŸæ­£çš„å±é™©æ—¶é—´</figcaption>
</figure>
<p>ç»™å®šä¸€ä¸ªçºµå‘çš„å±é™©å‘ç”Ÿçš„æ—¶é—´æ®µ</p></li>
<li><p><strong>longitudinal proper response çºµå‘çš„é€‚å½“å“åº”</strong></p>
<p>blame time
è´£ä»»æ—¶é—´è¡¨ç¤ºçš„æ˜¯è¿™ä¸ªæ—¶é—´èƒ½å¤Ÿå°†é©¾é©¶çš„è´£ä»»ä»è‡ªåŠ¨é©¾é©¶æ±½è½¦è½¬ç§»åˆ°é©¾é©¶å‘˜èº«ä¸Šï¼Œå¦‚æœæ¥ç®¡äº†é‚£ä¹ˆåç»­çš„è´£ä»»å°†ç”±é©¾é©¶å‘˜è´Ÿè´£ï¼Œå¦åˆ™ç”±æ±½è½¦è´Ÿè´£</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915172514045-20231022115917843.png"
alt="Definition 4" />
<figcaption aria-hidden="true">Definition 4</figcaption>
</figure>
<p>ç»™å‡ºäº†å¯¹äºçºµå‘å•å‘è¡Œé©¶è€Œè¨€çš„é€Ÿåº¦å’ŒåŠ é€Ÿçš„è¦æ±‚ï¼Œéœ€è¦åœ¨å±é™©åˆ°æ¥ä¹‹å‰åšå‡ºåˆç†çš„å“åº”</p></li>
</ul>
<h5
id="lateral-safe-distance-and-proper-response-æ¨ªå‘çš„çº¦æŸ"><strong>3.4
Lateral Safe Distance and Proper Response æ¨ªå‘çš„çº¦æŸ</strong></h5>
<ul>
<li><p>ç¨³å¥ä¾§å‘é€Ÿåº¦ <span
class="math inline">\(\mu\)</span>ï¼šæ±½è½¦æ€»æ˜¯å­˜åœ¨æ¨ªå‘çš„ä¸€ä¸ªå¾®å°æ‘†åŠ¨:
<span class="math display">\[
\mu-lateral-v=(l_{out}-l)/(t_{out}-t)
\]</span></p></li>
<li><p>æ¨ªå‘å®‰å…¨è·ç¦»ï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915172633796.png"
alt="Definition 6" />
<figcaption aria-hidden="true">Definition 6</figcaption>
</figure>
<p>å¯¹äºåŒæ–¹è€Œè¨€éƒ½æœ‰ä¸€ä¸ªåŠ é€Ÿåº¦ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªæœ€å°çš„åˆ¶åŠ¨åŠ é€Ÿåº¦</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915172648760.png"
alt="Lemma 4" />
<figcaption aria-hidden="true">Lemma 4</figcaption>
</figure></li>
<li><p>åŒæ ·å®šä¹‰æ¨ªå‘çš„å±é™©æ—¶é—´å’Œå±é™©åŒºé—´æ—¶é—´ï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173056976-20231022115918644.png"
alt="Definition 7" />
<figcaption aria-hidden="true">Definition 7</figcaption>
</figure></li>
<li><p><strong>Lateral Proper response ç»™å‡ºæ¨ªå‘çš„é€‚å½“ååº”</strong></p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173119252.png"
alt="Definition 8" />
<figcaption aria-hidden="true">Definition 8</figcaption>
</figure>
<p>é¦–å…ˆå¦‚æœåœ¨é€‚å½“çš„å“åº”æ—¶é—´èŒƒå›´ä¹‹å†…ï¼Œé‚£ä¹ˆåªéœ€è¦é™åˆ¶ä¸¤è½¦çš„åŠ é€Ÿåº¦åœ¨ä¸€å®šçš„èŒƒå›´ä¹‹å†…</p>
<p>å¦‚æœè¶…å‡ºäº†é€‚å½“å“åº”æ—¶é—´ï¼Œé‚£ä¹ˆå¯¹äºä¸¤è½¦çš„åŠ é€Ÿåº¦é™åˆ¶éœ€è¦æ›´æ”¹</p></li>
</ul>
<h5
id="combining-longitudinal-and-lateral-proper-responses-æ¨ªå‘å’Œçºµå‘ç›¸ç»“åˆ"><strong>3.5
Combining Longitudinal and Lateral Proper Responses
æ¨ªå‘å’Œçºµå‘ç›¸ç»“åˆ</strong></h5>
<ul>
<li><p>å¯¹äºæ¨ªå‘å’Œçºµå‘ç»“åˆçš„è½¦é“ï¼Œå®šä¹‰å±é™©æ—¶é—´å’Œå±é™©æƒ…å†µ</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173150615.png"
alt="Defintion 9" />
<figcaption aria-hidden="true">Defintion 9</figcaption>
</figure></li>
<li><p>å±é™©é˜ˆå€¼æ—¶é—´å®šä¹‰ä¸ºæ¨ªå‘å’Œçºµå‘çš„å±é™©é˜ˆå€¼æ—¶é—´çš„æœ€å¤§å€¼ï¼ŒåŒæ ·å®šä¹‰äº†å±é™©æ—¶é—´t</p></li>
<li><p><strong>Basic Proper response to dangerous situations
å¯¹äºå±é™©æƒ…å†µçš„æ­£ç¡®ååº”å¤„ç†</strong></p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173218415.png"
alt="Definition 10" />
<figcaption aria-hidden="true">Definition 10</figcaption>
</figure>
<p>å¯¹äºå±é™©çš„é˜ˆå€¼é€Ÿåº¦è¿›è¡Œåˆ†æï¼Œå¦‚æœåˆ†åˆ«ä¸ºçºµå‘çš„é˜ˆå€¼é€Ÿåº¦å’Œæ¨ªå‘çš„é˜ˆå€¼é€Ÿåº¦ï¼Œé‚£ä¹ˆåˆ†åˆ«æ ¹æ®å‰é¢æ‰€è¿°çš„Definition
4å’ŒDefinition 8 è¿›è¡Œé€Ÿåº¦çš„é™åˆ¶</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173251798-20231022115919728.png" alt="æ¨ªå‘çºµå‘æƒ…å†µ" style="zoom:50%;" /></p>
<p>ä¸Šé¢çš„è¿™å¼ å›¾å¯ä»¥è¯´æ˜é—®é¢˜ï¼Œå½“æ¨ªçºµçš„ä»»æ„ä¸€ä¸ªæ–¹å‘åˆ°è¾¾å±é™©çš„é˜ˆå€¼æƒ…å†µï¼Œåˆ†åˆ«ä½œå‡ºProper
Responseï¼Œé‚£ä¹ˆå°±å¯ä»¥æŒ‰ç…§åˆç†çš„æ–¹å¼æ¥è§„é¿é£é™©</p></li>
<li><p><strong>Lemma5 Utopia is possible</strong></p>
<p>Consider a multi-lane road where all lanes share the same geometry.
Suppose that at all times, all cars on the road comply with the basic
proper response as given in Definition 10. Then, there will be
<strong>no collisions</strong></p>
<p>å½’çº³è¯æ˜è¯´æ˜å¦‚æœåœ¨åˆé€‚çš„èŒƒå›´ä¹‹å†…ä½œå‡ºåˆç†çš„å“åº”ï¼Œé‚£ä¹ˆèƒ½è§„é¿ç¢°æ’</p></li>
</ul>
<h5
id="compensating-for-improper-behavior-of-others-ä»–äººçš„ä¸æ­£å½“è¡Œä¸º"><strong>3.6
Compensating for improper behavior of others
ä»–äººçš„ä¸æ­£å½“è¡Œä¸º</strong></h5>
<ul>
<li><p>å¦‚æœå¯¹æ–¹æ²¡åšå‡ºåˆç†ååº”ï¼Œé‚£ä¹ˆè‡ªå·±åº”å½“ä½œå‡ºåˆé€‚ååº”é¿å…å‘ç”Ÿäº‹æ•…ï¼ŒåŒæ—¶ä¸å¼•èµ·ä¸‹ä¸€ä¸ªäº‹æ•…</p></li>
<li><p>Naive Predictionï¼šæ ¹æ®é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çº¿æ€§å¤–æ¨</p></li>
<li><p>Evasive
Manoeuvreï¼šç»™å‡ºä¸¤ä¸ªå‡½æ•°æ¥å°½é‡è§„é¿å‡ºç°è½¦ç¥¸ï¼Œå°±æ˜¯æ ¹æ®æ—¶é—´æ¥ç»™é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çš„å˜åŒ–è§„åˆ’</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173348421.png"
alt="Definition 12" />
<figcaption aria-hidden="true">Definition 12</figcaption>
</figure>
<p>ç›¸å½“äºç»™å‡ºä¸¤ä¸ªå‡½æ•°æ¥çŸ¥é“æ±½è½¦åº”å½“åœ¨æŸä¸ªæ—¶é—´èŒƒå›´å†…åˆ°è¾¾ä»€ä¹ˆæ ·çš„ä½ç½®æ˜¯å®‰å…¨çš„ï¼Œé‚£ä¹ˆè¦è¾¾åˆ°è¿™æ ·çš„ä½ç½®æ±½è½¦è¦é‡‡å–ä»€ä¹ˆæ ·çš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦æ¥å®ç°</p>
<p><strong>if you can avoid an accident without causing another
accident, you must do it</strong></p></li>
</ul>
<h5
id="proper-response-with-extra-evasive-effort-åˆ¶åŠ¨è§„é¿çš„é€‚å½“ååº”"><strong>Proper
Response with Extra Evasive Effort åˆ¶åŠ¨è§„é¿çš„é€‚å½“ååº”</strong></h5>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173422047-20231022115920481.png"
alt="Definition 13" />
<figcaption aria-hidden="true">Definition 13</figcaption>
</figure>
<h5
id="multiple-geometry-and-right-of-way-ruleså¤„ç†å‡ ä½•å›¾å½¢åŒºåŸŸçš„è½¦è¾†ä¼˜å…ˆæƒé—®é¢˜"><strong>3.7
Multiple Geometry and Right-of-Way
Ruleså¤„ç†å‡ ä½•å›¾å½¢åŒºåŸŸçš„è½¦è¾†ä¼˜å…ˆæƒé—®é¢˜</strong></h5>
<ul>
<li><p>å¦‚æœæœ‰å­˜åœ¨ä¸åŒçš„å‡ ä½•å½¢çŠ¶çš„æƒ…å½¢ä¼šå¯¼è‡´å“åº”çš„å†²çª</p></li>
<li><p>å®šä¹‰æ¨ªå‘çš„å®‰å…¨è·ç¦»å¯¹äº<strong>ä¸åŒçš„å‡ ä½•è·¯å¾„</strong>å¯¹äºç›¸åŒçš„å‡ ä½•è·¯å¾„ä»ç„¶æˆç«‹</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173615571.png"
alt="Definition14" />
<figcaption aria-hidden="true">Definition14</figcaption>
</figure>
<p>å‘ä½ç½®èŒƒå›´ä¸º[x_i,min,
x_i,max]ï¼ŒæŒ‰ç…§ä¸åŒçš„åŠ é€Ÿåº¦è¡Œé©¶ï¼Œä¸”ä¸èƒ½è¶…è¿‡æŒ‡å®šçš„åŠ é€Ÿåº¦åˆ¶åŠ¨é‚£ä¹ˆï¼Œåˆ™c_1å’Œc_2ä¹‹é—´çš„æ¨ªå‘å®‰å…¨è·ç¦»éœ€è¦æ»¡è¶³ï¼š<strong>ä¸¤è½¦ä¹‹é—´æ¨ªå‘è·ç¦»çš„æœ€å°å€¼åº”å¤§äºDefinition7ä¸­å®šä¹‰çš„æ¨ªå‘å®‰å…¨è·ç¦»</strong></p></li>
<li><p>é‚£ä¹ˆå¦‚ä½•ä½œå‡ºé€‚å½“çš„ååº” Proper responseï¼Œç»™å‡ºåˆé€‚çš„é€Ÿåº¦çº¦æŸ</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173634068-20231022115921111.png"
alt="æ¨ªå‘çš„åˆé€‚å“åº”" />
<figcaption aria-hidden="true">æ¨ªå‘çš„åˆé€‚å“åº”</figcaption>
</figure>
<p>åœ¨ååº”æ—¶é—´ä¹‹å†…å¯ä»¥æŒ‰ç…§åŠ é€Ÿåº¦èŒƒå›´å†…è¿›è¡Œç§»åŠ¨ï¼Œä½†æ˜¯å½“è¶…è¿‡ååº”æ—¶é—´ä¹‹åå°±è¦å¯¹ä¾§å‘çš„é€Ÿåº¦è¿›è¡Œåˆ¶åŠ¨</p></li>
<li><p>å®šä¹‰ä¸åŒå‡ ä½•è·¯å†µçš„çºµå‘çš„é¡ºåº</p>
<ul>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173650265-20231022115921291.png"
alt="è·¯å†µä¼˜å…ˆæƒé—®é¢˜" />
<figcaption aria-hidden="true">è·¯å†µä¼˜å…ˆæƒé—®é¢˜</figcaption>
</figure>
<p>å¦‚æœåœ¨åŒä¸€æ¡è·¯ä¸Šé‚£ä¹ˆç›´æ¥æœ‰å…ˆåé¡ºåº</p>
<p>å¦‚æœä¸åœ¨åŒä¸€æ¡è·¯ä¸Šï¼Œé‚£ä¹ˆæ ¹æ®è½¦è¾†è·ç¦»ä¸¤æ¡é“è·¯çš„ç›¸äº¤çš„ä½ç½®æ¥å®š</p>
<p>å½“å­˜åœ¨çºµå‘çš„å®‰å…¨è·ç¦»æ‰ä¼šç”¨åˆ°è¿™ä¸ªå®šä¹‰ï¼ŒåŒæ—¶åº”å½“æ˜¯æ˜æ˜¾çš„å‰åé¡ºåº</p></li>
</ul></li>
<li><p>çºµå‘çš„å®‰å…¨è·ç¦»ï¼ˆä¸åŒçš„å‡ ä½•è·¯å¾„ï¼‰</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173703808-20231022115921710.png"
alt="Definition 17" />
<figcaption aria-hidden="true">Definition 17</figcaption>
</figure>
<ol type="1">
<li>å¦‚æœc_iæ²¡æœ‰è·¯å¾„çš„ä¼˜å…ˆçº§ï¼Œé‚£ä¹ˆå°†åœ¨è·¯å£æ±‡å…¥çš„ä½ç½®æ‰§è¡ŒåŠ é€Ÿåˆ°å‡é€Ÿçš„è¿‡ç¨‹åœåœ¨è·¯å£</li>
<li>å¦‚æœc_1åœ¨c_2å‰é¢ï¼Œc_1æ‰§è¡Œä»»æ„åŠ¨ä½œï¼ˆæœ€å¤§åˆ¹è½¦åŠ é€Ÿåº¦çš„æ„æ€æ˜¯ä¿è¯è¿™ä¸ªåŠ¨ä½œçš„è·ç¦»ä¸‹é™ï¼‰ï¼Œc_2æ‰§è¡Œæœ€å¤§åŠ é€Ÿ-æœ€å°å‡é€Ÿè¿‡ç¨‹ã€‚å½“ä¸¤è½¦é€Ÿåº¦éƒ½ä¸º0æ—¶ï¼Œc_1ä»ç„¶åœ¨c_2å‰é¢ï¼ˆå³åè½¦è¦åˆ¹å¾—ä½ï¼Œå½“å‰è½¦åœä¸‹æ—¶ï¼Œçºµå‘é¡ºåºå…³ç³»ä¾ç„¶èƒ½ä¿æŒï¼‰</li>
<li>å¦‚æœæ²¡æœ‰ä¼˜å…ˆçº§å’Œå‰åå…³ç³»ï¼Œåˆ™è€ƒè™‘ä¸¤è½¦åˆ°è¾¾è·¯å£çš„æ—¶é—´èŒƒå›´ï¼Œå¦‚æœä¸¤è€…æ—¶é—´èŒƒå›´ç›¸äº¤ï¼Œåˆ™æœ‰ç¢°æ’é£é™©ï¼Œéƒ½éœ€è¦åˆ¹è½¦ï¼Œåä¹‹å°±æ­£å¸¸èµ°ã€‚</li>
</ol>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173722252.png"
alt="ç¤ºæ„å›¾" />
<figcaption aria-hidden="true">ç¤ºæ„å›¾</figcaption>
</figure></li>
<li><p>çºµå‘çš„å®‰å…¨å“åº”ï¼ˆProper responseï¼‰</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173840619.png"
alt="Definition18" />
<figcaption aria-hidden="true">Definition18</figcaption>
</figure>
<ol type="1">
<li>longitudinal proper responseå–å†³äºDanger Threshold
Timeå‰çš„situationï¼š</li>
<li>å¦‚æœ17.1æ»¡è¶³ï¼Œåˆ™ä¼˜å…ˆè½¦è¾†æ­£å¸¸å¼€ï¼Œå¦å¤–ä¸€ä¸ªåˆ™éœ€è¦åœ¨ååº”æ—¶é—´ååˆ¹è½¦ã€‚</li>
<li>å¦‚æœ17.2æ»¡è¶³ï¼Œåˆ™å‰é¢è½¦è¾†æ­£å¸¸å¼€ï¼Œå€™è½¦éœ€è¦åœ¨ååº”æ—¶é—´ååˆ¹è½¦ã€‚</li>
<li>å¦‚æœ17.3æ»¡è¶³ï¼Œä¸¤è½¦éƒ½éœ€è¦åœ¨æ¨ªå‘å’Œçºµå‘ä¸Šåˆ¹è½¦ï¼ˆè¿™é‡Œåˆæåˆ°äº†æ¨ªå‘ï¼Œæ˜¯çºµå‘å·²ç»ä¸èƒ½å®Œå…¨è§„é¿ç¢°æ’é£é™©ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥æ¨ªå‘åŠ¨ä½œï¼‰ã€‚</li>
</ol></li>
<li><p>Traffic Lights</p>
<ol type="1">
<li>ä¸èƒ½ç®€å•é€šè¿‡çº¢ç»¿ç¯çš„æƒ…å†µæ¥å°†è´£ä»»åˆ†é…ç»™ä¸åŒçš„è½¦è¾†ï¼Œå¯¹äºä¾‹å¤–çš„è·¯å£çš„è½¦è¾†</li>
<li>ç»¿ç¯çš„æœ‰ä¼˜å…ˆæƒ ä½†ä¸æ˜¯æœ‰ä¼˜å…ˆæƒçš„å°±å¯¹äºè§„åˆ™è€Œè¨€æ²¡æœ‰è´£ä»»</li>
<li>The above discussion is a formalism of the common sense rule of
<strong>right of way is given, not taken.</strong></li>
</ol></li>
</ul>
<h5 id="unstructured-road-éç»“æ„åŒ–çš„é“è·¯"><strong>3.8 Unstructured Road
éç»“æ„åŒ–çš„é“è·¯</strong></h5>
<ol type="1">
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173851532-20231022115922491.png"
alt="Definition 19" />
<figcaption aria-hidden="true">Definition 19</figcaption>
</figure>
<p>è½¨è¿¹è¿™ä¸ªè¡¨ç¤ºäº†æ ¹æ®æ—¶é—´è€Œæ”¹å˜çš„ä½ç½®çŠ¶æ€ï¼Œtsçš„å®šä¹‰å°±è¡¨ç¤ºè½¦è¾†ç¬¬ä¸€æ¬¡å®Œå…¨åœæ­¢çš„æ—¶é—´</p>
<p><strong>æœªæ¥æŸéƒ¨åˆ†æ—¶åˆ»æ±½è½¦çš„ä½ç½®ã€æŸä¸ªæ—¶é—´è½¦è¾†çš„è§’åº¦</strong></p></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173902698-20231022115922745.png"
alt="Definition20" />
<figcaption aria-hidden="true">Definition20</figcaption>
</figure>
<p>å½“ä¸¤è½¦çš„è½¨è¿¹ä¸æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œåˆ™ç§°ä¼šå‘ç”Ÿç¢°æ’ï¼š</p>
<p>ï¼ˆ1ï¼‰å¯¹äºä¸¤è½¦å‡åœæ­¢ä¹‹å‰çš„ä»»æ„æ—¶åˆ»ï¼Œä¸¤è½¦ä¹‹é—´è·ç¦»å‡å¤§äºepsilonã€‚</p>
<p>ï¼ˆ2ï¼‰åœ¨æŸè½¦åœè½¦ä¹‹å‰ï¼Œä¸¤è½¦ä¹‹å‰è·ç¦»å‡å¤§äºepsilonï¼Œä¸”æ­¤æ—¶ç¬¬äºŒè¾†è½¦çš„é€Ÿåº¦çŸ¢é‡æŒ‡å‘ç¬¬ä¸€è¾†è½¦ã€‚å³å½“å‰è½¦åœè½¦ï¼Œåè½¦ä¾ç„¶å¾€å‰è½¦æ–¹å‘å¼€ï¼Œåè½¦éœ€è¦ä¸å‰è½¦ä¿æŒè·ç¦»ã€‚</p></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173913570.png"
alt="Definition 21" />
<figcaption aria-hidden="true">Definition 21</figcaption>
</figure>
<p>å®šä¹‰Constrainsï¼ˆCï¼‰ä¸‹çš„è½¨è¿¹T(C,
c)ï¼Œåˆ¹è½¦/æ­£å¸¸å‘å‰è¡Œé©¶çš„è½¨è¿¹åˆ†åˆ«è¡¨ç¤ºä¸ºT(Cb, c)å’ŒT(Cf,c).</p></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915173936523.png"
alt="Definition 22" />
<figcaption aria-hidden="true">Definition 22</figcaption>
</figure>
<ol type="1">
<li>å…¶ä¸­ä¸€è¾†è½¦çš„åˆ¹è½¦è½¨è¿¹å’Œå¦ä¸€è¾†è½¦çš„å‰è¿›è½¨è¿¹ä¸ç›¸äº¤ï¼Œé‚£ä¹ˆå®‰å…¨ï¼ˆæ³¨æ„ä¿æŒå…ˆåå…³ç³»å¯¹ä¸¤è¾†è½¦éƒ½é€‚ç”¨ï¼‰</li>
<li>ä¸¤è¾†è½¦éƒ½åˆ¹è½¦ï¼Œè½¨è¿¹æ²¡æœ‰ç›¸äº¤</li>
</ol></li>
<li><p>å¦‚æœä¸æ»¡è¶³å®‰å…¨çš„è¦æ±‚ï¼Œé‚£ä¹ˆåº”å½“é€‰æ‹©Proper Responseï¼š</p>
<ol type="1">
<li>å¦‚æœä¸¤è¾†è½¦éƒ½åœç€ï¼Œé‚£ä¹ˆå…¶ä¸­ä¸€è¾†è½¦åº”å½“è¿œç¦»å¦ä¸€è¾†è½¦é€‰æ‹©ç”¨Definition
20çš„æ–¹æ³•è¿œç¦»</li>
<li>å¦åˆ™ï¼Œå¦‚æœæ ¹æ®safe
distance(1)çš„å®šä¹‰æ˜¯å®‰å…¨çš„ï¼Œä¸€è¾†è½¦æ‰§è¡Œåˆ¹è½¦ï¼Œå¦ä¸€è¾†è½¦åœ¨åœä¸‹æ¥ä¹‹å‰å°±è¦æŒ‰ç…§Cfçš„è½¨è¿¹æ­£å¸¸å¼€ï¼Œéƒ½åœä¸‹æ¥ä¹‹åå°±å›åˆ°äº†ï¼ˆ1ï¼‰</li>
<li>åŒæ—¶é€‰æ‹©åˆ¹è½¦</li>
</ol></li>
</ol>
<h5 id="pedestrians-è¡Œäºº"><strong>3.9 Pedestrians è¡Œäºº</strong></h5>
<ul>
<li><p>å®‰å…¨è·ç¦»å’Œåˆç†ååº”ï¼›å’Œæ±½è½¦ç›¸æ¯”è°ƒæ•´å‚æ•°ä¸”å¢åŠ éç»“æ„åŒ–çš„å‡è®¾</p></li>
<li><p>åœ¨æ–‘é©¬çº¿æˆ–è€…æ˜¯äººè¡Œé“ä¸Šè§„å®šè¡Œäººçš„è¡Œä¸ºï¼Œè¡Œäººçš„åˆç†æ´»åŠ¨èŒƒå›´æ˜¯ä¸€ä¸ªä»¥ä»–ä¸ºåœ†å¿ƒçš„åœ†</p></li>
<li><p>éµå¾ªäº’ä¸å¹²æ‰°å¦åˆ™æœ‰è´£ä»»çš„å‡†åˆ™ï¼Œå½“æ±½è½¦è¿›å…¥è¡Œäººçš„å¯èƒ½å‡ºäº‹çš„èŒƒå›´é‚£ä¹ˆ
æ±½è½¦æœ‰è´£ï¼Œå¦åˆ™è¡Œäººæœ‰è´£ä»»</p></li>
</ul>
<h5 id="cautiousness-with-respect-to-occlusion-é®æŒ¡é—®é¢˜"><strong>3.10
Cautiousness with respect to Occlusion é®æŒ¡é—®é¢˜</strong></h5>
<ul>
<li><p>Exposure Time æ›å…‰æ—¶é—´ï¼šç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªç‰©ä½“çš„æ—¶é—´</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915173954765-20231022115923512.png"
alt="Definition23" />
<figcaption aria-hidden="true">Definition23</figcaption>
</figure></li>
<li><p><strong>é€Ÿåº¦ä¸åˆç†å¯¼è‡´çš„ä¸åˆç†æƒ…å†µ</strong>ï¼š</p>
<p>ç›¸å½“äºé€Ÿåº¦çš„èŒƒå›´ä¸åœ¨ç»™å®šçš„åˆç†çš„åŒºé—´ã€‚
ä¸Šè¿°æåˆ°çš„å‚æ•°å’Œåœ°å›¾ä¸Šçš„æ¯ä¸ªæ±½è½¦çš„ä½ç½®ã€ä¼˜å…ˆçº§è§„åˆ™å’Œå…¶ä»–çš„åœºæ™¯ç»“æ„ç­‰æ¡ä»¶ç›¸å…³è”</p>
<ol type="1">
<li><p>å…·æœ‰é“è·¯ä¼˜å…ˆçº§çš„æ±½è½¦çš„æœ€å¤§é€Ÿåº¦ä¼˜å…ˆçº§è¾ƒé«˜</p></li>
<li><p>é€Ÿåº¦çš„é˜ˆå€¼èŒƒå›´æ ¹æ®å…·ä½“çš„é“è·¯ç»“æ„</p></li>
</ol>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915174217869.png"
alt="é®æŒ¡ç¤ºæ„å›¾" />
<figcaption aria-hidden="true">é®æŒ¡ç¤ºæ„å›¾</figcaption>
</figure></li>
</ul>
<p>ç›¸å½“äºå¯¹äºé®æŒ¡é—®é¢˜éœ€è¦å¯¹åŒæ–¹çš„è½¦è¾†æœ‰é€Ÿåº¦é™åˆ¶æ‰èƒ½ä¿è¯å±é™©çš„å‘ç”Ÿ</p>
<h5 id="ä¸å½“è¡Œä¸ºé€ æˆçš„ä¸åˆç†çš„æƒ…å†µ"><strong>3.11
ä¸å½“è¡Œä¸ºé€ æˆçš„ä¸åˆç†çš„æƒ…å†µ</strong></h5>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915174242726.png"
alt="Definition 25" />
<figcaption aria-hidden="true">Definition 25</figcaption>
</figure>
<p>å¯¹äºå‡ºç°é®æŒ¡çš„å‚ä¸è€…éƒ½è¦ä¿æŒåˆç†çš„è¡Œä¸ºæ‰èƒ½è§„é¿äº‹æ•…</p>
<p><strong>å¯¹äºæœ‰é®æŒ¡çš„æ­£ç¡®å“åº”æ–¹æ³•</strong>ï¼šè§„é¿ä¸åˆç†çš„æƒ…å†µï¼ŒåŒ…æ‹¬ä½†ä¸é™äº24-25çš„</p>
<h5 id="responsibility"><strong>3.12 Responsibility</strong></h5>
<ul>
<li>æ˜ç¡®æ™ºèƒ½ä½“è´£ä»»</li>
<li>å‘ç”Ÿç¢°æ’é‚£ä¹ˆæœ‰å¯èƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªæ™ºèƒ½ä½“æ²¡æœ‰éµå®ˆé€‚å½“çš„å“åº”çº¦æŸï¼Œé‚£ä¹ˆéœ€è¦å¯¹äº‹æ•…è´Ÿè´£</li>
</ul>
<h5 id="utopia">3.13 Utopia</h5>
<ul>
<li>Lemma 5è¯æ˜å¦‚æœæ‰€æœ‰æ±½è½¦éƒ½éµå¾ªåŸºæœ¬çš„å“åº”è§„åˆ™ï¼Œé‚£ä¹ˆä¸ä¼šå‘ç”Ÿç¢°æ’</li>
<li>Lemma
6è¯æ˜å¦‚æœå¯¹äºé®æŒ¡çš„é—®é¢˜éƒ½èƒ½åšå‡ºåˆç†çš„å“åº”è§„åˆ™ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‘ç”Ÿäº‹æ•…ï¼ˆåè¯æ³•ï¼‰</li>
</ul>
<h4 id="driving-policy-rl"><strong>4. Driving Policy
ï¼ˆRLï¼‰</strong></h4>
<ul>
<li><p>é©¾é©¶ç­–ç•¥çš„å®šä¹‰ï¼šé©¾é©¶ç­–ç•¥æ˜¯ä»æ„ŸçŸ¥çŠ¶æ€åˆ°é©¾é©¶å‘½ä»¤çš„æ˜ å°„</p></li>
<li><p>æ„å»ºé«˜æ•ˆçš„é©¾é©¶ç­–ç•¥ï¼Œæ‹“å±•åˆ°ç™¾ä¸‡çº§åˆ«çš„ç­–ç•¥</p></li>
<li><p>æè¿°é©¾é©¶ç­–ç•¥çš„è¯­è¨€ï¼š(åˆ©ç”¨å¼ºåŒ–å­¦ä¹ çš„æè¿°æ–¹æ³•)</p>
<ol type="1">
<li><p><span class="math inline">\(s_t\)</span>è¡¨ç¤ºæŸä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼Œ<span
class="math inline">\(\pi\)</span>è¡¨ç¤ºçš„æ˜¯ç­–ç•¥å‡½æ•°ï¼Œ<span
class="math inline">\(a_t\)</span>è¡¨ç¤ºçš„æ˜¯æ±½è½¦èƒ½å¤Ÿé€‰æ‹©çš„åŠ¨ä½œï¼Œæ ¹æ®ç­–ç•¥å‡½æ•°æ¥ç¡®å®šï¼Œå¾—åˆ°ä¸€å—åºåˆ—
<span class="math inline">\(&lt;s_t,a_t&gt;\)</span></p></li>
<li><p><span class="math inline">\(P_{\pi}\)</span>è¡¨ç¤ºçš„æ˜¯æ ¹æ® <span
class="math inline">\(\pi\)</span> é€‰æ‹©äº§ç”Ÿçš„åé¢ä¸åŒåºåˆ—<span
class="math inline">\(&lt;s_t,a_t&gt;\)</span>çš„æ¦‚ç‡</p></li>
<li><p><span class="math inline">\(E_{s~P_\pi}[\rho(s)]\)</span>
ç”¨äºè¡¡é‡å½“å‰ç­–ç•¥çš„å¥½åç¨‹åº¦ï¼Œç›¸å½“äºå¯¹å½“ä¸‹è¿™ä¸ªç­–ç•¥å¯èƒ½äº§ç”Ÿçš„ä¸åŒå¥–åŠ±å€¼é€‰æ‹©æœŸæœ›ï¼ŒåŒæ—¶
<span
class="math inline">\(\rho(s)\)</span>è¡¨ç¤ºçš„æ˜¯å½“å‰çŠ¶æ€ä¸‹çš„å¥–åŠ±</p></li>
<li><p>åœ¨å®é™…çš„å®ç°è¿‡ç¨‹ä¸­ï¼Œ<span
class="math inline">\(a_t\)</span>è¡¨ç¤ºçš„æ˜¯æœ¬è½¦ä¸å…¶ä»–é“è·¯ä½¿ç”¨è€…çš„ä½ç½®ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ç­‰é—®é¢˜ï¼Œ<span
class="math inline">\(s_{t+1}\)</span>è¡¨ç¤ºçš„æ˜¯ä¸‹ä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼ŒåŒæ—¶å–å†³äºå½“å‰æ—¶åˆ»çš„åŠ¨ä½œä»¥åŠå…¶ä»–æ™ºèƒ½ä½“çš„è¡Œä¸ºï¼Œå¥–åŠ±å‡½æ•°<span
class="math inline">\(\rho(s)\)</span>
å–å†³äºå½“å‰ç¯å¢ƒä¸­çš„å…¶ä»–æ™ºèƒ½ä½“çš„ç›¸å¯¹ä½ç½®é€Ÿåº¦ç­‰ä¿¡æ¯ã€‚</p></li>
<li><p>ä»·å€¼å‡½æ•° <span
class="math inline">\(Q\)</span>è¡¨ç¤ºçš„æ˜¯å½“å‰æ™ºèƒ½ä½“æ‰§è¡ŒæŸä¸€ä¸ªåŠ¨ä½œæ‰€èƒ½é€ æˆçš„é•¿æœŸå›æŠ¥
,ç”±æ­¤æ¥é€‰æ‹©æœ€å¥½çš„ç­–ç•¥å‡½æ•°æ¥ä¿è¯<span class="math inline">\(\pi(s)=argmax
Q(s,a)\)</span></p></li>
<li><p><span class="math display">\[
Q(s, a)=\max _{(a_t, \ldots, a_{t+T})} \sum_{\tau=t}^T \rho(s_\tau,
a_\tau )  \quad  {  s.t. } \quad s_t=s, a_t=a, \forall \tau,
s_{\tau+1}=f(s_\tau, a_\tau)
\]</span></p>
<p>å®šä¹‰ä»·å€¼å‡½æ•°çš„è®¡ç®—æ–¹å¼ï¼Œæ ¹æ®æ¯ä¸ªæ—¶åˆ»æ±‡æ€»å¾—åˆ°çš„å¥–åŠ±å€¼è¿›è¡Œæ±‚å’Œå¾—åˆ°çš„æ€»çš„ä»·å€¼</p></li>
<li><p>å‚æ•° <span class="math inline">\(T\)</span>
è¡¨ç¤ºçš„æ˜¯â€œè§„åˆ’æ—¶é—´èŒƒå›´â€ æ§åˆ¶è®¡ç®—æ—¶é—´å’Œè¯„ä¼°è´¨é‡ä¹‹é—´çš„è‡ªç„¶æƒè¡¡ï¼Œå¦‚æœ <span
class="math inline">\(T\)</span>è¶Šå¤§é‚£ä¹ˆè¯´æ˜å½“å‰çš„åŠ¨ä½œè¯„ä¼°æ•ˆæœè¶Šå¥½</p></li>
</ol></li>
<li><p>è®¡ç®—ä»·å€¼å‡½æ•°æŒ‘æˆ˜ï¼š</p>
<ol type="1">
<li>å¦‚æœå°†åŠ¨ä½œç©ºé—´è¿›è¡Œç¦»æ•£ï¼Œé‚£ä¹ˆéœ€è¦è¾ƒå¤§çš„è®¡ç®—ç©ºé—´ï¼Œä¾èµ–äºå·¨å¤§çš„è®¡ç®—èƒ½åŠ›</li>
<li>é‡‡ç”¨ç¦»çº¿è®¡ç®—ï¼Œç¦»æ•£åŒ–åŠ¨ä½œåŸŸå’ŒçŠ¶æ€åŸŸï¼Œç„¶åé‡‡ç”¨ç¦»çº¿çš„è®¡ç®—æ–¹å¼è¯„ä¼°æ¯ä¸ª
<span class="math inline">\(ï¼ˆs,aï¼‰\)</span> çš„ä»·å€¼</li>
<li>é‡‡ç”¨åŠ¨æ€è§„åˆ’ï¼Œè®¡ç®—æ¯ä¸ª <span
class="math inline">\(ï¼ˆs,aï¼‰\)</span>çš„ä»·å€¼å‡½æ•°å€¼ <span
class="math inline">\(Qï¼ˆs,aï¼‰\)</span> ä»ç„¶é¢ä¸´è®¡ç®—ç©ºé—´è¾ƒå¤§çš„é—®é¢˜</li>
<li>åˆ©ç”¨æœ‰é™ç±»å‡½æ•°æ¥è¿‘ä¼¼ä»·å€¼å‡½æ•°ï¼Œä½†æ˜¯æ— æ³•åšå‡ºè‰¯å¥½çš„è¿‘ä¼¼ï¼ŒåŒæ—¶å¯¹äºè¿™æ ·çš„ç¥ç»ç½‘ç»œæ¯”è¾ƒéš¾ä»¥å­¦ä¹ </li>
<li>å½“æ›´æ–°æ—¶é—´è¾ƒå°å­˜åœ¨ä¸€å®šçš„ä¿¡å™ªæ¯”ï¼Œå¯¼è‡´å­¦ä¹ é€Ÿåº¦åŠå…¶ç¼“æ…¢ï¼Œé€¼è¿‘ç±»æ–¹æ³•å›ºæœ‰çš„é—®é¢˜</li>
<li>æ€»ç»“ï¼š<strong>èµ„æºè®¡ç®—é‡å·¨å¤§çš„æ–¹æ³•</strong>å’Œ
<strong>ç²—ç³™è¿‘ä¼¼é€¼è¿‘</strong>ä¼šå¸¦æ¥ä¸åŒç¨‹åº¦çš„é—®é¢˜</li>
</ol></li>
<li><p><strong>Semantics</strong> to the rescueé‡æ–°å®šä¹‰è‡ªåŠ¨é©¾é©¶è¯­ä¹‰</p>
<ul>
<li><p>åœ¨è¯­ä¹‰åŠ¨ä½œç©ºé—´ä¸Šå®šä¹‰ä»·å€¼å‡½æ•°Qï¼šè¯­ä¹‰ç©ºé—´è¾ƒå°æ— è¯­å¤§é‡è®¡ç®—èµ„æºï¼Œèƒ½å¤Ÿå¯¹ä»·å€¼å‡½æ•°Qè¿›è¡Œå‡†ç¡®çš„ä¼°è®¡</p></li>
<li><p>è¯­ä¹‰åŠ¨ä½œç©ºé—´ï¼š</p>
<ol type="1">
<li><p>ä¸»è¦æ€æƒ³ï¼šçºµå‘ç›®æ ‡ï¼›æ¨ªå‘ç›®æ ‡ï¼›å®ç°ç›®æ ‡çš„ç§¯ææ€§ç¨‹åº¦</p>
<p>æ¨ªå‘ï¼šLateral goals are desired positions in lane coordinate system
(e.g., â€œmy goal is to be in the center of lane number 2â€).</p>
<p>çºµå‘ï¼š Longitudinal goals are of three types. The first is relative
position and speed w.r.t. other vehicles (e.g., â€œmy goal is to be behind
car number 3, at its same speed, and at a distance of 2 seconds from
itâ€).</p>
<p>é€Ÿåº¦ç›®æ ‡ï¼šspeed target (e.g., â€œdrive at the allowed speed for this
road times 110%â€).</p>
<p>é€Ÿåº¦é™åˆ¶ï¼šspeed constraint at a certain position (e.g., when
approaching a junction, â€œspeed of 0 at the stop lineâ€, or when passing a
sharp curve, â€œspeed of at most 60kmh at a certain position on the
curveâ€).<strong>é€Ÿåº¦æ›²çº¿</strong></p></li>
<li><p>ç¡®å®šæ¨ªå‘ç›®æ ‡å’Œçºµå‘ç›®æ ‡ä¹‹é—´çš„ç»„åˆï¼Œåˆ©ç”¨è¿åŠ¨å­¦å…¬å¼æ¥å®ç°ç›®æ ‡</p></li>
<li><p>è¯­ä¹‰åŠ¨ä½œç©ºé—´äº§ç”Ÿäº†æ‰€æœ‰å¯èƒ½çš„å‡ ä½•æ›²çº¿çš„å­é›†ï¼Œé™¤äº†ç‰¹æ®Šçš„æƒ…å†µ</p></li>
</ol></li>
</ul></li>
<li><p><strong>Constructing an evaluation function for semantic
actions</strong> æ„å»º<strong>è¯­ä¹‰åŠ¨ä½œçš„è¯„ä¼°</strong>å‡½æ•°</p>
<ul>
<li>å®šä¹‰è¯­ä¹‰åŠ¨ä½œ <span
class="math inline">\(A^s\)</span>ç©ºé—´ï¼Œé€šè¿‡å½“å‰çš„çŠ¶æ€ <span
class="math inline">\(s\)</span>,é€‰æ‹©æœ€å¥½çš„åŠ¨ä½œ <span
class="math inline">\(a^s\in A^s\)</span>, æ ¹æ®ä¸€äº›åˆ—çš„å‡ ä½•è½¨è¿¹ <span
class="math inline">\((s_1,a_1),...,(s_T,a_T)\)</span>ï¼ŒåŒæ—¶è®¤ä¸ºæ–°çš„ä¸‹ä¸€æ—¶åˆ»çš„çŠ¶æ€æœ‰ä¸€ä¸ªæ–°çš„å‡½æ•°ç»™å‡º
<span class="math inline">\(s_{t+1}=f(s_t,a_t)\)</span>
åŒæ—¶ç»§ç»­æ ¹æ®å¥–åŠ±å‡½æ•°çš„å€¼æ¥è¯„ä¼°æ‰§è¡Œçš„è¯­ä¹‰åŠ¨ä½œçš„å¥½åç¨‹åº¦ <span
class="math inline">\(\frac{1}{T}
\sum_{t=1}^T\rho(s_t,a_t)\)</span></li>
<li>åˆ©ç”¨è¯­ä¹‰åŠ¨ä½œæ¥è¯„ä¼°èƒ½è§„é¿ä¿¡å™ªæ¯”ä½ç­‰é—®é¢˜</li>
<li>åˆ©ç”¨æœºå™¨å­¦ä¹ æ¥æ³›åŒ–ï¼Œåœ¨ä¸åŒç±»å‹çš„é“è·¯ä¸Šè¿›è¡Œè®­ç»ƒï¼Œæ¨å¹¿åˆ°ä¸åŒçš„é“è·¯</li>
<li>è¯­ä¹‰åŠ¨ä½œç©ºé—´ï¼š<strong>èµ„æºé«˜æ•ˆåˆ©ç”¨åŒæ—¶å¾ˆå‡†ç¡®åœ°è¿›è¡Œè¯„ä¼°</strong></li>
</ul></li>
<li><p><strong>The dynamics of the other agents
å…¶ä»–æ™ºèƒ½ä½“çš„åŠ¨æ€</strong></p>
<ul>
<li><span class="math inline">\(s_{t+1}=f(s_t,a_t)\)</span>
è¿™æ ·çš„ç¡®å®šæ€§å‡½æ•°ä¸ç°å®ä¸ç¬¦åˆï¼Œå¤šä¸ªæ™ºèƒ½ä½“ä¹‹é—´ä¼šç›¸äº’å½±å“</li>
<li>é€šè¿‡é«˜é¢‘æ¬¡åœ°é‡æ–°åº”ç”¨å†³ç­–ï¼Œä¸æ–­è°ƒæ•´ç­–ç•¥æ¥é€‚åº”æ–°çš„ç¯å¢ƒ</li>
</ul></li>
</ul>
<h4 id="sensing-ä¼ æ„Ÿ"><strong>Sensing ä¼ æ„Ÿ</strong></h4>
<h5 id="ä¼ æ„Ÿç ”ç©¶çš„å†…å®¹">ä¼ æ„Ÿç ”ç©¶çš„å†…å®¹ï¼š</h5>
<p>é™æ€å¯¹è±¡ï¼š(a fence that occludes relevant part of a merging
road).ï¼›</p>
<p>åŠ¨æ€å¯¹è±¡ï¼šè½¦è¾†ï¼ˆè¾¹ç•Œæ¡†ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦ï¼‰ã€è¡Œäººï¼ˆè¾¹ç•Œæ¡†ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦ï¼‰ã€äº¤é€šç¯ã€åŠ¨æ€é“è·¯åˆ†éš”çº¿ï¼ˆä¾‹å¦‚å»ºç­‘åŒºåŸŸçš„é”¥ä½“ï¼‰ã€ä¸´æ—¶äº¤é€šæ ‡å¿—å’Œè­¦å¯Ÿæ´»åŠ¨ä»¥åŠé“è·¯ä¸Šçš„å…¶ä»–éšœç¢ç‰©ã€‚</p>
<h5 id="sensing-system"><strong>Sensing system</strong></h5>
<ol type="1">
<li>Let <span class="math inline">\(S\)</span> denote the domain of
sensing state and let X be the domain of raw sensor and mapping data. A
ä¼ æ„Ÿç³»ç»Ÿè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå‡½æ•° <span class="math inline">\(\hat{s}\)</span> :
<span class="math inline">\(X â†’ S.\)</span></li>
<li>ä»€ä¹ˆæ—¶å€™ä¼ æ„Ÿå™¨çš„å€¼ <span class="math inline">\(\hat{s}\)</span>
èƒ½å¤Ÿå’ŒçŠ¶æ€ <span class="math inline">\(s\)</span>
è¿‘ä¼¼ï¼Ÿ<strong>é€šè¿‡è¿‘ä¼¼ä¹‹åå¯¹é©¾é©¶ç­–ç•¥çš„æ€»ä½“è¡¨ç°ï¼šå®‰å…¨æ€§å’Œèˆ’é€‚æ€§</strong></li>
<li>ä¼ æ„Ÿå™¨ç³»ç»Ÿå¯èƒ½ä¼šçŠ¯çš„<strong>é”™è¯¯ç±»å‹</strong>ï¼š
<ul>
<li>False negative: the sensing system misses an object
è¯¯æŠ¥ï¼šä¼ æ„Ÿå™¨é”™è¿‡äº†ä¸€ä¸ªç‰©ä½“</li>
<li>False positive: the sensing system indicates a â€œghostâ€ object
é”™è¯¯ï¼šä¼ æ„Ÿå™¨ç³»ç»Ÿæç¤ºå­˜åœ¨å¹½çµç‰©ä½“</li>
<li>Inaccurate measurements: the sensing system correctly detects an
object but incorrectly estimates its position or speed
æµ‹é‡ä¸å‡†ç¡®ï¼šä¼ æ„Ÿç³»ç»Ÿæ­£ç¡®æ£€æµ‹åˆ°ç‰©ä½“ä½†æ˜¯é”™è¯¯ä¼°è®¡ä½ç½®å’Œé€Ÿåº¦</li>
<li>Inaccurate semantic: the sensing system correctly detects an object
but misinterpret its semantic meaning, for example, the color of a
traffic light
è¯­ä¹‰ä¿¡æ¯ä¸å‡†ç¡®ï¼šä¼ æ„Ÿç³»ç»Ÿæ­£ç¡®æ£€æµ‹ç‰©ä½“ï¼Œä½†è¯¯è§£äº†è¯­ä¹‰ä¿¡æ¯ï¼Œæ¯”å¦‚äº¤é€šç¯çš„é¢œè‰²</li>
</ul></li>
</ol>
<h5 id="comfort"><strong>Comfort</strong></h5>
<ul>
<li>ç›¸å½“äºåˆ©ç”¨ä¼ æ„Ÿå™¨å‡½æ•°æ¥è¿‘ä¼¼ä¼°è®¡ <span
class="math inline">\(s\)</span> ,å¦‚æœ <span
class="math inline">\(\pi(\hat{s}(x))=\pi(s)\)</span> ä¹Ÿå°±æ˜¯è¯´<span
class="math inline">\(\pi(\hat{s}(x))=argmaxQ(\hat{s}(x),a)\)</span>ï¼Œé‚£ä¹ˆå°±è¯´æ˜å½“å‰è¿™ä¸ªä¼ æ„Ÿå™¨æ˜¯å¯ä»¥çš„ï¼ŒåŒæ—¶å…è®¸æœ‰ä¸€å®šçš„è¯¯å·®èŒƒå›´ï¼š
<span class="math inline">\(Q(\hat{s}(x),a)\ge
Q(s,\pi(s))-\epsilon\)</span>ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è¯´æ˜¯ <span
class="math inline">\(\epsilon
-\)</span>å‡†ç¡®çš„ï¼ŒåŒæ—¶ä¹Ÿå…è®¸ä¼ æ„Ÿå™¨æœ‰å°æ¦‚ç‡å‘ç”Ÿæ•…éšœ <span
class="math inline">\(\delta\)</span></li>
<li>For example, we can choose three thresholds, $$1 &lt; $<span
class="math inline">\(2 &lt;\)</span>$3 to represent mild, medium, and
gross mistakesï¼Œè¡¨ç¤ºä¼ æ„Ÿå™¨çš„é”™è¯¯ç¨‹åº¦ï¼Œè½»ä¸­é‡</li>
</ul>
<h5 id="pac-sensing-system"><strong>PAC sensing system</strong></h5>
<ol type="1">
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915174341417.png"
alt="Definition 28" />
<figcaption aria-hidden="true">Definition 28</figcaption>
</figure>
<p><strong>Probably-Approximately-Correct (PAC)</strong>
Xè¡¨ç¤ºçš„æ˜¯åŸå§‹çš„æ•°æ®ä¸æ˜ å°„çš„æ•°æ®åŸŸï¼Œä»æœŸæœ›çš„è§’åº¦ç»™å‡ºè¯¯å·®ç‡çš„å¹³å‡å€¼ï¼š
<span class="math display">\[
\mathbb{P}_{(x, s) \sim D}\left[Q(s, \pi(\hat{s}(x))) \geq Q(s,
\pi(s))-\epsilon_i\right] \geq 1-\delta_i
\]</span></p></li>
<li><p>é€šè¿‡è®°å½•è®¸å¤šäººç±»é©¾é©¶å‘˜çš„æ•°æ®æ¥æ„å»ºæ­¤åˆ†å¸ƒï¼Œè€Œä¸æ˜¯éµå¾ªè‡ªåŠ¨é©¾é©¶è½¦è¾†çš„ç‰¹å®šç­–ç•¥ï¼ˆä¸åˆ‡å®é™…ï¼‰ï¼Œç”±äºä»»ä½•åˆç†ç­–ç•¥å¯¹
D
çš„å½±å“éƒ½å¾ˆå°ï¼Œé€šè¿‡åº”ç”¨ç®€å•çš„æ•°æ®å¢å¼ºæŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºé€‚å½“çš„åˆ†å¸ƒï¼Œç„¶ååœ¨ä¼ æ„Ÿç³»ç»Ÿçš„æ¯æ¬¡é‡å¤§æ›´æ–°åæ‰§è¡Œç¦»çº¿éªŒè¯ã€‚</p></li>
<li><p>é‡ç‚¹å…³æ³¨ç»å¸¸å‘ç”Ÿçš„â€œæµ‹é‡ä¸å‡†ç¡®â€ç±»å‹çš„é”™è¯¯</p></li>
<li><p>let <span class="math inline">\(p(o)\)</span>ï¼Œ<span
class="math inline">\(\hat{p}(o)\)</span> be the positions of o in the
coordinate system of the host vehicle according to <span
class="math inline">\(s(x)\)</span>, <span
class="math inline">\(\hat{s}(x)\)</span>
respectively.åˆ†åˆ«è¡¨ç¤ºæŸä¸ªå¯¹è±¡çš„<strong>çœŸå®çš„ä½ç½®ä¿¡æ¯</strong>å’Œ<strong>ä¼ æ„Ÿå™¨çš„ä½ç½®ä¿¡æ¯</strong>ã€‚</p>
<p>ç›®æ ‡åˆ°ä¸»è½¦è¾†çš„è·ç¦»ä¸ºï¼š<span class="math inline">\(\|p\|\)</span>
ï¼ŒåŠ æ€§è¯¯å·®ï¼š<span
class="math inline">\(\|p(o)-\hat{p}(o)\|\)</span>ï¼Œç›¸å¯¹è¯¯å·®ä¸º <span
class="math inline">\(\frac{\|p(o)-\hat{p}(o)\|}{\|p(o)\|}\)</span></p></li>
<li><p>å¯¹äºpositions a set of objects <span
class="math inline">\(O\)</span>è¡¨ç¤ºçš„æ˜¯ä¸€å †å¯¹è±¡ï¼Œè¦æ±‚ <span
class="math inline">\(p(o)\)</span> å’Œ <span
class="math inline">\(\hat{p}(o)\)</span>ä¹‹é—´çš„ç›¸å¯¹è¯¯å·®å°äºä¸€ä¸ªç²¾ç¡®åº¦ä¸å¦¨è®¡ä½œ
$$ ,ä½†æ˜¯<span class="math inline">\(\epsilon-ego-accurate\)</span>
çš„ä¼ æ„ŸçŠ¶æ€ä¸èƒ½ä¿è¯PACä¼ æ„Ÿç³»ç»Ÿèƒ½å¤Ÿæ»¡è¶³æ¯ä¸ªåˆç†çš„ä»·å€¼å‡½æ•°ï¼šå½“ç›¸å¯¹è¯¯å·®å¾ˆå°çš„æ—¶å€™ï¼Œå°½ç®¡è®¤ä¸ºåˆç†äº†ï¼Œä½†æ˜¯å¯¹äºå®é™…çš„æƒ…å†µè€Œè¨€ä¼šå‡ºç°ä¸åŒçš„ä»·å€¼å‡½æ•°ç»“æœã€‚é€‰æ‹©åˆ¶åŠ¨orç»§ç»­å‰è¿›ï¼Œ<strong>æ¨ªå‘ä¸èƒ½ç”¨ç›¸å¯¹è·ç¦»</strong></p></li>
<li><p>è¡¨æ˜<span class="math inline">\(\epsilon-ego-accurate\)</span>
å¹¶ä¸èƒ½ä¿è¯æˆ‘ä»¬çš„ä¼ æ„Ÿç³»ç»Ÿæ˜¯PACã€‚æ˜¯å¦è¿˜æœ‰å…¶ä»–å±æ€§è¶³ä»¥æ»¡è¶³ PAC
ä¼ æ„Ÿç³»ç»Ÿçš„è¦æ±‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915174411587-20231022115924657.png"
alt="Definition 29" />
<figcaption aria-hidden="true">Definition 29</figcaption>
</figure></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915174449633.png"
alt="Definition 31" />
<figcaption aria-hidden="true">Definition 31</figcaption>
</figure>
<p>ç»™å‡ºä»·å€¼å‡½æ•°åˆç†çš„L-è¯­ä¹‰-<span
class="math inline">\(Lipschitz\)</span>æ¡ä»¶</p></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915174520766.png"
alt="Lemma 7" />
<figcaption aria-hidden="true">Lemma 7</figcaption>
</figure>
<p>åˆ¤å®šä¸ºPACä¼ æ„Ÿç³»ç»Ÿçš„ç»ˆæåˆ¤å®š</p></li>
</ol>
<h5 id="safety"><strong>Safety</strong></h5>
<ul>
<li><p>ç›®æ ‡æ˜¯å‡å°‘äº‹æ•…å‘ç”Ÿçš„æ¦‚ç‡ï¼Œå­˜åœ¨ä¸¤ç±»å®‰å…¨æƒ…å†µï¼š</p>
<ol type="1">
<li>ä¼ æ„Ÿç³»ç»Ÿè®¤ä¸ºå±é™©æƒ…å†µæ˜¯ä¸å±é™©çš„ï¼›</li>
<li>ä¼ æ„Ÿå™¨ç³»ç»Ÿè®¤ä¸ºä¸å±é™©æƒ…å†µæ˜¯å±é™©çš„ï¼šå½“å®‰å…¨çš„æ—¶å€™çªç„¶å‡ºç°ç´§æ€¥åˆ¹è½¦ä¼šå¯¼è‡´å±é™©</li>
</ol></li>
<li><p>è§£å†³çš„æ˜¯å¦‚ä½•ç¡®ä¿å’ŒéªŒè¯safety-critic sensing
mistakeè¶³å¤Ÿå°ï¼Œé‡‡ç”¨çš„æ–¹æ³•æ˜¯èåˆå¤šä¸ªå·¥ç¨‹å’ŒæŠ€æœ¯éƒ½ç‹¬ç«‹çš„å­ç³»ç»Ÿã€‚å¤šæ•°å­ç³»ç»Ÿè®¤ä¸ºå®‰å…¨æ‰ç®—å®‰å…¨ï¼š</p></li>
<li><p><strong>å•ä¾§c-è¿‘ä¼¼ç‹¬ç«‹</strong>çš„å¤šä¸ªå­ç³»ç»Ÿ</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20230915174623604-20231022115925281.png"
alt="Definition 32" />
<figcaption aria-hidden="true">Definition 32</figcaption>
</figure></li>
<li><p>å¯¹äºæœä»å•ä¾§-cè¿‘ä¼¼ç‹¬ç«‹çš„å­ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ¨å‡ºï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/img/image-20230915174653068.png"
alt="Corollary 3" />
<figcaption aria-hidden="true">Corollary 3</figcaption>
</figure>
<p>åŸºäºå¤šå­ç³»ç»Ÿæ–¹æ¡ˆå’ŒCorollary 3ï¼Œä¸ºäº†è¾¾åˆ°10^-9
å¤±æ•ˆç‡ï¼Œå¯¹sensingç³»ç»Ÿçš„éªŒè¯ä¸å†éœ€è¦10^9
å°æ—¶çš„æ•°æ®ï¼Œè€Œæ˜¯åˆ†åˆ«å¯¹æ¯ä¸ªå­ç³»ç»ŸéªŒè¯10^5å°æ—¶å°±å¯ä»¥äº†</p></li>
<li><p>ç‹¬ç«‹å‡è®¾èƒŒåçš„åˆç†æ€§ç•™ç»™æˆ‘ä»¬å»æ¨ç†ã€‚æœ‰äº›ä¼ æ„Ÿå™¨å¯¹ä¼šäº§ç”Ÿå®Œå…¨ä¸ç›¸å…³çš„è¯¯å·®ï¼›å•ä¾§-cè¿‘ä¼¼ç‹¬ç«‹æ˜¯å¦æˆç«‹</p></li>
<li><p>å¯¹äºå®‰å…¨å¹½çµè€Œè¨€ï¼Œå½“å‡ºç°è‡³å°‘æœ‰ä¸¤ä¸ªä¼ æ„Ÿå™¨è®¤ä¸ºçš„æƒ…å†µæ˜¯å±é™©çš„ï¼Œæ‰èƒ½è®¤ä¸ºæ˜¯å±é™©çš„</p></li>
<li><p><strong>Building a scalable sensing
systemå¯æ‰©å±•çš„ä¼ æ„Ÿå™¨ç³»ç»Ÿ</strong></p>
<ol type="1">
<li>Cameras</li>
<li>Road Experience Management (REM)ï¼Œä¸ä½¿ç”¨ç‚¹äº‘ï¼Œè€Œæ˜¯ä¸€ç§åŸºäºè¯­ä¹‰çš„æ–¹æ³•
approachï¼Œåˆ©ç”¨å¤§é‡çš„è½¦ç«¯detects semantically meaningful objects in the
scene (lane marks, curbs, poles, traffic lights,
etc.)ï¼Œå¹¶å¯ä»¥å¯¹äº‘ç«¯è¿›è¡Œæ›´æ–°ã€‚ä»¥å¯æ‰©å±•çš„æ–¹å¼éå¸¸é¢‘ç¹åœ°æ›´æ–°åœ°å›¾ã€‚æ­¤å¤–ï¼Œè‡ªåŠ¨é©¾é©¶è½¦è¾†å¯ä»¥é€šè¿‡ç°æœ‰çš„é€šä¿¡å¹³å°ï¼ˆèœ‚çªç½‘ç»œï¼‰æ¥æ”¶å°å‹åœ°å›¾æ•°æ®</li>
<li>A complementary radar and lidar
systemï¼Œèƒ½å¤Ÿäº§ç”Ÿæé«˜çš„ç²¾åº¦ï¼›ç›´æ¥æµ‹é‡é€Ÿåº¦å’Œè·ç¦»ï¼Œè¿™è¿›ä¸€æ­¥æé«˜äº†ä¹˜åçš„èˆ’é€‚åº¦</li>
</ol></li>
</ul>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>æ™ºèƒ½å®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åŸºç¡€å·¥å…·ã€‘DockeråŸºç¡€åŠŸèƒ½</title>
    <url>/2024/01/19/docker/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<p><a
href="https://docker.easydoc.net/doc/81170005/cCewZWoN/AWOEX9XM#nav_2">å‚è€ƒæ–‡æ¡£</a></p>
<h1 id="dockerä»‹ç»">Dockerä»‹ç»</h1>
<p>Docker
æ˜¯ä¸€ä¸ªåº”ç”¨æ‰“åŒ…ã€åˆ†å‘ã€éƒ¨ç½²çš„å·¥å…·ï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªè½»é‡çš„è™šæ‹Ÿæœºï¼Œå®ƒåªè™šæ‹Ÿä½ è½¯ä»¶éœ€è¦çš„è¿è¡Œç¯å¢ƒï¼Œå¤šä½™çš„ä¸€ç‚¹éƒ½ä¸è¦ï¼Œè€Œæ™®é€šè™šæ‹Ÿæœºåˆ™æ˜¯ä¸€ä¸ªå®Œæ•´è€Œåºå¤§çš„ç³»ç»Ÿï¼ŒåŒ…å«å„ç§ä¸ç®¡ä½ è¦ä¸è¦çš„è½¯ä»¶ã€‚</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119102920136.png" alt="Docker" style="zoom: 50%;" /></p>
<table>

<thead>
<tr class="header">
<th>ç‰¹æ€§</th>
<th>æ™®é€šè™šæ‹Ÿæœº</th>
<th>Docker</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>è·¨å¹³å°</td>
<td>é€šå¸¸åªèƒ½åœ¨æ¡Œé¢çº§ç³»ç»Ÿè¿è¡Œï¼Œä¾‹å¦‚
Windows/Macï¼Œæ— æ³•åœ¨ä¸å¸¦å›¾å½¢ç•Œé¢çš„æœåŠ¡å™¨ä¸Šè¿è¡Œ</td>
<td>æ”¯æŒçš„ç³»ç»Ÿéå¸¸å¤šï¼Œå„ç±» windows å’Œ Linux éƒ½æ”¯æŒ</td>
</tr>
<tr class="even">
<td>æ€§èƒ½</td>
<td>æ€§èƒ½æŸè€—å¤§ï¼Œå†…å­˜å ç”¨é«˜ï¼Œå› ä¸ºæ˜¯æŠŠæ•´ä¸ªå®Œæ•´ç³»ç»Ÿéƒ½è™šæ‹Ÿå‡ºæ¥äº†</td>
<td>æ€§èƒ½å¥½ï¼Œåªè™šæ‹Ÿè½¯ä»¶æ‰€éœ€è¿è¡Œç¯å¢ƒï¼Œæœ€å¤§åŒ–å‡å°‘æ²¡ç”¨çš„é…ç½®</td>
</tr>
<tr class="odd">
<td>è‡ªåŠ¨åŒ–</td>
<td>éœ€è¦æ‰‹åŠ¨å®‰è£…æ‰€æœ‰ä¸œè¥¿</td>
<td>ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥è‡ªåŠ¨éƒ¨ç½²å¥½æ‰€éœ€ç¯å¢ƒ</td>
</tr>
<tr class="even">
<td>ç¨³å®šæ€§</td>
<td>ç¨³å®šæ€§ä¸é«˜ï¼Œä¸åŒç³»ç»Ÿå·®å¼‚å¤§</td>
<td>ç¨³å®šæ€§å¥½ï¼Œä¸åŒç³»ç»Ÿéƒ½ä¸€æ ·éƒ¨ç½²æ–¹å¼</td>
</tr>
</tbody>
</table>
<h3 id="docker-ä¸»è¦åŠŸèƒ½">Docker ä¸»è¦åŠŸèƒ½</h3>
<ul>
<li><strong>æ‰“åŒ…</strong>ï¼šå°±æ˜¯æŠŠä½ è½¯ä»¶è¿è¡Œæ‰€éœ€çš„ä¾èµ–ã€ç¬¬ä¸‰æ–¹åº“ã€è½¯ä»¶æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œå˜æˆä¸€ä¸ªå®‰è£…åŒ…</li>
<li><strong>åˆ†å‘</strong>ï¼šä½ å¯ä»¥æŠŠä½ æ‰“åŒ…å¥½çš„â€œå®‰è£…åŒ…â€ä¸Šä¼ åˆ°ä¸€ä¸ªé•œåƒä»“åº“ï¼Œå…¶ä»–äººå¯ä»¥éå¸¸æ–¹ä¾¿çš„è·å–å’Œå®‰è£…</li>
<li><strong>éƒ¨ç½²</strong>ï¼šæ‹¿ç€â€œå®‰è£…åŒ…â€å°±å¯ä»¥ä¸€ä¸ªå‘½ä»¤è¿è¡Œèµ·æ¥ä½ çš„åº”ç”¨ï¼Œè‡ªåŠ¨æ¨¡æ‹Ÿå‡ºä¸€æ‘¸ä¸€æ ·çš„è¿è¡Œç¯å¢ƒï¼Œä¸ç®¡æ˜¯åœ¨
Windows/Mac/Linuxã€‚</li>
</ul>
<h3 id="docker-ç”¨é€”ä»‹ç»">Docker ç”¨é€”ä»‹ç»</h3>
<ul>
<li>åº”ç”¨åˆ†å‘ã€éƒ¨ç½²ï¼Œæ–¹ä¾¿ä¼ æ’­ç»™ä»–äººå®‰è£…ã€‚ç‰¹åˆ«æ˜¯å¼€æºè½¯ä»¶å’Œæä¾›ç§æœ‰éƒ¨ç½²çš„åº”ç”¨</li>
<li>å¿«é€Ÿå®‰è£…æµ‹è¯•/å­¦ä¹ è½¯ä»¶ï¼Œç”¨å®Œå°±ä¸¢ï¼ˆç±»ä¼¼å°ç¨‹åºï¼‰ï¼Œä¸æŠŠæ—¶é—´æµªè´¹åœ¨å®‰è£…è½¯ä»¶ä¸Šã€‚ä¾‹å¦‚
Redis / MongoDB / ElasticSearch / ELK</li>
<li>å¤šä¸ªç‰ˆæœ¬è½¯ä»¶å…±å­˜ï¼Œä¸æ±¡æŸ“ç³»ç»Ÿï¼Œä¾‹å¦‚
Python2ã€Python3ï¼ŒRedis4.0ï¼ŒRedis5.0</li>
<li>Windows ä¸Šä½“éªŒ/å­¦ä¹ å„ç§ Linux ç³»ç»Ÿ</li>
</ul>
<h3 id="dockerä¸»è¦æ¦‚å¿µ">Dockerä¸»è¦æ¦‚å¿µ</h3>
<ul>
<li><strong>é•œåƒ</strong>ï¼šå¯ä»¥ç†è§£ä¸ºè½¯ä»¶å®‰è£…åŒ…ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œä¼ æ’­å’Œå®‰è£…ã€‚</li>
<li><strong>å®¹å™¨</strong>ï¼šè½¯ä»¶å®‰è£…åçš„çŠ¶æ€ï¼Œæ¯ä¸ªè½¯ä»¶è¿è¡Œç¯å¢ƒéƒ½æ˜¯ç‹¬ç«‹çš„ã€éš”ç¦»çš„ï¼Œç§°ä¹‹ä¸ºå®¹å™¨ã€‚</li>
<li>ç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä»¬<strong>å­˜å‚¨ä¸Šä¼ é•œåƒï¼Œé€šè¿‡é•œåƒç”Ÿæˆå®¹å™¨</strong>ï¼Œé•œåƒå¯ä»¥åœ¨<strong>docker
hub</strong>ä¸­è¿›è¡Œç®¡ç†</li>
</ul>
<h1 id="dockerçš„å®‰è£…">Dockerçš„å®‰è£…</h1>
<h3 id="ç‰ˆæœ¬çš„å®‰è£…">ç‰ˆæœ¬çš„å®‰è£…</h3>
<ul>
<li>æ¡Œé¢ç‰ˆï¼š<a
href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a></li>
<li>æœåŠ¡å™¨ç‰ˆï¼š<a
href="https://docs.docker.com/engine/install/#server">https://docs.docker.com/engine/install/#server</a></li>
</ul>
<h3 id="é•œåƒåŠ é€Ÿæº">é•œåƒåŠ é€Ÿæº</h3>
<table>

<thead>
<tr class="header">
<th>é•œåƒåŠ é€Ÿå™¨</th>
<th>é•œåƒåŠ é€Ÿå™¨åœ°å€</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Docker ä¸­å›½å®˜æ–¹é•œåƒ</td>
<td><a
href="https://registry.docker-cn.com">https://registry.docker-cn.com</a></td>
</tr>
<tr class="even">
<td>DaoCloud é•œåƒç«™</td>
<td><a
href="http://f1361db2.m.daocloud.io">http://f1361db2.m.daocloud.io</a></td>
</tr>
<tr class="odd">
<td>Azure ä¸­å›½é•œåƒ</td>
<td><a
href="https://dockerhub.azk8s.cn">https://dockerhub.azk8s.cn</a></td>
</tr>
<tr class="even">
<td>ç§‘å¤§é•œåƒç«™</td>
<td><a
href="https://docker.mirrors.ustc.edu.cn">https://docker.mirrors.ustc.edu.cn</a></td>
</tr>
<tr class="odd">
<td>é˜¿é‡Œäº‘</td>
<td><a
href="https://ud6340vz.mirror.aliyuncs.com">https://ud6340vz.mirror.aliyuncs.com</a></td>
</tr>
<tr class="even">
<td>ä¸ƒç‰›äº‘</td>
<td><a
href="https://reg-mirror.qiniu.com">https://reg-mirror.qiniu.com</a></td>
</tr>
<tr class="odd">
<td>ç½‘æ˜“äº‘</td>
<td><a
href="https://hub-mirror.c.163.com">https://hub-mirror.c.163.com</a></td>
</tr>
<tr class="even">
<td>è…¾è®¯äº‘</td>
<td><a
href="https://mirror.ccs.tencentyun.com">https://mirror.ccs.tencentyun.com</a></td>
</tr>
</tbody>
</table>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119103400627.png"
alt="æ·»åŠ dockerçš„é•œåƒæº" />
<figcaption aria-hidden="true">æ·»åŠ dockerçš„é•œåƒæº</figcaption>
</figure>
<p><strong>åŠ å…¥ä»¥ä¸‹å‘½ä»¤ï¼š=="registry-mirrors":
["https://registry.docker-cn.com,
https://hub-mirror.c.163.com"]==</strong></p>
<h1 id="dockeré•œåƒä¸‹è½½ä¸è½¯ä»¶å®‰è£…">Dockeré•œåƒä¸‹è½½ä¸è½¯ä»¶å®‰è£…</h1>
<h3 id="docker-å®‰è£…çš„ä¼˜ç‚¹">Docker å®‰è£…çš„ä¼˜ç‚¹</h3>
<ul>
<li>ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥å®‰è£…å¥½ï¼Œå¿«é€Ÿæ–¹ä¾¿</li>
<li>æœ‰å¤§é‡çš„é•œåƒï¼Œå¯ç›´æ¥ä½¿ç”¨</li>
<li>æ²¡æœ‰ç³»ç»Ÿå…¼å®¹é—®é¢˜ï¼ŒLinux ä¸“äº«è½¯ä»¶ä¹Ÿç…§æ ·è·‘</li>
<li>æ”¯æŒè½¯ä»¶å¤šç‰ˆæœ¬å…±å­˜</li>
<li>ç”¨å®Œå°±ä¸¢ï¼Œä¸æ‹–æ…¢ç”µè„‘é€Ÿåº¦</li>
<li>ä¸åŒç³»ç»Ÿå’Œç¡¬ä»¶ï¼Œåªè¦å®‰è£…å¥½ Docker
å…¶ä»–éƒ½ä¸€æ ·äº†ï¼Œä¸€ä¸ªå‘½ä»¤æå®šæ‰€æœ‰</li>
</ul>
<h3 id="docker-å®‰è£…-redis">Docker å®‰è£… Redis</h3>
<p>Docker å®˜æ–¹é•œåƒä»“åº“æŸ¥æ‰¾ Redis ï¼šhttps://hub.docker.com/</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119103742209.png" alt="æŸ¥æ‰¾redisé•œåƒ" style="zoom:67%;" /></p>
<p>æ‰¾åˆ°å¦‚ä¸‹çš„å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ docker run --name some-redis -d redis<br></code></pre></td></tr></table></figure>
<ul>
<li>--nameçš„æ„æ€å°±æ˜¯ä¸ºäº§ç”Ÿçš„å®¹å™¨å‘½åï¼Œæ¯”å¦‚è¿™é‡Œå‘½åä¸ºsome-redis</li>
<li>-dçš„æ„æ€æ˜¯åœ¨åå°è¿è¡Œ</li>
<li>æ‰§è¡Œ<strong>docker run</strong>å°±èƒ½ç«‹åˆ»
<strong>pullé•œåƒã€ç”Ÿæˆå®¹å™¨ã€ä»¥åŠè¿è¡Œå®¹å™¨</strong></li>
</ul>
<h3 id="dockerå®‰è£…ubuntu">Dockerå®‰è£…ubuntu</h3>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119105133828.png"
alt="å®‰è£…ubuntu" />
<figcaption aria-hidden="true">å®‰è£…ubuntu</figcaption>
</figure>
<p>é¦–å…ˆå…ˆä»è¿œç«¯æ‹‰å–é•œåƒï¼Œå¯ä»¥æŒ‡å®šç‰ˆæœ¬æˆ–è€…æ˜¯æœ€æ–°çš„ç‰ˆæœ¬</p>
<p>æ¥ç€æœ¬åœ°è¿›è¡Œrun</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">- docker pull ubuntu:18.04<br>- docker run -it ubuntu /bin/bash<br></code></pre></td></tr></table></figure>
<h3 id="dockerå‚è€ƒæ–‡æ¡£">Dockerå‚è€ƒæ–‡æ¡£</h3>
<p>å‘½ä»¤å‚è€ƒï¼š<a
href="https://docs.docker.com/engine/reference/commandline/run/">https://docs.docker.com/engine/reference/commandline/run/</a></p>
<h1 id="dockerçš„å¸¸è§å‘½ä»¤">Dockerçš„å¸¸è§å‘½ä»¤</h1>
<ul>
<li><code>docker run</code>
è¿è¡Œä¸€ä¸ªå®¹å™¨<strong>(-dåå°è¿è¡Œã€--nameé‡å‘½åcontainer)</strong></li>
<li><code>docker stop</code> åœæ­¢è¿è¡Œä¸€ä¸ªå®¹å™¨</li>
<li><code>docker ps</code> åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨</li>
<li><code>docker ps -a</code> åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨</li>
<li><code>docker rm</code> åˆ é™¤æŸä¸ªå®¹å™¨</li>
<li><code>docker exec</code> <strong>(-it <code>mycontainer</code>
/bin/sh)</strong>è¿›å…¥æŸä¸€ä¸ªå®¹å™¨ï¼› <code>docker exit</code>
é€€å‡ºæŸä¸ªå®¹å™¨</li>
<li><code>docker stop container-id</code> åœæ­¢æŒ‡å®š id
çš„å®¹å™¨<code>docker start container-id</code> å¯åŠ¨æŸä¸ªidå®¹å™¨</li>
<li><code>docker images</code> æŸ¥çœ‹é•œåƒåˆ—è¡¨</li>
<li><code>docker rm container-id</code> åˆ é™¤æŒ‡å®š id çš„å®¹å™¨</li>
<li><code>docker rmi image-id</code> åˆ é™¤æŒ‡å®š id çš„é•œåƒ</li>
<li><code>docker volume ls</code> æŸ¥çœ‹ volume åˆ—è¡¨</li>
<li><code>docker network ls</code> æŸ¥çœ‹ç½‘ç»œåˆ—è¡¨</li>
<li><code>docker-compose up</code>
è¡¨ç¤ºçš„æ„æ€æ˜¯åœ¨docker-compose.ymlçš„æ–‡ä»¶å¤¹æ‰€åœ¨çš„ä½ç½®è¿è¡Œå¦‚ä¸‹</li>
<li><code>docker-compose up -d</code> åå°è¿è¡Œåªéœ€è¦åŠ ä¸€ä¸ª -d å‚æ•°</li>
<li><code>docker-compose ps</code> æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</li>
<li><code>docker-compose stop</code> åœæ­¢è¿è¡Œ</li>
<li><code>docker-compose</code> é‡å¯docker composeçš„æœåŠ¡</li>
<li><code>docker-compose restart service-name</code> é‡å¯å•ä¸ªæœåŠ¡</li>
<li><code>docker-compose exec service-name sh</code> è¿›å…¥å®¹å™¨å‘½ä»¤è¡Œ</li>
</ul>
<h1 id="dockeråˆ›å»ºé•œåƒ">Dockeråˆ›å»ºé•œåƒ</h1>
<p><code>Dockerfile</code>æ˜¯ç”¨äºåˆ›å»ºè‡ªå®šä¹‰Dockeré•œåƒçš„æ–‡ä»¶ï¼Œå…¶ä¸»è¦ä½œç”¨åŒ…æ‹¬é…ç½®æ–‡ä»¶ã€æŒ‚è½½ç‚¹ã€å¯¹å¤–æš´éœ²çš„ç«¯å£å’Œè®¾ç½®ç¯å¢ƒå˜é‡</p>
<p>å®¹å™¨å…¶å®æ˜¯åœ¨é•œåƒçš„æœ€ä¸Šé¢åŠ äº†ä¸€å±‚è¯»å†™å±‚ï¼Œåœ¨è¿è¡Œå®¹å™¨é‡Œåšçš„ä»»ä½•æ–‡ä»¶æ”¹åŠ¨ï¼Œéƒ½ä¼šå†™åˆ°è¿™ä¸ªè¯»å†™å±‚ã€‚å¦‚æœåˆ é™¤äº†å®¹å™¨ï¼Œä¹Ÿå°±åˆ é™¤äº†å…¶æœ€ä¸Šé¢çš„è¯»å†™å±‚ï¼Œæ–‡ä»¶æ”¹åŠ¨ä¹Ÿå°±ä¸¢å¤±äº†ã€‚Dockerä½¿ç”¨å­˜å‚¨é©±åŠ¨ç®¡ç†é•œåƒæ¯å±‚å†…å®¹åŠå¯è¯»å†™å±‚çš„å®¹å™¨å±‚ã€‚</p>
<h2 id="dockerfile-æ“ä½œå¸¸ç”¨æŒ‡ä»¤">Dockerfile æ“ä½œå¸¸ç”¨æŒ‡ä»¤</h2>
<ol type="1">
<li><p><strong>FROM é•œåƒ</strong></p>
<p>æŒ‡å®šæ–°é•œåƒæ‰€åŸºäºçš„åŸºç¡€é•œåƒï¼Œç¬¬ä¸€æ¡æŒ‡ä»¤å¿…é¡»ä¸ºFROM
æŒ‡ä»¤ï¼Œæ¯åˆ›å»ºä¸€ä¸ªé•œåƒå°±éœ€è¦ä¸€æ¡ FROM æŒ‡ä»¤</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#æŒ‡å®šäº†goçš„é•œåƒï¼šè¿™ä¸ªæ—¶å€™ä¼šä»ç½‘ä¸Šä¸‹è½½</span><br><span class="hljs-keyword">FROM</span> golang:<span class="hljs-number">1.20</span>-alpine<br></code></pre></td></tr></table></figure></li>
<li><p><strong>MAINTAINER åå­—</strong></p>
<p>è¯´æ˜æ–°é•œåƒçš„ç»´æŠ¤äººä¿¡æ¯</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#æŒ‡å®šç»´æŠ¤è€…çš„ä¿¡æ¯</span><br><span class="hljs-keyword">LABEL</span><span class="language-bash"> maintainer=<span class="hljs-string">&quot;XXXXX@gmail.com&quot;</span></span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>WORKDIR è·¯å¾„</strong> ä¸ºåç»­çš„ RUNã€CMDã€ENTRYPOINT
æŒ‡å®šå·¥ä½œç›®å½•</p>
<p>è¿™é‡Œå®šä¹‰çš„ç›®å½•ç›¸å½“äºæ˜¯åœ¨dockerçš„æ–‡ä»¶å¤¹ä¸‹å®šä¹‰æ–°çš„ç›®å½•å¹¶ä¼šå°†æœ¬åœ°çš„æ–‡ä»¶å†…å®¹ä¸Šä¼ ä¸Šå»</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># å®šä¹‰å·¥ä½œç›®å½•</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /Workspace/ApiService</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>RUN å‘½ä»¤</strong></p>
<p>åœ¨æ‰€åŸºäºçš„é•œåƒä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶æäº¤åˆ°æ–°çš„é•œåƒä¸­</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#ç¼–è¯‘åº”ç”¨ç¨‹åº</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> go build -o api_service main.go</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>CMD ["è¦è¿è¡Œçš„ç¨‹åº", "å‚æ•°1", "å‚æ•°2"]</strong></p>
<p>Dockerfileåªèƒ½æœ‰ä¸€æ¡CMDå‘½ä»¤ã€‚å¦‚æœæŒ‡å®šå¤šæ¡å‘½ä»¤ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¡å‘½ä»¤ã€‚</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># è¿è¡Œåº”ç”¨ç¨‹åº</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;./api_service&quot;</span>]</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>EXPOSE ç«¯å£å·</strong></p>
<p>æŒ‡å®šæ–°é•œåƒåŠ è½½åˆ° Docker æ—¶è¦å¼€å¯çš„ç«¯å£</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># æš´éœ²ç«¯å£</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>ENV ç¯å¢ƒå˜é‡ å˜é‡å€¼</strong></p>
<p>è®¾ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼Œä¼šè¢«åé¢çš„ RUN ä½¿ç”¨</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="hljs-keyword">ENV</span> BUILD_ENV local<br><span class="hljs-keyword">ENV</span> TZ=Asia/Shanghai <span class="hljs-comment">#å®¹å™¨å†…éƒ¨çš„æ—¶é—´è®¾ç½®ä¸ä¸Šæµ·æ‰€åœ¨çš„æ—¶åŒºä¸€è‡´</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>ADD æºæ–‡ä»¶/ç›®å½• ç›®æ ‡æ–‡ä»¶/ç›®å½•</strong></p>
<p>å°†æºæ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­ï¼Œæºæ–‡ä»¶è¦ä¸ <code>Dockerfile</code>
ä½äºç›¸åŒç›®å½•</p>
<p>ä¾‹å­æœ¬åœ°çš„æ–‡ä»¶åœ¨<code>/Workspace/ApiService</code>ä¸­ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå°†æœ¬åœ°çš„<code>/Workspace/ApiService</code>ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶é€åˆ°<code>docker</code>ä¸­çš„<code>/Workspace/ApiService/docker</code>ä¸­</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /Workspace/ApiService</span><br><br><span class="hljs-keyword">ADD</span><span class="language-bash"> docker .</span><br><span class="hljs-comment">#ADD . . #è¿™é‡Œè¡¨ç¤ºç›¸åŒæ–‡ä»¶å¤¹ç›®å½•ç›´æ¥å¤åˆ¶</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>VOLUME [â€œç›®å½•â€]</strong> åœ¨å®¹å™¨ä¸­åˆ›å»ºä¸€ä¸ªæŒ‚è½½ç‚¹</p></li>
</ol>
<h2 id="buildé•œåƒå¹¶è¿è¡Œ">Buildé•œåƒå¹¶è¿è¡Œ</h2>
<h4
id="æ„å»ºdockerfileé•œåƒå¹¶è¿è¡Œ"><strong>æ„å»ºdockerfileé•œåƒå¹¶è¿è¡Œ</strong></h4>
<p>è¦è¿è¡Œ Dockerfile æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨ Docker å·¥å…·ã€‚Docker
å¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬ Windowsã€macOS å’Œå„ç§ Linux
å‘è¡Œç‰ˆã€‚ä»¥ä¸‹æ˜¯ä¸€äº›è¿è¡Œ Dockerfile çš„æ­¥éª¤ï¼š</p>
<ol type="1">
<li>å®‰è£… Docker å·¥å…·</li>
</ol>
<p>åœ¨å®˜ç½‘ä¸Šä¸‹è½½å¹¶å®‰è£… Docker
å·¥å…·ï¼Œæ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿé€‰æ‹©å¯¹åº”ç‰ˆæœ¬ã€‚å®‰è£…å®Œæˆåï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œ
<strong><code>docker</code></strong> å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>
<ul>
<li>è¿›å…¥ Dockerfile æ‰€åœ¨ç›®å½•</li>
</ul>
<p>æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥ Dockerfile æ‰€åœ¨ç›®å½•ã€‚å¯ä»¥ä½¿ç”¨
<strong><code>cd</code></strong> å‘½ä»¤åˆ‡æ¢ç›®å½•ã€‚</p>
<ul>
<li>æ„å»º Docker é•œåƒ</li>
</ul>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»º Docker é•œåƒï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs Bash">docker build -t &lt;é•œåƒåç§°&gt; .<br><span class="hljs-comment">#docker build -t api_service . </span><br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­ <strong><code>-t</code></strong>
å‚æ•°ç”¨äºæŒ‡å®šé•œåƒçš„åç§°ï¼Œ<strong><code>.</code></strong> è¡¨ç¤º Dockerfile
æ‰€åœ¨ç›®å½•ã€‚æ‰§è¡Œè¯¥å‘½ä»¤åï¼ŒDocker ä¼šæ ¹æ® Dockerfile
æ–‡ä»¶ä¸­çš„æŒ‡ä»¤åˆ›å»ºé•œåƒã€‚</p>
<ul>
<li>è¿è¡Œ Docker å®¹å™¨</li>
</ul>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œ Docker å®¹å™¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs Bash">docker run -p &lt;ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt; &lt;é•œåƒåç§°&gt;<br>docker run -d --name my_container -p&lt;ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt; &lt;é•œåƒåç§°&gt;<br><span class="hljs-comment">#docker run -d --name api-container -p 8080:8080 api_service</span><br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­ <strong><code>-p</code></strong>
å‚æ•°ç”¨äºæŒ‡å®šä¸»æœºç«¯å£å’Œå®¹å™¨ç«¯å£çš„æ˜ å°„å…³ç³»ï¼Œ<strong><code>&lt;é•œåƒåç§°&gt;</code></strong>
æ˜¯åœ¨ç¬¬ 3 æ­¥ä¸­æŒ‡å®šçš„é•œåƒåç§°ã€‚æ‰§è¡Œè¯¥å‘½ä»¤åï¼ŒDocker
ä¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œå¹¶å°†å®¹å™¨çš„æ ‡å‡†è¾“å‡ºè¾“å‡ºåˆ°ç»ˆç«¯ä¸­ã€‚å¦‚æœ Dockerfile
ä¸­æ²¡æœ‰æŒ‡å®šç«¯å£ï¼Œéœ€è¦åœ¨è¿è¡Œå®¹å™¨æ—¶æŒ‡å®š <strong><code>-p</code></strong>
å‚æ•°ï¼Œå¹¶å°†å®¹å™¨ç«¯å£æ˜ å°„åˆ°ä¸»æœºä¸Šçš„ä¸€ä¸ªç«¯å£ã€‚å¦åˆ™ï¼Œå®¹å™¨ä¼šå¯åŠ¨å¤±è´¥ã€‚</p>
<p><code>-d</code>è¡¨ç¤ºçš„å½“å‰çš„å®¹å™¨å¯ä»¥åœ¨åå°è¿è¡Œ</p>
<p><code>--name</code>è¡¨ç¤ºç»™æŒ‡å®šçš„å®¹å™¨èµ·ä¸ªåå­—ï¼Œå¦åˆ™ä¼šéšæœºç”Ÿæˆåå­—</p>
<h4 id="åœæ­¢docekrå®¹å™¨"><strong>åœæ­¢docekrå®¹å™¨</strong></h4>
<p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åœæ­¢ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs Bash">docker stop &lt;container-id&gt;<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<strong><code>&lt;container-id&gt;</code></strong>
æ˜¯è¦åœæ­¢çš„å®¹å™¨çš„ IDã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨åˆ—è¡¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs Bash">docker ps<br></code></pre></td></tr></table></figure>
<p>å¦‚æœè¦åœæ­¢æ‰€æœ‰å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs Bash">docker stop $(docker ps -aq)<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<strong><code>docker ps -aq</code></strong>
å‘½ä»¤ç”¨äºåˆ—å‡ºæ‰€æœ‰å®¹å™¨çš„ IDã€‚</p>
<h2 id="scratchæœ€å°é•œåƒ">Scratchæœ€å°é•œåƒ</h2>
<p>ä½¿ç”¨<code>scratch</code>é•œåƒæ—¶ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºæ˜¯é™æ€çš„å¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…ä¸éœ€è¦é¢å¤–çš„æ“ä½œç³»ç»Ÿå±‚ï¼Œè¿™æ ·å¯ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘é•œåƒçš„å¤§å°</p>
<p>æˆ‘ä»¬è¿™é‡Œç»™å‡ºä¸€ä¸ªä¾‹å­</p>
<p>é¦–å…ˆåœ¨åˆ›å»ºä¸€ä¸ªæœ€å°çš„é•œåƒçš„æ—¶å€™éœ€è¦ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºå¯ä»¥é€šè¿‡dockerfileç”Ÿæˆæˆ–è€…æ˜¯ä»å…¶ä»–åœ°æ–¹å¼•å…¥ï¼Œé‚£ä¹ˆè¿™é‡Œç»™å‡ºä¸€ä¸ª<code>golang</code>
é•œåƒæ„å»ºåº”ç”¨ç¨‹åº<code>api_service</code></p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># ç¬¬ä¸€é˜¶æ®µï¼šä½¿ç”¨ golang é•œåƒæ„å»ºåº”ç”¨ç¨‹åº</span><br><span class="hljs-keyword">FROM</span> golang:<span class="hljs-number">1.20</span>-alpine AS builder<br><br><span class="hljs-comment"># å®šä¹‰å·¥ä½œç›®å½•</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /workspace</span><br><br><span class="hljs-comment"># å¤åˆ¶æºä»£ç åˆ°å·¥ä½œç›®å½•</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span><br><br><span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="hljs-keyword">ENV</span> CGO_ENABLED=<span class="hljs-number">0</span><br><span class="hljs-keyword">ENV</span> GOOS=linux<br><span class="hljs-keyword">ENV</span> GOARCH=amd64<br><br><span class="hljs-comment"># ç¼–è¯‘åº”ç”¨ç¨‹åº</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> go build -o api_service main.go</span><br></code></pre></td></tr></table></figure>
<p>æ¥ç€ç¬¬äºŒé˜¶æ®µå°±å»ºä¸€ä¸ªæœ€å°çš„è½»é‡çº§çš„dockeré•œåƒï¼Œé¦–å…ˆéœ€è¦æŒ‰ç…§æ„å»ºé•œåƒçš„åŸºæœ¬æ­¥éª¤ç¡®å®šå·¥ä½œç›®å½•ï¼Œç¯å¢ƒå˜é‡ã€ç«¯å£ç­‰ä¿¡æ¯ï¼Œæ¥ç€é€šè¿‡ä»å·²ç»ç¼–è¯‘å¥½çš„ç¯å¢ƒä¸­è·å–åº”ç”¨ç¨‹åºï¼Œæœ€åæ‰§è¡Œç¨‹åº</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># ç¬¬äºŒé˜¶æ®µï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è½»é‡çº§é•œåƒ</span><br><span class="hljs-keyword">FROM</span> scratch<br><br><span class="hljs-comment"># è®¾ç½®å·¥ä½œç›®å½•</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><br><span class="hljs-comment"># ä» builder é•œåƒä¸­å¤åˆ¶ç¼–è¯‘å¥½çš„åº”ç”¨ç¨‹åº</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> --from=builder /workspace/api_service .</span><br><br><span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="hljs-keyword">ENV</span> BUILD_ENV local<br><span class="hljs-keyword">ENV</span> TZ=Asia/Shanghai<br><br><span class="hljs-comment"># æš´éœ²ç«¯å£</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span><br><br><span class="hljs-comment"># è¿è¡Œåº”ç”¨ç¨‹åº</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;./api_service&quot;</span>]</span><br></code></pre></td></tr></table></figure>
<p>å†™å¥½dockerfileä¹‹åå°±å¯ä»¥æ„å»ºå¹¶è¿è¡Œäº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">docker build -t api_scratch .<br>docker run -d --name scratch_container -p 8080:8080 api_scratch<br></code></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼šé€šè¿‡è¿™ä¸ªæ–¹å¼åªä¼šäº§ç”Ÿä¸€ä¸ªscratché•œåƒï¼Œä»…åŒ…å«ä¸€ä¸ªåº”ç”¨ç¨‹åº</strong></p>
<h1 id="docker-compose">Docker-Compose</h1>
<p>å¦‚æœé¡¹ç›®ä¾èµ–æ›´å¤šçš„ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ç®¡ç†çš„å®¹å™¨å°±æ›´åŠ å¤šï¼Œæ¯ä¸ªéƒ½è¦å•ç‹¬é…ç½®è¿è¡Œï¼ŒæŒ‡å®šç½‘ç»œã€‚ä½¿ç”¨
docker-compose
æŠŠé¡¹ç›®çš„å¤šä¸ªæœåŠ¡é›†åˆåˆ°ä¸€èµ·ï¼Œä¸€é”®è¿è¡Œã€‚è¦æŠŠé¡¹ç›®ä¾èµ–çš„å¤šä¸ªæœåŠ¡é›†åˆåˆ°ä¸€èµ·ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ª<code>docker-compose.yml</code>æ–‡ä»¶ï¼Œæè¿°ä¾èµ–å“ªäº›æœåŠ¡</p>
<h3 id="wordpresså®‰è£…">Wordpresså®‰è£…</h3>
<p>åœ¨dockerhubåœ¨å®‰è£…wordpressçš„æ—¶å€™ï¼Œæ‰€éœ€è¦çš„æœåŠ¡éå¸¸å¤šï¼Œæ‰€ä»¥éœ€è¦æŠŠé¡¹ç›®ä¾èµ–çš„å¤šä¸ªæœåŠ¡é›†åˆåˆ°ä¸€èµ·</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.1&#x27;</span><br><br><span class="hljs-attr">services:</span><br><br>  <span class="hljs-attr">wordpress:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">wordpress</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">8080</span><span class="hljs-string">:80</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">WORDPRESS_DB_HOST:</span> <span class="hljs-string">db</span><br>      <span class="hljs-attr">WORDPRESS_DB_USER:</span> <span class="hljs-string">exampleuser</span><br>      <span class="hljs-attr">WORDPRESS_DB_PASSWORD:</span> <span class="hljs-string">examplepass</span><br>      <span class="hljs-attr">WORDPRESS_DB_NAME:</span> <span class="hljs-string">exampledb</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">wordpress:/var/www/html</span><br><br>  <span class="hljs-attr">db:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:5.7</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">exampledb</span><br>      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">exampleuser</span><br>      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">examplepass</span><br>      <span class="hljs-attr">MYSQL_RANDOM_ROOT_PASSWORD:</span> <span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">db:/var/lib/mysql</span><br><br><span class="hljs-attr">volumes:</span><br>  <span class="hljs-attr">wordpress:</span><br>  <span class="hljs-attr">db:</span><br><br></code></pre></td></tr></table></figure>
<p>é¦–å…ˆç¼–å†™ä¸€ä¸ªï¼š<code>docker-compose.yml</code></p>
<p>æ¥ç€åœ¨docker-compose.ym==læ–‡ä»¶æ‰€åœ¨çš„ä½ç½®==æ‰§è¡Œï¼š<code>docker-compose up</code>å°±å¯ä»¥äº†</p>
<p><strong>æ³¨æ„ï¼šæ‰§è¡Œå®Œdocker-compose
upä¹‹åå°±å·²ç»ç”Ÿæˆå®¹å™¨å¹¶å·²ç»æˆåŠŸrunèµ·æ¥äº†</strong></p>
]]></content>
      <categories>
        <category>åŸºç¡€å·¥å…·</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åŸºç¡€å·¥å…·ã€‘Gitå‘½ä»¤é›†</title>
    <url>/2023/10/23/git/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<p>Git
æ˜¯ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæ˜¯ä»»ä½•è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­çš„ä¸»è¦å†…å®¹ã€‚é€šå¸¸æœ‰ä¸¤ä¸ªä¸»è¦ç”¨é€”ï¼šä»£ç å¤‡ä»½å’Œä»£ç ç‰ˆæœ¬æ§åˆ¶ã€‚ä½¿ç”¨Gitå¯ä»¥é€æ­¥å¤„ç†ä»£ç ï¼Œåœ¨éœ€è¦å›æ»šåˆ°å¤‡ä»½å‰¯æœ¬çš„è¿‡ç¨‹ä¸­ä¿å­˜æ¯ä¸€æ­¥çš„è¿›åº¦ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206220759363.png"
alt="Gitä¸GitHub" />
<figcaption aria-hidden="true">Gitä¸GitHub</figcaption>
</figure>
<h2 id="gitçš„å®‰è£…ä¸é…ç½®">Gitçš„å®‰è£…ä¸é…ç½®</h2>
<h4 id="å®‰è£…git">å®‰è£…Git</h4>
<p>ç›´æ¥ä¸Šå®˜ç½‘ä¸‹è½½å®‰è£…</p>
<p><a
href="https://link.zhihu.com/?target=https%3A//git-scm.com/download">https://link.zhihu.com/?target=https%3A//git-scm.com/download</a></p>
<p><a href="https://git-scm.com/">https://git-scm.com/</a></p>
<p>æˆ–è€…MACä½¿ç”¨brewå¯¹gitè¿›è¡Œå®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">brew install git<br></code></pre></td></tr></table></figure>
<h4 id="æŸ¥çœ‹gitä¸­çš„é…ç½®">æŸ¥çœ‹Gitä¸­çš„é…ç½®</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git config --list<br>git config --global user.email <span class="hljs-built_in">test</span>@163.com<br>git config --global user.name <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure>
<h4 id="æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ">æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git version<br></code></pre></td></tr></table></figure>
<h2 id="gitçš„åŸºæœ¬æ§åˆ¶">Gitçš„åŸºæœ¬æ§åˆ¶</h2>
<h3 id="åˆå§‹åŒ–gitä»“åº“">åˆå§‹åŒ–Gitä»“åº“</h3>
<p>å½“å®Œæˆä¸Šè¿°çš„é…ç½®ä¹‹åï¼Œå°±èƒ½å¼€å§‹åˆå§‹åŒ–Gitä»“åº“ï¼Œè¿›å…¥éœ€è¦åˆ›å»º<strong>å·¥ä½œåŒº</strong>workspaceçš„æ–‡ä»¶å¤¹è¾“å‡ºgitåˆå§‹åŒ–çš„æ“ä½œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> workspace<br>git init<br></code></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªåä¸º .git
çš„æ–°å­ç›®å½•ï¼ˆè¯¥ç›®å½•ä¸ºéšè—çš„ï¼‰ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å¿…éœ€çš„å­˜å‚¨åº“æ–‡ä»¶ï¼ˆGit
å­˜å‚¨åº“æ¡†æ¶ï¼‰ï¼›æ³¨æ„åŒºåˆ†<strong>å·¥ä½œåŒº</strong>å’Œ<strong>æš‚å­˜åŒº</strong>ï¼Œåœ¨æ²¡æœ‰addä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯åœ¨<strong>å·¥ä½œåŒº</strong></p>
<p>ã€Vscodeã€‘è€ƒè™‘<strong>Git
graphæ’ä»¶</strong>æ¥å¯è§†åŒ–gitåˆ†æ”¯ç›®å½•çš„å…¨è²Œ</p>
<ul>
<li><h5 id="åœ¨githubç«¯æ–°å»ºä»“åº“">åœ¨Githubç«¯æ–°å»ºä»“åº“</h5>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206215455986.png"
alt="Githubç«¯æ–°å»ºä»“åº“" />
<figcaption aria-hidden="true">Githubç«¯æ–°å»ºä»“åº“</figcaption>
</figure>
<p>æ ¹æ®éœ€è¦å¯ä»¥è®¾ç½®ä¸ºå…¬æœ‰çš„æˆ–è€…æ˜¯ç§æœ‰çš„ï¼Œæœ€å¥½ä¸è¦è®¾ç½®README.mdï¼Œå› ä¸ºåˆå§‹åŒ–çš„å›½è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°å†²çªï¼Œè®¾ç½®ä¹Ÿæ²¡å…³ç³»</p></li>
<li><h5
id="æœ¬åœ°çš„gitå’Œè¿œç«¯githubçš„è¿æ¥">æœ¬åœ°çš„Gitå’Œè¿œç«¯githubçš„è¿æ¥</h5>
<p>è·å–æœ¬åœ°çš„SSHå…¬é’¥åŒ™ï¼Œæ‰“å¼€ç»ˆç«¯å¹¶è¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">ssh-keygen -t rsa -C <span class="hljs-string">&quot;youremail@example.com&quot;</span><br></code></pre></td></tr></table></figure>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206221011696.png"
alt="äº§ç”Ÿå…¬é’¥çš„ä½ç½®" />
<figcaption aria-hidden="true">äº§ç”Ÿå…¬é’¥çš„ä½ç½®</figcaption>
</figure>
<p>è¿›å…¥.sshä¸­å¤åˆ¶id_rsa.pubä¸­çš„å†…å®¹ï¼Œå¹¶åœ¨Githubä¸­çš„å¦‚ä¸‹ä½ç½®å¤åˆ¶æ”¹å†…å®¹æ·»åŠ SSHğŸ”—</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206221215856.png"
alt="SSHé“¾æ¥" />
<figcaption aria-hidden="true">SSHé“¾æ¥</figcaption>
</figure>
<p>å®Œæˆè¿æ¥ä¹‹åå†é…ç½®gitçš„ç›¸å…³å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git config --global user.email <span class="hljs-built_in">test</span>@163.com<br>git config --global user.name <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure></li>
<li><h5 id="æœ¬åœ°å·¥ä½œåŒºçš„è®¾ç½®">æœ¬åœ°å·¥ä½œåŒºçš„è®¾ç½®</h5>
<p>é¦–å…ˆè¿›è¡Œåˆå§‹åŒ–è®¾ç½®ï¼Œä½¿å½“å‰æ–‡ä»¶å¤¹èƒ½å¤Ÿä½¿ç”¨git</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git init<br></code></pre></td></tr></table></figure>
<p>å¦‚æœä¸€å¼€å§‹æ²¡æœ‰è®¾ç½®README.mdæ–‡ä»¶é‚£ä¹ˆæ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git add README.md<br>git commit -m <span class="hljs-string">&quot;first commit&quot;</span><br>git branch -M master<br>git remote add origin git@github.com.....git<br>git push -u origin master<br></code></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè¿™äº›æ­¥éª¤ï¼Œå°±èƒ½å°†æœ¬åœ°çš„gitå’Œè¿œç«¯çš„ä»“åº“è¿›è¡Œå…³è”</p></li>
<li><h5 id="æœ¬åœ°å’Œè¿œç«¯å…³è”å¤±è´¥">æœ¬åœ°å’Œè¿œç«¯å…³è”å¤±è´¥</h5>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206220359185.png"
alt="æ¨é€å‡ºç°é”™è¯¯" />
<figcaption aria-hidden="true">æ¨é€å‡ºç°é”™è¯¯</figcaption>
</figure>
<p>å½“ç„¶ä¼šå‡ºç°æœ¬åœ°å’Œè¿œç«¯å…³è”å¤±è´¥çš„æƒ…å†µï¼Œäº§ç”Ÿçš„åŸå› å¯èƒ½å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>git push</code>æ—¶ä¸€èˆ¬ä¼šä¸Šä¼ åˆ°<code>origin</code>ä¸‹çš„<code>master</code>åˆ†æ”¯ä¸Šï¼Œå½“<em>repository</em>å’Œ<em>branch</em>è¿‡å¤šï¼Œåˆæ²¡æœ‰è®¾ç½®å…³è”æ—¶ï¼Œgitå°±ä¼šäº§ç”Ÿç–‘é—®</p>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹<strong>è¿œç«¯</strong>å’Œ<strong>æœ¬åœ°</strong>çš„åˆ†æ”¯ï¼Œå¹¶<strong>é€‰æ‹©åˆé€‚çš„</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git branch //æœ¬åœ°<br>git branch -a //è¿œç«¯<br></code></pre></td></tr></table></figure>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231206220538190.png"
alt="è¿œç«¯å’Œæœ¬åœ°çš„ä¸åŒåˆ†æ”¯" />
<figcaption aria-hidden="true">è¿œç«¯å’Œæœ¬åœ°çš„ä¸åŒåˆ†æ”¯</figcaption>
</figure></li>
<li><p>å¦‚æœæœ¬åœ°åˆå§‹åŒ–çš„å†…å®¹å’Œè¿œç«¯çš„å†…å®¹ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆæ— æ³•åˆ¤æ–­æœ¬åœ°å’Œè¿œç«¯çš„å†…å®¹å·®å¼‚ï¼Œå› æ­¤éœ€è¦é€‰æ‹©å¦‚ä¸‹ä¹‹ä¸€</p></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git reset --hard origin/master<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥å°†è¿œç«¯çš„å†…å®¹è¦†ç›–åˆ°æœ¬åœ°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git push -f -u origin master<br></code></pre></td></tr></table></figure>
<p>å¼ºè¡Œå°†æœ¬åœ°çš„å†…å®¹è¦†ç›–åˆ°è¿œç«¯ï¼Œé‚£ä¹ˆå°±èƒ½å½¢æˆç»Ÿä¸€ï¼Œä»è€Œå®Œæˆé“¾æ¥ã€‚</p></li>
</ul>
<h3 id="æ·»åŠ æ–‡ä»¶å’Œå¤‡æ³¨">æ·»åŠ æ–‡ä»¶å’Œå¤‡æ³¨</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git add . <br>git add &lt;file&gt;<br></code></pre></td></tr></table></figure>
<p>æ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¹‹åå°†ä¼šå°†å½“å‰çš„fileæˆ–è€…æ˜¯å·¥ä½œåŒºä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Šä¼ åˆ°æš‚å­˜åŒº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git commit -m<span class="hljs-string">&quot;ã€testã€‘XXXæ›´æ”¹ä¿¡æ¯æç¤º&quot;</span><br><span class="hljs-comment">#å¦‚æœå¤šæ¬¡æäº¤æƒ³è¦†ç›–åˆ°åŒä¸€ä¸ªæäº¤çš„å¤‡æ³¨ä¸Šæ‰§è¡Œä¸‹é¢</span><br>git commit --amend<br></code></pre></td></tr></table></figure>
<p>ä¸Šè¿°çš„å‘½ä»¤æ˜¯å°†æœ¬æ¬¡çš„æäº¤æ·»åŠ æè¿°ï¼Œåˆ†å¸ƒå¼åä½œçš„æ—¶å€™èƒ½çœ‹æ¸…</p>
<h3 id="çŠ¶æ€ä¸æ—¥å¿—">çŠ¶æ€ä¸æ—¥å¿—</h3>
<p>æŸ¥çœ‹é»˜è®¤é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git config --list<br></code></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å½“å‰æ‰€åœ¨çš„åˆ†æ”¯ä½ç½®ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git status<br></code></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å½“å‰åˆ†æ”¯ä¸‹çš„æ›´æ”¹æ—¥å¿—</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>
<h3 id="æ¨é€ä¸æ‹‰å–">æ¨é€ä¸æ‹‰å–</h3>
<p>å°†æœ¬åœ°æš‚å­˜åŒºä¸­çš„æ›´æ”¹å†…å®¹æ¨é€åˆ°è¿œç«¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git push<br>git push -f <span class="hljs-comment">#å¼ºè¡Œæ¨å‡º</span><br></code></pre></td></tr></table></figure>
<p>å°†è¿œç«¯æ‰€åœ¨çš„åˆ†æ”¯å†…å®¹æ‹‰åˆ°æœ¬åœ°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git pull<br></code></pre></td></tr></table></figure>
<p>æ›´æ–°æ‰€åœ¨åˆ†æ”¯çš„æœ€æ–°å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git fetch --all <br></code></pre></td></tr></table></figure>
<h3 id="å¤åˆ¶åˆ†æ”¯">å¤åˆ¶åˆ†æ”¯</h3>
<p>è·å–gitè¿æ¥git@ XXX.gitä¹‹åæ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> git@ XXX.git<br></code></pre></td></tr></table></figure>
<p>å¦‚æœè§‰å¾—gitçš„å†…å®¹å¤ªå¤§ï¼Œå¯ä»¥é€‰æ‹©å†…éƒ¨çš„åˆ†æ”¯è¿›è¡Œä¸‹è½½</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> -b feature/xxx git@ XXX.git<br></code></pre></td></tr></table></figure>
<p>feature/xxxä¸ºå…·ä½“çš„åˆ†æ”¯å†…å®¹</p>
<h3 id="åˆ†æ”¯æ“ä½œ">åˆ†æ”¯æ“ä½œ</h3>
<p>æŸ¥çœ‹åˆ†æ”¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git branch -a <span class="hljs-comment">#æŸ¥çœ‹æ‰€æœ‰çš„åˆ†æ”¯</span><br>git branch -r <span class="hljs-comment">#æŸ¥çœ‹è¿œç«¯çš„åˆ†æ”¯</span><br></code></pre></td></tr></table></figure>
<p>åˆ‡æ¢ä¸åŒçš„åˆ†æ”¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git checkout [branch] <span class="hljs-comment">#åˆ‡æ¢åˆ°åˆ†æ”¯</span><br></code></pre></td></tr></table></figure>
<p>åˆ›å»ºæ–°çš„åˆ†æ”¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git branch [branch] <span class="hljs-comment">#åˆ›å»ºæ–°çš„åˆ†æ”¯</span><br></code></pre></td></tr></table></figure>
<p>åˆ›å»ºæ–°çš„åˆ†æ”¯å¹¶åˆ‡æ¢åˆ°ä¸Šé¢</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git checkout -b [branch] <span class="hljs-comment">#åˆ›å»ºå¹¶åˆ‡æ¢æ–°çš„åˆ†æ”¯</span><br></code></pre></td></tr></table></figure>
<p>åˆå¹¶åˆ†æ”¯</p>
<ul>
<li>ç°åœ¨çš„ä»»åŠ¡æ˜¯å°†båˆ†æ”¯å®Œå…¨åˆå¹¶è¿›aåˆ†æ”¯ï¼ŒåŒæ—¶åªç•™ä¸‹aåˆ†æ”¯</li>
<li>é¦–å…ˆç¡®ä¿båˆ†æ”¯ä¸Šçš„ä¿®æ”¹æäº¤åˆ°äº†origin</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git checkout a <span class="hljs-comment">#å…ˆåˆ‡æ¢åˆ°aåˆ†æ”¯</span><br>git pull <span class="hljs-comment">#è·å–æœ€æ–°çš„å†…å®¹</span><br>git merge origin/b <span class="hljs-comment">#åˆå¹¶b</span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git add .<br>git commit -m <span class="hljs-string">&quot;merge test&quot;</span><br>git push<br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯æ­¤æ—¶è¿˜æ˜¯æœ‰å¦ä¸€ä¸ªåˆ†æ”¯å­˜åœ¨ï¼Œå¦‚æœæƒ³åˆ é™¤åˆ†æ”¯b</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">git push origin --<span class="hljs-built_in">delete</span> b<br></code></pre></td></tr></table></figure>
<h3 id="åˆ†æ”¯å†²çª">åˆ†æ”¯å†²çª</h3>
<p><strong>é—®é¢˜æè¿°ï¼š</strong>å¦‚æœå½“å‰ä¿®æ”¹çš„ç‰ˆæœ¬åŸºäºæ—§ç‰ˆï¼Œä½†æ˜¯è¿œç«¯å·²ç»æ˜¯æ–°ç‰ˆorigin/masterï¼Œ<strong>æ­¤æ—¶ä¿®æ”¹åŸºäºçš„å†…å®¹å’Œè¿œç«¯ä¸åŒä¸èƒ½å¼ºè¡Œæ¨</strong>ã€‚</p>
<p><strong>è§£å†³æ–¹æ³•1ï¼š</strong>é€šè¿‡æ¢åŸºçš„æ–¹æ³•è§£å†³ï¼Œé€šè¿‡å°†å½“å‰çš„ä¿®æ”¹çš„æ—§ç‰ˆæ¢åˆ°æœ€æ–°çš„åŸºä¸Š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#å…ˆå°†æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒº</span><br>git add . <span class="hljs-comment">#ä¿å­˜åœ¨æš‚å­˜åŒº</span><br>git commit -m <span class="hljs-string">&quot;XXX&quot;</span><br><span class="hljs-comment">#è¿›è¡Œæ¢åŸºæ“ä½œ</span><br>git rebase -i origin/master<br><span class="hljs-comment">#å†æ¬¡æäº¤</span><br>git add .<br><span class="hljs-comment">#ç»§ç»­æ¢åŸº</span><br>git rebase --<span class="hljs-built_in">continue</span><br><span class="hljs-comment">#æ¢åŸºæˆåŠŸå,åªéœ€è¦ä¸€æ¬¡å¤‡æ³¨ï¼ˆè¦†ç›–ï¼‰</span><br>git commit --amend<br><span class="hljs-comment">#æœ€åé€€å‡º</span><br>git push<br>git push -f <span class="hljs-comment">#æˆ–è€…å¼ºè¡Œæ¨å‡º</span><br></code></pre></td></tr></table></figure>
<p><strong>è§£å†³æ–¹æ³•2ï¼š</strong> æš´åŠ›è¦†ç›–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git fetch --all <span class="hljs-comment">#è·å–è¿œç«¯çš„å…¨éƒ¨å†…å®¹</span><br>git reset --hard origin/master <span class="hljs-comment">#å¼ºè¡Œå°†è¿œç«¯çš„å†…å®¹è¦†ç›–åˆ°æœ¬åœ°çš„æ–‡ä»¶ä¸­</span><br>git commit --amend <br>git push -f <span class="hljs-comment">#å¼ºè¡Œæ¨å‡º</span><br><br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºç¡€å·¥å…·</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ·±åº¦å­¦ä¹ ã€‘å›¾ç¥ç»ç½‘ç»œ</title>
    <url>/2024/01/12/gnn/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="å›¾ç¥ç»ç½‘ç»œ">å›¾ç¥ç»ç½‘ç»œ</h1>
<p>GNNå…¨ç§°----å›¾ç¥ç»ç½‘ç»œï¼Œå®ƒæ˜¯ä¸€ç§ç›´æ¥ä½œç”¨äºå›¾ç»“æ„ä¸Šçš„ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬å¯ä»¥æŠŠå›¾ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹
<span class="math inline">\(V\)</span> å½“ä½œä¸ªä½“å¯¹è±¡ï¼Œè€Œæ¯ä¸€æ¡è¾¹ <span
class="math inline">\(E\)</span>
å½“ä½œä¸ªä½“ä¸ä¸ªä½“é—´çš„æŸç§è”ç³»ï¼Œæ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„å…³ç³»ç½‘å°±æ˜¯æœ€åçš„å›¾ <span
class="math inline">\(U\)</span></p>
<p>GNNçš„è¾“å…¥ä¸€èˆ¬æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„èµ·å§‹ç‰¹å¾å‘é‡å’Œè¡¨ç¤ºèŠ‚ç‚¹é—´å…³ç³»çš„é‚»æ¥çŸ©é˜µï¼Œæœ‰äº†è¿™ä¸¤ä¸ªè¾“å…¥ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥å°±æ˜¯èšåˆæ“ä½œäº†ã€‚æ‰€è°“çš„èšåˆï¼Œå…¶å®å°±æ˜¯å°†å‘¨è¾¹ä¸èŠ‚ç‚¹
V i ViVi æœ‰å…³è”çš„èŠ‚ç‚¹{V a , V b , . . . Va,Vb,...Va,Vb,...}åŠ æƒåˆ°V i
ViViä¸Šï¼Œå½“ä½œä¸€æ¬¡ç‰¹å¾æ›´æ–°ã€‚åŒç†ï¼Œå¯¹å›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œèšåˆæ“ä½œï¼Œæ›´æ–°æ‰€æœ‰å›¾èŠ‚ç‚¹çš„ç‰¹å¾ã€‚</p>
<p>GNNæœ¬è´¨å°±æ˜¯æ›´æ–°æ¯ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾ï¼Œè¾“å…¥æ˜¯ç‰¹å¾ï¼Œè¾“å‡ºæ˜¯ç‰¹å¾ï¼Œé‚»æ¥çŸ©é˜µä¸ä¼šå˜</p>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æ·±åº¦å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åç«¯å¼€å‘ã€‘Golangè¯­æ³•åŸºç¡€</title>
    <url>/2023/11/27/go-%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<hr />
<h1 id="golangåŸºç¡€">GolangåŸºç¡€</h1>
<p>å‚è€ƒå­¦ä¹ èµ„æ–™ï¼š</p>
<ul>
<li><a
href="https://www.bilibili.com/video/BV1gf4y1r79E/?spm_id_from=333.1007.top_right_bar_window_custom_collection.content.click">8å°æ—¶è½¬èŒGolangå·¥ç¨‹å¸ˆ</a></li>
<li><a href="https://gfw.go101.org/">Goè¯­è¨€101</a></li>
<li><a
href="https://golang.design/go-questions/">Goç¨‹åºå‘˜é¢è¯•ç¬”è¯•å®å…¸</a></li>
</ul>
<h2 id="golangç®€ä»‹">Golangç®€ä»‹</h2>
<h3 id="goè¯­è¨€çš„ä¼˜åŠ¿">goè¯­è¨€çš„ä¼˜åŠ¿</h3>
<ol type="1">
<li><strong>éƒ¨ç½²ç®€å•</strong>
<ul>
<li>å¯ä»¥ç›´æ¥ç¼–è¯‘æˆæœºå™¨ç å¯æ‰§è¡Œ</li>
<li>ä¸ä¾èµ–å…¶ä»–åº“</li>
<li>ç›´æ¥è¿è¡Œå³å¯éƒ¨ç½²</li>
</ul></li>
<li><strong>é™æ€ç±»å‹è¯­è¨€</strong>
<ul>
<li>ç¼–è¯‘çš„æ—¶å€™å°±èƒ½æŸ¥å‡ºæ¥å¤§å¤šæ•°çš„é—®é¢˜</li>
</ul></li>
<li><strong>è¯­è¨€å±‚é¢çš„å¹¶å‘</strong>
<ul>
<li>èƒ½å¤Ÿæˆåˆ†åˆ©ç”¨å¤šæ ¸</li>
</ul></li>
<li><strong>å¼ºå¤§çš„æ ‡å‡†åº“</strong>
<ul>
<li>runtimeç³»ç»Ÿè°ƒåº¦æœºåˆ¶</li>
<li>ä¸°å¯Œçš„æ ‡å‡†åº“</li>
</ul></li>
<li><strong>ç®€å•æ˜“å­¦</strong>
<ul>
<li>25ä¸ªå…³é”®å­—ï¼Œå†…åµŒCè¯­æ³•æ”¯æŒ</li>
<li>é¢å‘å¯¹è±¡çš„ç‰¹å¾ï¼Œèƒ½å¤Ÿè·¨å¹³å°</li>
<li>goè¯­è¨€<strong>æ²¡æœ‰å¼‚å¸¸</strong>ï¼Œå…¨éƒ¨éƒ½ç”¨ERRORæ¥è¡¨ç¤º</li>
</ul></li>
</ol>
<h3 id="goåº”ç”¨æ–¹å‘">goåº”ç”¨æ–¹å‘</h3>
<ol type="1">
<li><strong>äº‘è®¡ç®—åŸºç¡€è®¾æ–½å»ºè®¾</strong>
<ul>
<li>Docker, kubernetes</li>
<li>Consul, cloudflare CDN</li>
</ul></li>
<li><strong>åŸºç¡€åç«¯è½¯ä»¶</strong>ï¼štide, influxdb, cockroachdb</li>
<li><strong>å¾®æœåŠ¡</strong>ï¼šgo-kit, micro</li>
<li><strong>äº’è”ç½‘åŸºç¡€è®¾æ–½</strong>ï¼š ä»¥å¤ªåŠï¼Œhyperledger</li>
</ol>
<hr />
<h2 id="goçš„ç¯å¢ƒå®‰è£…">Goçš„ç¯å¢ƒå®‰è£…</h2>
<h3 id="ä¸‹è½½å®˜ç½‘">ä¸‹è½½å®˜ç½‘</h3>
<p>goçš„å®˜ç½‘ä¸‹è½½ç½‘ç«™ï¼Œé€‰æ‹©åˆé€‚çš„ç³»ç»Ÿç‰ˆæœ¬è¿›è¡Œå®‰è£…<a
href="https://go.dev/dl/">https://go.dev/dl/</a></p>
<h3 id="å®‰è£…æ­¥éª¤">å®‰è£…æ­¥éª¤</h3>
<ol type="1">
<li><p>ä¸‹è½½å®‰è£…åŒ…å¹¶æŒ‰ç…§å®‰è£…åŒ…çš„æŒ‡å¼•ä¸‹è½½ç›¸å…³çš„å†…å®¹</p></li>
<li><p>å¯¹äºMacç³»ç»Ÿä¼šç›´æ¥é…ç½®å¥½ç¯å¢ƒå˜é‡ï¼Œæ ¹æ®å®˜ç½‘çš„å®‰è£…æ‰‹å†Œè¿›è¡Œå®‰è£… <a
href="https://go.dev/doc/install">https://go.dev/doc/install</a></p></li>
<li><p>æµ‹è¯•GOçš„ç‰ˆæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">go version<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231127204733470.png" alt="go version" style="zoom: 67%;" /></p></li>
<li><p>æµ‹è¯•GOçš„ç¯å¢ƒå˜é‡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">go <span class="hljs-built_in">env</span><br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231127204804150.png" alt="go env" style="zoom: 50%;" /></p></li>
</ol>
<h2 id="goç¯å¢ƒå˜é‡">GOç¯å¢ƒå˜é‡</h2>
<h3 id="gorootè·¯å¾„">GOROOTè·¯å¾„</h3>
<p>GOROOT è¡¨ç¤ºçš„æ˜¯å®‰è£…åŒ…æ‰€åœ¨çš„ä½ç½®ï¼Œä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹</p>
<h3 id="gopathè·¯å¾„">GOPATHè·¯å¾„</h3>
<p>GOPATHè¡¨ç¤ºçš„æ˜¯è¿è¡Œæ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼Œè¡¨ç¤ºçš„æ˜¯workspaceçš„æ–‡ä»¶ä½ç½®ï¼ŒGOPATHæ˜¯æˆ‘ä»¬çš„å·¥ä½œç©ºé—´ï¼Œä¿å­˜goé¡¹ç›®ä»£ç å’Œç¬¬ä¸‰æ–¹ä¾èµ–åŒ…<strong>GOPATH</strong>å¯ä»¥è®¾ç½®å¤šä¸ªï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªå°†ä¼šæ˜¯é»˜è®¤çš„åŒ…ç›®å½•ï¼Œä½¿ç”¨
go get ä¸‹è½½çš„åŒ…éƒ½ä¼šåœ¨ç¬¬ä¸€ä¸ªpathä¸­çš„srcç›®å½•ä¸‹ï¼Œä½¿ç”¨ go
installæ—¶ï¼Œåœ¨å“ªä¸ªGOPATHä¸­æ‰¾åˆ°äº†è¿™ä¸ªåŒ…ï¼Œå°±ä¼šåœ¨å“ªä¸ªGOPATHä¸‹çš„binç›®å½•ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>
<p>ä¿®æ”¹GOPATHçš„è·¯å¾„</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> GOPATH=<span class="hljs-string">&quot;/Users/lihaibin/workspace/golang&quot;</span><br></code></pre></td></tr></table></figure>
<p>å°†æ–‡ä»¶æŸ¥æ‰¾çš„è·¯å¾„è®¾ç½®ä¸ºGOROOTå’ŒGOPATHçš„å¹¶é›†åˆ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$GOROOT</span>/bin:<span class="hljs-variable">$GOPATH</span>/bin<br></code></pre></td></tr></table></figure>
<p>å°†ä¸¤ä¸ªéƒ¨åˆ†å¹¶åœ¨ä¸€èµ·ä¹‹åï¼Œå°±èƒ½ä»ä¸¤ä¸ªåœ°æ–¹å¼€å§‹å¯»æ‰¾å®šä¹‰çš„åŒ…</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203140236053.png"
alt="æŸ¥æ‰¾æ–‡ä»¶çš„è·¯å¾„é¡ºåº" />
<figcaption aria-hidden="true">æŸ¥æ‰¾æ–‡ä»¶çš„è·¯å¾„é¡ºåº</figcaption>
</figure>
<p>é¦–å…ˆä¼šä»GOROOTè¿›è¡Œæœç´¢ï¼Œæ¥ç€ä»GOPATHè¿›è¡Œæœç´¢ã€‚</p>
<p>GOPATHæ˜¯å¼€å‘æ—¶çš„å·¥ä½œç›®å½•ã€‚ç”¨äºï¼š</p>
<ol type="1">
<li>ä¿å­˜ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li>
<li><code>go get</code>å’Œ<code>go install</code>å‘½ä»¤ä¼šä¸‹è½½goä»£ç åˆ°GOPATHã€‚</li>
<li>importåŒ…æ—¶çš„æœç´¢è·¯å¾„</li>
</ol>
<p>ä½¿ç”¨GOPATHæ—¶ï¼ŒGOä¼šåœ¨ä»¥ä¸‹ç›®å½•ä¸­æœç´¢åŒ…ï¼š</p>
<ol type="1">
<li><code>GOROOT/src</code>ï¼šè¯¥ç›®å½•ä¿å­˜äº†Goæ ‡å‡†åº“ä»£ç ã€‚</li>
<li><code>GOPATH/src</code>ï¼šè¯¥ç›®å½•ä¿å­˜äº†åº”ç”¨è‡ªèº«çš„ä»£ç å’Œç¬¬ä¸‰æ–¹ä¾èµ–çš„ä»£ç ã€‚</li>
</ol>
<p><strong>GOPATHçš„å¼Šç«¯</strong></p>
<p>åœ¨ GOPATH çš„ <code>$GOPATH/src</code> ä¸‹è¿›è¡Œ <code>.go</code>
æ–‡ä»¶æˆ–æºä»£ç çš„å­˜å‚¨ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å…¶ä¸º GOPATH
çš„æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼æ‹¥æœ‰ä¸€äº›å¼Šç«¯.</p>
<ul>
<li><p><strong>æ— ç‰ˆæœ¬æ§åˆ¶æ¦‚å¿µ.</strong>
åœ¨æ‰§è¡Œ<code>go get</code>çš„æ—¶å€™ï¼Œä½ æ— æ³•ä¼ è¾¾ä»»ä½•çš„ç‰ˆæœ¬ä¿¡æ¯çš„æœŸæœ›ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¹Ÿæ— æ³•çŸ¥é“è‡ªå·±å½“å‰æ›´æ–°çš„æ˜¯å“ªä¸€ä¸ªç‰ˆæœ¬ï¼Œä¹Ÿæ— æ³•é€šè¿‡æŒ‡å®šæ¥æ‹‰å–è‡ªå·±æ‰€æœŸæœ›çš„å…·ä½“ç‰ˆæœ¬ã€‚</p></li>
<li><p><strong>æ— æ³•åŒæ­¥ä¸€è‡´ç¬¬ä¸‰æ–¹ç‰ˆæœ¬å·.</strong> åœ¨è¿è¡Œ Go
åº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œä½ æ— æ³•ä¿è¯å…¶å®ƒäººä¸ä½ æ‰€æœŸæœ›ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“æ˜¯ç›¸åŒçš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨é¡¹ç›®ä¾èµ–åº“çš„ç®¡ç†ä¸Šï¼Œä½ æ— æ³•ä¿è¯æ‰€æœ‰äººçš„ä¾èµ–ç‰ˆæœ¬éƒ½ä¸€è‡´ã€‚</p></li>
<li><p><strong>æ— æ³•æŒ‡å®šå½“å‰é¡¹ç›®å¼•ç”¨çš„ç¬¬ä¸‰æ–¹ç‰ˆæœ¬å·.</strong> ä½ æ²¡åŠæ³•å¤„ç†
v1ã€v2ã€v3 ç­‰ç­‰ä¸åŒç‰ˆæœ¬çš„å¼•ç”¨é—®é¢˜ï¼Œå› ä¸º GOPATH
æ¨¡å¼ä¸‹çš„å¯¼å…¥è·¯å¾„éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯<code>github.com/foo/bar</code>ã€‚</p></li>
</ul>
<h3 id="goproxyè®¾ç½®">GOPROXYè®¾ç½®</h3>
<p>è¿™ä¸ªç¯å¢ƒå˜é‡ä¸»è¦æ˜¯ç”¨äºè®¾ç½® <strong>Go æ¨¡å—ä»£ç†ï¼ˆGo module
proxyï¼‰,å…¶ä½œç”¨æ˜¯ç”¨äºä½¿ Go
åœ¨åç»­æ‹‰å–æ¨¡å—ç‰ˆæœ¬æ—¶ç›´æ¥é€šè¿‡é•œåƒç«™ç‚¹æ¥å¿«é€Ÿæ‹‰å–</strong>ã€‚</p>
<p>GOPROXY
çš„é»˜è®¤å€¼æ˜¯ï¼š<code>https://proxy.golang.org,direct</code>ï¼Œ<code>proxy.golang.org</code>å›½å†…è®¿é—®ä¸äº†,éœ€è¦è®¾ç½®å›½å†…çš„ä»£ç†</p>
<ul>
<li>é˜¿é‡Œäº‘ https://mirrors.aliyun.com/goproxy/</li>
<li>ä¸ƒç‰›äº‘ https://goproxy.cn,direct</li>
</ul>
<p>å¹¶é€šè¿‡ä»¥ä¸‹çš„å‘½ä»¤è¿›è¡Œè®¾ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">go <span class="hljs-built_in">env</span> -w GOPROXY=https://goproxy.cn,direct<br></code></pre></td></tr></table></figure>
<p>GOPROXY çš„å€¼æ˜¯ä¸€ä¸ªä»¥è‹±æ–‡é€—å· â€œ,â€ åˆ†å‰²çš„ Go
æ¨¡å—ä»£ç†åˆ—è¡¨ï¼Œå…è®¸è®¾ç½®å¤šä¸ªæ¨¡å—ä»£ç†ï¼Œå‡è®¾ä½ ä¸æƒ³ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å°†å…¶è®¾ç½®ä¸º
â€œoffâ€ ï¼Œè¿™å°†ä¼šç¦æ­¢ Go åœ¨åç»­æ“ä½œä¸­ä½¿ç”¨ä»»ä½• Go æ¨¡å—ä»£ç†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">go <span class="hljs-built_in">env</span> -w GOPROXY=https://goproxy.cn,https://mirrors.aliyun.com/goproxy/,direct<br></code></pre></td></tr></table></figure>
<h3 id="go111module">GO111MODULE</h3>
<p>GO111MODULE æœ‰ä¸‰ä¸ªå€¼ï¼šoff, onå’Œautoï¼ˆé»˜è®¤å€¼ï¼‰ã€‚</p>
<ul>
<li>GO111MODULE=offï¼Œgoå‘½ä»¤è¡Œå°†ä¸ä¼šæ”¯æŒmoduleåŠŸèƒ½ï¼Œå¯»æ‰¾ä¾èµ–åŒ…çš„æ–¹å¼å°†ä¼šæ²¿ç”¨æ—§ç‰ˆæœ¬é‚£ç§é€šè¿‡vendorç›®å½•æˆ–è€…GOPATHæ¨¡å¼æ¥æŸ¥æ‰¾ã€‚</li>
<li>GO111MODULE=onï¼Œgoå‘½ä»¤è¡Œä¼šä½¿ç”¨modulesï¼Œè€Œä¸€ç‚¹ä¹Ÿä¸ä¼šå»GOPATHç›®å½•ä¸‹æŸ¥æ‰¾ã€‚</li>
<li>GO111MODULE=autoï¼Œé»˜è®¤å€¼ï¼Œgoå‘½ä»¤è¡Œå°†ä¼šæ ¹æ®å½“å‰ç›®å½•æ¥å†³å®šæ˜¯å¦å¯ç”¨moduleåŠŸèƒ½ã€‚è¿™ç§æƒ…å†µä¸‹å¯ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å½¢ï¼š
å½“å‰ç›®å½•åœ¨GOPATH/srcä¹‹å¤–ä¸”è¯¥ç›®å½•åŒ…å«go.modæ–‡ä»¶
å½“å‰æ–‡ä»¶åœ¨åŒ…å«go.modæ–‡ä»¶çš„ç›®å½•ä¸‹é¢ã€‚</li>
</ul>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å¯go modç®¡ç†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">go <span class="hljs-built_in">env</span> -w GO111MODULE=on<br></code></pre></td></tr></table></figure>
<p>Go modæ“ä½œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">go mod init github.com/hub/project<br></code></pre></td></tr></table></figure>
<h2 id="goåŸºæœ¬è¯­æ³•">GoåŸºæœ¬è¯­æ³•</h2>
<h3 id="å¦‚ä½•ç¼–è¯‘å¹¶è¿è¡Œä¸€ä¸ªgoæ–‡ä»¶">å¦‚ä½•ç¼–è¯‘å¹¶è¿è¡Œä¸€ä¸ªGoæ–‡ä»¶</h3>
<p>å¯¹äºå·²ç»å†™å¥½çš„goæ–‡ä»¶ï¼Œè¿™é‡Œä»¥hello.goä½œä¸ºä¾‹å­ï¼Œç›´æ¥ä½¿ç”¨ä»¥ä¸‹è¯­å¥è¿›è¡Œç¼–è¯‘å¹¶è¿è¡Œ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">go</span> run hello.<span class="hljs-keyword">go</span><br></code></pre></td></tr></table></figure>
<p>æˆ–è€…å°†ç¼–è¯‘å’Œè¿è¡Œä¸¤ä¸ªè¿‡ç¨‹åˆ†å¼€ï¼Œå…ˆç¼–è¯‘åè¿è¡Œï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">go</span> build hello.<span class="hljs-keyword">go</span><br>./ hello<br></code></pre></td></tr></table></figure>
<h3 id="å†™ä¸€ä¸ªhello.go">å†™ä¸€ä¸ªhello.go</h3>
<p>é¦–å…ˆç»™å‡ºåŸºæœ¬æ¡†æ¶</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span>(<br>	<span class="hljs-string">&quot;fmt&quot;</span>,<br>  <span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>  fmt.Println(<span class="hljs-string">&quot;hello world!&quot;</span>)<br>  time.Sleep(<span class="hljs-number">1</span>*time.Second)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç¨‹åºçš„ç¬¬ä¸€è¡Œå£°æ˜äº†åä¸ºmainçš„packageã€‚<strong>ä¸€ä¸ªpackageä¼šåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª.goæºä»£ç æ–‡ä»¶ã€‚æ¯ä¸€ä¸ªæºæ–‡ä»¶éƒ½æ˜¯ä»¥packageå¼€å¤´ã€‚</strong>æ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­é‡Œæ˜¯package
mainã€‚è¿™è¡Œå£°æ˜è¯­å¥è¡¨ç¤ºè¯¥æ–‡ä»¶æ˜¯å±äºå“ªä¸€ä¸ªpackageã€‚</p>
<ul>
<li>ç¬¬ä¸€è¡Œä»£ç <strong>package
main</strong>å®šä¹‰äº†åŒ…åã€‚ä½ å¿…é¡»åœ¨æºæ–‡ä»¶ä¸­éæ³¨é‡Šçš„ç¬¬ä¸€è¡ŒæŒ‡æ˜è¿™ä¸ªæ–‡ä»¶å±äºå“ªä¸ªåŒ…ï¼Œå¦‚ï¼špackage
mainã€‚package mainè¡¨ç¤ºä¸€ä¸ªå¯ç‹¬ç«‹æ‰§è¡Œçš„ç¨‹åºï¼Œæ¯ä¸ª Go
åº”ç”¨ç¨‹åºéƒ½åŒ…å«ä¸€ä¸ªåä¸º main çš„åŒ…ã€‚</li>
<li>ä¸‹ä¸€è¡Œ<strong>import "fmt"</strong>å‘Šè¯‰ Go ç¼–è¯‘å™¨è¿™ä¸ªç¨‹åºéœ€è¦ä½¿ç”¨
fmt åŒ…ï¼ˆçš„å‡½æ•°ï¼Œæˆ–å…¶ä»–å…ƒç´ ï¼‰ï¼Œfmt åŒ…å®ç°äº†æ ¼å¼åŒ–
IOï¼ˆè¾“å…¥/è¾“å‡ºï¼‰çš„å‡½æ•°</li>
<li><code>.</code>å’Œæ²¡æœ‰<code>.</code>å¯¼å…¥åŒ…çš„åŒºåˆ«ï¼Œå¦‚æœä¸€å¼€å§‹å¼•å…¥çš„æ—¶å€™æœ‰<code>.</code>é‚£ä¹ˆå°±ä¸éœ€è¦æŒ‡å®šå“ªä¸ªåŒ…çš„æ¥è°ƒç”¨å‡½æ•°ï¼Œå¦åˆ™éœ€è¦å†è°ƒç”¨å‡½æ•°çš„æ—¶å€™æŒ‡å®šå¯¹åº”çš„åŒ…<code>package</code></li>
<li>ä¸‹ä¸€è¡Œfunc main()æ˜¯ç¨‹åºå¼€å§‹æ‰§è¡Œçš„å‡½æ•°ã€‚main
å‡½æ•°æ˜¯æ¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºæ‰€å¿…é¡»åŒ…å«çš„ï¼Œä¸€èˆ¬æ¥è¯´éƒ½æ˜¯åœ¨å¯åŠ¨åç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‡½æ•°ï¼ˆå¦‚æœæœ‰
init() å‡½æ•°åˆ™ä¼šå…ˆæ‰§è¡Œè¯¥å‡½æ•°ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>ä¸€ä¸ªç¨‹åºçš„<code>main</code>å…¥å£å‡½æ•°å¿…é¡»ä¸å¸¦ä»»ä½•è¾“å…¥å‚æ•°å’Œè¿”å›ç»“æœã€‚è€Œä¸”goè¯­è¨€çš„è¯­æ³•ï¼Œå®šä¹‰å‡½æ•°çš„æ—¶å€™ï¼Œ<strong>â€˜{â€™
å¿…é¡»å’Œå‡½æ•°ååœ¨åŒä¸€è¡Œï¼Œä¸èƒ½å¦èµ·ä¸€è¡Œ</strong></p>
</blockquote>
<h3 id="å˜é‡çš„å£°æ˜">å˜é‡çš„å£°æ˜</h3>
<p>å£°æ˜å˜é‡çš„ä¸€èˆ¬å½¢å¼æ˜¯ä½¿ç”¨ var å…³é”®å­—</p>
<h4 id="ç¬¬ä¸€ç§å£°æ˜">ç¬¬ä¸€ç§å£°æ˜ï¼š</h4>
<p>æŒ‡å®šå˜é‡ç±»å‹ï¼Œå£°æ˜åè‹¥ä¸èµ‹å€¼ï¼Œä½¿ç”¨<strong>é»˜è®¤å€¼0</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> v_name v_type<br>v_name = value<br><span class="hljs-keyword">package</span> main<br><br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">var</span> a <span class="hljs-type">int</span><br>        fmt.Printf(<span class="hljs-string">&quot; = %d\n&quot;</span>, a)<br>&#125;<br><br><br>$<span class="hljs-keyword">go</span> run test.<span class="hljs-keyword">go</span><br>a = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<h4 id="ç¬¬äºŒç§å£°æ˜">ç¬¬äºŒç§å£°æ˜ï¼š</h4>
<p>æ ¹æ®å€¼è‡ªè¡Œåˆ¤å®šå˜é‡ç±»å‹ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> v_name = value<br></code></pre></td></tr></table></figure>
<h4 id="ç¬¬ä¸‰ç§å£°æ˜">ç¬¬ä¸‰ç§å£°æ˜ï¼š</h4>
<p>çœç•¥var, æ³¨æ„
:=å·¦ä¾§çš„å˜é‡ä¸åº”è¯¥æ˜¯å·²ç»å£°æ˜è¿‡çš„ï¼Œå°±æ˜¯:=åªèƒ½ç”¨äºæ²¡æœ‰è¢«å£°æ˜çš„å˜é‡èµ‹å€¼ä¸Šï¼Œå¦åˆ™ä¼šç¼–è¯‘é”™è¯¯</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">v_name := value<br><br><br><span class="hljs-comment">// ä¾‹å¦‚</span><br><span class="hljs-keyword">var</span> a <span class="hljs-type">int</span> = <span class="hljs-number">10</span><br><span class="hljs-keyword">var</span> b = <span class="hljs-number">10</span><br>c : = <span class="hljs-number">10</span><br></code></pre></td></tr></table></figure>
<p>å‡ ç§å£°æ˜ç±»å‹çš„å¯¹æ¯”</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-comment">//ç¬¬ä¸€ç§ ä½¿ç”¨é»˜è®¤å€¼</span><br>        <span class="hljs-keyword">var</span> a <span class="hljs-type">int</span><br>        fmt.Printf(<span class="hljs-string">&quot;a = %d\n&quot;</span>, a)<br><br><br>        <span class="hljs-comment">//ç¬¬äºŒç§</span><br>        <span class="hljs-keyword">var</span> b <span class="hljs-type">int</span> = <span class="hljs-number">10</span><br>        fmt.Printf(<span class="hljs-string">&quot;b = %d\n&quot;</span>, b)<br><br><br>        <span class="hljs-comment">//ç¬¬ä¸‰ç§ çœç•¥åé¢çš„æ•°æ®ç±»å‹,è‡ªåŠ¨åŒ¹é…ç±»å‹</span><br>        <span class="hljs-keyword">var</span> c = <span class="hljs-number">20</span><br>        fmt.Printf(<span class="hljs-string">&quot;c = %d\n&quot;</span>, c)<br><br><br>        <span class="hljs-comment">//ç¬¬å››ç§ çœç•¥varå…³é”®å­—</span><br>        d := <span class="hljs-number">3.14</span><br>        fmt.Printf(<span class="hljs-string">&quot;d = %f\n&quot;</span>, d)<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="å…¨å±€å˜é‡å£°æ˜">å…¨å±€å˜é‡å£°æ˜</h4>
<p>å’Œä¸€èˆ¬çš„å®šä¹‰å˜é‡çš„æ–¹å¼ä¸€æ ·</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> x, y <span class="hljs-type">int</span><br><span class="hljs-keyword">var</span> c, d <span class="hljs-type">int</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span><br><span class="hljs-keyword">var</span> e, f = <span class="hljs-number">123</span>, <span class="hljs-string">&quot;lihaibin&quot;</span><br></code></pre></td></tr></table></figure>
<p>ç‰¹æ®Šçš„å®šä¹‰å…¨å±€å˜é‡çš„æ–¹å¼ï¼Œè€Œä¸”<strong>:=çš„å®šä¹‰æ–¹å¼ä¸èƒ½å¤Ÿç”¨äºå®šä¹‰å…¨å±€å˜é‡</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><br><span class="hljs-keyword">var</span> ( <span class="hljs-comment">//è¿™ç§åˆ†è§£çš„å†™æ³•,ä¸€èˆ¬ç”¨äºå£°æ˜å…¨å±€å˜é‡</span><br>        a <span class="hljs-type">int</span><br>        b <span class="hljs-type">bool</span><br>)<br><br><span class="hljs-comment">//è¿™ç§ä¸å¸¦å£°æ˜æ ¼å¼çš„åªèƒ½åœ¨å‡½æ•°ä½“å†…å£°æ˜</span><br><span class="hljs-comment">//g, h := 123, &quot;éœ€è¦åœ¨funcå‡½æ•°ä½“å†…å®ç°&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;&#125;<br></code></pre></td></tr></table></figure>
<h4 id="å¤šå˜é‡å£°æ˜">å¤šå˜é‡å£°æ˜</h4>
<p>:=ä¸èƒ½ç”¨äºå·²ç»è¢«åˆå§‹åŒ–ä¹‹åçš„å˜é‡çš„èµ‹å€¼ï¼Œå¦‚æœå¯¹äº_çš„æƒ…å†µæ˜¯ä¸å…·å¤‡å¯è¯»æ€§ï¼Œç›¸å½“äºå¿½ç•¥</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>        g, h := <span class="hljs-number">123</span>, <span class="hljs-string">&quot;éœ€è¦åœ¨funcå‡½æ•°ä½“å†…å®ç°&quot;</span><br>        fmt.Println(x, y, a, b, c, d, e, f, g, h)<br><br>        <span class="hljs-comment">//ä¸èƒ½å¯¹gå˜é‡å†æ¬¡åšåˆå§‹åŒ–å£°æ˜</span><br>        <span class="hljs-comment">//g := 400</span><br><br>        _, value := <span class="hljs-number">7</span>, <span class="hljs-number">5</span>  <span class="hljs-comment">//å®é™…ä¸Š7çš„èµ‹å€¼è¢«åºŸå¼ƒï¼Œå˜é‡ _  ä¸å…·å¤‡è¯»ç‰¹æ€§</span><br>        <span class="hljs-comment">//fmt.Println(_) //_å˜é‡çš„æ˜¯è¯»ä¸å‡ºæ¥çš„</span><br>        fmt.Println(value) <span class="hljs-comment">//5</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="å¸¸é‡">å¸¸é‡</h3>
<h4 id="å¸¸é‡çš„å£°æ˜æ–¹å¼">å¸¸é‡çš„å£°æ˜æ–¹å¼</h4>
<p>å¸¸é‡æ˜¯ä¸€ä¸ªç®€å•å€¼çš„æ ‡è¯†ç¬¦ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œ<strong>ä¸ä¼šè¢«ä¿®æ”¹çš„é‡</strong>ã€‚å¸¸é‡ä¸­çš„æ•°æ®ç±»å‹åªå¯ä»¥æ˜¯å¸ƒå°”å‹ã€æ•°å­—å‹ï¼ˆæ•´æ•°å‹ã€æµ®ç‚¹å‹å’Œå¤æ•°ï¼‰å’Œå­—ç¬¦ä¸²å‹ã€‚</p>
<p>å¸¸é‡çš„å®šä¹‰æ ¼å¼ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> identifier [<span class="hljs-keyword">type</span>] = value<br><span class="hljs-keyword">const</span> b <span class="hljs-type">string</span> = <span class="hljs-string">&quot;abc&quot;</span><br></code></pre></td></tr></table></figure>
<p>éšå¼å®šä¹‰ç±»å‹æ–¹æ³•ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> b = <span class="hljs-string">&quot;abc&quot;</span><br></code></pre></td></tr></table></figure>
<p>å¤šé‡èµ‹å€¼</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> a, b, c = <span class="hljs-number">1</span>, <span class="hljs-literal">false</span>, <span class="hljs-string">&quot;str&quot;</span> <span class="hljs-comment">//å¤šé‡èµ‹å€¼</span><br></code></pre></td></tr></table></figure>
<p>æšä¸¾ç±»å‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>    Unknown = <span class="hljs-number">0</span><br>    Female = <span class="hljs-number">1</span><br>    Male = <span class="hljs-number">2</span><br>)<br></code></pre></td></tr></table></figure>
<p>å¸¸é‡å¯ä»¥ç”¨len(), cap(),
unsafe.Sizeof()å¸¸é‡è®¡ç®—è¡¨è¾¾å¼çš„å€¼ã€‚å¸¸é‡è¡¨è¾¾å¼ä¸­ï¼Œå‡½æ•°å¿…é¡»æ˜¯å†…ç½®å‡½æ•°</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;unsafe&quot;</span><br><span class="hljs-keyword">const</span> (<br>    a = <span class="hljs-string">&quot;abc&quot;</span><br>    b = <span class="hljs-built_in">len</span>(a)<br>    c = unsafe.Sizeof(a)<br>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">println</span>(a, b, c)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœä¸ºï¼šabc, 3, 16</p>
<blockquote>
<p>unsafe.Sizeof(a) = 16</p>
<p>å­—ç¬¦ä¸²ç±»å‹åœ¨ go é‡Œæ˜¯ä¸ªç»“æ„,
åŒ…å«æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆå’Œé•¿åº¦,è¿™ä¸¤éƒ¨åˆ†æ¯éƒ¨åˆ†éƒ½æ˜¯ 8
ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²ç±»å‹å¤§å°ä¸º 16 ä¸ªå­—èŠ‚ã€‚</p>
</blockquote>
<h4 id="å¸¸é‡ä¸­çš„iotaæ ‡è¯†ç¬¦">å¸¸é‡ä¸­çš„iotaæ ‡è¯†ç¬¦</h4>
<p>åœ¨ golang
ä¸­ï¼Œä¸€ä¸ªæ–¹ä¾¿çš„ä¹ æƒ¯å°±æ˜¯ä½¿ç”¨<code>iota</code>æ ‡ç¤ºç¬¦ï¼Œç®€åŒ–äº†å¸¸é‡ç”¨äºå¢é•¿æ•°å­—çš„å®šä¹‰ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç ä¸­ï¼Œå½“ç¬¬ä¸€è¡Œèµ‹å€¼äº†iotaä¹‹åï¼Œé‚£ä¹ˆç›¸å½“äºåˆå§‹åŒ–ä½ç½®æ˜¯0ï¼Œåé¢çš„ä¾æ¬¡å¢åŠ æ˜¯1ï¼Œ2</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>    CategoryBooks = <span class="hljs-literal">iota</span> <span class="hljs-comment">// 0</span><br>    CategoryHealth       <span class="hljs-comment">// 1</span><br>    CategoryClothing     <span class="hljs-comment">// 2</span><br>)<br></code></pre></td></tr></table></figure>
<p>å¦‚æœå¯¹<code>iota</code>è¿›è¡Œè¿ç®—ï¼Œå…¶å®ç›¸å½“äºæ˜¯é€‰æ‹©å½“å‰çš„è¡Œä½œä¸ºiotaçš„å–å€¼è¿›è¡Œè¿ç®—ï¼Œå¦‚æœä¸­é—´ä¸å¯¹è¿ç®—åŠ ä»¥æ”¹å˜ï¼Œé‚£ä¹ˆä¼šä¸€ç›´æŒç»­æŒ‰ç…§å½“å‰çš„è¿ç®—è§„åˆ™æ‰§è¡Œä¸‹å»</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>	<span class="hljs-comment">//å…³é”®å­— iota</span><br>	<span class="hljs-comment">/* BEIJING=0</span><br><span class="hljs-comment">	SHANGHAI=1</span><br><span class="hljs-comment">	SHENGZHENG=2 */</span><br>	BEIJING = <span class="hljs-number">10</span> * <span class="hljs-literal">iota</span> <span class="hljs-comment">// é»˜è®¤ä¸º0 è¾“å‡º0</span><br>	SHANGHAI  <span class="hljs-comment">//è¾“å‡º10</span><br>	HANGZHOU <span class="hljs-comment">//è¾“å‡º20</span><br>)<br></code></pre></td></tr></table></figure>
<p>åŒæ ·çš„åœ¨åŒä¸€ä¸ªconstä¸­å»å®šä¹‰ä¸åŒçš„
<code>iota</code>çš„è®¡ç®—æ–¹å¼ä¹Ÿå¯ä»¥ï¼Œ<code>iota</code>çš„å–å€¼å°±æ˜¯é€‰æ‹©å½“å‰çš„è¡Œï¼Œä»å“ªä¸ªåœ°æ–¹å¼€å§‹æ”¹å˜ï¼Œé‚£ä¹ˆå°±æ”¹æˆä¸åŒçš„è®¡ç®—æ–¹å¼</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>	<span class="hljs-comment">//è¿™ä¸ªiotaçš„å€¼è¡¨ç¤ºçš„æ˜¯å’Œè¡Œæ•°æœ‰å…³çš„æ•°å€¼ï¼Œå› æ­¤è®¡ç®—çš„æ—¶å€™ç”¨è¡Œæ¥è¡¨ç¤º</span><br>	a, b = <span class="hljs-literal">iota</span> + <span class="hljs-number">1</span>, <span class="hljs-literal">iota</span> + <span class="hljs-number">2</span> <span class="hljs-comment">//æ¯æ¬¡æ–°å¼€ä¸€ä¸ªå…³äºiotaçš„è®¡ç®— é‚£ä¹ˆåç»­å…¨éƒ¨ä¼šè·Ÿç€è¿™ä¸ªè®¡ç®—æ–¹å¼ä¸‹å»</span><br>	c, d<br>	e, f<br>	g, h = <span class="hljs-literal">iota</span> * <span class="hljs-number">2</span>, <span class="hljs-literal">iota</span> * <span class="hljs-number">3</span><br>	<span class="hljs-comment">//iotaåªèƒ½åœ¨constä¹‹ä¸­ä½¿ç”¨</span><br>	i, k<br>)<br></code></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯è¾“å‡ºçš„å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">a= 1 b= 2 c= 2 d= 3 e= 3 f= 4 g= 6 h= 9 i= 8 k= 12<br></code></pre></td></tr></table></figure>
<h3 id="å‡½æ•°">å‡½æ•°</h3>
<h4 id="åŸºæœ¬å‡½æ•°çš„å®šä¹‰">åŸºæœ¬å‡½æ•°çš„å®šä¹‰</h4>
<p>å¤šä¸ªè¿”å›å€¼åˆå§‹åŒ–è®¾ç½®äº†å‡½æ•°çš„å½¢å‚ä¹‹åï¼Œåˆå§‹å€¼æ˜¯0</p>
<p>goæ¯æ¬¡è®¾ç½®ä¸€ä¸ªå˜é‡å€¼ä¹‹åéƒ½æœ‰åˆå§‹å€¼ï¼Œå¦‚æœæ˜¯æ•°æ®å°±æ˜¯0ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²é‚£ä¹ˆå°±æ˜¯ç©ºï¼Œé˜²æ­¢å‡ºç°ä¸€äº›é‡æŒ‡é’ˆçš„æƒ…å†µ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swap</span><span class="hljs-params">(x, y <span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">string</span>) &#123;<br>   <span class="hljs-keyword">return</span> y, x<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   a, b := swap(<span class="hljs-string">&quot;Mahesh&quot;</span>, <span class="hljs-string">&quot;Kumar&quot;</span>)<br>   fmt.Println(a, b)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„ç»“æœæ˜¯</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">Kumar Mahesh<br></code></pre></td></tr></table></figure>
<h4 id="importå’Œinit">importå’Œinit</h4>
<p>æ‰€æœ‰è¢«å¯¼å…¥çš„åŒ…éƒ½åŠ è½½å®Œæ¯•äº†ï¼Œå°±ä¼šå¼€å§‹å¯¹mainåŒ…ä¸­çš„åŒ…çº§å¸¸é‡å’Œå˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰§è¡ŒmainåŒ…ä¸­çš„initå‡½æ•°ï¼Œæœ€åæ‰§è¡Œmainå‡½æ•°ã€‚ä¸‹å›¾è¯¦ç»†åœ°è§£é‡Šäº†æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231202121630297.png"
alt="initçš„è°ƒç”¨é¡ºåº" />
<figcaption aria-hidden="true">initçš„è°ƒç”¨é¡ºåº</figcaption>
</figure>
<p>åˆ†åˆ«å»ºä¸åŒçš„æ–‡ä»¶å¤¹å¯¹åº”çš„å°±æ˜¯packageçš„åå­—ï¼Œç›¸åº”çš„åœ¨.goæ–‡ä»¶å†…éƒ¨å£°æ˜packageçš„åå­—</p>
<p>main å‡½æ•°åªèƒ½åœ¨package mainä¸­</p>
<p><strong>æ³¨æ„ï¼š</strong>
åœ¨åŒ…ä¸­è®¾ç½®æ¥å£çš„æ—¶å€™ï¼Œå‡½æ•°åç§°<strong>å¿…é¡»ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯å¤§å†™ï¼Œå¦‚æœæ˜¯å°å†™çš„è¯å°†æ— æ³•è¯†åˆ«</strong></p>
<ul>
<li>å¦‚æœå‡½æ•°åç¬¬ä¸€ä¸ªæ˜¯å¤§å†™å°±æ˜¯å¯¹å¤–å¼€æ”¾çš„å‡½æ•°ï¼Œè®¤ä¸ºæ˜¯public</li>
<li>å¦‚æœå‡½æ•°åç¬¬ä¸€ä¸ªæ˜¯å°å†™çš„è¯å°±è®¤ä¸ºæ˜¯ç§æœ‰çš„å‡½æ•°ï¼Œè®¤ä¸ºæ˜¯private</li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203140110880.png" alt="æ¥å£å‡½æ•°å¤§å°å†™çš„åŒºåˆ«" style="zoom:67%;" /></p>
<p>initå‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼Œé¦–å…ˆä¼šå¯¹åŒ…ä¸­çš„initè¿›è¡Œåˆå§‹åŒ–å†è¿›è¡Œè°ƒç”¨æ¥å£</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203140412429.png" alt="init()è°ƒç”¨é¡ºåºå’Œè¿‡ç¨‹" style="zoom:67%;" /></p>
<p>å¦‚æœä½ å¯¼å…¥äº†åŒ…æ¯”å¦‚lib1ï¼Œä½†æ˜¯æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªåŒ…é‡Œé¢çš„æ¥å£å‡½æ•°ï¼Œä»ç„¶ä¼šæŠ¥é”™</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203141038750.png" alt="å¯¼å…¥åŒ…ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨æ¥å£å‡½æ•°" style="zoom:67%;" /></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªimportåŒ…çš„ä¾‹å­ï¼Œé¦–å…ˆå®šä¹‰ä¸¤ä¸ªä¸åŒåŒ…ä»¥åŠå¯¹åº”çš„æ¥å£å‡½æ•°å’Œåˆå§‹åŒ–å‡½æ•°çš„å®ç°</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> InitLib1<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br>    fmt.Println(<span class="hljs-string">&quot;lib1&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> InitLib2<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br>    fmt.Println(<span class="hljs-string">&quot;lib2&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;GolangTraining/InitLib1&quot;</span><br>    <span class="hljs-string">&quot;GolangTraining/InitLib2&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br>    fmt.Println(<span class="hljs-string">&quot;libmain init&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    fmt.Println(<span class="hljs-string">&quot;libmian main&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>"GolangTraining/InitLib1""GolangTraining/InitLib2"</code>æ˜¯ä¸¤ä¸ªåŒ…çš„åœ°å€ï¼Œgoä¼šé»˜è®¤ä»GOROOTå’ŒGOPATHä¸¤ä¸ªé»˜è®¤çš„ä½ç½®è¿›è¡Œå¯»æ‰¾ï¼Œé¦–å…ˆè¦ä¿è¯åœ°å€çš„æ­£ç¡®æ€§</p>
<p>ä»£ç çš„è¾“å‡ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">lib1<br>lib2<br>libmain init<br>libmian main<br></code></pre></td></tr></table></figure>
<h4 id="åŒ¿åå¯¼åŒ…æ–¹å¼">åŒ¿åå¯¼åŒ…æ–¹å¼</h4>
<p>å¦‚æœæˆ‘ä¸æƒ³è°ƒç”¨lib1çš„å‡½æ•°æ¥å£ï¼Œä½†æ˜¯æƒ³ä½¿ç”¨lib1çš„init()å‡½æ•°æ€ä¹ˆåŠå‘¢ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ç›´æ¥å¯¼å…¥äº†åŒ…ä½†æ˜¯ä¸è°ƒç”¨æ¥å£ï¼Œå°±ä¼šå‡ºç°ä¸Šè¿°çš„é”™è¯¯</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203141038750.png" alt="å¯¼å…¥åŒ…ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨æ¥å£å‡½æ•°" style="zoom:70%;" /></p>
<p>åœ¨å¯¼å…¥çš„åŒ…å‰é¢åŠ ä¸Šä¸‹åˆ’çº¿æ¥è®¤ä¸ºè¿™ä¸ªåŒ…æ˜¯åŒ¿åçš„ï¼Œè¿™æ ·å°±èƒ½çŸ¥è¿›è¡Œinitæ“ä½œ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span>(<br>			<span class="hljs-string">&quot;fmt&quot;</span><br>			_<span class="hljs-string">&quot;lib2&quot;</span><br>)<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±åªä¼šè°ƒç”¨<code>init()</code>å‡½æ•°åŒæ—¶ä¸ä¼šå‡ºé”™</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203141336299.png"
alt="åªè°ƒç”¨init()å‡½æ•°" />
<figcaption aria-hidden="true">åªè°ƒç”¨init()å‡½æ•°</figcaption>
</figure>
<p>é™¤äº†èƒ½å¤ŸåŒ¿åå¯¼åŒ…ä¹‹å¤–ï¼Œè¿˜èƒ½ç»™æ–°å¯¼å…¥çš„åŒ…èµ·ä¸ªåˆ«çš„åå­—ï¼Œæ¯”å¦‚å«mylibä½œä¸ºæ–°çš„åˆ«å</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203141500041.png" alt="ç»™å¯¼å…¥çš„åŒ…æ¢ä¸ªåå­—" style="zoom:67%;" /></p>
<p>æˆ–è€…ç›´æ¥ä½¿ç”¨<code>Â·</code>æ¥è¿›è¡Œè°ƒç”¨</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203141620428.png" alt="æ¢åˆ«åè¿›è¡Œå¯¼åŒ…" style="zoom:67%;" /></p>
<p>æœ€å¥½åˆ«ä½¿ç”¨è¿™ç§ï¼Œå¦‚æœä¸¤ä¸ªåŒ…çš„å‡½æ•°åç§°ä¸€æ ·é‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´<strong>å‡ºç°æ­§ä¹‰çš„æƒ…å†µ</strong></p>
<h4 id="å‡½æ•°å€¼ä¼ é€’">å‡½æ•°å€¼ä¼ é€’</h4>
<p>å‡½æ•°å¦‚æœä½¿ç”¨å‚æ•°ï¼Œè¯¥å˜é‡å¯ç§°ä¸ºå‡½æ•°çš„å½¢å‚ã€‚</p>
<p><strong>å½¢å‚</strong>å°±åƒå®šä¹‰åœ¨å‡½æ•°ä½“å†…çš„<strong>å±€éƒ¨å˜é‡</strong>ã€‚è°ƒç”¨å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥ä¼ é€’å‚æ•°ï¼š<strong>å€¼ä¼ é€’å’ŒæŒ‡é’ˆä¼ é€’</strong></p>
<p>å€¼ä¼ é€’æ˜¯æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œè¿™æ ·åœ¨å‡½æ•°ä¸­å¦‚æœå¯¹å‚æ•°è¿›è¡Œä¿®æ”¹ï¼Œå°†ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°ã€‚<strong>é»˜è®¤æƒ…å†µä¸‹ï¼ŒGo
è¯­è¨€ä½¿ç”¨çš„æ˜¯å€¼ä¼ é€’</strong>ï¼Œå³åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/* å®šä¹‰ç›¸äº’äº¤æ¢å€¼çš„å‡½æ•° */</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swap</span><span class="hljs-params">(x, y <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>   <span class="hljs-keyword">var</span> temp <span class="hljs-type">int</span><br><br><br>   temp = x <span class="hljs-comment">/* ä¿å­˜ x çš„å€¼ */</span><br>   x = y    <span class="hljs-comment">/* å°† y å€¼èµ‹ç»™ x */</span><br>   y = temp <span class="hljs-comment">/* å°† temp å€¼èµ‹ç»™ y*/</span><br><br><br>   <span class="hljs-keyword">return</span> temp;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å€¼ä¼ é€’æ¥è°ƒç”¨ swap() å‡½æ•°ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   <span class="hljs-comment">/* å®šä¹‰å±€éƒ¨å˜é‡ */</span><br>   <span class="hljs-keyword">var</span> a <span class="hljs-type">int</span> = <span class="hljs-number">100</span><br>   <span class="hljs-keyword">var</span> b <span class="hljs-type">int</span> = <span class="hljs-number">200</span><br><br><br>   fmt.Printf(<span class="hljs-string">&quot;äº¤æ¢å‰ a çš„å€¼ä¸º : %d\n&quot;</span>, a )<br>   fmt.Printf(<span class="hljs-string">&quot;äº¤æ¢å‰ b çš„å€¼ä¸º : %d\n&quot;</span>, b )<br><br><br>   <span class="hljs-comment">/* é€šè¿‡è°ƒç”¨å‡½æ•°æ¥äº¤æ¢å€¼ */</span><br>   swap(a, b)<br><br><br>   fmt.Printf(<span class="hljs-string">&quot;äº¤æ¢å a çš„å€¼ : %d\n&quot;</span>, a )<br>   fmt.Printf(<span class="hljs-string">&quot;äº¤æ¢å b çš„å€¼ : %d\n&quot;</span>, b )<br>&#125;<br><br><br><span class="hljs-comment">/* å®šä¹‰ç›¸äº’äº¤æ¢å€¼çš„å‡½æ•° */</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swap</span><span class="hljs-params">(x, y <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>   <span class="hljs-keyword">var</span> temp <span class="hljs-type">int</span><br><br><br>   temp = x <span class="hljs-comment">/* ä¿å­˜ x çš„å€¼ */</span><br>   x = y    <span class="hljs-comment">/* å°† y å€¼èµ‹ç»™ x */</span><br>   y = temp <span class="hljs-comment">/* å°† temp å€¼èµ‹ç»™ y*/</span><br><br><br>   <span class="hljs-keyword">return</span> temp;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œçš„ç»“æœä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">äº¤æ¢å‰ a çš„å€¼ä¸º : 100<br>äº¤æ¢å‰ b çš„å€¼ä¸º : 200<br>äº¤æ¢å a çš„å€¼ : 100<br>äº¤æ¢å b çš„å€¼ : 200<br></code></pre></td></tr></table></figure>
<h3 id="goæŒ‡é’ˆ">GOæŒ‡é’ˆ</h3>
<p>å’ŒC++ä»¥åŠCä¸­çš„æ˜¯ä¸€æ ·çš„ï¼Œå¯¹goä¸­çš„æŒ‡é’ˆå®šä¹‰çš„æ—¶å€™ *int
ä¼ é€’å˜é‡çš„åœ°å€&amp;</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203171319969.png" alt="æŒ‡é’ˆå’Œå¼•ç”¨çš„ä¼ é€’ä¾‹å­" style="zoom:67%;" /></p>
<p>åœ¨å¯¹ä¸€ä¸ªæŒ‡é’ˆèµ‹å€¼çš„æ—¶å€™ï¼Œä¼ é€’çš„æ˜¯æŸä¸€ä¸ªå˜é‡çš„åœ°å€ï¼Œå°±æ˜¯ä¼ é€’è¿™ä¸ªå˜é‡çš„å¼•ç”¨ï¼Œå¼•ç”¨ä¼ é€’æ˜¯æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°çš„åœ°å€ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å½±å“åˆ°å®é™…å‚æ•°ã€‚</p>
<h3 id="defer">defer</h3>
<p>deferè¯­å¥è¢«ç”¨äºé¢„å®šå¯¹ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ã€‚å¯ä»¥æŠŠè¿™ç±»è¢«deferè¯­å¥è°ƒç”¨çš„å‡½æ•°ç§°ä¸º<strong>å»¶è¿Ÿå‡½æ•°</strong>ï¼Œä¸»è¦ä½œç”¨ï¼š</p>
<ul>
<li>é‡Šæ”¾å ç”¨çš„èµ„æº</li>
<li>æ•æ‰å¤„ç†å¼‚å¸¸</li>
<li>è¾“å‡ºæ—¥å¿—</li>
</ul>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°ä¸­æœ‰å¤šä¸ªdeferè¯­å¥ï¼Œå®ƒä»¬ä¼šä»¥<strong>LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰</strong>çš„é¡ºåºæ‰§è¡Œã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Demo</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;1&quot;</span>)<br>	<span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;2&quot;</span>)<br>	<span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;3&quot;</span>)<br>	<span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;4&quot;</span>)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	Demo()<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">4<br>3<br>2<br>1<br></code></pre></td></tr></table></figure>
<h3 id="æ•°ç»„ä¸åˆ‡ç‰‡">æ•°ç»„ä¸åˆ‡ç‰‡</h3>
<p>Go è¯­è¨€åˆ‡ç‰‡ <code>slice</code> æ˜¯å¯¹æ•°ç»„çš„æŠ½è±¡</p>
<h4 id="é™æ€æ•°ç»„">é™æ€æ•°ç»„</h4>
<p>é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œåˆå§‹åŒ–æ•°ç»„ä»¥åŠè¿›è¡Œåˆ‡ç‰‡æ“ä½œï¼Œé€šè¿‡rangeå…³é”®å­—è¿›è¡Œéå†æ•°ç»„ï¼Œå¹¶ç»™å‡ºindexå’Œvalueè¿›è¡Œç»™å‡ºä¸åŒçš„ä¸‹æ ‡å’Œæ•°å€¼</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203174817927.png" alt="åˆå§‹åŒ–æ•°ç»„å¹¶è¿›è¡Œåˆ‡ç‰‡æ“ä½œ" style="zoom:67%;" /></p>
<p>å›ºå®šæ•°ç»„ä¼ é€’çš„æ˜¯ä¸€ä¸ªå€¼æ‹·è´</p>
<h4 id="åŠ¨æ€æ•°ç»„-slice"><strong>åŠ¨æ€æ•°ç»„ slice</strong></h4>
<p>åˆ‡ç‰‡ä¸éœ€è¦è¯´æ˜é•¿åº¦</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/*</span><br><span class="hljs-comment">		å£°æ˜åˆ‡ç‰‡ä¹‹åçš„é•¿åº¦æ˜¯3ï¼ŒåŒæ—¶åˆå§‹åŒ–çš„å€¼æ˜¯1ï¼Œ2ï¼Œ3</span><br><span class="hljs-comment">	*/</span><br>slice1 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br>s := arr[:]<br><span class="hljs-comment">//ä½†æ˜¯è¿™ä¸ªæ—¶å€™å°±åªä¼šé‡æ–°èµ‹äºˆç©ºé—´å¹¶å¤åˆ¶0</span><br>slice1 = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">4</span>)<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">		å£°æ˜sliceæ˜¯åˆ‡ç‰‡,ä½†æ˜¯æ²¡æœ‰åˆ†é…ç©ºé—´</span><br><span class="hljs-comment">	*/</span><br><span class="hljs-keyword">var</span> slice2 []<span class="hljs-type">int</span><br></code></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥æŒ‡å®šå®¹é‡ï¼Œå…¶ä¸­<code>capacity</code>ä¸ºå¯é€‰å‚æ•°ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span>([]T, length, capacity)<br></code></pre></td></tr></table></figure>
<p>å°†arrä¸­ä»ä¸‹æ ‡startIndexåˆ°<strong>endIndex-1</strong>
ä¸‹çš„å…ƒç´ åˆ›å»ºä¸ºä¸€ä¸ªæ–°çš„åˆ‡ç‰‡</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">s := arr[startIndex:endIndex]<br></code></pre></td></tr></table></figure>
<p>ç¼ºçœendIndexæ—¶å°†è¡¨ç¤ºä¸€ç›´åˆ°arrçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç¼ºçœstartIndexæ—¶å°†è¡¨ç¤ºä»arrçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">s := arr[startIndex:]<br>s := arr[:endIndex]<br></code></pre></td></tr></table></figure>
<p>é€šè¿‡åˆ‡ç‰‡såˆå§‹åŒ–åˆ‡ç‰‡s1</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">s1 := s[startIndex:endIndex]<br></code></pre></td></tr></table></figure>
<p>é€šè¿‡å†…ç½®å‡½æ•° <code>make()</code>åˆå§‹åŒ–åˆ‡ç‰‡s,<code>[]int</code>
æ ‡è¯†ä¸ºå…¶å…ƒç´ ç±»å‹ä¸ºintçš„åˆ‡ç‰‡</p>
<p>åŒæ—¶åŠ¨æ€æ•°ç»„ä¼ é€’çš„è¿‡ç¨‹ä¸­çš„å‚æ•°å½¢å¼æ˜¯ä¸€è‡´çš„ï¼Œèƒ½å¤Ÿé€‚é…æ‰€æœ‰çš„sliceå‚æ•°ç±»å‹ï¼Œä½†æ˜¯å¯¹äº</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203205827787.png" alt="åŠ¨æ€æ•°ç»„ä¼ é€’å¼•ç”¨åŒæ—¶ä¸ä¼šå› ä¸ºé•¿åº¦ä¸ä¸€æ ·è€Œæ”¹å˜å½¢å‚" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203205839072.png" alt="åŠ¨æ€æ•°ç»„çš„åˆå§‹åŒ–å’Œæ‰“å°" style="zoom:67%;" /></p>
<p>è¿™é‡Œé¢çš„ä¸‹åˆ’çº¿è¡¨ç¤ºçš„æ˜¯<strong>ä¸éœ€è¦è€ƒè™‘</strong>çš„indexçš„æ•°å€¼ï¼Œå¯ä»¥å¿½ç•¥ï¼Œè¿™é‡Œæ˜¯å…³äºåˆ‡ç‰‡sliceçš„å£°æ˜å’Œæ‰“å°</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">	<span class="hljs-comment">//å£°æ˜åˆ‡ç‰‡ä¹‹åçš„é•¿åº¦æ˜¯3ï¼ŒåŒæ—¶åˆå§‹åŒ–çš„å€¼æ˜¯1ï¼Œ2ï¼Œ3</span><br>	slice1 :=[]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;<br>	<span class="hljs-comment">//%vè¡¨ç¤ºçš„æ˜¯æ‰“å°å‡ºå…¨éƒ¨çš„è¡¨ç¤ºä¿¡æ¯</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice1),slice1)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‰“å°çš„ç»“æœæ˜¯</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203210558440.png" alt="è¾“å‡ºçš„ç»“æœ" style="zoom:67%;" /></p>
<p>å£°æ˜sliceä½†æ˜¯ä¸ä¸€å®šå£°æ˜äº†ç©ºé—´ï¼Œå› æ­¤éœ€è¦æ³¨æ„çš„æ˜¯å£°æ˜çš„åŒæ—¶å¹¶ç»™å‡ºç©ºé—´å¤§å°ï¼ŒåŒæ—¶æ²¡åŠæ³•ä¸­é€”å¢åŠ ç©ºé—´</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span>  <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-comment">/* </span><br><span class="hljs-comment">	å£°æ˜åˆ‡ç‰‡ä¹‹åçš„é•¿åº¦æ˜¯3ï¼ŒåŒæ—¶åˆå§‹åŒ–çš„å€¼æ˜¯1ï¼Œ2ï¼Œ3</span><br><span class="hljs-comment">	 */</span><br>	slice1 :=[]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;<br>	<span class="hljs-comment">//%vè¡¨ç¤ºçš„æ˜¯æ‰“å°å‡ºå…¨éƒ¨çš„è¡¨ç¤ºä¿¡æ¯</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice1),slice1)<br>	<span class="hljs-comment">//ç›´æ¥å¯¹æ²¡æœ‰èµ‹äºˆç©ºé—´çš„ä½ç½®ä¿®æ”¹ä¼šå‡ºç°ä½ç½®è¶Šç•Œ</span><br>	<span class="hljs-comment">//slice1[3]=999</span><br>	slice1 = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-number">4</span>)<br>	<span class="hljs-comment">//ä½†æ˜¯è¿™ä¸ªæ—¶å€™å°±åªä¼šé‡æ–°èµ‹äºˆç©ºé—´å¹¶å¤åˆ¶0</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice1),slice1)<br>	<span class="hljs-comment">/* </span><br><span class="hljs-comment">	å£°æ˜sliceæ˜¯åˆ‡ç‰‡,ä½†æ˜¯æ²¡æœ‰åˆ†é…ç©ºé—´</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-keyword">var</span> slice2 []<span class="hljs-type">int</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice2),slice2)<br>	<span class="hljs-comment">//slice2[0]=2 //ç›´æ¥èµ‹äºˆæ•°å€¼ä¼šå‡ºç°é”™è¯¯ï¼Œè¶Šç•Œ</span><br>	slice2 = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-number">3</span>)<br>	<span class="hljs-comment">//å¼€è¾Ÿç©ºé—´ï¼Œä½†æ˜¯é»˜è®¤å€¼éƒ½æ˜¯0</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice2),slice2)<br>	slice2[<span class="hljs-number">0</span>]=<span class="hljs-number">1000</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice2),slice2)<br>	<span class="hljs-comment">//æ­¤æ—¶å°±ä¿®æ”¹æˆåŠŸ</span><br>	<span class="hljs-comment">/*  </span><br><span class="hljs-comment">	å£°æ˜sliceç±»å‹ï¼ŒåŒæ—¶åˆ†é…ç©ºé—´</span><br><span class="hljs-comment">	*/</span><br>	<span class="hljs-keyword">var</span> slice3 =<span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-number">5</span>)<br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice3),slice3)<br><br><br></code></pre></td></tr></table></figure>
<p>åˆ¤æ–­ä¸€ä¸ªåˆ‡ç‰‡æ˜¯ä¸æ˜¯ç©ºçš„</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">	<span class="hljs-comment">/* </span><br><span class="hljs-comment">	åˆ¤æ–­ä¸€ä¸ªsliceåˆ‡ç‰‡æ˜¯ä¸æ˜¯ä¸º0</span><br><span class="hljs-comment">	*/</span><br>	<span class="hljs-keyword">if</span> slice1 == <span class="hljs-literal">nil</span>&#123;<br>		fmt.Println(<span class="hljs-string">&quot;slice1 is null&quot;</span>)<br>	&#125;<span class="hljs-keyword">else</span>&#123;<br>		fmt.Println(<span class="hljs-string">&quot;slice1 is not null&quot;</span>)<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„if-elseçš„æ ¼å¼æœ‰è¦æ±‚ï¼Œ<code>&#123;</code>å¿…é¡»æ˜¯å‡ºç°åœ¨elseå’Œifç´§æ¥ç€çš„ä½ç½®ï¼Œä¸èƒ½æ¢è¡Œå†™</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203211744713.png" alt="åˆ¤æ–­å½“å‰çš„åŠ¨æ€æ•°ç»„æ˜¯ä¸æ˜¯ç©ºçš„" style="zoom:67%;" /></p>
<h4 id="appendå’Œcopy">append()å’Œcopy()</h4>
<p>å¦‚æœæƒ³å¢åŠ åˆ‡ç‰‡çš„å®¹é‡ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„æ›´å¤§çš„åˆ‡ç‰‡å¹¶æŠŠåŸåˆ†ç‰‡çš„å†…å®¹éƒ½æ‹·è´è¿‡æ¥</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231203213134825.png" alt="è¿½åŠ å…ƒç´ çš„æ“ä½œæ˜¾ç¤º" style="zoom:67%;" /></p>
<p><strong>æ³¨æ„ï¼Œå¦‚æœappendè¶…è¿‡äº†å½“å‰çš„ç©ºé—´ï¼Œé‚£ä¹ˆsliceå°±ä¼šç»§ç»­å¢åŠ ç©ºé—´ï¼Œå¢åŠ çš„å¤§å°æ˜¯capçš„å¤§å°å¢åŠ </strong></p>
<p>æ‹·è´copy()æ“ä½œ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/* åˆ›å»ºåˆ‡ç‰‡ numbers1 æ˜¯ä¹‹å‰åˆ‡ç‰‡çš„ä¸¤å€å®¹é‡*/</span><br>   numbers1 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-built_in">len</span>(numbers), (<span class="hljs-built_in">cap</span>(numbers))*<span class="hljs-number">2</span>)<br><br><br>   <span class="hljs-comment">/* æ‹·è´ numbers çš„å†…å®¹åˆ° numbers1 */</span><br>   <span class="hljs-built_in">copy</span>(numbers1,numbers)<br>   printSlice(numbers1)  <br></code></pre></td></tr></table></figure>
<p>å…³äºåˆ‡ç‰‡çš„æˆªå–æ“ä½œ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/* </span><br><span class="hljs-comment">	åˆ‡ç‰‡çš„æˆªå– </span><br><span class="hljs-comment">	*/</span><br>	<span class="hljs-keyword">var</span> slice6 = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-number">3</span>)<br>	slice6[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span><br>	slice6[<span class="hljs-number">2</span>]=<span class="hljs-number">33</span><br>	fmt.Printf(<span class="hljs-string">&quot;len = %d, cap = %d, slice =%v\n&quot;</span>, <span class="hljs-built_in">len</span>(slice6), <span class="hljs-built_in">cap</span>(slice6), slice6)<br>	<span class="hljs-comment">//æˆªå–çš„è¿‡ç¨‹ä¸­æ˜¯å·¦é—­å³å¼€</span><br>	s1:=slice6[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>]<br>	<span class="hljs-comment">// s1:=slice6[:]//è¡¨ç¤ºæˆªå–å…¨éƒ¨</span><br>	fmt.Println(s1)<br>	<span class="hljs-comment">//æ³¨æ„æ­¤æ—¶çš„s1çš„åœ°å€å’Œslice6çš„ä½ç½®ä¸€æ ·äº†</span><br><br>	<span class="hljs-comment">//copy</span><br>	<span class="hljs-keyword">var</span> s2 = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-number">3</span>)<br>	<span class="hljs-built_in">copy</span>(s2,slice6)<br>	fmt.Println(s2)<span class="hljs-comment">// åªä¼šä»å¤´å¼€å§‹æˆªå–s2é•¿åº¦çš„ï¼Œå¦‚æœé•¿äº†é‚£ä¹ˆå°±æ˜¯0ï¼Œ</span><br>	<span class="hljs-comment">//å¦åˆ™å°±æ˜¯é€‰æ‹©slice6ä¸­ç›¸åŒé•¿åº¦çš„å…ƒç´ ï¼Œä»å·¦åˆ°å³è¾¹</span><br></code></pre></td></tr></table></figure>
<h3 id="map">map</h3>
<p>mapå’Œsliceç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯æ•°æ®ç»“æ„ä¸åŒï¼Œä¸‹é¢æ˜¯mapçš„ä¸€äº›å£°æ˜æ–¹å¼ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//ç¬¬ä¸€ç§å£°æ˜</span><br>    <span class="hljs-keyword">var</span> test1 <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span><br>    <span class="hljs-comment">//åœ¨ä½¿ç”¨mapå‰ï¼Œéœ€è¦å…ˆmakeï¼Œmakeçš„ä½œç”¨å°±æ˜¯ç»™mapåˆ†é…æ•°æ®ç©ºé—´</span><br>    test1 = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, <span class="hljs-number">10</span>) <br>    test1[<span class="hljs-string">&quot;one&quot;</span>] = <span class="hljs-string">&quot;php&quot;</span><br>    test1[<span class="hljs-string">&quot;two&quot;</span>] = <span class="hljs-string">&quot;golang&quot;</span><br>    test1[<span class="hljs-string">&quot;three&quot;</span>] = <span class="hljs-string">&quot;java&quot;</span><br>    fmt.Println(test1) <span class="hljs-comment">//map[two:golang three:java one:php]</span><br><br><br>    <span class="hljs-comment">//ç¬¬äºŒç§å£°æ˜</span><br>    test2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)<br>    test2[<span class="hljs-string">&quot;one&quot;</span>] = <span class="hljs-string">&quot;php&quot;</span><br>    test2[<span class="hljs-string">&quot;two&quot;</span>] = <span class="hljs-string">&quot;golang&quot;</span><br>    test2[<span class="hljs-string">&quot;three&quot;</span>] = <span class="hljs-string">&quot;java&quot;</span><br>    fmt.Println(test2) <span class="hljs-comment">//map[one:php two:golang three:java]</span><br><br>    <span class="hljs-comment">//ç¬¬ä¸‰ç§å£°æ˜</span><br>    test3 := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>&#123;<br>        <span class="hljs-string">&quot;one&quot;</span> : <span class="hljs-string">&quot;php&quot;</span>,<br>        <span class="hljs-string">&quot;two&quot;</span> : <span class="hljs-string">&quot;golang&quot;</span>,<br>        <span class="hljs-string">&quot;three&quot;</span> : <span class="hljs-string">&quot;java&quot;</span>,<br>    &#125;<br>    fmt.Println(test3) <span class="hljs-comment">//map[one:php two:golang three:java]</span><br><br><br>    <br>    language := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)<br>    language[<span class="hljs-string">&quot;php&quot;</span>] = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, <span class="hljs-number">2</span>)<br>    language[<span class="hljs-string">&quot;php&quot;</span>][<span class="hljs-string">&quot;id&quot;</span>] = <span class="hljs-string">&quot;1&quot;</span><br>    language[<span class="hljs-string">&quot;php&quot;</span>][<span class="hljs-string">&quot;desc&quot;</span>] = <span class="hljs-string">&quot;phpæ˜¯ä¸–ç•Œä¸Šæœ€ç¾çš„è¯­è¨€&quot;</span><br>    language[<span class="hljs-string">&quot;golang&quot;</span>] = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, <span class="hljs-number">2</span>)<br>    language[<span class="hljs-string">&quot;golang&quot;</span>][<span class="hljs-string">&quot;id&quot;</span>] = <span class="hljs-string">&quot;2&quot;</span><br>    language[<span class="hljs-string">&quot;golang&quot;</span>][<span class="hljs-string">&quot;desc&quot;</span>] = <span class="hljs-string">&quot;golangæŠ—å¹¶å‘éå¸¸good&quot;</span><br>    <br>    fmt.Println(language) <span class="hljs-comment">//map[php:map[id:1 desc:phpæ˜¯ä¸–ç•Œä¸Šæœ€ç¾çš„è¯­è¨€] golang:map[id:2 desc:golangæŠ—å¹¶å‘éå¸¸good]]</span><br><br><br>    <span class="hljs-comment">//å¢åˆ æ”¹æŸ¥</span><br>    <span class="hljs-comment">// val, key := language[&quot;php&quot;]  //æŸ¥æ‰¾æ˜¯å¦æœ‰phpè¿™ä¸ªå­å…ƒç´ </span><br>    <span class="hljs-comment">// if key &#123;</span><br>    <span class="hljs-comment">//     fmt.Printf(&quot;%v&quot;, val)</span><br>    <span class="hljs-comment">// &#125; else &#123;</span><br>    <span class="hljs-comment">//     fmt.Printf(&quot;no&quot;);</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">//language[&quot;php&quot;][&quot;id&quot;] = &quot;3&quot; //ä¿®æ”¹äº†phpå­å…ƒç´ çš„idå€¼</span><br>    <span class="hljs-comment">//language[&quot;php&quot;][&quot;nickname&quot;] = &quot;å•ªå•ªå•ª&quot; //å¢åŠ phpå…ƒç´ é‡Œçš„nicknameå€¼</span><br>    <span class="hljs-comment">//delete(language, &quot;php&quot;)  //åˆ é™¤äº†phpå­å…ƒç´ </span><br>    fmt.Println(language)<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="é¢å‘å¯¹è±¡ç»“æ„ä½“">é¢å‘å¯¹è±¡ç»“æ„ä½“</h3>
<h4 id="å®šä¹‰ä¸€ä¸ªç»“æ„ä½“">å®šä¹‰ä¸€ä¸ªç»“æ„ä½“</h4>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªç»“æ„ä½“</span><br><span class="hljs-keyword">type</span> T <span class="hljs-keyword">struct</span> &#123;<br>    name <span class="hljs-type">string</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>åˆ†åˆ«å®šä¹‰ä¸åŒçš„æ‹·è´å’Œå¼•ç”¨çš„å‡½æ•°</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(t T)</span></span> method1() &#123;<br>    t.name = <span class="hljs-string">&quot;new name1&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(t *T)</span></span> method2() &#123;<br>    t.name = <span class="hljs-string">&quot;new name2&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç»“æœæ˜¯ä½¿ç”¨å€¼æ‹·è´çš„è¾“å‡ºçš„nameæ²¡æœ‰æ”¹å˜ï¼Œåªæœ‰ä½¿ç”¨å¼•ç”¨çš„æ‰å‘ç”Ÿäº†æ”¹å˜</p>
<p>å…³äºç»“æ„ä½“å®šä¹‰çš„ç»†èŠ‚ï¼Œå†…éƒ¨çš„æˆå‘˜å˜é‡å’Œç»“æ„ä½“æœ¬èº«çš„å¤§å°å†™å°±æ˜¯è•´å«äº†æ˜¯ä¸æ˜¯ç§æœ‰å’Œå…¬æœ‰çš„å…³ç³»ï¼Œå¤§å†™æ ‡è¯†å…¬æœ‰ï¼Œå°å†™è¡¨ç¤ºç§æœ‰</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å¦‚æœè¿™ä¸ªç±»å¦‚æœæ˜¯å¤§å†™ï¼Œé‚£ä¹ˆå…¶ä»–çš„Packageä¹Ÿèƒ½å¤Ÿè®¿é—®</span><br><span class="hljs-keyword">type</span> Human <span class="hljs-keyword">struct</span> &#123;<br>	Name <span class="hljs-type">string</span> <span class="hljs-comment">//å…¶ä¸­å˜é‡åç§°è¡¨ç¤ºå¤§å†™è¯´æ˜æ˜¯èƒ½å¤Ÿå¯¹å¤–ç•Œå¯è§çš„public</span><br>	Age  <span class="hljs-type">int</span><br>	<span class="hljs-comment">//å¦‚æœæ˜¯å°å†™é‚£ä¹ˆå°±æ˜¯privateçš„å±æ€§</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>å¯¹äºç»“æ„ä½“å†…éƒ¨çš„æˆå‘˜å‡½æ•°ï¼Œå¿…é¡»æ˜¯ä¼ é€’äº†å¼•ç”¨çš„åœ°å€æ‰èƒ½å¤Ÿä¿®æ”¹ï¼Œå¦åˆ™å°±æ˜¯é»˜è®¤çš„å€¼ä¼ é€’</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Human)</span></span> GetName() &#123;<br>	fmt.Println(this.Name)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Human)</span></span> SetName(newname <span class="hljs-type">string</span>) &#123;<br>	<span class="hljs-comment">//åªæœ‰æ˜¯å¼•ç”¨åœ°å€çš„ä¼ é€’çš„æ—¶å€™æ‰æ˜¯èƒ½å¤Ÿä¿®æ”¹çš„</span><br>	this.Name = newname<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this Human)</span></span> SetName1(newname <span class="hljs-type">string</span>) &#123;<br>	<span class="hljs-comment">//é»˜è®¤æ˜¯å€¼ä¼ é€’</span><br>	this.Name = newname<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="ç±»çš„ç»§æ‰¿æ€§">ç±»çš„ç»§æ‰¿æ€§</h4>
<p>å¦‚æœæ–°å®šä¹‰çš„ç±»ç»§æ‰¿äº†æŸä¸ªç±»ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨å†…éƒ¨å†™ä¸Šæ‰€ç»§æ‰¿çš„ç±»çš„åç§°ï¼ŒåŒæ—¶è¿™é‡Œæ²¡æœ‰C++ä¸­çš„å…¬æœ‰ä¿æŠ¤ç­‰å…¶ä»–ç±»å‹çš„ç»§æ‰¿ï¼Œå…¬æœ‰ç§æœ‰çš„è®¾å®šä¿æŒä¸€è‡´</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Superman <span class="hljs-keyword">struct</span> &#123;<br>	Human <span class="hljs-comment">//è¡¨ç¤ºSupermanç»§æ‰¿äº†Humanï¼ŒåŒæ—¶è¿™é‡Œæ²¡æœ‰C++ä¸­çš„å…¬æœ‰ä¿æŠ¤ç­‰å…¶ä»–ç±»å‹çš„ç»§æ‰¿</span><br>	<span class="hljs-comment">//åœ¨å­ç±»ä¸­é‡æ–°å¢åŠ å˜é‡</span><br>	Level <span class="hljs-type">int</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>å¯¹ç»§æ‰¿ç±»ä¸­çš„æ–¹æ³•é‡å†™ï¼ŒåŒæ ·ä¼ é€’çš„è¿˜æ˜¯å¼•ç”¨å’ŒæŒ‡é’ˆ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å¯¹äºçˆ¶ç±»æ–¹æ³•è¿›è¡Œé‡å†™</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Superman)</span></span> GetName() &#123;<br>	fmt.Println(this.Name)<br>	fmt.Println(this.Level)<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>é‡æ–°å®šä¹‰æ–°çš„æ–¹æ³•</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å­ç±»ä¸­çš„æ–°æ–¹æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Superman)</span></span> LevelUp() &#123;<br>	fmt.Println(<span class="hljs-string">&quot;level up&quot;</span>)<br>	this.Level = this.Level + <span class="hljs-number">1</span><br>	fmt.Println(this)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å…³äºä¸»å‡½æ•°ä¸­çš„è°ƒç”¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	human := Human&#123;Name: <span class="hljs-string">&quot;zhang&quot;</span>, Age: <span class="hljs-number">99</span>&#125;<br>	human.SetName1(<span class="hljs-string">&quot;li&quot;</span>)<br>	fmt.Println(human) <span class="hljs-comment">//&#123;zhang 99&#125;</span><br>	human.SetName(<span class="hljs-string">&quot;li&quot;</span>)<br>	fmt.Println(human) <span class="hljs-comment">//&#123;li 99&#125;</span><br>	human.GetName()<br>	fmt.Println(<span class="hljs-string">&quot;-------------&quot;</span>)<br>	superman := Superman&#123;Human&#123;<span class="hljs-string">&quot;li4&quot;</span>, <span class="hljs-number">18</span>&#125;, <span class="hljs-number">99</span>&#125;<br>	<span class="hljs-comment">//çˆ¶ç±»æ–¹æ³•çš„é‡å†™</span><br>	superman.GetName()<br>	<span class="hljs-comment">//å­ç±»æ–°æ–¹æ³•</span><br>	superman.LevelUp()<br>	<span class="hljs-comment">/* level up</span><br><span class="hljs-comment">	&amp;&#123;&#123;li4 18&#125; 100&#125;	 */</span><br>	<span class="hljs-comment">//çˆ¶ç±»æ–¹æ³•åŸå°ä¸åŠ¨</span><br>	superman.SetName(<span class="hljs-string">&quot;wang5&quot;</span>)<br>	fmt.Println(superman) <span class="hljs-comment">//&#123;&#123;wang5 18&#125; 100&#125;</span><br><br>	fmt.Println(<span class="hljs-string">&quot;+++++++++++++&quot;</span>)<br>	<span class="hljs-comment">//ç¬¬äºŒç§ç»§æ‰¿ç±»å¯¹è±¡çš„å£°æ˜</span><br>	<span class="hljs-keyword">var</span> super Superman<br>	super.Name = <span class="hljs-string">&quot;zhangmazi&quot;</span><br>	super.Level = <span class="hljs-number">100</span><br>	super.Age = <span class="hljs-number">19</span><br>	fmt.Println(super)<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="interfaceä¸ç±»å‹æ–­è¨€">Interfaceä¸ç±»å‹æ–­è¨€</h3>
<p>åœ¨ç»§æ‰¿å’Œå¤šæ€ä¸Šï¼Œä¸€ç³»åˆ—å®¶æ—å®šä¹‰çš„æ¥å£ï¼Œ<strong>æ¯ä¸ªå­ç±»èƒ½å¤Ÿé‡å†™æ–¹æ³•</strong>ï¼Œå®ç°åŒä¸€ä¸ªæ–¹æ³•æœ‰å¤šä¸ªæ¥å£è¡¨ç°å½¢å¼</p>
<h4 id="ç±»çš„å¤šæ€æ€§">ç±»çš„å¤šæ€æ€§</h4>
<p>æœ¬è´¨ä¸Šåˆ©ç”¨interfaceæ¥å®ç°ç±»çš„å¤šæ€æ€§</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// æœ¬è´¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¤šæ€</span><br><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">interface</span> &#123;<br>	<span class="hljs-comment">//ç»™å‡ºæ¥å£åŒ…å«çš„å¤šæ€çš„å‡½æ•°</span><br>	Sleep()<br>	GetColor() <span class="hljs-type">string</span><br>	GetType() <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå…·ä½“çš„ç±»</span><br><span class="hljs-keyword">type</span> Cat <span class="hljs-keyword">struct</span> &#123;<br>	<span class="hljs-comment">/*å¦‚æœç»§æ‰¿ä¸€ä¸ªæ¥å£interface é‚£ä¹ˆå°±ä¸éœ€è¦ç›´æ¥å†™å‡ºæ¥ç»§æ‰¿ï¼Œ</span><br><span class="hljs-comment">	åªéœ€è¦è¿›è¡Œå®ç°å°±å¯ä»¥è®¤ä¸ºç»§æ‰¿äº†è¿™ä¸ªæ¥å£inerface</span><br><span class="hljs-comment">	*/</span><br>	color <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-comment">// ç¬¬äºŒä¸ªå¤šæ€çš„ç±»</span><br><span class="hljs-keyword">type</span> Dog <span class="hljs-keyword">struct</span> &#123;<br>	<span class="hljs-comment">//åŒæ ·éœ€è¦è¿›è¡Œç»§æ‰¿è¿™ä¸ªinterface</span><br>	color <span class="hljs-type">string</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>é‚£æ€ä¹ˆè®¤ä¸ºè¿™ä¸ªcatç»§æ‰¿äº†è¿™ä¸ªanimalç±»å‘¢ï¼Ÿåªéœ€è¦å¯¹animalä¸­çš„æ‰€æœ‰å‡½æ•°é‡å†™å³å¯è®¤ä¸ºæ˜¯ç»§æ‰¿äº†</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/* å¿…é¡»è¦å®Œå…¨é‡å†™æ‰€æœ‰çš„æ¥å£æ‰èƒ½è®¤ä¸ºæ˜¯å¤šæ€æ»¡è¶³ */</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Cat)</span></span> Sleep() &#123;<br>	fmt.Println(<span class="hljs-string">&quot;cat sleep...&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Cat)</span></span> GetColor() <span class="hljs-type">string</span> &#123;<br>	fmt.Printf(<span class="hljs-string">&quot;the cat color is %v\n&quot;</span>, this.color)<br>	<span class="hljs-keyword">return</span> this.color<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Cat)</span></span> GetType() <span class="hljs-type">string</span> &#123;<br>	fmt.Printf(<span class="hljs-string">&quot;the type is cat\n&quot;</span>)<br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Cat&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>åŒç†å¯¹äºdogä¹Ÿæ˜¯ä¸€æ ·</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Dog)</span></span> Sleep() &#123;<br>	fmt.Println(<span class="hljs-string">&quot;dog sleep...&quot;</span>)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Dog)</span></span> GetColor() <span class="hljs-type">string</span> &#123;<br>	fmt.Printf(<span class="hljs-string">&quot;the dog color is %v\n&quot;</span>, this.color)<br>	<span class="hljs-keyword">return</span> this.color<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *Dog)</span></span> GetType() <span class="hljs-type">string</span> &#123;<br>	fmt.Printf(<span class="hljs-string">&quot;the type is dog\n&quot;</span>)<br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Dog&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä¸»å‡½æ•°ä¸­å¦‚ä½•å®ç°ä¸åŒçš„å¤šæ€è°ƒç”¨å‘¢ï¼Ÿæ³¨æ„å“¦ï¼Œè¿™ä¸ªåœ°æ–¹ä¼ é€’çš„æ˜¯ç»§æ‰¿ç±»çš„å¼•ç”¨è¿›å»æ¥å®ç°å¤šæ€</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">showanimal</span><span class="hljs-params">(animal Animal)</span></span> &#123;<br>	animal.Sleep()<br>	<span class="hljs-comment">// fmt.Println(&quot;color = &quot;,animal.GetColor())</span><br>	<span class="hljs-comment">// fmt.Println(&quot;type = &quot;,animal.GetType())</span><br>	animal.GetType()<br>	animal.GetColor()<br>&#125;<br><br><br>	cat := Cat&#123;<span class="hljs-string">&quot;Green&quot;</span>&#125;<br>	dog := Dog&#123;<span class="hljs-string">&quot;Yellow&quot;</span>&#125;<br><br>	<span class="hljs-comment">//é€šè¿‡ä¼ é€’æŒ‡é’ˆå’Œå¼•ç”¨æ¥å®ç°å¤šæ€æ€§</span><br>	showanimal(&amp;cat)<br>	showanimal(&amp;dog)<br></code></pre></td></tr></table></figure>
<h4 id="ä¸‡èƒ½ç±»å‹interface">ä¸‡èƒ½ç±»å‹interface</h4>
<p>golangä¸­çš„æ‰€æœ‰ç¨‹åºéƒ½å®ç°äº†interface{}çš„æ¥å£ï¼Œè¿™æ„å‘³ç€ï¼Œæ‰€æœ‰çš„ç±»å‹å¦‚string,int,int64ç”šè‡³æ˜¯è‡ªå®šä¹‰çš„structç±»å‹éƒ½å°±æ­¤æ‹¥æœ‰äº†<code>interface&#123;&#125;</code>çš„æ¥å£ï¼Œè¿™ç§åšæ³•å’Œjavaä¸­çš„Objectç±»å‹æ¯”è¾ƒç±»ä¼¼ã€‚é‚£ä¹ˆåœ¨ä¸€ä¸ªæ•°æ®é€šè¿‡<code>func funcName(interface&#123;&#125;)</code>çš„æ–¹å¼ä¼ è¿›æ¥çš„æ—¶å€™ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªå‚æ•°è¢«è‡ªåŠ¨çš„è½¬ä¸º<code>interface&#123;&#125;</code>çš„ç±»å‹ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">funcName</span><span class="hljs-params">(a <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> <span class="hljs-type">string</span> &#123;<br>     <span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(a)<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>interface&#123;&#125;</code>ç›¸å½“äºæ˜¯ä¸€ä¸ªä¸‡èƒ½çš„æ•°æ®ç±»å‹ï¼Œé€‚ç”¨äºå¯¹ä»»ä½•çš„å‡½æ•°çš„å‚æ•°ä¼ é€’ä¸­çš„ä½¿ç”¨</p>
<ul>
<li>ç›´æ¥æ–­è¨€ä½¿ç”¨</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> a <span class="hljs-keyword">interface</span>&#123;&#125;<br>fmt.Println(<span class="hljs-string">&quot;Where are you,Jonny?&quot;</span>, a.(<span class="hljs-type">string</span>))<br></code></pre></td></tr></table></figure>
<p>å¦‚æœæ–­è¨€å¤±è´¥ä¸€èˆ¬ä¼šå¯¼è‡´panicçš„å‘ç”Ÿã€‚æ‰€ä»¥ä¸ºäº†é˜²æ­¢panicçš„å‘ç”Ÿï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ–­è¨€å‰è¿›è¡Œä¸€å®šçš„åˆ¤æ–­</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">value, ok := a.(<span class="hljs-type">string</span>)<br></code></pre></td></tr></table></figure>
<p>å¦‚æœæ–­è¨€å¤±è´¥ï¼Œ<strong>é‚£ä¹ˆokçš„å€¼å°†ä¼šæ˜¯false,ä½†æ˜¯å¦‚æœæ–­è¨€æˆåŠŸokçš„å€¼å°†ä¼šæ˜¯true</strong>ï¼ŒåŒæ—¶valueå°†ä¼šå¾—åˆ°æ‰€æœŸå¾…çš„æ­£ç¡®çš„å€¼ã€‚</p>
<h5 id="interfaceçš„ä¾‹å­">interface{}çš„ä¾‹å­</h5>
<p>å®šä¹‰ä¸€ä¸ªæ–­è¨€ç±»å‹çš„å‡½æ•°</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">myFunc</span><span class="hljs-params">(arg <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> &#123;<br>	fmt.Println(<span class="hljs-string">&quot;myfunc is called...&quot;</span>)<br>	fmt.Println(arg)<br><br>	<span class="hljs-comment">//interface&#123;&#125;å¦‚ä½•ç¡®å®šç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</span><br><br>	<span class="hljs-comment">//ç±»å‹æ–­è¨€æœºåˆ¶ ç”¨äºåˆ¤æ–­æ˜¯ä»€ä¹ˆç±»å‹</span><br>	value, ok := arg.(<span class="hljs-type">string</span>)<br>	<span class="hljs-keyword">if</span> !ok &#123;<br>		fmt.Println(<span class="hljs-string">&quot;arg is not a string&quot;</span>)<br>		fmt.Printf(<span class="hljs-string">&quot;the value is %T\n&quot;</span>, arg) <span class="hljs-comment">//the value is main.Book</span><br>	&#125; <span class="hljs-keyword">else</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;arg is string type,is = &quot;</span>, value)<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä¸»å‡½æ•°çš„è°ƒç”¨å…³ç³»å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Book <span class="hljs-keyword">struct</span> &#123;<br>	auth <span class="hljs-type">string</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	book := Book&#123;<span class="hljs-string">&quot;golang&quot;</span>&#125;<br>	myFunc(book) <span class="hljs-comment">//&#123;golang&#125;</span><br>	myFunc(<span class="hljs-number">100</span>)  <span class="hljs-comment">//100</span><br>	myFunc(<span class="hljs-string">&quot;goland&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>è¾“å‡ºçš„å†…å®¹æ˜¯ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#è¾“å‡ºçš„å€¼</span><br>myfunc is called...<br>&#123;golang&#125;<br>arg is not a string<br>the value is main.Book<br>myfunc is called...<br>100<br>arg is not a string<br>the value is int<br>myfunc is called...<br>goland<br></code></pre></td></tr></table></figure>
<h3 id="reflectåå°„">Reflectåå°„</h3>
<p>åœ¨è®²åå°„ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹Golangå…³äºç±»å‹è®¾è®¡çš„ä¸€äº›åŸåˆ™</p>
<ul>
<li>å˜é‡åŒ…æ‹¬ï¼ˆtype, valueï¼‰ä¸¤éƒ¨åˆ†</li>
<li>type åŒ…æ‹¬ <code>static type</code>å’Œ<code>concrete type</code>.
ç®€å•æ¥è¯´
<code>static type</code>æ˜¯ä½ åœ¨ç¼–ç æ˜¯çœ‹è§çš„ç±»å‹(å¦‚intã€string)ï¼Œ<code>concrete type</code>æ˜¯<code>runtime</code>ç³»ç»Ÿçœ‹è§çš„ç±»å‹</li>
<li>ç±»å‹æ–­è¨€èƒ½å¦æˆåŠŸï¼Œå–å†³äºå˜é‡çš„<code>concrete type</code>ï¼Œè€Œä¸æ˜¯<code>static type</code>.
å› æ­¤ï¼Œä¸€ä¸ª
<code>reader</code>å˜é‡å¦‚æœå®ƒçš„<code>concrete type</code>ä¹Ÿå®ç°äº†<code>write</code>æ–¹æ³•çš„è¯ï¼Œå®ƒä¹Ÿå¯ä»¥è¢«ç±»å‹æ–­è¨€ä¸º<code>writer</code>.</li>
</ul>
<p><code>åå°„</code>ï¼Œå°±æ˜¯å»ºç«‹åœ¨ç±»å‹ä¹‹ä¸Šçš„ï¼ŒGolangçš„æŒ‡å®šç±»å‹çš„å˜é‡çš„ç±»å‹æ˜¯é™æ€çš„ï¼ˆä¹Ÿå°±æ˜¯æŒ‡å®šintã€stringè¿™äº›çš„å˜é‡ï¼Œå®ƒçš„typeæ˜¯static
typeï¼‰ï¼Œåœ¨åˆ›å»ºå˜é‡çš„æ—¶å€™å°±å·²ç»ç¡®å®šï¼Œ<strong>åå°„ä¸»è¦ä¸Golangçš„interfaceç±»å‹ç›¸å…³</strong>ï¼ˆå®ƒçš„typeæ˜¯concrete
typeï¼‰ï¼Œ<strong>åªæœ‰interfaceç±»å‹æ‰æœ‰åå°„ä¸€è¯´</strong></p>
<p>åœ¨Golangçš„å®ç°ä¸­ï¼Œæ¯ä¸ª<code>interface</code>å˜é‡éƒ½æœ‰ä¸€ä¸ªå¯¹åº”<code>pair</code>ï¼Œpairä¸­è®°å½•äº†å®é™…å˜é‡çš„å€¼å’Œç±»å‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">(value, <span class="hljs-keyword">type</span>)<br></code></pre></td></tr></table></figure>
<p>valueæ˜¯å®é™…å˜é‡å€¼ï¼Œtypeæ˜¯å®é™…å˜é‡çš„ç±»å‹ã€‚ä¸€ä¸ª<code>interface&#123;&#125;</code>ç±»å‹çš„å˜é‡åŒ…å«äº†2ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å€¼çš„<strong>ç±»å‹<code>concrete type</code></strong>ï¼Œå¦å¤–ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘<strong>å®é™…çš„å€¼å¯¹åº”<code>value</code></strong></p>
<h4 id="reflectçš„åŸºæœ¬åŠŸèƒ½">reflectçš„åŸºæœ¬åŠŸèƒ½</h4>
<p><strong>reflectçš„åå°„ç±»å‹å¯¹è±¡ï¼šTypeOfå’ŒValueOf</strong></p>
<p>é‚£ä¹ˆåœ¨Golangçš„reflectåå°„åŒ…ä¸­æœ‰ä»€ä¹ˆæ ·çš„æ–¹å¼å¯ä»¥è®©æˆ‘ä»¬ç›´æ¥è·å–åˆ°å˜é‡å†…éƒ¨çš„ä¿¡æ¯å‘¢ï¼Ÿ
å®ƒæä¾›äº†ä¸¤ç§ç±»å‹ï¼ˆæˆ–è€…è¯´ä¸¤ä¸ªæ–¹æ³•ï¼‰è®©æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„è®¿é—®æ¥å£å˜é‡å†…å®¹ï¼Œåˆ†åˆ«æ˜¯<code>reflect.ValueOf()</code>
å’Œ <code>reflect.TypeOf()</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// ValueOf returns a new Value initialized to the concrete value</span><br><span class="hljs-comment">// stored in the interface i.  ValueOf(nil) returns the zero </span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ValueOf</span><span class="hljs-params">(i <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> Value &#123;...&#125;<br><br><span class="hljs-comment">//ValueOfç”¨æ¥è·å–è¾“å…¥å‚æ•°æ¥å£ä¸­çš„æ•°æ®çš„å€¼ï¼Œå¦‚æœæ¥å£ä¸ºç©ºåˆ™è¿”å›0</span><br><br><br><span class="hljs-comment">// TypeOf returns the reflection Type that represents the dynamic type of i.</span><br><span class="hljs-comment">// If i is a nil interface value, TypeOf returns nil.</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TypeOf</span><span class="hljs-params">(i <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> Type &#123;...&#125;<br><br><span class="hljs-comment">//TypeOfç”¨æ¥åŠ¨æ€è·å–è¾“å…¥å‚æ•°æ¥å£ä¸­çš„å€¼çš„ç±»å‹ï¼Œå¦‚æœæ¥å£ä¸ºç©ºåˆ™è¿”å›nil</span><br></code></pre></td></tr></table></figure>
<p><code>reflect.TypeOf()</code>æ˜¯è·å–pairä¸­çš„typeï¼Œ<code>reflect.ValueOf()</code>è·å–pairä¸­çš„valueï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;reflect&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">var</span> num <span class="hljs-type">float64</span> = <span class="hljs-number">1.2345</span><br><br>    fmt.Println(<span class="hljs-string">&quot;type: &quot;</span>, reflect.TypeOf(num))<br>    fmt.Println(<span class="hljs-string">&quot;value: &quot;</span>, reflect.ValueOf(num))<br>&#125;<br><br>è¿è¡Œç»“æœ:<br><span class="hljs-keyword">type</span>:  <span class="hljs-type">float64</span><br>value:  <span class="hljs-number">1.2345</span><br></code></pre></td></tr></table></figure>
<p>è¯´æ˜ï¼š</p>
<ol type="1">
<li><strong>reflect.TypeOfï¼š</strong>
ç›´æ¥ç»™åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„typeç±»å‹ï¼Œå¦‚float64ã€intã€å„ç§pointerã€struct
ç­‰ç­‰çœŸå®çš„ç±»å‹</li>
<li><strong>reflect.ValueOfï¼š</strong>ç›´æ¥ç»™åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„å…·ä½“çš„å€¼ï¼Œå¦‚1.2345è¿™ä¸ªå…·ä½“æ•°å€¼ï¼Œæˆ–è€…ç±»ä¼¼&amp;{1
"Allen.Wu" 25} è¿™æ ·çš„ç»“æ„ä½“structçš„å€¼</li>
<li>åå°„å¯ä»¥å°†â€œæ¥å£ç±»å‹å˜é‡â€è½¬æ¢ä¸ºâ€œåå°„ç±»å‹å¯¹è±¡â€ï¼Œåå°„ç±»å‹æŒ‡çš„æ˜¯<code>reflect.Type</code>å’Œ<code>reflect.Valueè¿™</code>ä¸¤ç§</li>
</ol>
<h4 id="refletä¾‹å­1">refletä¾‹å­1:</h4>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reflectNum</span><span class="hljs-params">(arg <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> &#123;<br>	fmt.Println(<span class="hljs-string">&quot;type:&quot;</span>, reflect.TypeOf(arg))<br>	fmt.Println(<span class="hljs-string">&quot;value:&quot;</span>, reflect.ValueOf(arg))<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä¸»å‡½æ•°çš„è°ƒç”¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-keyword">var</span> num <span class="hljs-type">float64</span> = <span class="hljs-number">1.2345</span><br>	reflectNum(num)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œåœ¨ä½¿ç”¨åå°„ä¹‹å‰éœ€è¦å¼•å…¥<strong>reflectçš„åŒ…</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;reflect&quot;</span><br>)<br></code></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">var</span> num <span class="hljs-type">float64</span> = <span class="hljs-number">1.2345</span><br><br>    pointer := reflect.ValueOf(&amp;num)<br>    value := reflect.ValueOf(num)<br><br>    <span class="hljs-comment">// å¯ä»¥ç†è§£ä¸ºâ€œå¼ºåˆ¶è½¬æ¢â€ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ—¶å€™ï¼Œè½¬æ¢çš„æ—¶å€™ï¼Œå¦‚æœè½¬æ¢çš„ç±»å‹ä¸å®Œå…¨ç¬¦åˆï¼Œåˆ™ç›´æ¥panic</span><br>    <span class="hljs-comment">// Golang å¯¹ç±»å‹è¦æ±‚éå¸¸ä¸¥æ ¼ï¼Œç±»å‹ä¸€å®šè¦å®Œå…¨ç¬¦åˆ</span><br>    <span class="hljs-comment">// å¦‚ä¸‹ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯*float64ï¼Œä¸€ä¸ªæ˜¯float64ï¼Œå¦‚æœå¼„æ··ï¼Œåˆ™ä¼španic</span><br>    convertPointer := pointer.Interface().(*<span class="hljs-type">float64</span>)<br>    convertValue := value.Interface().(<span class="hljs-type">float64</span>)<br><br>    fmt.Println(convertPointer)<br>    fmt.Println(convertValue)<br>&#125;<br><br>è¿è¡Œç»“æœï¼š<br><span class="hljs-number">0xc42000e238</span><br><span class="hljs-number">1.2345</span><br></code></pre></td></tr></table></figure>
<h4 id="refletä¾‹å­2">refletä¾‹å­2:</h4>
<ul>
<li><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªç±»ä»¥åŠå…³äºè¿™ä¸ªç±»çš„æ–¹æ³•</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>	Id   <span class="hljs-type">int</span><br>	Name <span class="hljs-type">string</span><br>	Age  <span class="hljs-type">int</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this User)</span></span> Call() &#123; <span class="hljs-comment">//ä¸ºä»€ä¹ˆè¿™ä¸ªåœ°æ–¹è¿”å›ç±»å‹ä¸æ˜¯*</span><br>	fmt.Println(<span class="hljs-string">&quot;user is called ..&quot;</span>)<br>	fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, this)<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>å†å®šä¹‰ä¸€ä¸ªåˆ©ç”¨åå°„é€‰æ‹©ç±»ä¸­å€¼å’Œæ–¹æ³•çš„å‡½æ•°</p></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoFiledAndMethod</span><span class="hljs-params">(input <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> &#123;<br>	<span class="hljs-comment">//è·å–è¾“å…¥çš„ç±»å‹type</span><br>	inputType := reflect.TypeOf(input)<br>	fmt.Println(<span class="hljs-string">&quot;input type is: &quot;</span>, inputType.Name())<br>	<span class="hljs-comment">//output: input type is:  User</span><br><br>	<span class="hljs-comment">//è·å–inputçš„value</span><br>	inputValue := reflect.ValueOf(input)<br>	fmt.Println(<span class="hljs-string">&quot;input value is: &quot;</span>, inputValue)<br>	<span class="hljs-comment">//output: input value is:  &#123;1 eric 19&#125;</span><br><br>	<span class="hljs-comment">//é€šè¿‡typeè·å–å…¶ä¸­çš„å­—æ®µ</span><br>	<span class="hljs-comment">/*</span><br><span class="hljs-comment">		1ã€è·å–interfaceä¸­çš„reflectçš„type, é€šè¿‡typeå¾—åˆ°numfieldï¼Œè¿›è¡Œéå†</span><br><span class="hljs-comment">		2ã€å¾—åˆ°æ¯ä¸ªfiledï¼Œå°±æ˜¯æ•°æ®ç±»å‹</span><br><span class="hljs-comment">		3ã€é€šè¿‡filedä¸­æœ‰ä¸€ä¸ªinterface()æ–¹æ³•å¾—åˆ°å¯¹åº”çš„value</span><br><span class="hljs-comment">	*/</span><br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; inputType.NumField(); i++ &#123;<br>		field := inputType.Field(i)<br>		<span class="hljs-comment">// value:=inputType.Field&#123;i&#125;.interface()</span><br>		value := inputValue.Field(i).Interface()<br>		<span class="hljs-comment">// fmt.Println(field) //&#123;Id  int  0 [0] false&#125;ã€&#123;Name  string  8 [1] false&#125;</span><br>		<span class="hljs-comment">/*</span><br><span class="hljs-comment">			æ¯ä¸ªfieldè¡¨ç¤ºçš„å°±æ˜¯ä¸€è¡Œçš„å…ƒç´ å†…å®¹ï¼Œå…¶ä¸­Nameè¡¨ç¤ºäº†è¿™ä¸€è¡Œçš„å˜é‡åï¼Œ Typeè¡¨ç¤ºçš„æ˜¯è¿™ä¸€è¡Œçš„ç±»å‹</span><br><span class="hljs-comment">			é€šè¿‡valueå•ç‹¬å­˜åœ¨fieldé‡Œé¢ï¼Œæ ¹æ®ç´¢å¼•å€¼å¯»æ‰¾é€šè¿‡Interface()è°ƒç”¨</span><br><span class="hljs-comment">		*/</span><br>		fmt.Printf(<span class="hljs-string">&quot;%s: %v = %v\n&quot;</span>, field.Name, field.Type, value)<br><br>	&#125;<br><br>	<span class="hljs-comment">/* å¦‚ä½•éå†é€‰æ‹©æ–¹æ³•å‘¢</span><br><span class="hljs-comment">	ä¹Ÿæ˜¯æ ¹æ®inputTypeæ¥è¿›è¡Œåˆ’åˆ†</span><br><span class="hljs-comment">	*/</span><br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; inputType.NumMethod(); i++ &#123;<br>		m := inputType.Method(i)<br>		fmt.Printf(<span class="hljs-string">&quot;%s: %v\n&quot;</span>, m.Name, m.Type)<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ol type="1">
<li><strong>reflect.TypeOf</strong>(input)å¾—åˆ°ç±»å‹</li>
<li><strong>reflect.ValueOf</strong>(input)å¾—åˆ°å¯¹åº”çš„å€¼</li>
<li><strong>reflect.TypeOf</strong>(input).<strong>NumField()</strong>çš„æ–¹æ³•æ˜¯è·å¾—interface()ä¸­çš„æ‰€æœ‰çš„å­—æ®µ</li>
<li>å¦‚æœé€‰æ‹©å­—æ®µä¸­çš„ç±»å‹ï¼š <strong>inputType.Field(i) =
reflect.TypeOf(input).Field(i)</strong></li>
<li>å¦‚æœé€‰æ‹©å­—æ®µä¸­çš„å€¼ï¼š<strong>inputType.Field(i) =
reflect.TypeOf(input).Field(i).Interface()</strong></li>
<li>å¦‚æœæƒ³ä¾¿åˆ©interfaceä¸­çš„æ–¹æ³•ï¼š<strong>reflect.TypeOf</strong>(input).<strong>NumMethod()</strong>ï¼Œå…¶ä¸­å…·ä½“çš„æ–¹æ³•æ˜¯ï¼š<strong>reflect.TypeOf(input).Method(i)</strong></li>
</ol>
<p>é€šè¿‡è¿è¡Œç»“æœå¯ä»¥å¾—çŸ¥è·å–æœªçŸ¥ç±»å‹çš„interfaceçš„æ‰€å±æ–¹æ³•ï¼ˆå‡½æ•°ï¼‰çš„æ­¥éª¤ä¸ºï¼š</p>
<ol type="1">
<li>å…ˆè·å–interfaceçš„reflect.Typeï¼Œç„¶åé€šè¿‡NumMethodè¿›è¡Œéå†</li>
<li>å†åˆ†åˆ«é€šè¿‡reflect.Typeçš„Methodè·å–å¯¹åº”çš„çœŸå®çš„æ–¹æ³•ï¼ˆå‡½æ•°ï¼‰</li>
<li>æœ€åå¯¹ç»“æœå–å…¶Nameå’ŒTypeå¾—çŸ¥å…·ä½“çš„æ–¹æ³•å</li>
<li>ä¹Ÿå°±æ˜¯è¯´åå°„å¯ä»¥å°†â€œåå°„ç±»å‹å¯¹è±¡â€å†é‡æ–°è½¬æ¢ä¸ºâ€œæ¥å£ç±»å‹å˜é‡â€</li>
<li>struct æˆ–è€… struct çš„åµŒå¥—éƒ½æ˜¯ä¸€æ ·çš„åˆ¤æ–­å¤„ç†æ–¹å¼</li>
</ol>
<h4
id="é€šè¿‡reflect.valueè®¾ç½®å®é™…å˜é‡çš„å€¼">é€šè¿‡reflect.Valueè®¾ç½®å®é™…å˜é‡çš„å€¼</h4>
<p>reflect.Valueæ˜¯é€šè¿‡reflect.ValueOf(X)è·å¾—çš„ï¼Œåªæœ‰å½“Xæ˜¯æŒ‡é’ˆçš„æ—¶å€™ï¼Œæ‰å¯ä»¥é€šè¿‡reflec.Valueä¿®æ”¹å®é™…å˜é‡Xçš„å€¼ï¼Œå³ï¼šè¦ä¿®æ”¹åå°„ç±»å‹çš„å¯¹è±¡å°±ä¸€å®šè¦ä¿è¯å…¶å€¼æ˜¯â€œaddressableâ€çš„ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;reflect&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><br>    <span class="hljs-keyword">var</span> num <span class="hljs-type">float64</span> = <span class="hljs-number">1.2345</span><br>    fmt.Println(<span class="hljs-string">&quot;old value of pointer:&quot;</span>, num)<br><br>    <span class="hljs-comment">// é€šè¿‡reflect.ValueOfè·å–numä¸­çš„reflect.Valueï¼Œæ³¨æ„ï¼Œå‚æ•°å¿…é¡»æ˜¯æŒ‡é’ˆæ‰èƒ½ä¿®æ”¹å…¶å€¼</span><br>    pointer := reflect.ValueOf(&amp;num)<br>    newValue := pointer.Elem()<br><br>    fmt.Println(<span class="hljs-string">&quot;type of pointer:&quot;</span>, newValue.Type())<br>    fmt.Println(<span class="hljs-string">&quot;settability of pointer:&quot;</span>, newValue.CanSet())<br><br>    <span class="hljs-comment">// é‡æ–°èµ‹å€¼</span><br>    newValue.SetFloat(<span class="hljs-number">77</span>)<br>    fmt.Println(<span class="hljs-string">&quot;new value of pointer:&quot;</span>, num)<br><br>    <span class="hljs-comment">////////////////////</span><br>    <span class="hljs-comment">// å¦‚æœreflect.ValueOfçš„å‚æ•°ä¸æ˜¯æŒ‡é’ˆï¼Œä¼šå¦‚ä½•ï¼Ÿ</span><br>    pointer = reflect.ValueOf(num)<br>    <span class="hljs-comment">//newValue = pointer.Elem() // å¦‚æœéæŒ‡é’ˆï¼Œè¿™é‡Œç›´æ¥panicï¼Œâ€œpanic: reflect: call of reflect.Value.Elem on float64 Valueâ€</span><br>&#125;<br><br>è¿è¡Œç»“æœï¼š<br>old value of pointer: <span class="hljs-number">1.2345</span><br><span class="hljs-keyword">type</span> of pointer: <span class="hljs-type">float64</span><br>settability of pointer: <span class="hljs-literal">true</span><br><span class="hljs-built_in">new</span> value of pointer: <span class="hljs-number">77</span><br></code></pre></td></tr></table></figure>
<ol type="1">
<li>éœ€è¦ä¼ å…¥çš„å‚æ•°æ˜¯*
float64è¿™ä¸ªæŒ‡é’ˆï¼Œç„¶åå¯ä»¥é€šè¿‡pointer.Elem()å»è·å–æ‰€æŒ‡å‘çš„Valueï¼Œ<strong>æ³¨æ„ä¸€å®šè¦æ˜¯æŒ‡é’ˆ</strong>ã€‚</li>
<li>å¦‚æœä¼ å…¥çš„å‚æ•°ä¸æ˜¯æŒ‡é’ˆï¼Œè€Œæ˜¯å˜é‡ï¼Œé‚£ä¹ˆ</li>
</ol>
<ul>
<li><ul>
<li>é€šè¿‡Elemè·å–åŸå§‹å€¼å¯¹åº”çš„å¯¹è±¡åˆ™ç›´æ¥panic</li>
<li>é€šè¿‡CanSetæ–¹æ³•æŸ¥è¯¢æ˜¯å¦å¯ä»¥è®¾ç½®è¿”å›false</li>
</ul></li>
</ul>
<ol type="1">
<li>newValue.CantSet()è¡¨ç¤ºæ˜¯å¦å¯ä»¥é‡æ–°è®¾ç½®å…¶å€¼ï¼Œå¦‚æœè¾“å‡ºçš„æ˜¯trueåˆ™å¯ä¿®æ”¹ï¼Œå¦åˆ™ä¸èƒ½ä¿®æ”¹ï¼Œä¿®æ”¹å®Œä¹‹åå†è¿›è¡Œæ‰“å°å‘ç°çœŸçš„å·²ç»ä¿®æ”¹äº†ã€‚</li>
<li>reflect.Value.Elem()
è¡¨ç¤ºè·å–åŸå§‹å€¼å¯¹åº”çš„åå°„å¯¹è±¡ï¼Œåªæœ‰åŸå§‹å¯¹è±¡æ‰èƒ½ä¿®æ”¹ï¼Œå½“å‰åå°„å¯¹è±¡æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œæ˜¯æŒ‡åªèƒ½ä¿®æ”¹åŸæ˜¯å¯¹è±¡çš„<strong>å€¼çš„å¤§å°ï¼Œä¸èƒ½ä¿®æ”¹åœ°å€</strong></li>
<li>newValue.SetFloat(77)é‡æ–°è®¾ç½®å€¼çš„æ“ä½œï¼Œä¼ é€’å¼•ç”¨æ¥ä¿®æ”¹interfaceä¸­çš„å€¼</li>
</ol>
<h4 id="åå°„çš„åŸºæœ¬åŸç†">åå°„çš„åŸºæœ¬åŸç†</h4>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231219205804430.png"
alt="åå°„åŸºæœ¬åŸç†æ€»ç»“" />
<figcaption aria-hidden="true">åå°„åŸºæœ¬åŸç†æ€»ç»“</figcaption>
</figure>
<h3 id="section"></h3>
<h3 id="ç»“æ„ä½“æ ‡ç­¾">ç»“æ„ä½“æ ‡ç­¾</h3>
<p>æœ¬è´¨ä¸Šè¿˜æ˜¯åˆ©ç”¨äº†åå°„ï¼Œé€šè¿‡ä»¥ä¸‹å½¢å¼ç»™ç»“æ„ä½“ä¸­çš„å˜é‡æ·»åŠ æ ‡ç­¾ä½œç”¨ï¼š
å…¶ä»–åŒ…åœ¨è°ƒç”¨è¿™ä¸ªå½“å‰åŒ…çš„æ—¶å€™å¯¹äºæŸä¸ªå±æ€§çš„ä¸€ä¸ªè¯´æ˜ï¼ŒæŒ‡ç¤ºæŸä¸ªåŒ…åœ¨å…·ä½“ä½¿ç”¨ä¸­çš„ä½œç”¨ã€‚</p>
<p><strong>ä½œç”¨ï¼šèƒ½å¤Ÿå°†ç»“æ„ä½“è½¬åŒ–ä¸ºjsonæ ¼å¼</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;reflect&quot;</span><br>)<br><span class="hljs-keyword">type</span> resume <span class="hljs-keyword">struct</span>&#123;<br>	<span class="hljs-comment">/*  </span><br><span class="hljs-comment">	é€šè¿‡ä»¥ä¸‹å½¢å¼ç»™ç»“æ„ä½“ä¸­çš„å˜é‡æ·»åŠ æ ‡ç­¾</span><br><span class="hljs-comment">	ä½œç”¨ï¼š å…¶ä»–åŒ…åœ¨è°ƒç”¨è¿™ä¸ªå½“å‰åŒ…çš„æ—¶å€™å¯¹äºæŸä¸ªå±æ€§çš„ä¸€ä¸ªè¯´æ˜ï¼ŒæŒ‡ç¤ºæŸä¸ªåŒ…åœ¨å…·ä½“ä½¿ç”¨ä¸­çš„ä½œç”¨</span><br><span class="hljs-comment">	*/</span><br>	Name <span class="hljs-type">string</span> <span class="hljs-string">`info:&quot;name&quot; doc:&quot;æˆ‘çš„åå­—&quot;`</span> <br>	Sex <span class="hljs-type">string</span> <span class="hljs-string">`info:&quot;sex&quot;`</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">findtag</span><span class="hljs-params">(str <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span>&#123;<br>	t :=reflect.TypeOf(str).Elem()<br><br>	<span class="hljs-keyword">for</span> i:=<span class="hljs-number">0</span>;i&lt;t.NumField();i++&#123;<br>		tagstring:=t.Field(i).Tag.Get(<span class="hljs-string">&quot;info&quot;</span>)<br>		tagdoc:=t.Field(i).Tag.Get(<span class="hljs-string">&quot;doc&quot;</span>)<br>		fmt.Println(<span class="hljs-string">&quot;info:&quot;</span>,tagstring,<span class="hljs-string">&quot;doc&quot;</span>,tagdoc)<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-keyword">var</span> re resume<br>	findtag(&amp;re) <span class="hljs-comment">//æ³¨æ„è¿™é‡Œä¼ é€’çš„æ˜¯å¼•ç”¨</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231207215501791.png" alt="go printfçš„å ä½ç¬¦æ ¼å¼" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231207215514980.png" alt="go printfçš„å ä½ç¬¦è¡¨ç¤º" style="zoom:67%;" /></p>
<p>è¾“å‡ºä¹‹ååœ¨jsonæ ¼å¼è½¬æ¢ä¸­å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼Œæ³¨æ„å¯ä»¥çœ‹åˆ°çš„æ˜¯è¾“å‡ºçš„å†…å®¹æ˜¯æ ¹æ®ç»™å®šçš„tagæ¥è¿›è¡Œæ ‡é¢˜çš„å‘½åçš„</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231207215859488.png" alt="è½¬åŒ–ä¸ºjsonæ ¼å¼çš„ä¾‹å­" style="zoom:67%;" /></p>
<p>åˆ©ç”¨åå°„å–å‡ºå…ƒç´ æŸ¥è¯¢</p>
<p>åˆ©ç”¨ç¼–ç å’Œè§£ç å¯¹struct å’Œjsonä¹‹é—´çš„è½¬åŒ–</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;encoding/json&quot;</span><br>)<br><br><span class="hljs-comment">//å¦‚ä½•å°†ç»“æ„ä½“è½¬åŒ–æˆjson</span><br><span class="hljs-keyword">type</span> Movie <span class="hljs-keyword">struct</span>&#123;<br>	Title <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;title&quot;`</span>  <span class="hljs-comment">//å°±æ˜¯å‘Šè¯‰jsonåº“å¯¹åº”çš„å˜é‡çš„æ ‡ç­¾åå­—æ˜¯è¿™ä¸ª</span><br>	Year <span class="hljs-type">int</span> <span class="hljs-string">`json:&quot;year&quot;`</span><br>	Price <span class="hljs-type">int</span> <span class="hljs-string">`json:&quot;rmb&quot;`</span><br>	Actors []<span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;actors&quot;`</span> <span class="hljs-comment">//slice `json:&quot;actors&quot;`</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	movie :=Movie&#123;<span class="hljs-string">&quot;å–œå‰§ä¹‹ç‹&quot;</span>,<span class="hljs-number">2000</span>,<span class="hljs-number">10</span>,[]<span class="hljs-type">string</span>&#123;<span class="hljs-string">&quot;zhouxingchi&quot;</span>,<span class="hljs-string">&quot;zhangbozhi&quot;</span>&#125;&#125;<br><br>	<span class="hljs-comment">//ç¼–ç çš„è¿‡ç¨‹å°±æ˜¯å°† struct--&gt;json</span><br><br>	jsonStr,err:=json.Marshal(movie)<br><br>	<span class="hljs-comment">//è¿”å›ä¸¤ä¸ªå­—æ®µ</span><br><br>	<span class="hljs-keyword">if</span> err!=<span class="hljs-literal">nil</span>&#123;<br>		fmt.Println(<span class="hljs-string">&quot;json marshal error&quot;</span>,err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	fmt.Printf(<span class="hljs-string">&quot;jsonStr=%s\n&quot;</span>,jsonStr )<br>	<span class="hljs-comment">/* jsonStr=&#123;&quot;title&quot;:&quot;å–œå‰§ä¹‹ç‹&quot;,&quot;year&quot;:2000,&quot;rmb&quot;:10,&quot;Actors&quot;:[&quot;zhouxingchi&quot;,&quot;zhangbozhi&quot;]&#125; */</span><br><br>	<span class="hljs-comment">//è§£ç è¿‡ç¨‹ï¼šjson--&gt;struct</span><br>	<span class="hljs-comment">//jsonStr=&#123;&quot;title&quot;:&quot;å–œå‰§ä¹‹ç‹&quot;,&quot;year&quot;:2000,&quot;rmb&quot;:10,&quot;actors&quot;:[&quot;zhouxingchi&quot;,&quot;zhangbozhi&quot;]&#125;</span><br><br>	myMovie:=Movie&#123;&#125;<br>	<span class="hljs-comment">//æ³¨æ„è¿™ä¸ªåœ°æ–¹ä¼ é€’çš„å‚é‡æ˜¯å¼•ç”¨</span><br>	err=json.Unmarshal(jsonStr,&amp;myMovie)<br>	<span class="hljs-keyword">if</span> err!=<span class="hljs-literal">nil</span>&#123;<br>		fmt.Println(<span class="hljs-string">&quot;json unmashal error&quot;</span>,err)<br>		<span class="hljs-keyword">return</span> <br>	&#125;<br>	fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>,myMovie)<br>	<span class="hljs-comment">//è¿”å›ç»“æ„ä½“</span><br>	<span class="hljs-comment">//&#123;å–œå‰§ä¹‹ç‹ 2000 10 [zhouxingchi zhangbozhi]&#125;</span><br>&#125;<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åç«¯å¼€å‘</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åç«¯å¼€å‘ã€‘Golangåç¨‹ä¸Channel</title>
    <url>/2023/12/19/goroutine/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="golangè¿›é˜¶">Golangè¿›é˜¶</h1>
<p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦ä»‹ç»golangä¸­çš„å¹¶å‘ï¼Œå¹¶å‘æ˜¯ golang çš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œä½¿ç”¨å…³é”®å­—
go å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¼€å¯ä¸€ä¸ª<strong>åç¨‹</strong>. go è¯­è¨€ä¸­ï¼Œå¸¸å¸¸ç”¨
<strong>go</strong>ã€<strong>chan</strong>ã€<strong>select</strong> åŠ
<strong>sync
åº“</strong>å®Œæˆå¹¶å‘æ“ä½œï¼Œå¤„ç†<strong>åŒæ­¥</strong>ã€<strong>å¼‚æ­¥</strong>ã€<strong>é˜»å¡</strong>ã€<strong>éé˜»å¡</strong>ä»»åŠ¡</p>
<p>go è¯­è¨€çš„å¹¶å‘ç¼–ç¨‹ï¼Œä»¥ä¸‹æ˜¯éœ€è¦äº†è§£çš„åŸºç¡€çŸ¥è¯†ç‚¹</p>
<ul>
<li><strong>é˜»å¡</strong>:
é˜»å¡æ˜¯è¿›ç¨‹(ä¹Ÿå¯ä»¥æ˜¯çº¿ç¨‹ã€åç¨‹)çš„çŠ¶æ€ä¹‹ä¸€ï¼ˆæ–°å»ºã€å°±ç»ªã€è¿è¡Œã€é˜»å¡ã€ç»ˆæ­¢).
æŒ‡çš„æ˜¯å½“æ•°æ®æœªå‡†å¤‡å°±ç»ªï¼Œè¿™ä¸ªè¿›ç¨‹(çº¿ç¨‹ã€åç¨‹)ä¸€ç›´ç­‰å¾…ï¼Œè¿™å°±æ˜¯é˜»å¡.</li>
<li><strong>éé˜»å¡</strong>:
å½“æ•°æ®ä¸ºå‡†å¤‡å°±ç»ªï¼Œè¯¥è¿›ç¨‹(çº¿ç¨‹ã€åç¨‹)ä¸ç­‰å¾…å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯éé˜»å¡.</li>
<li><strong>åŒæ­¥</strong>:
åœ¨å‘èµ·ä¸€ä¸ªè°ƒç”¨æ—¶ï¼Œåœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰ï¼Œè¿™ä¸ªè°ƒç”¨å°±ä¸è¿”å›ï¼Œè¿™ä¸ªè°ƒç”¨è¿‡ç¨‹ä¸€ç›´åœ¨ç­‰å¾….
è¿™æ˜¯åŒæ­¥.</li>
<li><strong>å¼‚æ­¥</strong>:
åœ¨å‘èµ·è°ƒç”¨åï¼Œå°±ç«‹åˆ»è¿”å›äº†ï¼Œè¿™æ¬¡è°ƒç”¨è¿‡ç¨‹å°±ç»“æŸäº†.
ç­‰åˆ°æœ‰ç»“æœäº†è¢«è°ƒç”¨æ–¹ä¸»åŠ¨é€šçŸ¥è°ƒç”¨è€…ç»“æœ. è¿™æ˜¯å¼‚æ­¥</li>
<li><strong>goroutine</strong>: é€šè¿‡å…³é”®å­— go å³å¯åˆ›å»ºä¸€ä¸ªåç¨‹.</li>
<li><strong>chan :</strong> golang
ä¸­ç”¨äºå¹¶å‘çš„é€šé“ï¼Œç”¨äºåç¨‹çš„é€šä¿¡.</li>
</ul>
<h2 id="goroutineåç¨‹">Goroutineåç¨‹</h2>
<p>åç¨‹å¹¶å‘ï¼Œcoroutineï¼Œä¹Ÿå«è½»é‡çº§çº¿ç¨‹ã€‚</p>
<p>ä¸ä¼ ç»Ÿçš„ç³»ç»Ÿçº§çº¿ç¨‹å’Œè¿›ç¨‹ç›¸æ¯”ï¼Œåç¨‹æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºâ€œè½»é‡çº§â€ã€‚å¯ä»¥è½»æ¾åˆ›å»ºä¸Šä¸‡ä¸ªè€Œä¸ä¼šå¯¼è‡´ç³»ç»Ÿèµ„æºè¡°ç«­ã€‚</p>
<p>ä¸€ä¸ªçº¿ç¨‹ä¸­å¯ä»¥æœ‰ä»»æ„å¤šä¸ªåç¨‹ï¼Œä½†æŸä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªåç¨‹åœ¨è¿è¡Œï¼Œ<strong>å¤šä¸ªåç¨‹åˆ†äº«è¯¥çº¿ç¨‹åˆ†é…åˆ°çš„è®¡ç®—æœºèµ„æº</strong>ã€‚</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231207223749991-20231219211513985.png" alt="ä¼ ç»Ÿçš„çº¿ç¨‹è°ƒåº¦æ–¹å¼" style="zoom:80%;" /></p>
<p>å­˜åœ¨åˆ‡æ¢æˆæœ¬ï¼Œå­˜å‚¨å½“å‰çš„çº¿ç¨‹çš„çŠ¶æ€</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231207223845618.png"
alt="CPUåˆ‡æ¢é€ æˆçš„æ—¶é—´æ¶ˆè€—" />
<figcaption aria-hidden="true">CPUåˆ‡æ¢é€ æˆçš„æ—¶é—´æ¶ˆè€—</figcaption>
</figure>
<p>åœ¨åç¨‹ä¸­ï¼Œè°ƒç”¨ä¸€ä¸ªä»»åŠ¡å°±åƒè°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¸€æ ·ï¼Œæ¶ˆè€—çš„ç³»ç»Ÿèµ„æºæœ€å°‘ï¼ä½†èƒ½è¾¾åˆ°è¿›ç¨‹ã€çº¿ç¨‹å¹¶å‘ç›¸åŒçš„æ•ˆæœã€‚</p>
<p>åœ¨ä¸€æ¬¡å¹¶å‘ä»»åŠ¡ä¸­ï¼Œè¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹å‡å¯ä»¥å®ç°ã€‚ä»ç³»ç»Ÿèµ„æºæ¶ˆè€—çš„è§’åº¦å‡ºå‘æ¥çœ‹ï¼Œè¿›ç¨‹ç›¸å½“å¤šï¼Œçº¿ç¨‹æ¬¡ä¹‹ï¼Œåç¨‹æœ€å°‘</p>
<h3 id="goroutineåŸºæœ¬æ¨¡å‹">GoroutineåŸºæœ¬æ¨¡å‹</h3>
<p>çº¿ç¨‹æ•°é‡è¶Šå¤šä¼šå¯¼è‡´åˆ‡æ¢æˆæœ¬è¶Šå¤§è¶Šå®¹æ˜“é€ æˆæµªè´¹</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231210220547247.png" alt="CPUç®¡ç†åç¨‹çš„å…·ä½“ç»†èŠ‚" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231210220633895.png" alt="æ—©æœŸè°ƒåº¦å™¨çš„æ–¹å¼" style="zoom:67%;" /></p>
<p>è€å¼è°ƒåº¦å™¨çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>åˆ›å»ºã€é”€æ¯ã€è°ƒåº¦Géƒ½éœ€è¦æ¯ä¸ªMè·å–é”ï¼Œè¿™å°±å½¢æˆäº†<strong>æ¿€çƒˆçš„é”ç«äº‰</strong></li>
<li>Mè½¬ç§»Gä¼šé€ æˆ<strong>å»¶è¿Ÿå’Œé¢å¤–çš„ç³»ç»Ÿè´Ÿè½½</strong></li>
<li>ç³»ç»Ÿè°ƒç”¨(CPUåœ¨Mä¹‹é—´çš„åˆ‡æ¢)
å¯¼è‡´é¢‘ç¹çš„çº¿ç¨‹é˜»å¡å’Œå–æ¶ˆé˜»å¡æ“ä½œ<strong>å¢åŠ äº†ç³»ç»Ÿå¼€é”€</strong></li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231210221404383.png" alt="è°ƒåº¦å™¨è®¾è®¡çš„å‡†åˆ™" style="zoom:67%;" /></p>
<h3 id="goroutineçš„å®šä¹‰">Goroutineçš„å®šä¹‰</h3>
<p>goroutineæ˜¯Goè¯­è¨€å¹¶è¡Œè®¾è®¡çš„æ ¸å¿ƒï¼Œæœ‰äººç§°ä¹‹ä¸ºgoç¨‹ã€‚
Goroutineä»é‡çº§ä¸Šçœ‹å¾ˆåƒåç¨‹ï¼Œå®ƒæ¯”çº¿ç¨‹æ›´å°ï¼Œåå‡ ä¸ªgoroutineå¯èƒ½ä½“ç°åœ¨åº•å±‚å°±æ˜¯äº”å…­ä¸ªçº¿ç¨‹ï¼ŒGoè¯­è¨€å†…éƒ¨å¸®ä½ å®ç°äº†è¿™äº›goroutineä¹‹é—´çš„å†…å­˜å…±äº«ã€‚æ‰§è¡Œgoroutineåªéœ€æå°‘çš„æ ˆå†…å­˜(å¤§æ¦‚æ˜¯4~5KB)ï¼Œå½“ç„¶ä¼šæ ¹æ®ç›¸åº”çš„æ•°æ®ä¼¸ç¼©ã€‚ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œå¯åŒæ—¶è¿è¡Œæˆåƒä¸Šä¸‡ä¸ªå¹¶å‘ä»»åŠ¡ã€‚goroutineæ¯”threadæ›´æ˜“ç”¨ã€æ›´é«˜æ•ˆã€æ›´è½»ä¾¿ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ™®é€šè®¡ç®—æœºè·‘å‡ åä¸ªçº¿ç¨‹å°±æœ‰ç‚¹è´Ÿè½½è¿‡å¤§äº†ï¼Œä½†æ˜¯åŒæ ·çš„æœºå™¨å´å¯ä»¥è½»æ¾åœ°è®©æˆç™¾ä¸Šåƒä¸ªgoroutineè¿›è¡Œèµ„æºç«äº‰ã€‚</p>
<h3 id="åˆ›å»ºgoroutine">åˆ›å»ºGoroutine</h3>
<p>åªéœ€åœ¨å‡½æ•°è°ƒâ½¤è¯­å¥å‰æ·»åŠ  <strong>go</strong>
å…³é”®å­—ï¼Œå°±å¯åˆ›å»ºå¹¶å‘æ‰§â¾å•å…ƒã€‚åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æƒ³å°†ä¸€ä¸ªè¿‡ç¨‹åˆ‡åˆ†æˆå‡ å—ï¼Œç„¶åè®©æ¯ä¸ªgoroutineå„è‡ªè´Ÿè´£ä¸€å—å·¥ä½œï¼Œå½“ä¸€ä¸ªç¨‹åºå¯åŠ¨æ—¶ï¼Œä¸»å‡½æ•°åœ¨ä¸€ä¸ªå•ç‹¬çš„goroutineä¸­è¿è¡Œï¼Œæˆ‘ä»¬å«å®ƒmain
goroutineã€‚</p>
<p>ç¤ºä¾‹ä»£ç </p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;time&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newTask</span><span class="hljs-params">()</span></span> &#123;<br>    i := <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> &#123;<br>        i++<br>        fmt.Printf(<span class="hljs-string">&quot;new goroutine: i = %d\n&quot;</span>, i)<br>        time.Sleep(<span class="hljs-number">1</span>*time.Second) <span class="hljs-comment">//å»¶æ—¶1s</span><br>    &#125;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ª goroutineï¼Œå¯åŠ¨å¦å¤–ä¸€ä¸ªä»»åŠ¡</span><br>    <span class="hljs-keyword">go</span> newTask()<br>    i := <span class="hljs-number">0</span><br>    <span class="hljs-comment">//main goroutine å¾ªç¯æ‰“å°</span><br>    <span class="hljs-keyword">for</span> &#123;<br>        i++<br>        fmt.Printf(<span class="hljs-string">&quot;main goroutine: i = %d\n&quot;</span>, i)<br>        time.Sleep(<span class="hljs-number">1</span> * time.Second) <span class="hljs-comment">//å»¶æ—¶1s</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">main Goroutine: i=1<br>new Goroutine: i =2<br>new Goroutine: i =3<br>main Goroutine: i=2<br>main Goroutine: i=3<br>new Goroutine: i =4<br>new Goroutine: i =5<br></code></pre></td></tr></table></figure>
<h3 id="goroutineç‰¹æ€§">Goroutineç‰¹æ€§</h3>
<p><strong>ä¸»goroutineé€€å‡ºåï¼Œå…¶å®ƒçš„å·¥ä½œgoroutineä¹Ÿä¼šè‡ªåŠ¨é€€å‡ºï¼š</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;time&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newTask</span><span class="hljs-params">()</span></span> &#123;<br>    i := <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> &#123;<br>        i++<br>        fmt.Printf(<span class="hljs-string">&quot;new goroutine: i = %d\n&quot;</span>, i)<br>        time.Sleep(<span class="hljs-number">1</span> * time.Second) <span class="hljs-comment">//å»¶æ—¶1s</span><br>    &#125;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ª goroutineï¼Œå¯åŠ¨å¦å¤–ä¸€ä¸ªä»»åŠ¡</span><br>    <span class="hljs-keyword">go</span> newTask()<br> <br>    fmt.Println(<span class="hljs-string">&quot;main goroutine exit&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231219213501210.png" alt="ä¸»è¿›ç¨‹ç»“æŸé‚£ä¹ˆå…¶ä½™çš„goroutineç»“æŸ" style="zoom:67%;" /></p>
<h3 id="goexitå‡½æ•°">Goexitå‡½æ•°</h3>
<p>è°ƒç”¨ runtime.Goexit() å°†ç«‹å³ç»ˆæ­¢å½“å‰ goroutine
æ‰§â¾ï¼Œè°ƒåº¦å™¨ç¡®ä¿æ‰€æœ‰å·²æ³¨å†Œ defer å»¶è¿Ÿè°ƒç”¨è¢«æ‰§è¡Œã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;runtime&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;A.defer&quot;</span>)<br> <br>        <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>            <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;B.defer&quot;</span>)<br>            runtime.Goexit() <span class="hljs-comment">// ç»ˆæ­¢å½“å‰ goroutine, import &quot;runtime&quot;</span><br>            fmt.Println(<span class="hljs-string">&quot;B&quot;</span>) <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span><br>        &#125;()<br> <br>        fmt.Println(<span class="hljs-string">&quot;A&quot;</span>) <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span><br>    &#125;()       <span class="hljs-comment">//ä¸è¦å¿˜è®°()</span><br> <br>    <span class="hljs-comment">//æ­»å¾ªç¯ï¼Œç›®çš„ä¸è®©ä¸»goroutineç»“æŸ</span><br>    <span class="hljs-keyword">for</span> &#123;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231219214022511.png" alt="image-20231219214022511" style="zoom:67%;" /></p>
<p>å¯¹äºgoroutineçš„å½¢å¼æ²¡åŠæ³•æ‹¿åˆ°åç¨‹è¿”å›çš„å€¼
ï¼Œä»è€Œé˜»å¡äº†ä¸¤ä¸ªåç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œå› æ­¤æœ‰å¿…è¦ç ”ç©¶å¦‚ä½•è®©ä¸¤ä¸ªåç¨‹è¿›è¡Œé€šä¿¡çš„æœºåˆ¶å› æ­¤è¿™ä¸ªåœ°æ–¹å¼•å…¥äº†</p>
<h2 id="channelç®¡é“">Channelç®¡é“</h2>
<p>channelæ˜¯Goè¯­è¨€ä¸­çš„ä¸€ä¸ª<strong>æ ¸å¿ƒç±»å‹</strong>ï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆç®¡é“ã€‚å¹¶å‘æ ¸å¿ƒå•å…ƒé€šè¿‡å®ƒå°±å¯ä»¥å‘é€æˆ–è€…æ¥æ”¶æ•°æ®è¿›è¡Œé€šè®¯</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231213150125899.png" alt="goè¯­è¨€ä¹‹é—´çš„goroutineé€šä¿¡æœºåˆ¶" style="zoom:80%;" /></p>
<p>channelæ˜¯ä¸€ä¸ªæ•°æ®ç±»å‹ï¼Œä¸»è¦ç”¨æ¥è§£å†³goç¨‹çš„åŒæ­¥é—®é¢˜ä»¥åŠgoç¨‹ä¹‹é—´æ•°æ®å…±äº«ï¼ˆæ•°æ®ä¼ é€’ï¼‰çš„é—®é¢˜ã€‚å¼•â½¤ç±»å‹
channelå¯ç”¨äº<strong>å¤šä¸ª goroutine
é€šè®¯ã€‚å…¶å†…éƒ¨å®ç°äº†åŒæ­¥ï¼Œç¡®ä¿å¹¶å‘å®‰å…¨</strong>ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231213150927632.png"
alt="åŸºäºchannelçš„åŒæ­¥å¹¶å‘å®‰å…¨" />
<figcaption aria-hidden="true">åŸºäºchannelçš„åŒæ­¥å¹¶å‘å®‰å…¨</figcaption>
</figure>
<p>è¿™ä¸ªchannelåœ¨è¿™ä¸ªä½ç½®å°±å·²ç»éšå«è¡¨ç¤ºäº†å…ˆåæ‰§è¡Œçš„å…³ç³»</p>
<ul>
<li>å¦‚æœmain.goåœ¨è¿è¡Œçš„æ—¶å€™å¦‚æœæ‰¾ä¸åˆ°
channelè¿”å›çš„å€¼ï¼Œé‚£ä¹ˆå°±ä¼šchannelè®©main.goäº§ç”Ÿé˜»å¡ï¼Œ</li>
<li>åŒç†å¯¹äºå¦ä¸€è¾¹çš„sub.goä¹Ÿæ˜¯ä¸€æ ·ï¼Œå¦‚æœæ²¡æœ‰å¦ä¸€ä¸ªgoroutineæ¥æ¥å—å‘å‡ºçš„channelæ•°æ®ï¼Œé‚£ä¹ˆå°±ä¼šä¸€ç›´å¤„äºç­‰å¾…æ¥å—çš„çŠ¶æ€äº§ç”Ÿé˜»å¡ï¼Œ</li>
<li><strong>ç›¸å½“äºé¦–å…ˆå¾—æ¡ä¸Šæ‰‹æ‰èƒ½ç»§ç»­æ‰§è¡Œè¿›ç¨‹</strong></li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231213151022873.png" alt="ä¸»goroutineå‘ç”Ÿé˜»å¡" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231213151129109.png" alt="å­è¿›ç¨‹å‘ç”Ÿé˜»å¡" style="zoom:67%;" /></p>
<h3 id="å®šä¹‰channelåŸºæœ¬è¯­æ³•">å®šä¹‰channelåŸºæœ¬è¯­æ³•</h3>
<p>å®šä¹‰ä¸€ä¸ªchannelæ—¶ï¼Œä¹Ÿéœ€è¦å®šä¹‰å‘é€åˆ°channelçš„å€¼çš„ç±»å‹ã€‚channelå¯ä»¥ä½¿ç”¨å†…ç½®çš„<strong>make()å‡½æ•°</strong>æ¥åˆ›å»ºï¼š</p>
<p><strong>chan</strong>æ˜¯åˆ›å»ºchannelæ‰€éœ€ä½¿ç”¨çš„å…³é”®å­—ã€‚Type
ä»£è¡¨æŒ‡å®šchannelæ”¶å‘æ•°æ®çš„ç±»å‹ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> Type)  <span class="hljs-comment">//ç­‰ä»·äºmake(chan Type, 0)</span><br><span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> Type, capacity)<br></code></pre></td></tr></table></figure>
<p>å½“ å‚æ•°<code>capacity= 0</code> æ—¶ï¼Œchannel
æ˜¯<strong>æ— ç¼“å†²é˜»å¡</strong>è¯»å†™çš„ï¼›å½“<code>capacity &gt; 0</code>
æ—¶ï¼Œchannel <strong>æœ‰ç¼“å†²éé˜»å¡çš„</strong>ï¼Œç›´åˆ°å†™æ»¡
capacityä¸ªå…ƒç´ æ‰é˜»å¡å†™å…¥ã€‚</p>
<p>channeléå¸¸åƒç”Ÿæ´»ä¸­çš„ç®¡é“ï¼Œä¸€è¾¹å¯ä»¥å­˜æ”¾ä¸œè¥¿ï¼Œå¦ä¸€è¾¹å¯ä»¥å–å‡ºä¸œè¥¿ã€‚channelé€šè¿‡æ“ä½œç¬¦
<code>&lt;-</code>
æ¥æ¥æ”¶å’Œå‘é€æ•°æ®ï¼Œ<strong>å‘é€å’Œæ¥æ”¶</strong>æ•°æ®è¯­æ³•ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">channel &lt;- value      <span class="hljs-comment">//å‘é€valueåˆ°channel</span><br>&lt;-channel             <span class="hljs-comment">//æ¥æ”¶å¹¶å°†å…¶ä¸¢å¼ƒ</span><br>x := &lt;-channel        <span class="hljs-comment">//ä»channelä¸­æ¥æ”¶æ•°æ®ï¼Œå¹¶èµ‹å€¼ç»™x</span><br>x, ok := &lt;-channel    <span class="hljs-comment">//åŠŸèƒ½åŒä¸Šï¼ŒåŒæ—¶æ£€æŸ¥é€šé“æ˜¯å¦å·²å…³é—­æˆ–è€…æ˜¯å¦ä¸ºç©º</span><br></code></pre></td></tr></table></figure>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œchannelæ¥æ”¶å’Œå‘é€æ•°æ®éƒ½æ˜¯é˜»å¡çš„ï¼Œé™¤éå¦ä¸€ç«¯å·²ç»å‡†å¤‡å¥½ï¼Œè¿™æ ·å°±ä½¿å¾—goroutineåŒæ­¥å˜çš„æ›´åŠ çš„ç®€å•ï¼Œè€Œ<strong>ä¸éœ€è¦æ˜¾å¼çš„lockã€‚</strong></p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br> <br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;å­goç¨‹ç»“æŸ&quot;</span>)<br> <br>        fmt.Println(<span class="hljs-string">&quot;å­goç¨‹æ­£åœ¨è¿è¡Œâ€¦â€¦&quot;</span>)<br> <br>        c &lt;- <span class="hljs-number">666</span> <span class="hljs-comment">//666å‘é€åˆ°c</span><br>    &#125;()<br> <br>    num := &lt;-c <span class="hljs-comment">//ä»cä¸­æ¥æ”¶æ•°æ®ï¼Œå¹¶èµ‹å€¼ç»™num</span><br> <br>    fmt.Println(<span class="hljs-string">&quot;num = &quot;</span>, num)<br>    fmt.Println(<span class="hljs-string">&quot;main goç¨‹ç»“æŸ&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">goroutine æ­£åœ¨è¿è¡Œ...<br>goroutineç»“æŸ<br>num =  666<br>main goroutine ç»“æŸ...<br></code></pre></td></tr></table></figure>
<p>åˆ†æï¼š</p>
<ul>
<li>é¦–å…ˆç¬¬ä¸€æ­¥ä¼šéœ€è¦å­è¿›ç¨‹å°†666æ”¾è¿›channelä¸­æ‰ä¸ä¼šå‘ç”Ÿé˜»å¡ï¼ŒåŒæ—¶ä¸»è¿›ç¨‹ä¼šåœ¨
<code>num := &lt;-c</code>çš„ä½ç½®è¿›è¡Œç­‰å¾…channelä¸­ä¼ å…¥æ•°æ®</li>
<li>å½“channelä¸­å‡ºç°äº†æ•°æ®ä¹‹åï¼Œé‚£ä¹ˆä¸‹ä¸€æ­¥å°±æ˜¯ä»ä¸­é€‰æ‹©æ•°æ®å¹¶è¿›è¡Œèµ‹å€¼</li>
<li>æœ€åç»“æŸ</li>
</ul>
<h3 id="channelçš„æ— ç¼“å†²é˜»å¡">channelçš„æ— ç¼“å†²é˜»å¡</h3>
<p>æ— ç¼“å†²çš„é€šé“ï¼ˆunbuffered
channelï¼‰æ˜¯æŒ‡åœ¨æ¥æ”¶å‰æ²¡æœ‰èƒ½åŠ›ä¿å­˜ä»»ä½•æ•°æ®å€¼çš„é€šé“ã€‚</p>
<p>è¿™ç§ç±»å‹çš„é€šé“è¦æ±‚å‘é€goroutineå’Œæ¥æ”¶goroutineåŒæ—¶å‡†å¤‡å¥½ï¼Œæ‰èƒ½å®Œæˆå‘é€å’Œæ¥æ”¶æ“ä½œã€‚å¦åˆ™ï¼Œé€šé“ä¼šå¯¼è‡´å…ˆæ‰§è¡Œå‘é€æˆ–æ¥æ”¶æ“ä½œçš„
goroutine é˜»å¡ç­‰å¾…ã€‚</p>
<p><strong>é˜»å¡ï¼š</strong>ç”±äºæŸç§åŸå› æ•°æ®æ²¡æœ‰åˆ°è¾¾ï¼Œå½“å‰goç¨‹ï¼ˆçº¿ç¨‹ï¼‰æŒç»­å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³ï¼Œæ‰è§£é™¤é˜»å¡ã€‚</p>
<p><strong>åŒæ­¥ï¼š</strong>åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªgoç¨‹ï¼ˆçº¿ç¨‹ï¼‰é—´ï¼Œä¿æŒæ•°æ®å†…å®¹ä¸€è‡´æ€§çš„æœºåˆ¶ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231213151511356.png"
alt="æ— ç¼“å†²çš„channelåŒæ­¥" />
<figcaption aria-hidden="true">æ— ç¼“å†²çš„channelåŒæ­¥</figcaption>
</figure>
<p>å¦‚æœä¸¤ä¸ªgoroutineå­˜åœ¨åˆ©ç”¨channelé€šä¿¡çš„æƒ…å†µï¼Œä¸¤ä¸ªgoroutineä¹‹é—´å­˜åœ¨ç›¸äº’çš„æ¶ˆæ¯ä¼ é€’ï¼Œé‚£ä¹ˆåœ¨æ— ç¼“å†²çš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨éšå«çš„å…ˆååŒæ­¥å…³ç³»ï¼Œå¿…é¡»æ¥æ”¶æ–¹åˆ°è¾¾äº†channelä¹‹åæ¶ˆæ¯å‘é€æ–¹æ‰ä¼šæŒç»­å‘é€æ¶ˆæ¯å¹¶å¾€ä¸‹è¿è¡Œ</p>
<ul>
<li>åœ¨ç¬¬ 1 æ­¥ï¼Œä¸¤ä¸ª goroutine
éƒ½åˆ°è¾¾é€šé“ï¼Œä½†å“ªä¸ªéƒ½æ²¡æœ‰å¼€å§‹æ‰§è¡Œå‘é€æˆ–è€…æ¥æ”¶ã€‚</li>
<li>åœ¨ç¬¬ 2 æ­¥ï¼Œå·¦ä¾§çš„ goroutine
å°†å®ƒçš„æ‰‹ä¼¸è¿›äº†é€šé“ï¼Œè¿™æ¨¡æ‹Ÿäº†å‘é€šé“å‘é€æ•°æ®çš„è¡Œä¸ºã€‚è¿™æ—¶ï¼Œè¿™ä¸ª goroutine
ä¼šåœ¨é€šé“ä¸­è¢«é”ä½ï¼Œç›´åˆ°äº¤æ¢å®Œæˆã€‚</li>
<li>åœ¨ç¬¬ 3 æ­¥ï¼Œå³ä¾§çš„ goroutine
å°†å®ƒçš„æ‰‹æ”¾å…¥é€šé“ï¼Œè¿™æ¨¡æ‹Ÿäº†ä»é€šé“é‡Œæ¥æ”¶æ•°æ®ã€‚è¿™ä¸ª goroutine
ä¸€æ ·ä¹Ÿä¼šåœ¨é€šé“ä¸­è¢«é”ä½ï¼Œç›´åˆ°äº¤æ¢å®Œæˆã€‚</li>
<li>åœ¨ç¬¬ 4 æ­¥å’Œç¬¬ 5 æ­¥ï¼Œè¿›è¡Œäº¤æ¢ï¼Œå¹¶æœ€ç»ˆï¼Œåœ¨ç¬¬ 6 æ­¥ï¼Œä¸¤ä¸ª goroutine
éƒ½å°†å®ƒä»¬çš„æ‰‹ä»é€šé“é‡Œæ‹¿å‡ºæ¥ï¼Œè¿™æ¨¡æ‹Ÿäº†è¢«é”ä½çš„ goroutine å¾—åˆ°é‡Šæ”¾ã€‚ä¸¤ä¸ª
goroutine ç°åœ¨éƒ½å¯ä»¥å»åšå…¶ä»–äº‹æƒ…äº†ã€‚</li>
</ul>
<p>æ— ç¼“å†²çš„channelåˆ›å»ºæ ¼å¼ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> Type)   <span class="hljs-comment">//ç­‰ä»·äºmake(chan Type, 0)</span><br></code></pre></td></tr></table></figure>
<p>å¦‚æœ<strong>æ²¡æœ‰æŒ‡å®šç¼“å†²åŒºå®¹é‡</strong>ï¼Œé‚£ä¹ˆè¯¥é€šé“å°±æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤ä¼šé˜»å¡åˆ°å‘é€è€…å‡†å¤‡å¥½å‘é€å’Œæ¥æ”¶è€…å‡†å¤‡å¥½æ¥æ”¶ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;time&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">0</span>) <span class="hljs-comment">//åˆ›å»ºæ— ç¼“å†²çš„é€šé“ c </span><br> <br>    <span class="hljs-comment">//å†…ç½®å‡½æ•° len è¿”å›æœªè¢«è¯»å–çš„ç¼“å†²å…ƒç´ æ•°é‡ï¼Œcap è¿”å›ç¼“å†²åŒºå¤§å°</span><br>    fmt.Printf(<span class="hljs-string">&quot;len(c)=%d, cap(c)=%d\n&quot;</span>, <span class="hljs-built_in">len</span>(c), <span class="hljs-built_in">cap</span>(c))<br> <br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;å­goç¨‹ç»“æŸ&quot;</span>)<br> <br>        <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++ &#123;<br>            c &lt;- i<br>            fmt.Printf(<span class="hljs-string">&quot;å­goç¨‹æ­£åœ¨è¿è¡Œ[%d]: len(c)=%d, cap(c)=%d\n&quot;</span>, i, <span class="hljs-built_in">len</span>(c), <span class="hljs-built_in">cap</span>(c))<br>        &#125;<br>    &#125;()<br> <br>    time.Sleep(<span class="hljs-number">2</span> * time.Second) <span class="hljs-comment">//å»¶æ—¶2s</span><br> <br>    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++ &#123;<br>        num := &lt;-c <span class="hljs-comment">//ä»cä¸­æ¥æ”¶æ•°æ®ï¼Œå¹¶èµ‹å€¼ç»™num</span><br>        fmt.Println(<span class="hljs-string">&quot;num = &quot;</span>, num)<br>    &#125;<br> <br>    fmt.Println(<span class="hljs-string">&quot;mainè¿›ç¨‹ç»“æŸ&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿è¡Œçš„ç»“æœæ˜¯ï¼š</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231219220132461.png" alt="æ— ç¼“å†²channelçš„è¿è¡Œç»“æœ" style="zoom:67%;" /></p>
<p>åˆ†æï¼š</p>
<ul>
<li>æœ¬è´¨ä¸Šä¼šå‡ºç°é˜»å¡ï¼Œå¦‚æœæ²¡æœ‰åŠæ—¶æŠŠæ•°æ®æ‹¿å‡º</li>
<li>å› æ­¤å¿…é¡»æ˜¯å…¶ä¸­ä¸€ä¸ªæ”¾è¿›å»æ•°æ®ï¼Œå¦ä¸€ä¸ªæ‹¿å‡ºæ•°æ®æ‰èƒ½èƒ½è®©è¿›ç¨‹æ‰§è¡Œä¸‹å»ï¼Œæœ¬è´¨ä¸Šä¿è¯äº†åŒæ­¥çš„è¿›è¡Œ</li>
</ul>
<h3 id="channelçš„æœ‰ç¼“å†²é˜»å¡">channelçš„æœ‰ç¼“å†²é˜»å¡</h3>
<blockquote>
<p><strong>æœ¬è´¨ä¸Šæ˜¯ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹</strong></p>
</blockquote>
<p>è¿™ç§ç±»å‹çš„é€šé“å¹¶ä¸å¼ºåˆ¶è¦æ±‚ goroutine
ä¹‹é—´å¿…é¡»åŒæ—¶å®Œæˆå‘é€å’Œæ¥æ”¶ã€‚é€šé“ä¼šé˜»å¡å‘é€å’Œæ¥æ”¶åŠ¨ä½œçš„æ¡ä»¶ä¹Ÿä¸åŒã€‚</p>
<p>åªæœ‰é€šé“ä¸­æ²¡æœ‰è¦æ¥æ”¶çš„å€¼æ—¶ï¼Œæ¥æ”¶åŠ¨ä½œæ‰ä¼šé˜»å¡ã€‚åªæœ‰é€šé“æ²¡æœ‰å¯ç”¨ç¼“å†²åŒºå®¹çº³è¢«å‘é€çš„å€¼æ—¶ï¼Œå‘é€åŠ¨ä½œæ‰ä¼šé˜»å¡ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231219220401111.png"
alt="æœ‰ç¼“å†²çš„é€šé“åœ¨channeä¹‹é—´åŒæ­¥æ•°æ®" />
<figcaption
aria-hidden="true">æœ‰ç¼“å†²çš„é€šé“åœ¨channeä¹‹é—´åŒæ­¥æ•°æ®</figcaption>
</figure>
<ul>
<li>åœ¨ç¬¬ 1 æ­¥ï¼Œå³ä¾§çš„ goroutine æ­£åœ¨ä»é€šé“æ¥æ”¶ä¸€ä¸ªå€¼ã€‚</li>
<li>åœ¨ç¬¬ 2 æ­¥ï¼Œå³ä¾§çš„è¿™ä¸ª goroutineç‹¬ç«‹å®Œæˆäº†æ¥æ”¶å€¼çš„åŠ¨ä½œï¼Œè€Œå·¦ä¾§çš„
goroutine æ­£åœ¨å‘é€ä¸€ä¸ªæ–°å€¼åˆ°é€šé“é‡Œã€‚</li>
<li>åœ¨ç¬¬ 3 æ­¥ï¼Œå·¦ä¾§çš„goroutine è¿˜åœ¨å‘é€šé“å‘é€æ–°å€¼ï¼Œè€Œå³ä¾§çš„ goroutine
æ­£åœ¨ä»é€šé“æ¥æ”¶å¦å¤–ä¸€ä¸ªå€¼ã€‚è¿™ä¸ªæ­¥éª¤é‡Œçš„ä¸¤ä¸ªæ“ä½œ<strong>æ—¢ä¸æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸ä¼šäº’ç›¸é˜»å¡</strong>ã€‚</li>
<li>æœ€åï¼Œåœ¨ç¬¬ 4
æ­¥ï¼Œæ‰€æœ‰çš„å‘é€å’Œæ¥æ”¶éƒ½å®Œæˆï¼Œè€Œé€šé“é‡Œè¿˜æœ‰å‡ ä¸ªå€¼ï¼Œä¹Ÿæœ‰ä¸€äº›ç©ºé—´å¯ä»¥å­˜æ›´å¤šçš„å€¼ã€‚</li>
</ul>
<p><strong>æœ‰ç¼“å†²çš„channelåˆ›å»ºæ ¼å¼ï¼š</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> Type, capacity)<br></code></pre></td></tr></table></figure>
<p>å¦‚æœç»™å®šäº†ä¸€ä¸ªç¼“å†²åŒºå®¹é‡ï¼Œé€šé“å°±æ˜¯å¼‚æ­¥çš„ã€‚åªè¦ç¼“å†²åŒºæœ‰æœªä½¿ç”¨ç©ºé—´ç”¨äºå‘é€æ•°æ®ï¼Œæˆ–è¿˜åŒ…å«å¯ä»¥æ¥æ”¶çš„æ•°æ®ï¼Œé‚£ä¹ˆå…¶é€šä¿¡å°±ä¼šæ— é˜»å¡åœ°è¿›è¡Œã€‚</p>
<p><strong>å‡½æ•° len(ch)æ±‚å–ç¼“å†²åŒºä¸­å‰©ä½™å…ƒç´ ä¸ªæ•°ï¼Œ cap(ch)
æ±‚å–ç¼“å†²åŒºå…ƒç´ å®¹é‡å¤§å°</strong></p>
<p>ç¤ºä¾‹ä»£ç </p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span>  <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span> ,<span class="hljs-number">3</span>) <span class="hljs-comment">//å¸¦æœ‰ç¼“å†²çš„channel</span><br><br>	<span class="hljs-comment">//æŸ¥çœ‹å½“å‰çš„channelä¸­çš„ç¼“å†²çš„å®¹é‡å¤§å°</span><br>	<span class="hljs-comment">//lenè¡¨ç¤ºçš„æ˜¯å…ƒç´ æ•°é‡ capè¡¨ç¤ºçš„æ˜¯ç¼“å†²çš„å®¹é‡å¤§å°</span><br>	fmt.Println(<span class="hljs-string">&quot;len(c) = &quot;</span>, <span class="hljs-built_in">len</span>(c), <span class="hljs-string">&quot;, cap(c)&quot;</span>, <span class="hljs-built_in">cap</span>(c))<br><br>	<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå­goroutine</span><br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>&#123;<br>		<span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;sub goroutineç»“æŸ&quot;</span>)<br>		<br>		<span class="hljs-comment">// for i := 0; i&lt;3; i++&#123;</span><br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; i++&#123;<span class="hljs-comment">// è¿™ç§æƒ…å†µå°±ä¼šå‡ºç°é˜»å¡ï¼Œå› ä¸ºè¶…è¿‡äº†ç¼“å†²çš„å®¹é‡</span><br>			c &lt;- i<br>			fmt.Println(<span class="hljs-string">&quot;sub goroutine æ­£åœ¨è¿è¡Œ: len(c) = &quot;</span>, <span class="hljs-built_in">len</span>(c), <span class="hljs-string">&quot;, cap(c) =  &quot;</span>, <span class="hljs-built_in">cap</span>(c),<span class="hljs-string">&quot; å‘é€çš„å…ƒç´ æ˜¯= &quot;</span>,i)<br>		&#125;<br>	&#125;()<br><br>	time.Sleep(<span class="hljs-number">1</span>*time.Second)<br><br>	<span class="hljs-comment">//æœ‰ç¼“å­˜çš„è¯å°±ä¸ä¼šå‡ºç°é˜»å¡çš„æƒ…å†µ</span><br><br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">3</span>;i++&#123;<br>		num := &lt;-c <span class="hljs-comment">//ä»cä¸­æ¥å—æ•°æ®å¹¶èµ‹å€¼ç»™num</span><br>		fmt.Println(<span class="hljs-string">&quot;num = &quot;</span>, num)<br>	&#125;<br>	fmt.Println(<span class="hljs-string">&quot;main ç»“æŸ&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231219220650672.png"
alt="æœ‰ç¼“å†²é€šé“çš„è¿è¡Œç»“æœ" />
<figcaption aria-hidden="true">æœ‰ç¼“å†²é€šé“çš„è¿è¡Œç»“æœ</figcaption>
</figure>
<h3 id="å…³é—­channel">å…³é—­Channel</h3>
<p>æ²¡æœ‰æ›´å¤šçš„å€¼éœ€è¦å‘é€åˆ°channelçš„è¯ï¼Œé‚£ä¹ˆè®©æ¥æ”¶è€…ä¹Ÿèƒ½åŠæ—¶çŸ¥é“æ²¡æœ‰å¤šä½™çš„å€¼å¯æ¥æ”¶å°†æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºæ¥æ”¶è€…å¯ä»¥åœæ­¢ä¸å¿…è¦çš„æ¥æ”¶ç­‰å¾…ã€‚è¿™å¯ä»¥é€šè¿‡å†…ç½®çš„<code>close</code>å‡½æ•°æ¥å…³é—­channelå®ç°ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>) <span class="hljs-comment">//channelè¦é€šè¿‡makeæ¥è§¦å‘ï¼Œå¦‚æœæ˜¯nil channel ä¼šå‘ç”Ÿé˜»å¡</span><br><br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>&#123;<br>		<span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">&quot;sub finished ...&quot;</span>)<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>;i&lt;<span class="hljs-number">5</span>;i++&#123;<br>			c &lt;- i<br>			<span class="hljs-comment">// close(c)</span><br>			<span class="hljs-comment">//å¦‚æœå‘å·²ç»å…³é—­çš„channelå‘é€æ•°æ®å°±ä¼šå‡ºç°panicçš„é”™è¯¯</span><br>		&#125;<br>		<span class="hljs-comment">// close å…³é—­ä¸€ä¸ªchannel</span><br>		<span class="hljs-built_in">close</span>(c)<br>		<span class="hljs-comment">//å¦‚æœå»æ‰å…³é—­channelè¿™ä¸ªå¼€å…³ï¼Œé‚£ä¹ˆä¼šå‡ºç°æ­»é”çš„æƒ…å†µï¼Œå°±æ˜¯mainçš„è¿›ç¨‹æ•°æ®éƒ½åœ¨ç­‰å¾…å¡æ•°æ®</span><br>	&#125;()<br><br>	<span class="hljs-keyword">for</span>&#123;<br>		<span class="hljs-comment">//å¦‚æœokä¸ºture é‚£ä¹ˆchannelæ²¡æœ‰å…³é—­, å¦‚æœä¸ºfalse é‚£ä¹ˆå·²ç»è¢«å…³é—­</span><br>		<span class="hljs-keyword">if</span> data, ok := &lt;-c; ok&#123;<br>			fmt.Println(data)<br>		&#125;<span class="hljs-keyword">else</span>&#123;<br>			<span class="hljs-keyword">break</span><br>		&#125;<br>	&#125;<br><br>	fmt.Println(<span class="hljs-string">&quot;Main finished ...&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„ç»“æœï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">/* è¾“å‡ºçš„å€¼go run channel4.go<br>0<br>1<br>2<br>3<br>4<br>Main finished ...<br>sub finished ... */<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>channelä¸åƒæ–‡ä»¶ä¸€æ ·éœ€è¦ç»å¸¸å»å…³é—­ï¼Œåªæœ‰å½“ä½ ç¡®å®æ²¡æœ‰ä»»ä½•å‘é€æ•°æ®äº†ï¼Œæˆ–è€…ä½ æƒ³æ˜¾å¼çš„ç»“æŸrangeå¾ªç¯ä¹‹ç±»çš„ï¼Œæ‰å»å…³é—­channelï¼›</li>
<li>å¦‚æœå‘å·²ç»å…³é—­çš„channelå‘é€æ•°æ®å°±ä¼šå‡ºç°panicçš„é”™è¯¯</li>
<li>å…³é—­channelåï¼Œå¯ä»¥ç»§ç»­ä»channelæ¥æ”¶æ•°æ®ï¼›</li>
<li>å¦‚æœokä¸ºture é‚£ä¹ˆchannelæ²¡æœ‰å…³é—­, å¦‚æœä¸ºfalse é‚£ä¹ˆå·²ç»è¢«å…³é—­</li>
<li>å¯¹äºnil channelï¼Œæ— è®ºæ”¶å‘éƒ½ä¼šè¢«é˜»å¡ã€‚</li>
</ul>
<h3 id="rangeæ“ä½œchannel">Rangeæ“ä½œchannel</h3>
<p>å¯ä»¥ä½¿ç”¨ <strong>range</strong> æ¥è¿­ä»£ä¸æ–­æ“ä½œchannelï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br> <br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ &#123;<br>            c &lt;- i<br>        &#125;<br>        <span class="hljs-built_in">close</span>(c)<br>    &#125;()<br> <br>    <span class="hljs-keyword">for</span> data := <span class="hljs-keyword">range</span> c &#123;<br>        fmt.Println(data)<br>    &#125;<br>    fmt.Println(<span class="hljs-string">&quot;Finished&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼š</p>
<ul>
<li><p>åˆ©ç”¨rangeè¿›è¡Œç®€å†™</p></li>
<li><p>åˆ©ç”¨rangeä¸æ–­è¿­ä»£ä»channelä¸­æ“ä½œæ•°æ®</p></li>
</ul>
<h3 id="å•å‘channel">å•å‘Channel</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé€šé“channelæ˜¯åŒå‘çš„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ—¢å¯ä»¥å¾€é‡Œé¢å‘é€æ•°æ®ä¹Ÿå¯ä»¥åŒé‡Œé¢æ¥æ”¶æ•°æ®ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬ç»å¸¸è§ä¸€ä¸ªé€šé“ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’è€Œåªå¸Œæœ›å¯¹æ–¹æ˜¯å•å‘ä½¿ç”¨çš„ï¼Œè¦ä¹ˆåªè®©å®ƒå‘é€æ•°æ®ï¼Œè¦ä¹ˆåªè®©å®ƒæ¥æ”¶æ•°æ®ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥æŒ‡å®šé€šé“çš„æ–¹å‘ã€‚</p>
<p>å•å‘channelçš„å®šä¹‰ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> ch1 <span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>       <span class="hljs-comment">// ch1æ˜¯ä¸€ä¸ªæ­£å¸¸çš„channelï¼Œæ˜¯åŒå‘çš„</span><br><span class="hljs-keyword">var</span> ch2 <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-type">float64</span> <span class="hljs-comment">// ch2æ˜¯å•å‘channelï¼Œåªç”¨äºå†™float64æ•°æ®</span><br><span class="hljs-keyword">var</span> ch3 &lt;-<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>     <span class="hljs-comment">// ch3æ˜¯å•å‘channelï¼Œåªç”¨äºè¯»intæ•°æ®</span><br></code></pre></td></tr></table></figure>
<p>å¯ä»¥å°† channel éšå¼è½¬æ¢ä¸ºå•å‘é˜Ÿåˆ—ï¼Œåªæ”¶æˆ–åªå‘ï¼Œä¸èƒ½å°†å•å‘ channel
è½¬æ¢ä¸ºæ™®é€š channelï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">3</span>)<br><span class="hljs-keyword">var</span> send <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-type">int</span> = c <span class="hljs-comment">// send-only</span><br><span class="hljs-keyword">var</span> recv &lt;-<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span> = c <span class="hljs-comment">// receive-only</span><br>send &lt;- <span class="hljs-number">1</span><br><span class="hljs-comment">//&lt;-send //invalid operation: &lt;-send (receive from send-only type chan&lt;- int)</span><br>&lt;-recv<br><span class="hljs-comment">//recv &lt;- 2 //invalid operation: recv &lt;- 2 (send to receive-only type &lt;-chan int)</span><br> <br><span class="hljs-comment">//ä¸èƒ½å°†å•å‘ channel è½¬æ¢ä¸ºæ™®é€š channel</span><br>d1 := (<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)(send) <span class="hljs-comment">//cannot convert send (type chan&lt;- int) to type chan int</span><br>d2 := (<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)(recv) <span class="hljs-comment">//cannot convert recv (type &lt;-chan int) to type chan int</span><br></code></pre></td></tr></table></figure>
<p>å•å‘channelçš„ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//   chan&lt;- //åªå†™</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">counter</span><span class="hljs-params">(out <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-type">int</span>)</span></span> &#123;<br>    <span class="hljs-keyword">defer</span> <span class="hljs-built_in">close</span>(out)<br>    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ &#123;<br>        out &lt;- i <span class="hljs-comment">//å¦‚æœå¯¹æ–¹ä¸è¯» ä¼šé˜»å¡</span><br>    &#125;<br>&#125;<br> <br><span class="hljs-comment">//   &lt;-chan //åªè¯»</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">printer</span><span class="hljs-params">(in &lt;-<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)</span></span> &#123;<br>    <span class="hljs-keyword">for</span> num := <span class="hljs-keyword">range</span> in &#123;<br>        fmt.Println(num)<br>    &#125;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>) <span class="hljs-comment">//   chan   //è¯»å†™</span><br> <br>    <span class="hljs-keyword">go</span> counter(c) <span class="hljs-comment">//ç”Ÿäº§è€…</span><br>    printer(c)    <span class="hljs-comment">//æ¶ˆè´¹è€…</span><br> <br>    fmt.Println(<span class="hljs-string">&quot;done&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="channelçš„select">Channelçš„Select</h2>
<h3 id="selectåŸºæœ¬å®šä¹‰">SelectåŸºæœ¬å®šä¹‰</h3>
<p>Goé‡Œé¢æä¾›äº†ä¸€ä¸ªå…³é”®å­—selectï¼Œé€šè¿‡selectå¯ä»¥ç›‘å¬channelä¸Šçš„æ•°æ®æµåŠ¨ã€‚æ¯ä¸ªcaseè¡¨ç¤ºç›‘æ§ä¸åŒçš„æ¡ä»¶.
é€šè¿‡selectæ¥è¿›è¡Œæ§åˆ¶ã€‚</p>
<p>selectæœ‰æ¯”è¾ƒå¤šçš„é™åˆ¶ï¼Œå…¶ä¸­æœ€å¤§çš„ä¸€æ¡é™åˆ¶å°±æ˜¯æ¯ä¸ª<strong>caseè¯­å¥é‡Œå¿…é¡»æ˜¯ä¸€ä¸ªIOæ“ä½œ</strong>ï¼Œå¤§è‡´çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">select</span> &#123;<br><span class="hljs-keyword">case</span> &lt;- chan1:<br>    <span class="hljs-comment">// å¦‚æœchan1æˆåŠŸè¯»åˆ°æ•°æ®ï¼Œåˆ™è¿›è¡Œè¯¥caseå¤„ç†è¯­å¥</span><br><span class="hljs-keyword">case</span> chan2 &lt;- <span class="hljs-number">1</span>:<br>    <span class="hljs-comment">// å¦‚æœæˆåŠŸå‘chan2å†™å…¥æ•°æ®ï¼Œåˆ™è¿›è¡Œè¯¥caseå¤„ç†è¯­å¥</span><br><span class="hljs-keyword">default</span>:<br>    <span class="hljs-comment">// å¦‚æœä¸Šé¢éƒ½æ²¡æœ‰æˆåŠŸï¼Œåˆ™è¿›å…¥defaultå¤„ç†æµç¨‹</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>åœ¨ä¸€ä¸ªselectè¯­å¥ä¸­ï¼ŒGoè¯­è¨€ä¼šæŒ‰é¡ºåº<strong>ä»å¤´è‡³å°¾</strong>è¯„ä¼°æ¯ä¸€ä¸ªå‘é€å’Œæ¥æ”¶çš„è¯­å¥ã€‚å¦‚æœå…¶ä¸­çš„<strong>ä»»æ„ä¸€è¯­å¥å¯ä»¥ç»§ç»­æ‰§è¡Œ</strong>(å³æ²¡æœ‰è¢«é˜»å¡)ï¼Œé‚£ä¹ˆå°±ä»é‚£äº›å¯ä»¥æ‰§è¡Œçš„è¯­å¥ä¸­ä»»æ„é€‰æ‹©ä¸€æ¡æ¥ä½¿ç”¨ã€‚</p>
<p>å¦‚æœ<strong>æ²¡æœ‰ä»»æ„ä¸€æ¡è¯­å¥å¯ä»¥æ‰§è¡Œ</strong>(å³æ‰€æœ‰çš„é€šé“éƒ½è¢«é˜»å¡)ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§å¯èƒ½çš„æƒ…å†µï¼š</p>
<ol type="1">
<li>å¦‚æœç»™å‡ºäº†defaultè¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œdefaultè¯­å¥ï¼ŒåŒæ—¶ç¨‹åºçš„æ‰§è¡Œä¼šä»selectè¯­å¥åçš„è¯­å¥ä¸­æ¢å¤</li>
<li>å¦‚æœæ²¡æœ‰defaultè¯­å¥ï¼Œé‚£ä¹ˆselectè¯­å¥å°†è¢«é˜»å¡ï¼Œç›´åˆ°è‡³å°‘æœ‰ä¸€ä¸ªé€šä¿¡å¯ä»¥è¿›è¡Œä¸‹å»</li>
</ol>
<p>ä¸‹é¢æ˜¯<strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br> <br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fibonacci</span><span class="hljs-params">(c, quit <span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)</span></span> &#123;<br>    x, y := <span class="hljs-number">1</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> &#123;<br>        <span class="hljs-keyword">select</span> &#123;<br>        <span class="hljs-keyword">case</span> c &lt;- x:<br>            x, y = y, x+y<br>        <span class="hljs-keyword">case</span> &lt;-quit:<br>            fmt.Println(<span class="hljs-string">&quot;quit&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        &#125;<br>    &#125;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br>    quit := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br> <br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; i++ &#123;<br>            fmt.Println(&lt;-c)<br>        &#125;<br>        quit &lt;- <span class="hljs-number">0</span><br>    &#125;()<br> <br>    fibonacci(c, quit)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œçš„ç»“æœï¼š</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231220211918321.png" alt="æ‰§è¡Œçš„ç»“æœ" style="zoom:70%;" /></p>
<h3 id="äº¤æ›¿æ‰“å°æ•°å­—å­—æ¯">äº¤æ›¿æ‰“å°æ•°å­—å­—æ¯</h3>
<p>éœ€æ±‚ï¼šåå¤æ‰“å°æ•°å­—1å­—æ¯a-&gt;1a2b3c4d5e...ä¾æ¬¡ç±»æ¨</p>
<p>æ€è·¯ï¼šé€‰æ‹©ä¸¤ä¸ªgoroutineæ¥å®ç°è¿™éƒ¨åˆ†çš„å†…å®¹ï¼Œäº§ç”Ÿé˜»å¡çš„æ¡ä»¶æ˜¯ä¸€ä¸ªè¿›ç¨‹éœ€è¦å–æ•°ï¼Œä¸€ä¸ªgoroutineéœ€è¦å­˜æ•°æ¥è¿›è¡Œé˜»å¡</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br><br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">26</span>; i++ &#123;<br>			&lt;-c<br>			fmt.Println(<span class="hljs-type">string</span>(<span class="hljs-number">96</span> + i))<br>			c &lt;- <span class="hljs-number">0</span><br>		&#125;<br>	&#125;()<br><br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">26</span>; i++ &#123;<br>			fmt.Println(i)<br>			c &lt;- <span class="hljs-number">0</span><br>			&lt;-c<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‰“å°çš„ç»“æœæ˜¯ï¼š</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231220214320935.png" alt="æ•°å­—å­—æ¯äº¤æ›¿æ‰“å°" style="zoom:70%;" /></p>
]]></content>
      <categories>
        <category>åç«¯å¼€å‘</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç®—æ³•é¢˜ã€‘LeetCodeç®—æ³•æ±‡æ€»</title>
    <url>/2024/01/01/leetcode/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="è¯­è¨€ç»†èŠ‚">è¯­è¨€ç»†èŠ‚</h1>
<p>vectorçš„é•¿åº¦ï¼š</p>
<ul>
<li>C++ï¼šnums.size()</li>
<li>Pythonï¼šlen(nums)</li>
<li>GOï¼šlen(nums)</li>
</ul>
<p>åˆå§‹åŒ–æ•°ç»„ï¼š</p>
<ul>
<li>C++ï¼šarray[n]={0} è®©æ‰€æœ‰å…ƒç´ éƒ½æ˜¯0</li>
</ul>
<p>æ„é€ vector:</p>
<ul>
<li>C++ï¼švector result(é•¿åº¦ï¼Œå…ƒç´ )</li>
<li>Pythonï¼šres = [float('inf')] * len(nums)</li>
<li>GOï¼š=make([]intï¼Œn)</li>
</ul>
<p>forå¾ªç¯ï¼š</p>
<ul>
<li>C++ï¼šæ¡ä»¶å°æ‹¬å·+å¾ªç¯ä½“ä¸­æ‹¬å·</li>
<li>Pythonï¼šå†’å·ä¸”ä¸éœ€è¦å°æ‹¬å·åŒ…æ¡ä»¶</li>
<li>GOï¼šå¾ªç¯ä½“ä¸­æ‹¬å·ï¼Œæ¡ä»¶æŒ‰ç…§C++å†™ä½†æ˜¯ä¸éœ€è¦å°æ‹¬å·</li>
</ul>
<h1 id="æ•°ç»„">æ•°ç»„</h1>
<h3 id="äºŒåˆ†æŸ¥æ‰¾">äºŒåˆ†æŸ¥æ‰¾</h3>
<p><strong>é¢˜ç›®æè¿°</strong></p>
<p>é“¾æ¥ï¼š<a
href="https://leetcode.cn/problems/binary-search/description/">https://leetcode.cn/problems/binary-search/description/</a></p>
<p>ç»™å®šä¸€ä¸ª n ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target
ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å›
-1ã€‚</p>
<p><strong>ç¤ºä¾‹ 1:</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">è¾“å…¥: nums = [-1,0,3,5,9,12], target = 9</span><br><span class="hljs-section">è¾“å‡º: 4</span><br><span class="hljs-section">è§£é‡Š: 9 å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º 4</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2:</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">è¾“å…¥: nums = [-1,0,3,5,9,12], target = 2</span><br><span class="hljs-section">è¾“å‡º: -1</span><br><span class="hljs-section">è§£é‡Š: 2 ä¸å­˜åœ¨ nums ä¸­å› æ­¤è¿”å› -1</span><br></code></pre></td></tr></table></figure>
<p><strong>æ€è·¯</strong></p>
<p>é¢˜ç›®è¡¨ç¤ºçš„æ˜¯æœ‰åºæ•°ç»„ï¼Œè€Œä¸”é¢˜ç›®æ²¡æœ‰é‡å¤å…ƒç´ ã€‚åœ¨äºŒåˆ†æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œä¿æŒä¸å˜é‡ï¼Œå°±æ˜¯åœ¨whileå¯»æ‰¾ä¸­æ¯ä¸€æ¬¡è¾¹ç•Œçš„å¤„ç†éƒ½è¦åšæŒæ ¹æ®åŒºé—´çš„å®šä¹‰æ¥æ“ä½œï¼Œè¿™å°±æ˜¯<strong>å¾ªç¯ä¸å˜é‡</strong>è§„åˆ™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>], target: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        left, right = <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(nums) - <span class="hljs-number">1</span>  <span class="hljs-comment"># å®šä¹‰targetåœ¨å·¦é—­å³é—­çš„åŒºé—´é‡Œï¼Œ[left, right]</span><br><br>        <span class="hljs-keyword">while</span> left &lt;= right:<br>            middle = left + (right - left) // <span class="hljs-number">2</span><br>            <br>            <span class="hljs-keyword">if</span> nums[middle] &gt; target:<br>                right = middle - <span class="hljs-number">1</span>  <span class="hljs-comment"># targetåœ¨å·¦åŒºé—´ï¼Œæ‰€ä»¥[left, middle - 1]</span><br>            <span class="hljs-keyword">elif</span> nums[middle] &lt; target:<br>                left = middle + <span class="hljs-number">1</span>  <span class="hljs-comment"># targetåœ¨å³åŒºé—´ï¼Œæ‰€ä»¥[middle + 1, right]</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> middle  <span class="hljs-comment"># æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œç›´æ¥è¿”å›ä¸‹æ ‡</span><br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>  <span class="hljs-comment"># æœªæ‰¾åˆ°ç›®æ ‡å€¼</span><br></code></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œç»™å‡ºçš„é¢˜è§£æ³•ï¼šå½“
<code>left &lt;= right</code>çš„æ—¶å€™ï¼Œä»¥ä¸‹çš„æ¡ä»¶ä¸­å…¨éƒ¨éƒ½ä¸å–åˆ°ç­‰å·
<code>nums[middle] &gt; target nums[middle] &lt; target</code></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>right=nums.size()-1</code></p>
<p>C++ç‰ˆæœ¬</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">search</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> target)</span> </span>&#123;<br>        <span class="hljs-type">int</span> left=<span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> right=nums.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">while</span>(left&lt;=right)<br>        &#123;<br>            <span class="hljs-comment">// int middle = (left+right)/2; è¿™æ ·å†™ä¼šæº¢å‡º</span><br>            <span class="hljs-type">int</span> middle = left + ((right - left) / <span class="hljs-number">2</span>);<br>            <span class="hljs-keyword">if</span>(nums[middle]&gt;target)<br>            &#123;<br>                right = middle<span class="hljs-number">-1</span>;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[middle]&lt;target)<br>            &#123;<br>                left = middle+<span class="hljs-number">1</span>;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">return</span> middle;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>Goç‰ˆæœ¬</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">search</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    right:=<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span><br>    left:=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> left&lt;=right&#123;<br>        middle:= left+(right-left)/<span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> nums[middle]&lt;target&#123;<br>            left = middle+<span class="hljs-number">1</span><br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> nums[middle]&gt;target&#123;<br>            right = middle<span class="hljs-number">-1</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> middle<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="ç§»é™¤å…ƒç´ ">ç§»é™¤å…ƒç´ </h3>
<p><a
href="https://leetcode.cn/problems/remove-element/description/">https://leetcode.cn/problems/remove-element/description/</a></p>
<p><strong>é¢˜ç›®æè¿°</strong></p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[3,2,2,3]</span>, val = 3<br>è¾“å‡ºï¼š2, nums = <span class="hljs-comment">[2,2]</span><br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡½æ•°è¿”å›çš„æ–°é•¿åº¦ä¸º 2 ï¼Œè€Œ nums = <span class="hljs-comment">[2,2,3,3]</span> æˆ– nums = <span class="hljs-comment">[2,2,0,0]</span>ï¼Œä¹Ÿä¼šè¢«è§†ä½œæ­£ç¡®ç­”æ¡ˆã€‚<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šnums = [<span class="hljs-number">0,1,2,2</span>,<span class="hljs-number">3,0,4,2</span>], val = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š<span class="hljs-number">5</span>, nums = [<span class="hljs-number">0,1,3,0</span>,<span class="hljs-number">4</span>]<br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ <span class="hljs-number">5</span>, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>ã€‚æ³¨æ„è¿™äº”ä¸ªå…ƒç´ å¯ä¸ºä»»æ„é¡ºåºã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚<br></code></pre></td></tr></table></figure>
<p><strong>æ€è·¯</strong></p>
<p>åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰ï¼š
<strong>é€šè¿‡ä¸€ä¸ªå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆåœ¨ä¸€ä¸ªforå¾ªç¯ä¸‹å®Œæˆä¸¤ä¸ªforå¾ªç¯çš„å·¥ä½œã€‚</strong></p>
<p>å®šä¹‰å¿«æ…¢æŒ‡é’ˆ</p>
<ul>
<li>å¿«æŒ‡é’ˆï¼šå¯»æ‰¾æ–°æ•°ç»„çš„å…ƒç´  ï¼Œæ–°æ•°ç»„å°±æ˜¯ä¸å«æœ‰ç›®æ ‡å…ƒç´ çš„æ•°ç»„</li>
<li>æ…¢æŒ‡é’ˆï¼šæŒ‡å‘æ›´æ–° æ–°æ•°ç»„ä¸‹æ ‡çš„ä½ç½®</li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240111141316267.png" alt="åŒæŒ‡é’ˆé¢˜è§£" style="zoom:67%;" /></p>
<p>C++ç‰ˆæœ¬</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">removeElement</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> val)</span> </span>&#123;<br>        <span class="hljs-type">int</span> slowindex=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> fastindex = <span class="hljs-number">0</span>; fastindex&lt;nums.<span class="hljs-built_in">size</span>();fastindex++)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(val!=nums[fastindex])&#123;<br>                nums[slowindex] = nums[fastindex];<br>                slowindex++;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> slowindex;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>pythonç‰ˆæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeElement</span>(<span class="hljs-params">self, nums, val</span>):<br>        slowindex=<span class="hljs-number">0</span><br>        fastindex=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> fastindex&lt;<span class="hljs-built_in">len</span>(nums):<br>            <span class="hljs-keyword">if</span> val!=nums[fastindex]:<br>                nums[slowindex]=nums[fastindex]<br>                slowindex = slowindex+<span class="hljs-number">1</span><br>            fastindex+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> slowindex        <br></code></pre></td></tr></table></figure>
<p>GOç‰ˆæœ¬ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">removeElement</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, val <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    slow:=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">len</span>(nums);i++&#123;<br>        <span class="hljs-keyword">if</span> nums[i]!=val&#123;<br>            nums[slow]=nums[i]<br>            slow++<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> slow<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="æœ‰åºæ•°ç»„çš„å¹³æ–¹">æœ‰åºæ•°ç»„çš„å¹³æ–¹</h3>
<p><a
href="https://leetcode.cn/problems/squares-of-a-sorted-array/">https://leetcode.cn/problems/squares-of-a-sorted-array/</a></p>
<p><strong>é¢˜ç›®æè¿°</strong></p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šnums = [-<span class="hljs-number">4</span>,-<span class="hljs-number">1,0,3,10</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">0,1,9,16</span>,<span class="hljs-number">100</span>]<br>è§£é‡Šï¼šå¹³æ–¹åï¼Œæ•°ç»„å˜ä¸º [<span class="hljs-number">16,1,0,9</span>,<span class="hljs-number">100</span>]<br>æ’åºåï¼Œæ•°ç»„å˜ä¸º [<span class="hljs-number">0,1,9,16</span>,<span class="hljs-number">100</span>]<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šnums = [-<span class="hljs-number">7</span>,-<span class="hljs-number">3,2,3,11</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">4,9,9,49</span>,<span class="hljs-number">121</span>]<br></code></pre></td></tr></table></figure>
<p><strong>æ€è·¯</strong></p>
<p>åŒæŒ‡é’ˆæ³•ï¼Œé¦–å°¾éå†æ¯”è¾ƒå¹¶å­˜å‚¨</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240111144022821.png"
alt="åŒæŒ‡é’ˆéå†å­˜å‚¨" />
<figcaption aria-hidden="true">åŒæŒ‡é’ˆéå†å­˜å‚¨</figcaption>
</figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">sortedSquares</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">result</span><span class="hljs-params">(nums.size(),<span class="hljs-number">0</span>)</span></span>;<br>        <span class="hljs-type">int</span> j = nums.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;<br>        <span class="hljs-type">int</span> k =j;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ;i&lt;=j;)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(nums[i]*nums[i]&gt;nums[j]*nums[j])&#123;<br>                result[k--]= nums[i]*nums[i];<br>                i++;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                result[k--]= nums[j]*nums[j];<br>                j--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>Python:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sortedSquares</span>(<span class="hljs-params">self, nums</span>):<br>        l, r, i = <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(nums)-<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(nums)-<span class="hljs-number">1</span><br>        res = [<span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)] * <span class="hljs-built_in">len</span>(nums) <span class="hljs-comment"># éœ€è¦æå‰å®šä¹‰åˆ—è¡¨ï¼Œå­˜æ”¾ç»“æœ</span><br>        <span class="hljs-keyword">while</span> l&lt;=r :<br>            <span class="hljs-keyword">if</span> nums[l]*nums[l] &lt; nums[r]*nums[r] :<br>                res[i--]=nums[r]*nums[r]<br>                r--<br>            <span class="hljs-keyword">else</span>:<br>                res[i--]=nums[l]*nums[l]<br>                l++<br>        <span class="hljs-keyword">return</span> <br></code></pre></td></tr></table></figure>
<p>GO:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sortedSquares</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> []<span class="hljs-type">int</span> &#123;<br>	n := <span class="hljs-built_in">len</span>(nums)<br>	i, j, k := <span class="hljs-number">0</span>, n<span class="hljs-number">-1</span>, n<span class="hljs-number">-1</span><br>	ans := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, n)<br>	<span class="hljs-keyword">for</span> i &lt;= j &#123;<br>		lm, rm := nums[i]*nums[i], nums[j]*nums[j]<br>		<span class="hljs-keyword">if</span> lm &gt; rm &#123;<br>			ans[k] = lm<br>			i++<br>		&#125; <span class="hljs-keyword">else</span> &#123;<br>			ans[k] = rm<br>			j--<br>		&#125;<br>		k--<br>	&#125;<br>	<span class="hljs-keyword">return</span> ans<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="é•¿åº¦æœ€å°çš„å­æ•°ç»„">é•¿åº¦æœ€å°çš„å­æ•°ç»„</h3>
<p><a
href="https://leetcode.cn/problems/minimum-size-subarray-sum/description/">https://leetcode.cn/problems/minimum-size-subarray-sum/description/</a></p>
<p><strong>é¢˜ç›®æè¿°</strong></p>
<p>ç»™å®šä¸€ä¸ªå«æœ‰ <code>n</code> ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•°
<code>target</code> <strong>ã€‚</strong></p>
<p>æ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶æ€»å’Œå¤§äºç­‰äº <code>target</code> çš„é•¿åº¦æœ€å°çš„
<strong>è¿ç»­å­æ•°ç»„</strong>
<code>[numsl, numsl+1, ..., numsr-1, numsr]</code>
ï¼Œå¹¶è¿”å›å…¶é•¿åº¦<strong>ã€‚</strong>å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å›
<code>0</code> ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼štarget = 7, nums = <span class="hljs-comment">[2,3,1,2,4,3]</span><br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šå­æ•°ç»„ <span class="hljs-comment">[4,3]</span> æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><code class="hljs aspectj">è¾“å…¥ï¼š<span class="hljs-keyword">target</span> = <span class="hljs-number">4</span>, nums = [<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼štarget = <span class="hljs-number">11</span>, nums = [<span class="hljs-number">1,1,1,1</span>,<span class="hljs-number">1,1,1,1</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<p><strong>æ€è·¯</strong></p>
<p>æ»‘åŠ¨çª—å£æ³•</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240111153940915.png" alt="æ»‘åŠ¨çª—å£æ³•" style="zoom:67%;" /></p>
<p>æ»‘åŠ¨çª—å£ä¹Ÿå¯ä»¥ç†è§£ä¸ºåŒæŒ‡é’ˆæ³•çš„ä¸€ç§ï¼åªä¸è¿‡è¿™ç§è§£æ³•æ›´åƒæ˜¯ä¸€ä¸ªçª—å£çš„ç§»åŠ¨æœ¬é¢˜ä¸­å®ç°æ»‘åŠ¨çª—å£ï¼Œä¸»è¦ç¡®å®šå¦‚ä¸‹ä¸‰ç‚¹ï¼š</p>
<ul>
<li>çª—å£å†…æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>å¦‚ä½•ç§»åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Ÿ</li>
<li>å¦‚ä½•ç§»åŠ¨çª—å£çš„ç»“æŸä½ç½®ï¼Ÿ</li>
</ul>
<p>çª—å£å°±æ˜¯ æ»¡è¶³å…¶å’Œ â‰¥ s çš„é•¿åº¦æœ€å°çš„ è¿ç»­ å­æ•°ç»„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">minSubArrayLen</span><span class="hljs-params">(<span class="hljs-type">int</span> s, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-type">int</span> result = INT32_MAX;<br>        <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ»‘åŠ¨çª—å£æ•°å€¼ä¹‹å’Œ</span><br>        <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ»‘åŠ¨çª—å£èµ·å§‹ä½ç½®</span><br>        <span class="hljs-type">int</span> subLength = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ»‘åŠ¨çª—å£çš„é•¿åº¦</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; nums.<span class="hljs-built_in">size</span>(); j++) &#123;<br>            sum += nums[j];<br>            <span class="hljs-comment">// æ³¨æ„è¿™é‡Œä½¿ç”¨whileï¼Œæ¯æ¬¡æ›´æ–° iï¼ˆèµ·å§‹ä½ç½®ï¼‰ï¼Œå¹¶ä¸æ–­æ¯”è¾ƒå­åºåˆ—æ˜¯å¦ç¬¦åˆæ¡ä»¶</span><br>            <span class="hljs-keyword">while</span> (sum &gt;= s) &#123;<br>                subLength = (j - i + <span class="hljs-number">1</span>); <span class="hljs-comment">// å–å­åºåˆ—çš„é•¿åº¦</span><br>                result = result &lt; subLength ? result : subLength;<br>                sum -= nums[i++]; <span class="hljs-comment">// è¿™é‡Œä½“ç°å‡ºæ»‘åŠ¨çª—å£çš„ç²¾é«“ä¹‹å¤„ï¼Œä¸æ–­å˜æ›´iï¼ˆå­åºåˆ—çš„èµ·å§‹ä½ç½®ï¼‰</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// å¦‚æœresultæ²¡æœ‰è¢«èµ‹å€¼çš„è¯ï¼Œå°±è¿”å›0ï¼Œè¯´æ˜æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­åºåˆ—</span><br>        <span class="hljs-keyword">return</span> result == INT32_MAX ? <span class="hljs-number">0</span> : result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="èºæ—‹çŸ©é˜µ">èºæ—‹çŸ©é˜µ</h3>
<p><a
href="https://leetcode.cn/problems/spiral-matrix-ii/">https://leetcode.cn/problems/spiral-matrix-ii/</a></p>
<p><strong>é¢˜ç›®æè¿°</strong></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240111155904466.png" alt="èºæ—‹çŸ©é˜µ" style="zoom:67%;" /></p>
<p>ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° <code>n</code> ï¼Œç”Ÿæˆä¸€ä¸ªåŒ…å« <code>1</code> åˆ°
<code>n2</code> æ‰€æœ‰å…ƒç´ ï¼Œä¸”å…ƒç´ æŒ‰é¡ºæ—¶é’ˆé¡ºåºèºæ—‹æ’åˆ—çš„
<code>n x n</code> æ­£æ–¹å½¢çŸ©é˜µ <code>matrix</code></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šn = <span class="hljs-number">3</span><br>è¾“å‡ºï¼š<span class="hljs-string">[[1,2,3],[8,9,4],[7,6,5]]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šn = <span class="hljs-number">1</span><br>è¾“å‡ºï¼š<span class="hljs-string">[[1]]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šå¤§æ¨¡æ‹Ÿå¾ªç¯éå†</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">generateMatrix</span>(<span class="hljs-type">int</span> n) &#123;<br>        vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">result</span>(n, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;(n,<span class="hljs-number">0</span>));<br>        <span class="hljs-type">int</span> is=<span class="hljs-number">0</span>,ie=n<span class="hljs-number">-1</span>,js=<span class="hljs-number">0</span>,je=n<span class="hljs-number">-1</span>;<br>        <span class="hljs-type">int</span> k = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span>(is&lt;=ie&amp;&amp;js&lt;=je)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=js;j&lt;=je;j++)<br>            &#123;<br>                result[is][j] = k++;<br>            &#125;<br>            is++;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =is;i&lt;=ie;i++)<br>            &#123;<br>                result[i][je] = k++;<br>            &#125;<br>            je--;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=je;j&gt;=js;j--)<br>            &#123;<br>                result[ie][j] = k++;<br>            &#125;<br>            ie--;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=ie;i&gt;=is;i--)<br>            &#123;<br>                result[i][js] = k++;<br>            &#125;<br>            js++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="å“ˆå¸Œè¡¨">å“ˆå¸Œè¡¨</h1>
<p><strong>ä¸€èˆ¬å“ˆå¸Œè¡¨éƒ½æ˜¯ç”¨æ¥å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°é›†åˆé‡Œ</strong></p>
<p>åªéœ€è¦åˆå§‹åŒ–æŠŠæ‰€æœ‰å…ƒç´ éƒ½å­˜åœ¨å“ˆå¸Œè¡¨é‡Œï¼Œåœ¨æŸ¥è¯¢çš„æ—¶å€™é€šè¿‡ç´¢å¼•ç›´æ¥å°±å¯ä»¥çŸ¥é“å…ƒç´ åœ¨ä¸åœ¨è¿™å“ˆå¸Œè¡¨é‡Œäº†</p>
<p>å»ºç«‹ç´¢å¼•ï¼šå“ˆå¸Œå‡½æ•°</p>
<h3 id="æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯">æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯</h3>
<p><a
href="https://leetcode.cn/problems/valid-anagram/description/">https://leetcode.cn/problems/valid-anagram/description/</a></p>
<p><strong>é¢˜ç›®æè¿°</strong></p>
<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² s å’Œ t ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥åˆ¤æ–­ t æ˜¯å¦æ˜¯ s
çš„å­—æ¯å¼‚ä½è¯ã€‚</p>
<p>ç¤ºä¾‹ 1: è¾“å…¥: s = "anagram", t = "nagaram" è¾“å‡º: true</p>
<p>ç¤ºä¾‹ 2: è¾“å…¥: s = "rat", t = "car" è¾“å‡º: false</p>
<p><strong>æ€è·¯</strong></p>
<p>æš´åŠ›çš„æ–¹æ³•å¯èƒ½æ—¶é—´å¤æ‚åº¦ä¼šå¾ˆé«˜</p>
<p>åˆ¤æ–­æœ‰æ²¡æœ‰å¼‚ä½è¯çš„æœ¬è´¨å°±æ˜¯æŸ¥çœ‹å½“å‰çš„å­—æ¯æ˜¯ä¸æ˜¯æœ‰å‡ºç°è¿‡ï¼Œé‚£ä¹ˆæ€è·¯å°±æ˜¯é€‰æ‹©
<strong>å“ˆå¸Œè¡¨</strong></p>
<p>å®šä¹‰ä¸€ä¸ªæ•°ç»„å«åšrecordç”¨æ¥ä¸Šè®°å½•å­—ç¬¦ä¸²sé‡Œå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ã€‚</p>
<p>éœ€è¦æŠŠå­—ç¬¦æ˜ å°„åˆ°æ•°ç»„ä¹Ÿå°±æ˜¯å“ˆå¸Œè¡¨çš„ç´¢å¼•ä¸‹æ ‡ä¸Šï¼Œ<strong>å› ä¸ºå­—ç¬¦aåˆ°å­—ç¬¦zçš„ASCIIæ˜¯26ä¸ªè¿ç»­çš„æ•°å€¼ï¼Œæ‰€ä»¥å­—ç¬¦aæ˜ å°„ä¸ºä¸‹æ ‡0ï¼Œç›¸åº”çš„å­—ç¬¦zæ˜ å°„ä¸ºä¸‹æ ‡25ã€‚</strong></p>
<p>å†éå† å­—ç¬¦ä¸²sçš„æ—¶å€™ï¼Œ<strong>åªéœ€è¦å°† s[i] - â€˜aâ€™ æ‰€åœ¨çš„å…ƒç´ åš+1
æ“ä½œå³å¯ï¼Œå¹¶ä¸éœ€è¦è®°ä½å­—ç¬¦açš„ASCIIï¼Œåªè¦æ±‚å‡ºä¸€ä¸ªç›¸å¯¹æ•°å€¼å°±å¯ä»¥äº†ã€‚</strong>
è¿™æ ·å°±å°†å­—ç¬¦ä¸²sä¸­å­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç»Ÿè®¡å‡ºæ¥äº†</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isAnagram</span><span class="hljs-params">(string s, string t)</span> </span>&#123;<br>        <span class="hljs-type">int</span> record[<span class="hljs-number">26</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-comment">// å¹¶ä¸éœ€è¦è®°ä½å­—ç¬¦açš„ASCIIï¼Œåªè¦æ±‚å‡ºä¸€ä¸ªç›¸å¯¹æ•°å€¼å°±å¯ä»¥äº†</span><br>            record[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>]++;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; t.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            record[t[i] - <span class="hljs-string">&#x27;a&#x27;</span>]--;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span> (record[i] != <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-comment">// recordæ•°ç»„å¦‚æœæœ‰çš„å…ƒç´ ä¸ä¸ºé›¶0ï¼Œè¯´æ˜å­—ç¬¦ä¸²så’Œt ä¸€å®šæ˜¯è°å¤šäº†å­—ç¬¦æˆ–è€…è°å°‘äº†å­—ç¬¦ã€‚</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// recordæ•°ç»„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºé›¶0ï¼Œè¯´æ˜å­—ç¬¦ä¸²så’Œtæ˜¯å­—æ¯å¼‚ä½è¯</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†">ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</h3>
<p><a
href="https://leetcode.cn/problems/intersection-of-two-arrays/description/">https://leetcode.cn/problems/intersection-of-two-arrays/description/</a></p>
<p>é¢˜ç›®æè¿°</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums1 = <span class="hljs-comment">[1,2,2,1]</span>, nums2 = <span class="hljs-comment">[2,2]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[2]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums1 = <span class="hljs-comment">[4,9,5]</span>, nums2 = <span class="hljs-comment">[9,4,9,8,4]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[9,4]</span><br>è§£é‡Šï¼š<span class="hljs-comment">[4,9]</span> ä¹Ÿæ˜¯å¯é€šè¿‡çš„<br></code></pre></td></tr></table></figure>
<p>æ€è·¯</p>
<p>ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨ï¼Œä½†æ˜¯ç”¨<code>set(unordered_set)</code></p>
<p>std::setå’Œstd::multisetåº•å±‚å®ç°éƒ½æ˜¯çº¢é»‘æ ‘ï¼Œstd::unordered_setçš„åº•å±‚å®ç°æ˜¯å“ˆå¸Œè¡¨ï¼Œ
ä½¿ç”¨unordered_set
è¯»å†™æ•ˆç‡æ˜¯æœ€é«˜çš„ï¼Œå¹¶ä¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œè€Œä¸”è¿˜ä¸è¦è®©æ•°æ®é‡å¤ï¼Œæ‰€ä»¥é€‰æ‹©unordered_set</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">intersection</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums1, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums2)</span> </span>&#123;<br>        unordered_set&lt;<span class="hljs-type">int</span>&gt; result_set; <span class="hljs-comment">// å­˜æ”¾ç»“æœï¼Œä¹‹æ‰€ä»¥ç”¨setæ˜¯ä¸ºäº†ç»™ç»“æœé›†å»é‡</span><br>        <span class="hljs-function">unordered_set&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">nums_set</span><span class="hljs-params">(nums1.begin(), nums1.end())</span></span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums2) &#123;<br>            <span class="hljs-comment">// å‘ç°nums2çš„å…ƒç´  åœ¨nums_seté‡Œåˆå‡ºç°è¿‡</span><br>            <span class="hljs-keyword">if</span> (nums_set.<span class="hljs-built_in">find</span>(num) != nums_set.<span class="hljs-built_in">end</span>()) &#123;<br>                result_set.<span class="hljs-built_in">insert</span>(num);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;(result_set.<span class="hljs-built_in">begin</span>(), result_set.<span class="hljs-built_in">end</span>());<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å¿«ä¹æ•°">å¿«ä¹æ•°</h3>
<p><a
href="https://leetcode.cn/problems/happy-number/description/">https://leetcode.cn/problems/happy-number/description/</a></p>
<p>é¢˜ç›®æè¿°</p>
<p>ç¼–å†™ä¸€ä¸ªç®—æ³•æ¥åˆ¤æ–­ä¸€ä¸ªæ•° <code>n</code> æ˜¯ä¸æ˜¯å¿«ä¹æ•°ã€‚</p>
<p><strong>ã€Œå¿«ä¹æ•°ã€</strong> å®šä¹‰ä¸ºï¼š</p>
<ul>
<li>å¯¹äºä¸€ä¸ªæ­£æ•´æ•°ï¼Œæ¯ä¸€æ¬¡å°†è¯¥æ•°æ›¿æ¢ä¸ºå®ƒæ¯ä¸ªä½ç½®ä¸Šçš„æ•°å­—çš„å¹³æ–¹å’Œã€‚</li>
<li>ç„¶åé‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°è¿™ä¸ªæ•°å˜ä¸º 1ï¼Œä¹Ÿå¯èƒ½æ˜¯ <strong>æ— é™å¾ªç¯</strong>
ä½†å§‹ç»ˆå˜ä¸åˆ° 1ã€‚</li>
<li>å¦‚æœè¿™ä¸ªè¿‡ç¨‹ <strong>ç»“æœä¸º</strong> 1ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å°±æ˜¯å¿«ä¹æ•°ã€‚</li>
</ul>
<p>å¦‚æœ <code>n</code> æ˜¯ <em>å¿«ä¹æ•°</em> å°±è¿”å› <code>true</code>
ï¼›ä¸æ˜¯ï¼Œåˆ™è¿”å› <code>false</code> ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><code class="hljs routeros">è¾“å…¥ï¼šn = 19<br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br>è§£é‡Šï¼š<br>1*<span class="hljs-number">*2</span> + 9*<span class="hljs-number">*2</span> = 82<br>8*<span class="hljs-number">*2</span> + 2*<span class="hljs-number">*2</span> = 68<br>6*<span class="hljs-number">*2</span> + 8*<span class="hljs-number">*2</span> = 100<br>1*<span class="hljs-number">*2</span> + 0*<span class="hljs-number">*2</span> + 0*<span class="hljs-number">*2</span> = 1<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>æ³¨æ„ï¼Œé¢˜ç›®ä¸­æåˆ°ä¸€ä¸ªç‚¹æ˜¯
<strong>æ— é™å¾ªç¯</strong>ï¼Œè¯´æ˜è®¡ç®—çš„ç»“æœ<strong>sumæ˜¯æœ‰é™</strong>çš„åªéœ€è¦åœ¨å“ˆå¸Œè¡¨ä¸­å°†è¿™éƒ¨åˆ†çš„ç»“æœå­˜å‚¨è¿›å»ï¼Œå¹¶æ¯æ¬¡æ¯”è¾ƒæ˜¯ä¸æ˜¯<strong>å‡ºç°1</strong>
å¦‚æœæ˜¯é‚£ä¹ˆå°±æ˜¯å¿«ä¹æ•°ï¼Œå¦åˆ™å°±ä¸æ˜¯å¿«ä¹æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getSum</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123;<br>        <span class="hljs-type">int</span> sum=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(n)&#123;<br>            sum+=(n%<span class="hljs-number">10</span>)*(n%<span class="hljs-number">10</span>);<br>            n/=<span class="hljs-number">10</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isHappy</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>        <span class="hljs-comment">//é¦–å…ˆå»ºç«‹å“ˆå¸Œè¡¨æ¥å­˜å‚¨æ˜¯ä¸æ˜¯å‡ºç°äº†æ— é™å¾ªç¯çš„ç»“æœ</span><br>        unordered_set&lt;<span class="hljs-type">int</span>&gt;sum_set;<br>        <span class="hljs-comment">//æ— é™å¾ªç¯ ç›´åˆ°å‡ºç°1æˆ–è€…æ— é™å¾ªç¯ä¸”ä¸æ˜¯å¿«ä¹æ•°</span><br>        <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>)&#123;<br>            n=<span class="hljs-built_in">getSum</span>(n);<br>            <span class="hljs-keyword">if</span>(sum_set.<span class="hljs-built_in">find</span>(n)!=sum_set.<span class="hljs-built_in">end</span>())&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                sum_set.<span class="hljs-built_in">insert</span>(n);<br>            &#125;<br>            <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸¤æ•°ä¹‹å’Œ">ä¸¤æ•°ä¹‹å’Œ</h3>
<p>é¢˜ç›®æè¿°</p>
<p><a
href="https://leetcode.cn/problems/two-sum/submissions/495021134/">https://leetcode.cn/problems/two-sum/submissions/495021134/</a></p>
<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼
<code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º <strong>å’Œä¸ºç›®æ ‡å€¼</strong>
<em><code>target</code></em> çš„é‚£ <strong>ä¸¤ä¸ª</strong>
æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p>
<p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œ<strong>æ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°</strong>ã€‚</p>
<p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[2,7,11,15]</span>, target = 9<br>è¾“å‡ºï¼š<span class="hljs-comment">[0,1]</span><br>è§£é‡Šï¼šå› ä¸º nums<span class="hljs-comment">[0]</span> + nums<span class="hljs-comment">[1]</span> == 9 ï¼Œè¿”å› <span class="hljs-comment">[0, 1]</span> ã€‚<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[3,2,4]</span>, target = 6<br>è¾“å‡ºï¼š<span class="hljs-comment">[1,2]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[3,3]</span>, target = 6<br>è¾“å‡ºï¼š<span class="hljs-comment">[0,1]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>æ„å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œç„¶åéå†ä¸€éå°±è¡Œäº†åœ¨å“ˆå¸Œè¡¨ä¸­æ‰¾n-açš„å€¼æ˜¯å¦å­˜åœ¨ï¼Œä½†æ˜¯æœ€å¤§çš„é—®é¢˜æ˜¯<strong>æ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°</strong>ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•è€ƒè™‘unordered_set</p>
<p>è¿™é‡Œæä¾›ä¸€ç§æ–°çš„æ€è·¯ï¼Œå°±æ˜¯ç”¨unordered_mapæ¥å­˜å‚¨æ•°ç»„ä¸­çš„æ•°æ®å†…å®¹å’Œä¸‹æ ‡çš„æ•°å€¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">twoSum</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> target)</span> </span>&#123;<br>        std::unordered_map &lt;<span class="hljs-type">int</span>,<span class="hljs-type">int</span>&gt; map;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-comment">// éå†å½“å‰å…ƒç´ ï¼Œå¹¶åœ¨mapä¸­å¯»æ‰¾æ˜¯å¦æœ‰åŒ¹é…çš„key</span><br>            <span class="hljs-keyword">auto</span> iter = map.<span class="hljs-built_in">find</span>(target - nums[i]); <br>            <span class="hljs-keyword">if</span>(iter != map.<span class="hljs-built_in">end</span>()) &#123;<br>                <span class="hljs-keyword">return</span> &#123;iter-&gt;second, i&#125;;<br>            &#125;<br>            <span class="hljs-comment">// å¦‚æœæ²¡æ‰¾åˆ°åŒ¹é…å¯¹ï¼Œå°±æŠŠè®¿é—®è¿‡çš„å…ƒç´ å’Œä¸‹æ ‡åŠ å…¥åˆ°mapä¸­</span><br>            map.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">pair</span>&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;(nums[i], i)); <br>        &#125;<br>        <span class="hljs-keyword">return</span> &#123;&#125;;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å››æ•°ç›¸åŠ ">å››æ•°ç›¸åŠ </h3>
<p><a
href="https://leetcode.cn/problems/4sum-ii/description/">https://leetcode.cn/problems/4sum-ii/description/</a></p>
<p>ç»™ä½ å››ä¸ªæ•´æ•°æ•°ç»„
<code>nums1</code>ã€<code>nums2</code>ã€<code>nums3</code> å’Œ
<code>nums4</code> ï¼Œæ•°ç»„é•¿åº¦éƒ½æ˜¯ <code>n</code> ï¼Œè¯·ä½ è®¡ç®—æœ‰å¤šå°‘ä¸ªå…ƒç»„
<code>(i, j, k, l)</code> èƒ½æ»¡è¶³ï¼š</p>
<ul>
<li><code>0 &lt;= i, j, k, l &lt; n</code></li>
<li><code>nums1[i] + nums2[j] + nums3[k] + nums4[l] == 0</code></li>
</ul>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><code class="hljs gcode">è¾“å…¥ï¼š<span class="hljs-symbol">nums1</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], <span class="hljs-symbol">nums2</span> = [<span class="hljs-number">-2</span>,<span class="hljs-number">-1</span>], <span class="hljs-symbol">nums3</span> = [<span class="hljs-number">-1</span>,<span class="hljs-number">2</span>], <span class="hljs-symbol">nums4</span> = [<span class="hljs-number">0</span>,<span class="hljs-number">2</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">2</span><br>è§£é‡Šï¼š<br>ä¸¤ä¸ªå…ƒç»„å¦‚ä¸‹ï¼š<br><span class="hljs-number">1.</span> <span class="hljs-comment">(0, 0, 0, 1)</span> -&gt; <span class="hljs-symbol">nums1</span>[<span class="hljs-number">0</span>] + <span class="hljs-symbol">nums2</span>[<span class="hljs-number">0</span>] + <span class="hljs-symbol">nums3</span>[<span class="hljs-number">0</span>] + <span class="hljs-symbol">nums4</span>[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span> + <span class="hljs-comment">(-2)</span> + <span class="hljs-comment">(-1)</span> + <span class="hljs-number">2</span> = <span class="hljs-number">0</span><br><span class="hljs-number">2.</span> <span class="hljs-comment">(1, 1, 0, 0)</span> -&gt; <span class="hljs-symbol">nums1</span>[<span class="hljs-number">1</span>] + <span class="hljs-symbol">nums2</span>[<span class="hljs-number">1</span>] + <span class="hljs-symbol">nums3</span>[<span class="hljs-number">0</span>] + <span class="hljs-symbol">nums4</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">2</span> + <span class="hljs-comment">(-1)</span> + <span class="hljs-comment">(-1)</span> + <span class="hljs-number">0</span> = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><code class="hljs gcode">è¾“å…¥ï¼š<span class="hljs-symbol">nums1</span> = [<span class="hljs-number">0</span>], <span class="hljs-symbol">nums2</span> = [<span class="hljs-number">0</span>], <span class="hljs-symbol">nums3</span> = [<span class="hljs-number">0</span>], <span class="hljs-symbol">nums4</span> = [<span class="hljs-number">0</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯</p>
<ol type="1">
<li>é¦–å…ˆå®šä¹‰ ä¸€ä¸ªunordered_mapï¼Œkeyæ”¾aå’Œbä¸¤æ•°ä¹‹å’Œï¼Œvalue
æ”¾aå’Œbä¸¤æ•°ä¹‹å’Œ<strong>å‡ºç°çš„æ¬¡æ•°</strong>ã€‚</li>
<li>éå†å¤§Aå’Œå¤§Bæ•°ç»„ï¼Œç»Ÿè®¡ä¸¤ä¸ªæ•°ç»„å…ƒç´ ä¹‹å’Œï¼Œå’Œå‡ºç°çš„æ¬¡æ•°ï¼Œæ”¾åˆ°mapä¸­ã€‚</li>
<li>å®šä¹‰intå˜é‡countï¼Œç”¨æ¥ç»Ÿè®¡ a+b+c+d = 0 å‡ºç°çš„æ¬¡æ•°ã€‚</li>
<li>åœ¨éå†å¤§Cå’Œå¤§Dæ•°ç»„ï¼Œæ‰¾åˆ°å¦‚æœ 0-(c+d)
åœ¨mapä¸­å‡ºç°è¿‡çš„è¯ï¼Œå°±ç”¨countæŠŠmapä¸­keyå¯¹åº”çš„valueä¹Ÿå°±æ˜¯å‡ºç°æ¬¡æ•°ç»Ÿè®¡å‡ºæ¥ã€‚</li>
<li>æœ€åè¿”å›ç»Ÿè®¡å€¼ count å°±å¯ä»¥äº†</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">fourSumCount</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums1, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums2, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums3, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums4)</span> </span>&#123;<br>        std::unordered_map&lt;<span class="hljs-type">int</span>,<span class="hljs-type">int</span>&gt;nm;<br>        <span class="hljs-type">int</span> res=<span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums1.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;nums2.<span class="hljs-built_in">size</span>();j++)&#123;<br>                <span class="hljs-type">int</span> s = nums1[i]+nums2[j];<br>                nm[s]++;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums3.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;nums4.<span class="hljs-built_in">size</span>();j++)&#123;<br>                <span class="hljs-keyword">if</span>(nm.<span class="hljs-built_in">find</span>(<span class="hljs-number">0</span>-nums3[i]-nums4[j])!=nm.<span class="hljs-built_in">end</span>())&#123;<br>                    res+=nm[<span class="hljs-number">0</span>-(nums3[i]+nums4[j])];<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="èµé‡‘ä¿¡">èµé‡‘ä¿¡</h3>
<p><a
href="https://leetcode.cn/problems/ransom-note/description/">https://leetcode.cn/problems/ransom-note/description/</a></p>
<p>ç»™ä½ ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š<code>ransomNote</code> å’Œ <code>magazine</code>
ï¼Œåˆ¤æ–­ <code>ransomNote</code> èƒ½ä¸èƒ½ç”± <code>magazine</code>
é‡Œé¢çš„å­—ç¬¦æ„æˆã€‚</p>
<p>å¦‚æœå¯ä»¥ï¼Œè¿”å› <code>true</code> ï¼›å¦åˆ™è¿”å› <code>false</code> ã€‚</p>
<p><code>magazine</code> ä¸­çš„æ¯ä¸ªå­—ç¬¦åªèƒ½åœ¨ <code>ransomNote</code>
ä¸­ä½¿ç”¨ä¸€æ¬¡ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight nix"><table><tr><td class="code"><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">ransomNote</span> = <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-attr">magazine</span> = <span class="hljs-string">&quot;b&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight nix"><table><tr><td class="code"><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">ransomNote</span> = <span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-attr">magazine</span> = <span class="hljs-string">&quot;ab&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>ç”¨å“ˆå¸Œè¡¨unordered_mapæ¥å­˜å‚¨æ¬¡æ•°ï¼Œå¯¹äºransomNoteæ¥å‡å»æ¬¡æ•°</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">canConstruct</span><span class="hljs-params">(string ransomNote, string magazine)</span> </span>&#123;<br>        unordered_map&lt;<span class="hljs-type">int</span>,<span class="hljs-type">int</span>&gt;umap;<br>        <span class="hljs-keyword">if</span>(ransomNote.<span class="hljs-built_in">size</span>()&gt;magazine.<span class="hljs-built_in">size</span>())&#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;magazine.<span class="hljs-built_in">size</span>();i++)&#123;<br>            umap[magazine[i]-<span class="hljs-string">&#x27;a&#x27;</span>]++;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;ransomNote.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(umap.<span class="hljs-built_in">find</span>(ransomNote[i]-<span class="hljs-string">&#x27;a&#x27;</span>)!=umap.<span class="hljs-built_in">end</span>())&#123;<br>                umap[ransomNote[i]-<span class="hljs-string">&#x27;a&#x27;</span>]--;<br>                <span class="hljs-keyword">if</span>(umap[ransomNote[i]-<span class="hljs-string">&#x27;a&#x27;</span>]&lt;<span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸‰æ•°ä¹‹å’Œ">ä¸‰æ•°ä¹‹å’Œ</h3>
<p><a
href="https://leetcode.cn/problems/3sum/description/">https://leetcode.cn/problems/3sum/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„
<code>[nums[i], nums[j], nums[k]]</code> æ»¡è¶³
<code>i != j</code>ã€<code>i != k</code> ä¸” <code>j != k</code>
ï¼ŒåŒæ—¶è¿˜æ»¡è¶³ <code>nums[i] + nums[j] + nums[k] == 0</code> ã€‚è¯·</p>
<p>ä½ è¿”å›æ‰€æœ‰å’Œä¸º <code>0</code> ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[-1,0,1,2,-1,-4]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[-1,-1,2]</span>,<span class="hljs-comment">[-1,0,1]</span>]</span><br>è§£é‡Šï¼š<br>nums<span class="hljs-comment">[0]</span> + nums<span class="hljs-comment">[1]</span> + nums<span class="hljs-comment">[2]</span> = (-1) + 0 + 1 = 0 ã€‚<br>nums<span class="hljs-comment">[1]</span> + nums<span class="hljs-comment">[2]</span> + nums<span class="hljs-comment">[4]</span> = 0 + 1 + (-1) = 0 ã€‚<br>nums<span class="hljs-comment">[0]</span> + nums<span class="hljs-comment">[3]</span> + nums<span class="hljs-comment">[4]</span> = (-1) + 2 + (-1) = 0 ã€‚<br>ä¸åŒçš„ä¸‰å…ƒç»„æ˜¯ <span class="hljs-comment">[-1,0,1]</span> å’Œ <span class="hljs-comment">[-1,-1,2]</span> ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯</p>
<p><strong>å…¶å®è¿™é“é¢˜ç›®ä½¿ç”¨å“ˆå¸Œæ³•å¹¶ä¸ååˆ†åˆé€‚</strong>ï¼Œå› ä¸ºåœ¨å»é‡çš„æ“ä½œä¸­æœ‰å¾ˆå¤šç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œåœ¨é¢è¯•ä¸­å¾ˆéš¾ç›´æ¥å†™å‡ºæ²¡æœ‰bugçš„ä»£ç ï¼Œè€Œä¸”ä½¿ç”¨å“ˆå¸Œæ³•
åœ¨ä½¿ç”¨ä¸¤å±‚forå¾ªç¯çš„æ—¶å€™ï¼Œèƒ½åšçš„å‰ªææ“ä½œå¾ˆæœ‰é™ï¼Œè™½ç„¶æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2)</p>
<p>è¿™é“é¢˜å¯ä»¥ç”¨åŒæŒ‡é’ˆæ³•æ±‚è§£</p>
<p>æ‹¿è¿™ä¸ªnumsæ•°ç»„æ¥ä¸¾ä¾‹ï¼Œé¦–å…ˆå°†æ•°ç»„æ’åºï¼Œç„¶åæœ‰ä¸€å±‚forå¾ªç¯ï¼Œ<strong>iä»ä¸‹æ ‡0çš„åœ°æ–¹å¼€å§‹ï¼ŒåŒæ—¶å®šä¸€ä¸ªä¸‹æ ‡left
å®šä¹‰åœ¨i+1çš„ä½ç½®ä¸Šï¼Œå®šä¹‰ä¸‹æ ‡right åœ¨æ•°ç»„ç»“å°¾çš„ä½ç½®ä¸Š</strong>ã€‚</p>
<p>ä¾ç„¶è¿˜æ˜¯åœ¨æ•°ç»„ä¸­æ‰¾åˆ° abc ä½¿å¾—a + b +c =0ï¼Œæˆ‘ä»¬è¿™é‡Œç›¸å½“äº a =
nums[i]ï¼Œb = nums[left]ï¼Œc = nums[right]ã€‚</p>
<p>æ¥ä¸‹æ¥å¦‚ä½•ç§»åŠ¨left å’Œrightå‘¢ï¼Œ å¦‚æœnums[i] + nums[left] + nums[right]
&gt; 0 å°±è¯´æ˜
<strong>æ­¤æ—¶ä¸‰æ•°ä¹‹å’Œå¤§äº†</strong>ï¼Œå› ä¸ºæ•°ç»„æ˜¯æ’åºåäº†ï¼Œæ‰€ä»¥rightä¸‹æ ‡å°±åº”è¯¥å‘å·¦ç§»åŠ¨ï¼Œè¿™æ ·æ‰èƒ½è®©ä¸‰æ•°ä¹‹å’Œå°ä¸€äº›ã€‚</p>
<p>å¦‚æœ nums[i] + nums[left] + nums[right] &lt; 0 è¯´æ˜ æ­¤æ—¶
ä¸‰æ•°ä¹‹å’Œå°äº†ï¼Œ<strong>left
å°±å‘å³ç§»åŠ¨ï¼Œæ‰èƒ½è®©ä¸‰æ•°ä¹‹å’Œå¤§ä¸€äº›ï¼Œç›´åˆ°leftä¸rightç›¸é‡ä¸ºæ­¢</strong>ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªéš¾åº¦å°±æ˜¯ä¸èƒ½æœ‰é‡å¤çš„ç»“æœï¼Œéœ€è¦åšä¸€æ¬¡å»é‡çš„æ“ä½œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">threeSum</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums) &#123;<br>        vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; result;<br>        <span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-comment">// æ‰¾å‡ºa + b + c = 0</span><br>        <span class="hljs-comment">// a = nums[i], b = nums[left], c = nums[right]</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-comment">// æ’åºä¹‹åå¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ å·²ç»å¤§äºé›¶ï¼Œé‚£ä¹ˆæ— è®ºå¦‚ä½•ç»„åˆéƒ½ä¸å¯èƒ½å‡‘æˆä¸‰å…ƒç»„ï¼Œç›´æ¥è¿”å›ç»“æœå°±å¯ä»¥äº†</span><br>            <span class="hljs-keyword">if</span> (nums[i] &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> result;<br>            &#125;<br>          <span class="hljs-comment">// æ­£ç¡®å»é‡aæ–¹æ³•</span><br>            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i - <span class="hljs-number">1</span>]) &#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-type">int</span> left = i + <span class="hljs-number">1</span>;<br>            <span class="hljs-type">int</span> right = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">while</span> (right &gt; left) &#123;<br>                <span class="hljs-keyword">if</span> (nums[i] + nums[left] + nums[right] &gt; <span class="hljs-number">0</span>) right--;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[i] + nums[left] + nums[right] &lt; <span class="hljs-number">0</span>) left++;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    result.<span class="hljs-built_in">push_back</span>(vector&lt;<span class="hljs-type">int</span>&gt;&#123;nums[i], nums[left], nums[right]&#125;);<br>                    <span class="hljs-comment">// å»é‡é€»è¾‘åº”è¯¥æ”¾åœ¨æ‰¾åˆ°ä¸€ä¸ªä¸‰å…ƒç»„ä¹‹åï¼Œå¯¹b å’Œ cå»é‡</span><br>                    <span class="hljs-keyword">while</span> (right &gt; left &amp;&amp; nums[right] == nums[right - <span class="hljs-number">1</span>]) right--;<br>                    <span class="hljs-keyword">while</span> (right &gt; left &amp;&amp; nums[left] == nums[left + <span class="hljs-number">1</span>]) left++;<br>                  <span class="hljs-comment">// æ‰¾åˆ°ç­”æ¡ˆæ—¶ï¼ŒåŒæŒ‡é’ˆåŒæ—¶æ”¶ç¼©</span><br>                    right--;<br>                    left++;<br>                &#125;<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="åŒæŒ‡é’ˆ">åŒæŒ‡é’ˆ</h1>
<h3 id="ç§»é™¤å…ƒç´ -1">ç§»é™¤å…ƒç´ </h3>
<p><a
href="https://leetcode.cn/problems/remove-element/description/">https://leetcode.cn/problems/remove-element/description/</a></p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[3,2,2,3]</span>, val = 3<br>è¾“å‡ºï¼š2, nums = <span class="hljs-comment">[2,2]</span><br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡½æ•°è¿”å›çš„æ–°é•¿åº¦ä¸º 2 ï¼Œè€Œ nums = <span class="hljs-comment">[2,2,3,3]</span> æˆ– nums = <span class="hljs-comment">[2,2,0,0]</span>ï¼Œä¹Ÿä¼šè¢«è§†ä½œæ­£ç¡®ç­”æ¡ˆã€‚<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šnums = [<span class="hljs-number">0,1,2,2</span>,<span class="hljs-number">3,0,4,2</span>], val = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š<span class="hljs-number">5</span>, nums = [<span class="hljs-number">0,1,3,0</span>,<span class="hljs-number">4</span>]<br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ <span class="hljs-number">5</span>, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>ã€‚æ³¨æ„è¿™äº”ä¸ªå…ƒç´ å¯ä¸ºä»»æ„é¡ºåºã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæ¥å®ç°ä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´çš„ç§»åŠ¨ï¼Œå¯¹äºæ‰¾åˆ°äº†å’Œvalæ•°å€¼ä¸€æ ·çš„å°±è¿›è¡Œæ›¿æ¢</p>
<h3 id="åè½¬å­—ç¬¦ä¸²">åè½¬å­—ç¬¦ä¸²</h3>
<p><a
href="https://leetcode.cn/problems/reverse-string/description/">https://leetcode.cn/problems/reverse-string/description/</a></p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šs = [<span class="hljs-string">&quot;h&quot;</span>,<span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;l&quot;</span>,<span class="hljs-string">&quot;l&quot;</span>,<span class="hljs-string">&quot;o&quot;</span>]<br>è¾“å‡ºï¼š[<span class="hljs-string">&quot;o&quot;</span>,<span class="hljs-string">&quot;l&quot;</span>,<span class="hljs-string">&quot;l&quot;</span>,<span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;h&quot;</span>]<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šs = [<span class="hljs-string">&quot;H&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;h&quot;</span>]<br>è¾“å‡ºï¼š[<span class="hljs-string">&quot;h&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;H&quot;</span>]<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>é‡‡ç”¨ä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´äº’ç›¸äº¤æ¢ï¼Œé¦–å°¾äº¤æ¢</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reverseString</span><span class="hljs-params">(vector&lt;<span class="hljs-type">char</span>&gt;&amp; s)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> a=<span class="hljs-number">0</span>, b = s.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;a&lt;b;)&#123;<br>            <span class="hljs-type">char</span> tmp;<br>            tmp=s[a];<br>            s[a]=s[b];<br>            s[b]=tmp;<br>            a++;<br>            b--;<br>        &#125;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯">åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯</h3>
<p><a
href="https://leetcode.cn/problems/reverse-words-in-a-string/description/">https://leetcode.cn/problems/reverse-words-in-a-string/description/</a></p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šs <span class="hljs-operator">=</span> <span class="hljs-string">&quot;the sky is blue&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-string">&quot;blue is sky the&quot;</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šs <span class="hljs-operator">=</span> <span class="hljs-string">&quot;  hello world  &quot;</span><br>è¾“å‡ºï¼š<span class="hljs-string">&quot;world hello&quot;</span><br>è§£é‡Šï¼šåè½¬åçš„å­—ç¬¦ä¸²ä¸­ä¸èƒ½å­˜åœ¨å‰å¯¼ç©ºæ ¼å’Œå°¾éšç©ºæ ¼ã€‚<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šs <span class="hljs-operator">=</span> <span class="hljs-string">&quot;a good   example&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-string">&quot;example good a&quot;</span><br>è§£é‡Šï¼šå¦‚æœä¸¤ä¸ªå•è¯é—´æœ‰å¤šä½™çš„ç©ºæ ¼ï¼Œåè½¬åçš„å­—ç¬¦ä¸²éœ€è¦å°†å•è¯é—´çš„ç©ºæ ¼å‡å°‘åˆ°ä»…æœ‰ä¸€ä¸ªã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>é¦–å…ˆå¯¹å­—ç¬¦ä¸²ä¸­é¢å¤–çš„ç©ºæ ¼è¿›è¡Œåˆ é™¤</p>
<p>å­—ç¬¦ä¸²è¿›è¡Œå…¨å±€çš„é€†åº</p>
<p>å†æ ¹æ®ç©ºæ ¼ä½œä¸ºä¸€ä¸ªå•ç‹¬å­—æ¯çš„èŠ‚ç‚¹è¿›è¡Œåˆ†æ ¼åˆ†åˆ«è¿›è¡Œé€†åº</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">string <span class="hljs-title">reverseWords</span><span class="hljs-params">(string s)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = s.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;i&gt;<span class="hljs-number">0</span>;i--)&#123;<br>            <span class="hljs-keyword">if</span>(s[i]==s[i<span class="hljs-number">-1</span>]&amp;&amp;s[i]==<span class="hljs-string">&#x27; &#x27;</span>)&#123;<br>                s.<span class="hljs-built_in">erase</span>(s.<span class="hljs-built_in">begin</span>()+i);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(s.<span class="hljs-built_in">size</span>()&gt;<span class="hljs-number">0</span>&amp;&amp;s[s.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>]==<span class="hljs-string">&#x27; &#x27;</span>)&#123;<br>            s.<span class="hljs-built_in">erase</span>(s.<span class="hljs-built_in">begin</span>()+s.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(s.<span class="hljs-built_in">size</span>()&gt;<span class="hljs-number">0</span>&amp;&amp;s[<span class="hljs-number">0</span>]==<span class="hljs-string">&#x27; &#x27;</span>)&#123;<br>            s.<span class="hljs-built_in">erase</span>(s.<span class="hljs-built_in">begin</span>());<br>        &#125;<br><br>        <span class="hljs-comment">//å®Œæˆå…¨å±€çš„äº¤æ¢</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j=s.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;i&lt;j;i++,j--)&#123;<br>            <span class="hljs-type">char</span> tmp;<br>            tmp = s[i];<br>            s[i] = s[j];<br>            s[j] = tmp;<br>        &#125;<br>        cout&lt;&lt;s;<br>        <span class="hljs-comment">//è¿›è¡Œå±€éƒ¨çš„äº¤æ¢</span><br>        <span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span>(j&lt;=s.<span class="hljs-built_in">size</span>())&#123;<br>            <span class="hljs-keyword">if</span>(s[j]==<span class="hljs-string">&#x27; &#x27;</span>||j==s.<span class="hljs-built_in">size</span>())&#123;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k =i, q =j<span class="hljs-number">-1</span>;k&lt;q;k++,q--)&#123;<br>                    <span class="hljs-type">char</span> tmp;<br>                    tmp = s[k];<br>                    s[k] = s[q];<br>                    s[q] = tmp;<br>                &#125;<br>                i=j+<span class="hljs-number">1</span>;<br>                j=i+<span class="hljs-number">1</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                j++;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> s;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="åè½¬é“¾è¡¨">åè½¬é“¾è¡¨</h3>
<p><a
href="https://leetcode.cn/problems/reverse-linked-list/description/">https://leetcode.cn/problems/reverse-linked-list/description/</a></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240118151406885.png" alt="image-20240118151406885" style="zoom:67%;" /></p>
<figure class="highlight accesslog"><table><tr><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šhead = <span class="hljs-string">[1,2,3,4,5]</span><br>è¾“å‡ºï¼š<span class="hljs-string">[5,4,3,2,1]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šæœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨äº†ä¸¤ä¸ªé“¾è¡¨æŒ‡é’ˆå®ç°å¯¹å…ƒç´ çš„è½¬å‘</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">ListNode* <span class="hljs-title">reverseList</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>        ListNode* temp;<br>        ListNode* cur = head;<br>        ListNode* pre = <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-keyword">while</span>(cur)&#123;<br>            temp = cur-&gt;next;<br>            cur-&gt;next = pre;<br>            pre = cur;<br>            cur = temp;<br>        &#125;<br>        <span class="hljs-keyword">return</span> pre;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ªç»“ç‚¹">åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªç»“ç‚¹</h3>
<p><a
href="https://leetcode.cn/problems/remove-nth-node-from-end-of-list/description/">https://leetcode.cn/problems/remove-nth-node-from-end-of-list/description/</a></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240118152000575.png" alt="image-20240118152000575" style="zoom:67%;" /></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šhead = [<span class="hljs-number">1,2,3,4</span>,<span class="hljs-number">5</span>], n = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š[<span class="hljs-number">1,2,3,5</span>]<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šhead = <span class="hljs-comment">[1]</span>, n = 1<br>è¾“å‡ºï¼š<span class="hljs-comment">[]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>éå†ï¼Œç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æ¥è®°å½•</p>
<p>å¦‚æœè¦åˆ é™¤å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹ï¼Œè®©fastç§»åŠ¨næ­¥ï¼Œç„¶åè®©fastå’ŒslowåŒæ—¶ç§»åŠ¨ï¼Œç›´åˆ°fastæŒ‡å‘é“¾è¡¨æœ«å°¾ã€‚åˆ æ‰slowæ‰€æŒ‡å‘çš„èŠ‚ç‚¹å°±å¯ä»¥äº†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs CPP"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">ListNode* <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(ListNode* head, <span class="hljs-type">int</span> n)</span> </span>&#123;<br>        ListNode* dummyHead = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ListNode</span>(<span class="hljs-number">0</span>);<br>        dummyHead-&gt;next = head;<br>        ListNode* slow = dummyHead;<br>        ListNode* fast = dummyHead;<br>        <span class="hljs-keyword">while</span>(n-- &amp;&amp; fast != <span class="hljs-literal">NULL</span>) &#123;<br>            fast = fast-&gt;next;<br>        &#125;<br>        fast = fast-&gt;next; <span class="hljs-comment">// fastå†æå‰èµ°ä¸€æ­¥ï¼Œå› ä¸ºéœ€è¦è®©slowæŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-keyword">while</span> (fast != <span class="hljs-literal">NULL</span>) &#123;<br>            fast = fast-&gt;next;<br>            slow = slow-&gt;next;<br>        &#125;<br>        slow-&gt;next = slow-&gt;next-&gt;next; <br>        <br>        <span class="hljs-comment">// ListNode *tmp = slow-&gt;next;  C++é‡Šæ”¾å†…å­˜çš„é€»è¾‘</span><br>        <span class="hljs-comment">// slow-&gt;next = tmp-&gt;next;</span><br>        <span class="hljs-comment">// delete nth;</span><br>        <br>        <span class="hljs-keyword">return</span> dummyHead-&gt;next;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="é“¾è¡¨ç›¸äº¤">é“¾è¡¨ç›¸äº¤</h3>
<p>ç»™ä½ ä¸¤ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>headA</code> å’Œ <code>headB</code>
ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„èµ·å§‹èŠ‚ç‚¹ã€‚å¦‚æœä¸¤ä¸ªé“¾è¡¨æ²¡æœ‰äº¤ç‚¹ï¼Œè¿”å›
<code>null</code> ã€‚</p>
<p>é¢˜ç›®æ•°æ® <strong>ä¿è¯</strong> æ•´ä¸ªé“¾å¼ç»“æ„ä¸­ä¸å­˜åœ¨ç¯ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼Œå‡½æ•°è¿”å›ç»“æœåï¼Œé“¾è¡¨å¿…é¡»
<strong>ä¿æŒå…¶åŸå§‹ç»“æ„</strong> ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119195217619.png" alt="é“¾è¡¨ç›¸äº¤å›¾" style="zoom:80%;" /></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šintersectVal = <span class="hljs-number">8</span>, listA = [<span class="hljs-number">4,1,8,4</span>,<span class="hljs-number">5</span>], listB = [<span class="hljs-number">5,0,1,8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], skipA = <span class="hljs-number">2</span>, skipB = <span class="hljs-number">3</span><br>è¾“å‡ºï¼šIntersected at &#x27;<span class="hljs-number">8</span>&#x27;<br>è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º <span class="hljs-number">8</span> ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º <span class="hljs-number">0</span>ï¼‰ã€‚<br>ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ <span class="hljs-keyword">A</span> ä¸º [<span class="hljs-number">4,1,8,4</span>,<span class="hljs-number">5</span>]ï¼Œé“¾è¡¨ B ä¸º [<span class="hljs-number">5,0,1,8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]ã€‚<br>åœ¨ <span class="hljs-keyword">A</span> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <span class="hljs-number">2</span> ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <span class="hljs-number">3</span> ä¸ªèŠ‚ç‚¹ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ±‚ä¸¤ä¸ªé“¾è¡¨äº¤ç‚¹èŠ‚ç‚¹çš„<strong>æŒ‡é’ˆ</strong>ï¼Œæ³¨æ„è¿”å›çš„æ˜¯ç»“ç‚¹çš„æŒ‡é’ˆï¼Œä¸æ˜¯å¯¹åº”çš„æ•°å€¼ï¼ŒåŒæ—¶æ³¨æ„è¿™é‡Œæ¯”è¾ƒçš„æ˜¯<strong>ç›¸åŒçš„æŒ‡é’ˆä¸æ˜¯æ•°å€¼ç›¸åŒ</strong>ï¼Œå› æ­¤ç›´æ¥æ¯”è¾ƒæŒ‡é’ˆæ˜¯ä¸æ˜¯ç›¸åŒå°±å¯ä»¥äº†</p>
<p>ç”±äºé¢˜ç›®è¯´çš„ç›¸äº¤çš„ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœå­˜åœ¨ç›¸äº¤çš„æŒ‡é’ˆä½ç½®ï¼Œåªå¯èƒ½å‡ºç°åœ¨åé¢åªéœ€è¦è€ƒè™‘åˆ©ç”¨åŒæŒ‡é’ˆä»ç›¸å·®çš„æ•°å€¼ä½å¼€å§‹éå†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">ListNode *<span class="hljs-title">getIntersectionNode</span><span class="hljs-params">(ListNode *headA, ListNode *headB)</span> </span>&#123;<br>        ListNode* curA = headA;<br>        ListNode* curB = headB;<br>        <span class="hljs-type">int</span> lenA = <span class="hljs-number">0</span>, lenB = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(curA != <span class="hljs-literal">NULL</span>)&#123;<br>            lenA++;<br>            curA = curA -&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">while</span>(curB != <span class="hljs-literal">NULL</span>)&#123;<br>            lenB++;<br>            curB = curB -&gt;next;<br>        &#125;<br>        curA = headA;<br>        curB = headB;<br>        <span class="hljs-keyword">if</span>(lenB&gt; lenA)&#123;<br>            <span class="hljs-built_in">swap</span>(lenA,lenB);<br>            <span class="hljs-built_in">swap</span>(curA, curB);<br>        &#125;<br><br>        <span class="hljs-type">int</span> gap = lenA - lenB;<br>        <span class="hljs-keyword">while</span>(gap--)&#123;<br>            curA =  curA-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">while</span>(curA!=<span class="hljs-literal">NULL</span>)&#123;<br>            <span class="hljs-keyword">if</span>(curA == curB)&#123;<br>                <span class="hljs-keyword">return</span> curA;<br>            &#125;<br>            curA = curA-&gt;next;<br>            curB = curB-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ç¯å½¢é“¾è¡¨">ç¯å½¢é“¾è¡¨</h3>
<p><a
href="https://leetcode.cn/problems/linked-list-cycle-ii/description/">https://leetcode.cn/problems/linked-list-cycle-ii/description/</a></p>
<p>åˆ¤æ–­æ˜¯å¦æ˜¯æœ‰è¿˜å­˜åœ¨ï¼Œå¦‚æœæœ‰é‚£ä¹ˆè¿”å›å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸‹æ ‡</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119200331204.png" alt="ç¯å½¢é“¾è¡¨" style="zoom:50%;" /></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">è¾“å…¥ï¼š<span class="hljs-built_in">head</span> = [3,2,0,-4], pos = 1<br>è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 1 çš„é“¾è¡¨èŠ‚ç‚¹<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>è¿™é“é¢˜ç”¨å¿«æ…¢æŒ‡é’ˆçš„æ€è·¯ï¼Œå°±æ˜¯æ…¢æŒ‡é’ˆæ¯æ¬¡åªèµ°ä¸€æ­¥ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œå¦‚æœåœ¨åˆ°è¾¾nullä¹‹å‰å‡ºç°å¿«æ…¢æŒ‡é’ˆæŒ‡å‘äº†åŒä¸€ä¸ªåœ°æ–¹ï¼Œè¯´æ˜è¿™ä¸ª<strong>é“¾è¡¨æœ‰ç¯å­˜åœ¨</strong>ï¼Œé‚£ä¹ˆæ€ä¹ˆåˆ¤æ–­ä¸‹æ ‡çš„ä½ç½®å‘¢ï¼Ÿ</p>
<p>å…·ä½“çš„è¯æ˜è¿‡ç¨‹ï¼š</p>
<figure>
<img
src="../../../../../Library/Application%20Support/typora-user-images/image-20240119200838486.png"
alt="ç¯å½¢é“¾è¡¨" />
<figcaption aria-hidden="true">ç¯å½¢é“¾è¡¨</figcaption>
</figure>
<p>ç›¸é‡æ—¶slowæŒ‡é’ˆèµ°è¿‡çš„èŠ‚ç‚¹æ•°ä¸º: <code>x + y</code>ï¼Œ
fastæŒ‡é’ˆèµ°è¿‡çš„èŠ‚ç‚¹æ•°ï¼š<code>x + y + n (y + z)</code>ï¼Œnä¸ºfastæŒ‡é’ˆåœ¨ç¯å†…èµ°äº†nåœˆæ‰é‡åˆ°slowæŒ‡é’ˆï¼Œ
ï¼ˆy+zï¼‰ä¸º ä¸€åœˆå†…èŠ‚ç‚¹çš„ä¸ªæ•°Aã€‚</p>
<p>å› ä¸ºfastæŒ‡é’ˆæ˜¯ä¸€æ­¥èµ°ä¸¤ä¸ªèŠ‚ç‚¹ï¼ŒslowæŒ‡é’ˆä¸€æ­¥èµ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ æ‰€ä»¥
fastæŒ‡é’ˆèµ°è¿‡çš„èŠ‚ç‚¹æ•° = slowæŒ‡é’ˆèµ°è¿‡çš„èŠ‚ç‚¹æ•° * 2ï¼š</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><code class="hljs lisp">(<span class="hljs-name">x</span> + y) * <span class="hljs-number">2</span> = x + y + n (<span class="hljs-name">y</span> + z)<br></code></pre></td></tr></table></figure>
<p>ä¸¤è¾¹æ¶ˆæ‰ä¸€ä¸ªï¼ˆx+yï¼‰: <code>x + y = n (y + z)</code></p>
<p>å› ä¸ºè¦æ‰¾ç¯å½¢çš„å…¥å£ï¼Œé‚£ä¹ˆè¦æ±‚çš„æ˜¯xï¼Œå› ä¸ºxè¡¨ç¤º å¤´ç»“ç‚¹åˆ°
ç¯å½¢å…¥å£èŠ‚ç‚¹çš„çš„è·ç¦»ã€‚</p>
<p>æ‰€ä»¥è¦æ±‚x ï¼Œå°†xå•ç‹¬æ”¾åœ¨å·¦é¢ï¼š<code>x = n (y + z) - y</code> ,</p>
<p>å†ä»n(y+z)ä¸­æå‡ºä¸€ä¸ª
ï¼ˆy+zï¼‰æ¥ï¼Œæ•´ç†å…¬å¼ä¹‹åä¸ºå¦‚ä¸‹å…¬å¼ï¼š<code>x = (n - 1) (y + z) + z</code>
æ³¨æ„è¿™é‡Œnä¸€å®šæ˜¯å¤§äºç­‰äº1çš„ï¼Œå› ä¸º
fastæŒ‡é’ˆè‡³å°‘è¦å¤šèµ°ä¸€åœˆæ‰èƒ½ç›¸é‡slowæŒ‡é’ˆ</p>
<p>æ‰€ä»¥å¯ä»¥å¾—åˆ°çš„è§„å¾‹æ˜¯ï¼š<strong>ä»å¤´ç»“ç‚¹å‡ºå‘ä¸€ä¸ªæŒ‡é’ˆï¼Œä»ç›¸é‡èŠ‚ç‚¹
ä¹Ÿå‡ºå‘ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸¤ä¸ªæŒ‡é’ˆæ¯æ¬¡åªèµ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ
é‚£ä¹ˆå½“è¿™ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡çš„æ—¶å€™å°±æ˜¯ ç¯å½¢å…¥å£çš„èŠ‚ç‚¹</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">ListNode *<span class="hljs-title">detectCycle</span><span class="hljs-params">(ListNode *head)</span> </span>&#123;<br>        ListNode* fast = head;<br>        ListNode* slow = head;<br>        <span class="hljs-keyword">while</span>(fast!=<span class="hljs-literal">NULL</span>&amp;&amp; fast-&gt;next!=<span class="hljs-literal">NULL</span>)&#123;<br>            slow = slow-&gt;next;<br>            fast = fast-&gt;next-&gt;next;<br>            <span class="hljs-comment">//è¯´æ˜æ‰¾åˆ°äº†</span><br>            <span class="hljs-keyword">if</span>(slow==fast)&#123;<br>                ListNode* index1 = fast;<br>                ListNode* index2 = head;<br>                <span class="hljs-keyword">while</span>(index1!=index2)&#123;<br>                    index1 = index1-&gt;next;<br>                    index2 = index2 -&gt;next;<br>                &#125;<br>                <span class="hljs-keyword">return</span> index2;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="æ¥é›¨æ°´">æ¥é›¨æ°´</h3>
<p>ç»™å®š <code>n</code> ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º <code>1</code>
çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/rainwatertrap.png"
alt="æ¥é›¨æ°´" />
<figcaption aria-hidden="true">æ¥é›¨æ°´</figcaption>
</figure>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šheight = [<span class="hljs-number">0,1,0,2</span>,<span class="hljs-number">1,0,1,3</span>,<span class="hljs-number">2,1,2,1</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">6</span><br>è§£é‡Šï¼šä¸Šé¢æ˜¯ç”±æ•°ç»„ [<span class="hljs-number">0,1,0,2</span>,<span class="hljs-number">1,0,1,3</span>,<span class="hljs-number">2,1,2,1</span>] è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ <span class="hljs-number">6</span> ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚ <br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight accesslog"><table><tr><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šheight = <span class="hljs-string">[4,2,0,3,2,5]</span><br>è¾“å‡ºï¼š<span class="hljs-number">9</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>æ‰¾åˆ°æœ€å¤§çš„å·¦è¾¹å’Œæœ€å¤§çš„å³è¾¹å¹¶ç›¸å‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">trap</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; height)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(height.<span class="hljs-built_in">size</span>()&lt;=<span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">maxLeft</span><span class="hljs-params">(height.size(), <span class="hljs-number">0</span>)</span></span>;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">maxRight</span><span class="hljs-params">(height.size(), <span class="hljs-number">0</span>)</span></span>;<br>        <span class="hljs-type">int</span> size = maxRight.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-comment">//è®°å½•æ¯ä¸ªæŸ±å­å·¦è¾¹æŸ±å­çš„æœ€å¤§é«˜åº¦</span><br>        maxLeft[<span class="hljs-number">0</span>] = height[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;size;i++)&#123;<br>            maxLeft[i] = <span class="hljs-built_in">max</span>(height[i],maxLeft[i<span class="hljs-number">-1</span>]);<br>        &#125;<br>        <span class="hljs-comment">//è®°å½•æ¯ä¸ªæŸ±å­å³è¾¹æŸ±å­çš„æœ€å¤§é«˜åº¦</span><br>        maxRight[size<span class="hljs-number">-1</span>] = height[size<span class="hljs-number">-1</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=size<span class="hljs-number">-2</span>;i&gt;=<span class="hljs-number">0</span>;i--)&#123;<br>            maxRight[i] = <span class="hljs-built_in">max</span>(height[i],maxRight[i+<span class="hljs-number">1</span>]);<br>        &#125;<br>        <span class="hljs-type">int</span> sum=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;size;i++)&#123;<br>            <span class="hljs-type">int</span> count = <span class="hljs-built_in">min</span>(maxLeft[i], maxRight[i])-height[i];<br>            <span class="hljs-keyword">if</span>(count &gt; <span class="hljs-number">0</span>) sum+=count;<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="æŸ±å½¢å›¾ä¸­çš„æœ€å¤§çŸ©å½¢">æŸ±å½¢å›¾ä¸­çš„æœ€å¤§çŸ©å½¢</h3>
<p><a
href="https://leetcode.cn/problems/largest-rectangle-in-histogram/description/">https://leetcode.cn/problems/largest-rectangle-in-histogram/description/</a></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240129144103735.png" alt="æœ€å¤§çŸ©å½¢é—®é¢˜" style="zoom:67%;" /></p>
<figure class="highlight accesslog"><table><tr><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šheights = <span class="hljs-string">[2,1,5,6,2,3]</span><br>è¾“å‡ºï¼š<span class="hljs-number">10</span><br>è§£é‡Šï¼šæœ€å¤§çš„çŸ©å½¢ä¸ºå›¾ä¸­çº¢è‰²åŒºåŸŸï¼Œé¢ç§¯ä¸º <span class="hljs-number">10</span><br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">largestRectangleArea</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; heights)</span> </span>&#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">minLeft</span><span class="hljs-params">(heights.size())</span></span>;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">minRight</span><span class="hljs-params">(heights.size())</span></span>;<br>        <span class="hljs-type">int</span> size = heights.<span class="hljs-built_in">size</span>();<br><br>        <span class="hljs-comment">//è®°å½•æ¯ä¸ªæŸ±å­å·¦è¾¹ç¬¬ä¸€ä¸ªå°äºè¯¥æŸ±å­çš„ä¸‹æ ‡</span><br>        minLeft[<span class="hljs-number">0</span>] = <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;size;i++)&#123;<br>            <span class="hljs-type">int</span> t= i<span class="hljs-number">-1</span>;<br>            <span class="hljs-keyword">while</span>(t&gt;=<span class="hljs-number">0</span>&amp;&amp;heights[t]&gt;=heights[i]) t=minLeft[t];<br>            minLeft[i]=t;<br>        &#125;<br>        <span class="hljs-comment">//è®°å½•æ¯ä¸ªæŸ±å³è¾¹ç¬¬ä¸€ä¸ªå°äºè¯¥æŸ±å­çš„ä¸‹æ ‡</span><br>        minRight[size<span class="hljs-number">-1</span>]=size;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=size <span class="hljs-number">-2</span>;i&gt;=<span class="hljs-number">0</span>;i--)&#123;<br>            <span class="hljs-type">int</span> t=i+<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">while</span>(t&lt;size&amp;&amp;heights[t]&gt;=heights[i]) t=minRight[t];<br>            minRight[i]=t;<br>        &#125;<br><br>        <span class="hljs-type">int</span> res=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;size;i++)&#123;<br>            <span class="hljs-type">int</span> sum=heights[i]*(minRight[i]-minLeft[i]<span class="hljs-number">-1</span>);<br>            res = <span class="hljs-built_in">max</span>(sum,res);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="äºŒå‰æ ‘">äºŒå‰æ ‘</h1>
<h1 id="æ·±æœå›æº¯">æ·±æœå›æº¯</h1>
<p><strong>æ·±åº¦ä¼˜å…ˆæœç´¢çš„ä¸‰éƒ¨æ›²ï¼š</strong></p>
<ol type="1">
<li>ç¡®å®šæœç´¢å‡½æ•°çš„è¿”å›å€¼ä»¥åŠæœç´¢å‡½æ•°çš„å‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆ</li>
<li>ç¡®å®šæ¯æ¬¡æ‰¾åˆ°å¶å­ç»“ç‚¹çš„ç»ˆæ­¢æ¡ä»¶</li>
<li>ç¡®å®šforå•å±‚æœç´¢çš„é€»è¾‘ï¼ŒåŒ…å«push,backtracking,pop</li>
</ol>
<p>åˆ«å¿˜äº†æœ€å¼€å§‹çš„åˆå§‹åŒ–æ­¥éª¤</p>
<h3 id="ç»„åˆé—®é¢˜">ç»„åˆé—®é¢˜</h3>
<p><a
href="https://leetcode.cn/problems/combinations/description/">https://leetcode.cn/problems/combinations/description/</a></p>
<p>ç»™å®šä¸¤ä¸ªæ•´æ•° <code>n</code> å’Œ <code>k</code>ï¼Œè¿”å›èŒƒå›´
<code>[1, n]</code> ä¸­æ‰€æœ‰å¯èƒ½çš„ <code>k</code> ä¸ªæ•°çš„ç»„åˆã€‚</p>
<p>ä½ å¯ä»¥æŒ‰ <strong>ä»»ä½•é¡ºåº</strong> è¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šn = 4, k = 2<br>è¾“å‡ºï¼š<br><span class="hljs-comment">[</span><br><span class="hljs-comment">  <span class="hljs-comment">[2,4]</span>,</span><br><span class="hljs-comment">  <span class="hljs-comment">[3,4]</span>,</span><br><span class="hljs-comment">  <span class="hljs-comment">[2,3]</span>,</span><br><span class="hljs-comment">  <span class="hljs-comment">[1,2]</span>,</span><br><span class="hljs-comment">  <span class="hljs-comment">[1,3]</span>,</span><br><span class="hljs-comment">  <span class="hljs-comment">[1,4]</span>,</span><br><span class="hljs-comment">]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šn = <span class="hljs-number">1</span>, k = <span class="hljs-number">1</span><br>è¾“å‡ºï¼š<span class="hljs-string">[[1]]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼Œä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•è¿›è¡Œå¤„ç†</p>
<ul>
<li>é¦–å…ˆè¦åŒºåˆ†privateå’Œpublicè¿™ä¸¤ä¸ªéƒ¨åˆ†åˆ†åˆ«åšçš„å†…å®¹ï¼Œprivateä¸»è¦å°±æ˜¯å†™å‡ºå›æº¯çš„å‡½æ•°ä¸»ä½“å¹¶ä¸”å¯èƒ½éœ€è¦çš„æ•°æ®ç»“æ„</li>
<li>publicä¸­å°±å¯¹å‡½æ•°è¿›è¡Œè·³ç”¨ä»¥åŠæ•°æ®ç»“æ„çš„ä½¿ç”¨</li>
<li>ç¬¬ä¸€æ­¥å°±æ˜¯ç¡®å®šå‡½æ•°çš„ç±»å‹å’Œè¿”å›ï¼Œè¿™é‡Œç”¨äº†ä¸€ä¸ª <code>startindex</code>
ç”¨æ¥å­˜å‚¨ä¸‹ä¸€æ¬¡è¿›è¡Œé€‰æ‹©çš„ä½ç½®ç‚¹è¿™æ ·èƒ½å¤Ÿé¿å…é‡å¤</li>
<li>åŒæ—¶å‡½æ•°çš„è¿”å›ç±»å‹æ˜¯äºŒä½çš„å‘é‡ç»“æ„</li>
<li>åŒæ—¶å®šä¹‰ç»ˆæ­¢æ¡ä»¶å’Œå•å±‚å¾ªç¯çš„å†…å®¹</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; result;<br>    vector&lt;<span class="hljs-type">int</span>&gt;path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(<span class="hljs-type">int</span> n,<span class="hljs-type">int</span> k, <span class="hljs-type">int</span> startindex)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(path.<span class="hljs-built_in">size</span>()==k)&#123;<br>            result.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = startindex;i&lt;=n;i++)&#123;<br>            path.<span class="hljs-built_in">push_back</span>(i);<br>            <span class="hljs-built_in">backtracking</span>(n,k,i+<span class="hljs-number">1</span>);<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">combine</span>(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span> k)&#123;<br>        <span class="hljs-built_in">backtracking</span>(n,k,<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ç»„åˆé—®é¢˜iii">ç»„åˆé—®é¢˜III</h3>
<p><a
href="https://leetcode.cn/problems/combination-sum-iii/submissions/496823507/">https://leetcode.cn/problems/combination-sum-iii/submissions/496823507/</a></p>
<p>æ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸º <code>n</code> çš„ <code>k</code>
ä¸ªæ•°çš„ç»„åˆï¼Œä¸”æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼š</p>
<ul>
<li>åªä½¿ç”¨æ•°å­—1åˆ°9</li>
<li>æ¯ä¸ªæ•°å­— <strong>æœ€å¤šä½¿ç”¨ä¸€æ¬¡</strong></li>
</ul>
<p>è¿”å› <em>æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆç»„åˆçš„åˆ—è¡¨</em>
ã€‚è¯¥åˆ—è¡¨ä¸èƒ½åŒ…å«ç›¸åŒçš„ç»„åˆä¸¤æ¬¡ï¼Œç»„åˆå¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›ã€‚</p>
<p><strong>ç¤ºä¾‹:</strong></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥: k = <span class="hljs-number">3</span>, n = <span class="hljs-number">7</span><br>è¾“å‡º: <span class="hljs-string">[[1,2,4]]</span><br>è§£é‡Š:<br><span class="hljs-number">1</span> + <span class="hljs-number">2</span> + <span class="hljs-number">4</span> = <span class="hljs-number">7</span><br>æ²¡æœ‰å…¶ä»–ç¬¦åˆçš„ç»„åˆäº†ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šç®€å•çš„æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯å¯ä»¥é€‚å½“é‡‡ç”¨<strong>å‡ææ“ä½œå’Œå¿…è¦çš„æ—¶å€™æ·»åŠ sumå˜é‡è¿›è¡Œè®°å½•</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; result;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtacking</span><span class="hljs-params">(<span class="hljs-type">int</span> k, <span class="hljs-type">int</span> n,<span class="hljs-type">int</span> startindex, <span class="hljs-type">int</span> sum)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(path.<span class="hljs-built_in">size</span>()==k)&#123;<br>            <span class="hljs-keyword">if</span>(sum == n) result.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i= startindex;i&lt;=<span class="hljs-number">9</span>;i++)&#123;<br>            sum+=i;<br>            path.<span class="hljs-built_in">push_back</span>(i);<br>            <span class="hljs-built_in">backtacking</span>(k,n,i+<span class="hljs-number">1</span>,sum);<br>            sum-=i;<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">combinationSum3</span>(<span class="hljs-type">int</span> k, <span class="hljs-type">int</span> n) &#123;<br>        <span class="hljs-built_in">backtacking</span>(k,n,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>ä¸ºäº†ä¼˜åŒ–å¯ä»¥åšä¸€ä¸ªå‰ªææ“ä½œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (sum &gt; targetSum) &#123; <span class="hljs-comment">// å‰ªææ“ä½œ</span><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="ç”µè¯å·ç ç»„åˆé—®é¢˜">ç”µè¯å·ç ç»„åˆé—®é¢˜</h3>
<p>ç»™å®šä¸€ä¸ªä»…åŒ…å«æ•°å­— <code>2-9</code>
çš„å­—ç¬¦ä¸²ï¼Œè¿”å›æ‰€æœ‰å®ƒèƒ½è¡¨ç¤ºçš„å­—æ¯ç»„åˆã€‚ç­”æ¡ˆå¯ä»¥æŒ‰
<strong>ä»»æ„é¡ºåº</strong> è¿”å›ã€‚</p>
<p>ç»™å‡ºæ•°å­—åˆ°å­—æ¯çš„æ˜ å°„å¦‚ä¸‹ï¼ˆä¸ç”µè¯æŒ‰é”®ç›¸åŒï¼‰ã€‚æ³¨æ„ 1
ä¸å¯¹åº”ä»»ä½•å­—æ¯ã€‚</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240119211247536.png" alt="ç”µè¯å·ç çš„æŒ‰é”®" style="zoom:50%;" /></p>
<p><strong>ç¤ºä¾‹ ï¼š</strong></p>
<figure class="highlight ada"><table><tr><td class="code"><pre><code class="hljs ada">è¾“å…¥ï¼š<span class="hljs-keyword">digits</span> = <span class="hljs-string">&quot;23&quot;</span><br>è¾“å‡ºï¼š[<span class="hljs-string">&quot;ad&quot;</span>,<span class="hljs-string">&quot;ae&quot;</span>,<span class="hljs-string">&quot;af&quot;</span>,<span class="hljs-string">&quot;bd&quot;</span>,<span class="hljs-string">&quot;be&quot;</span>,<span class="hljs-string">&quot;bf&quot;</span>,<span class="hljs-string">&quot;cd&quot;</span>,<span class="hljs-string">&quot;ce&quot;</span>,<span class="hljs-string">&quot;cf&quot;</span>]<br></code></pre></td></tr></table></figure>
<p>è¿™é“é¢˜éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œé¦–å…ˆç¬¬ä¸€æ­¥åšå¥½mapå­—ç¬¦çš„æ˜ å°„</p>
<p>ç¬¬äºŒæ­¥æœ€å…³é”®æ˜¯è¦å†™æ¸…æ¥šå›æº¯å‡½æ•°çš„å‚æ•°å¯èƒ½åŒ…å«indexï¼Œå°±æ˜¯ç¬¬å‡ ä½ç½®çš„å­—ç¬¦ï¼ŒåŒæ—¶éœ€è¦åŒºåˆ†backtrackingå‡½æ•°çš„forå¾ªç¯çš„å†…å®¹æ˜¯ç›¸å½“äºæ¨ªå‘çš„éå†ï¼Œè€Œå‡½æ•°ä½“å†…éƒ¨çš„å®ç°æ˜¯çºµå‘çš„éå†</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">private</span>:<br><span class="hljs-type">const</span> string letterMap[<span class="hljs-number">10</span>] = &#123;<br>        <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// 0</span><br>        <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// 1</span><br>        <span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-comment">// 2</span><br>        <span class="hljs-string">&quot;def&quot;</span>, <span class="hljs-comment">// 3</span><br>        <span class="hljs-string">&quot;ghi&quot;</span>, <span class="hljs-comment">// 4</span><br>        <span class="hljs-string">&quot;jkl&quot;</span>, <span class="hljs-comment">// 5</span><br>        <span class="hljs-string">&quot;mno&quot;</span>, <span class="hljs-comment">// 6</span><br>        <span class="hljs-string">&quot;pqrs&quot;</span>, <span class="hljs-comment">// 7</span><br>        <span class="hljs-string">&quot;tuv&quot;</span>, <span class="hljs-comment">// 8</span><br>        <span class="hljs-string">&quot;wxyz&quot;</span>, <span class="hljs-comment">// 9</span><br>    &#125;;<br>    vector&lt;string&gt; result;<br>    string s;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(<span class="hljs-type">const</span> string digits,<span class="hljs-type">int</span> index, string s)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(digits.<span class="hljs-built_in">size</span>()==<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(index==digits.<span class="hljs-built_in">size</span>())&#123;<br>            result.<span class="hljs-built_in">push_back</span>(s);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">int</span> digit = digits[index]-<span class="hljs-string">&#x27;0&#x27;</span>;<br>        string letters = letterMap[digit];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i= <span class="hljs-number">0</span>;i&lt;letters.<span class="hljs-built_in">size</span>();i++)&#123;<br>            s.<span class="hljs-built_in">push_back</span>(letters[i]);<br>            <span class="hljs-built_in">backtracking</span>(digits, index+<span class="hljs-number">1</span>, s);<br>            s.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">letterCombinations</span><span class="hljs-params">(string digits)</span> </span>&#123;<br>        <span class="hljs-built_in">backtracking</span>(digits,<span class="hljs-number">0</span>,<span class="hljs-string">&quot;&quot;</span>);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ç»„åˆæ€»å’Œ">ç»„åˆæ€»å’Œ</h3>
<p><a
href="https://leetcode.cn/problems/combination-sum/">https://leetcode.cn/problems/combination-sum/</a></p>
<p>ç»™ä½ ä¸€ä¸ª <strong>æ— é‡å¤å…ƒç´ </strong> çš„æ•´æ•°æ•°ç»„
<code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° <code>target</code> ï¼Œæ‰¾å‡º
<code>candidates</code> ä¸­å¯ä»¥ä½¿æ•°å­—å’Œä¸ºç›®æ ‡æ•° <code>target</code> çš„
æ‰€æœ‰ <strong>ä¸åŒç»„åˆ</strong> ï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼è¿”å›ã€‚ä½ å¯ä»¥æŒ‰
<strong>ä»»æ„é¡ºåº</strong> è¿”å›è¿™äº›ç»„åˆã€‚</p>
<p><code>candidates</code> ä¸­çš„ <strong>åŒä¸€ä¸ª</strong> æ•°å­—å¯ä»¥
<strong>æ— é™åˆ¶é‡å¤è¢«é€‰å–</strong>
ã€‚å¦‚æœè‡³å°‘ä¸€ä¸ªæ•°å­—çš„è¢«é€‰æ•°é‡ä¸åŒï¼Œåˆ™ä¸¤ç§ç»„åˆæ˜¯ä¸åŒçš„ã€‚</p>
<p>å¯¹äºç»™å®šçš„è¾“å…¥ï¼Œä¿è¯å’Œä¸º <code>target</code> çš„ä¸åŒç»„åˆæ•°å°‘äº
<code>150</code> ä¸ªã€‚</p>
<p><strong>ç¤ºä¾‹ ï¼š</strong></p>
<figure class="highlight tap"><table><tr><td class="code"><pre><code class="hljs tap">è¾“å…¥ï¼šcandidates = [2,3,6,7], target = 7<br>è¾“å‡ºï¼š[[2,2,3],[7]]<br>è§£é‡Šï¼š<br>2 å’Œ<span class="hljs-number"> 3 </span>å¯ä»¥å½¢æˆä¸€ç»„å€™é€‰ï¼Œ2 +<span class="hljs-number"> 2 </span>+<span class="hljs-number"> 3 </span>=<span class="hljs-number"> 7 </span>ã€‚æ³¨æ„<span class="hljs-number"> 2 </span>å¯ä»¥ä½¿ç”¨å¤šæ¬¡ã€‚<br>7 ä¹Ÿæ˜¯ä¸€ä¸ªå€™é€‰ï¼Œ<span class="hljs-number"> 7 </span>=<span class="hljs-number"> 7 </span>ã€‚<br>ä»…æœ‰è¿™ä¸¤ç§ç»„åˆã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>é¢˜ç›®æœ€å…³é”®çš„ç‚¹åœ¨äºèƒ½é‡å¤ä½¿ç”¨å…ƒç´ ä½†æ˜¯ä¸èƒ½<strong>é‡å¤å…ƒç´ çš„ç»„åˆä¸èƒ½è¢«é‡å¤è¾“å‡º</strong></p>
<p>å› æ­¤éœ€è¦è°ƒæ•´startindexçš„å¼€å§‹çš„ä½ç½®æ˜¯åœ¨<code>backtracking(candidates,target,sum,i);</code>æ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™ä»iå¼€å§‹ä¿è¯è¿˜èƒ½ç”¨åˆ°è‡ªå·±çš„å…ƒç´ é‡å¤ä½¿ç”¨ï¼Œè¿˜æœ‰<strong>æœ€é‡è¦çš„
<code>sort(candidates.begin(), candidates.end()); // éœ€è¦æ’åº</code></strong></p>
<p>æ’åºä¹‹åèƒ½å¤Ÿå¾ˆå¥½çš„è¿›è¡Œå‰ªæï¼Œå°†ä¸€äº›åŠ äº†ä¹‹åå…ƒç´ å¤§äºç›®æ ‡çš„åˆ æ‰ç›´æ¥è·³è¿‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp;candidates, <span class="hljs-type">int</span> target, <span class="hljs-type">int</span> sum, <span class="hljs-type">int</span> startindex)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(sum==target)&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=startindex;i&lt;candidates.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(sum&gt;target)&#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            sum+=candidates[i];<br>            path.<span class="hljs-built_in">push_back</span>(candidates[i]);<br>            <span class="hljs-built_in">backtracking</span>(candidates,target,sum,i);<br>            sum-=candidates[i];<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">combinationSum</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; candidates, <span class="hljs-type">int</span> target) &#123;<br>        <span class="hljs-built_in">sort</span>(candidates.<span class="hljs-built_in">begin</span>(), candidates.<span class="hljs-built_in">end</span>()); <span class="hljs-comment">// éœ€è¦æ’åº</span><br>        <span class="hljs-built_in">backtracking</span>(candidates, target, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ç»„åˆæ€»å’Œii">ç»„åˆæ€»å’ŒII</h3>
<p><a
href="https://leetcode.cn/problems/combination-sum-ii/description/">https://leetcode.cn/problems/combination-sum-ii/description/</a></p>
<p>ç»™å®šä¸€ä¸ªå€™é€‰äººç¼–å·çš„é›†åˆ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•°
<code>target</code> ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º
<code>target</code> çš„ç»„åˆã€‚</p>
<p><code>candidates</code>
ä¸­çš„æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­<strong>åªèƒ½ä½¿ç”¨</strong> <strong>ä¸€æ¬¡</strong>
ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚</p>
<p><strong>ç¤ºä¾‹ :</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥: candidates = <span class="hljs-comment">[10,1,2,7,6,1,5]</span>, target = 8,<br>è¾“å‡º:<br><span class="hljs-comment">[</span><br><span class="hljs-comment"><span class="hljs-comment">[1,1,6]</span>,</span><br><span class="hljs-comment"><span class="hljs-comment">[1,2,5]</span>,</span><br><span class="hljs-comment"><span class="hljs-comment">[1,7]</span>,</span><br><span class="hljs-comment"><span class="hljs-comment">[2,6]</span></span><br><span class="hljs-comment">]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>è¿™ä¸ªåœ°æ–¹æœ€å¤§çš„å›°éš¾åœ¨äºæ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼ŒåŒæ—¶é›†åˆä¸­çš„å…ƒç´ å­˜åœ¨é‡å¤çš„å…ƒç´ ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ‰èƒ½<strong>å¯¹å…ƒç´ è¿›è¡Œå»é‡å¤„ç†</strong>å‘¢ï¼Œå°±æ˜¯è®©æ¯ä¸ªå…ƒç´ åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡</p>
<p>å»é‡çš„æ“ä½œå°±åœ¨äº
<code>vector&lt;bool&gt; used(candidates.size(),false);         sort(candidates.begin(), candidates.end());</code></p>
<p>é¦–å…ˆéœ€è¦åœ¨
<code>backtracking</code>ä¸­å®šä¸€ä¸ªcontinueï¼Œè¿™ä¸ªåœ°æ–¹æ˜¯ä¸ºäº†ç­›é€‰ä¸æ˜¯é‡å¤çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¦‚ä½•åŒºåˆ†å¼€æ˜¯å¦æ˜¯åŒä¸€ä¸ªæ•°ç»„ä¸­é‡å¤çš„å…ƒç´ è€Œä¸æ˜¯é‡å¤åˆ©ç”¨çš„å…ƒç´ å‘¢ï¼Ÿ</p>
<ul>
<li><code>i&gt;0&amp;&amp;candidates[i]==candidates[i-1]</code>è¿™ä¸ªåœ°æ–¹è¡¨æ˜äº†å¯¹å…ƒç´ ç›¸é‚»ä¹‹é—´è¿›è¡Œæ¯”è¾ƒ</li>
<li><code>used[i-1]==false</code>å¦‚æœè¿™ä¸ªåœ°æ–¹æ˜¯falseï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªå…ƒç´ æ˜¯åŒä¸€å±‚çš„å…ƒç´ (åŒä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ )</li>
<li>æ³¨æ„
<code>i&lt;candidates.size()&amp;&amp;sum + candidates[i] &lt;= target</code>ä¸ºäº†é¿å…å‡ºç°è¶…å‡ºæ—¶é—´é™åˆ¶çš„æƒ…å†µ</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; candidates, <span class="hljs-type">int</span> target, <span class="hljs-type">int</span> sum, <span class="hljs-type">int</span> startindex, vector&lt;<span class="hljs-type">bool</span>&gt;used)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(sum==target)&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i= startindex;i&lt;candidates.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">0</span>&amp;&amp;candidates[i]==candidates[i<span class="hljs-number">-1</span>]&amp;&amp;used[i<span class="hljs-number">-1</span>]==<span class="hljs-literal">false</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            sum+=candidates[i];<br>            used[i]=<span class="hljs-literal">true</span>;<br>            path.<span class="hljs-built_in">push_back</span>(candidates[i]);<br>            <span class="hljs-built_in">backtracking</span>(candidates, target, sum, i+<span class="hljs-number">1</span>, used);<br>            used[i]=<span class="hljs-literal">false</span>;<br>            path.<span class="hljs-built_in">pop_back</span>();<br>            sum-=candidates[i];<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">combinationSum2</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; candidates, <span class="hljs-type">int</span> target) &#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">used</span><span class="hljs-params">(candidates.size(),<span class="hljs-literal">false</span>)</span></span>;<br>        <span class="hljs-built_in">sort</span>(candidates.<span class="hljs-built_in">begin</span>(), candidates.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-built_in">backtracking</span>(candidates, target, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, used);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="åˆ†å‰²å›æ–‡ä¸²">åˆ†å‰²å›æ–‡ä¸²</h3>
<p><a
href="https://leetcode.cn/problems/palindrome-partitioning/description/">https://leetcode.cn/problems/palindrome-partitioning/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code>ï¼Œè¯·ä½ å°† <code>s</code>
åˆ†å‰²æˆä¸€äº›å­ä¸²ï¼Œä½¿æ¯ä¸ªå­ä¸²éƒ½æ˜¯ <strong>å›æ–‡ä¸²</strong> ã€‚è¿”å›
<code>s</code> æ‰€æœ‰å¯èƒ½çš„åˆ†å‰²æ–¹æ¡ˆã€‚</p>
<p><strong>å›æ–‡ä¸²</strong> æ˜¯æ­£ç€è¯»å’Œåç€è¯»éƒ½ä¸€æ ·çš„å­—ç¬¦ä¸²ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;aab&quot;</span><br>è¾“å‡ºï¼š[[<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>],[<span class="hljs-string">&quot;aa&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>]]<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<ul>
<li>é¦–å…ˆç»™å‡ºå›æ–‡å­—ç¬¦çš„åˆ¤æ–­æ–¹æ³•ï¼šé¦–å°¾æŒ‡é’ˆæ¥å›æ¯”è¾ƒ</li>
<li>å›æº¯ç®—æ³•ä¸­æœ€å…³é”®çš„ç‚¹åœ¨äº<code>startindex</code>çš„ä½¿ç”¨ï¼Œåˆ©ç”¨è¿™ä¸ªæ¥ç§»åŠ¨
<code>s.substr(startindex, i-startindex+1)</code>æ¥æˆªå–å¹¶ç­›é€‰å‡ºç›¸åº”çš„å­—ç¬¦ä¸²çš„å€¼è¿›è¡Œå›æ–‡æ¯”è¾ƒ</li>
<li>å›æº¯çš„ç»ˆæ­¢æ¡ä»¶æ˜¯
<code>startindex&gt;=s.size()</code>å¦‚æœè¶…å‡ºäº†èŒƒå›´é‚£ä¹ˆä¹…è¯´æ˜åˆ°ç»ˆç‚¹äº†</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;string&gt;&gt; res;<br>    vector&lt;string&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">ishuiwen</span><span class="hljs-params">(string s, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end)</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = start,j = end;i&lt;j;i++,j--)&#123;<br>            <span class="hljs-keyword">if</span>(s[i]!=s[j])&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(string s, <span class="hljs-type">int</span> startindex)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(startindex&gt;=s.<span class="hljs-built_in">size</span>())&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=startindex;i&lt;s.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ishuiwen</span>(s,startindex,i))&#123;<br>                string str = s.<span class="hljs-built_in">substr</span>(startindex, i-startindex+<span class="hljs-number">1</span>);<br>                path.<span class="hljs-built_in">push_back</span>(str);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-built_in">backtracking</span>(s,i+<span class="hljs-number">1</span>);<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;string&gt;&gt; <span class="hljs-built_in">partition</span>(string s) &#123;<br>        <span class="hljs-built_in">backtracking</span>(s,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å¤åŸipåœ°å€">å¤åŸIPåœ°å€</h3>
<p><a
href="https://leetcode.cn/problems/restore-ip-addresses/description/">https://leetcode.cn/problems/restore-ip-addresses/description/</a></p>
<p><strong>æœ‰æ•ˆ IP åœ°å€</strong> æ­£å¥½ç”±å››ä¸ªæ•´æ•°ï¼ˆæ¯ä¸ªæ•´æ•°ä½äº
<code>0</code> åˆ° <code>255</code> ä¹‹é—´ç»„æˆï¼Œä¸”ä¸èƒ½å«æœ‰å‰å¯¼
<code>0</code>ï¼‰ï¼Œæ•´æ•°ä¹‹é—´ç”¨ <code>'.'</code> åˆ†éš”ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼š<code>"0.1.2.201"</code> å’Œ<code>"192.168.1.1"</code> æ˜¯
<strong>æœ‰æ•ˆ</strong> IP åœ°å€ï¼Œä½†æ˜¯
<code>"0.011.255.245"</code>ã€<code>"192.168.1.312"</code> å’Œ
<code>"192.168@1.1"</code> æ˜¯ <strong>æ— æ•ˆ</strong> IP åœ°å€ã€‚</li>
</ul>
<p>ç»™å®šä¸€ä¸ªåªåŒ…å«æ•°å­—çš„å­—ç¬¦ä¸² <code>s</code> ï¼Œç”¨ä»¥è¡¨ç¤ºä¸€ä¸ª IP
åœ°å€ï¼Œè¿”å›æ‰€æœ‰å¯èƒ½çš„<strong>æœ‰æ•ˆ IP åœ°å€</strong>ï¼Œè¿™äº›åœ°å€å¯ä»¥é€šè¿‡åœ¨
<code>s</code> ä¸­æ’å…¥ <code>'.'</code> æ¥å½¢æˆã€‚ä½  <strong>ä¸èƒ½</strong>
é‡æ–°æ’åºæˆ–åˆ é™¤ <code>s</code> ä¸­çš„ä»»ä½•æ•°å­—ã€‚ä½ å¯ä»¥æŒ‰
<strong>ä»»ä½•</strong> é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ ï¼š</strong></p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;25525511135&quot;</span><br>è¾“å‡ºï¼š[<span class="hljs-string">&quot;255.255.11.135&quot;</span>,<span class="hljs-string">&quot;255.255.111.35&quot;</span>]<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<ul>
<li>å›æº¯ä¸‰éƒ¨æ›²ç¬¬ä¸€æ­¥ï¼šå¦‚ä½•ç¡®å®šå‡½æ•°çš„ç±»å‹ä»¥åŠå‚æ•°å‘¢ï¼Ÿé¦–å…ˆå‚æ•°è‚¯å®šåŒ…å«äº†sã€å¼€å§‹çš„ä½ç½®(å› ä¸ºè¦ä¸€ç›´å¾€åç§»åŠ¨å¹¶é€‰æ‹©)ã€ä»¥åŠä¸€ä¸ªæ ‡è®°ç”¨äºæ˜¯å¦å·²ç»æœ‰ä¸‰ä¸ªç‚¹</li>
<li>å†™å¥½åˆ¤æ–­æ˜¯å¦åˆæ³•çš„å‡½æ•°ï¼Œè¿™é‡Œæ¯”è¾ƒå¤šçš„é™·é˜±éœ€è¦æ³¨æ„</li>
<li>æ³¨æ„ï¼Œå½“æ”¾è¿›å»3ä¸ªç‚¹ä¹‹ååˆ«å¿˜äº†åˆ¤æ–­æœ€åä¸€ä½æ˜¯å¦æ»¡è¶³åˆæ³•æ€§çš„è¦æ±‚ï¼Œå®¹æ˜“å¿½ç•¥æœ€åä¸€ä½çš„æƒ…å†µ</li>
<li>æ³¨æ„å­—ç¬¦ä¸²çš„æ’å…¥ <code>s.inset(n,'.')</code> å’Œåˆ é™¤
<code>s.erase(n)</code></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;string&gt; res;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isvalid</span><span class="hljs-params">(string s, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(start&gt;end)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(s[start]==<span class="hljs-string">&#x27;0&#x27;</span>&amp;&amp;start!=end)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=start;i&lt;=end;i++)&#123;<br>            <span class="hljs-keyword">if</span> (s[i] &gt; <span class="hljs-string">&#x27;9&#x27;</span> || s[i] &lt; <span class="hljs-string">&#x27;0&#x27;</span>) &#123; <span class="hljs-comment">// é‡åˆ°éæ•°å­—å­—ç¬¦ä¸åˆæ³•</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            num=num*<span class="hljs-number">10</span>+(s[i]-<span class="hljs-string">&#x27;0&#x27;</span>);<br>            <span class="hljs-keyword">if</span>(num&gt;<span class="hljs-number">255</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(string s, <span class="hljs-type">int</span> startindex, <span class="hljs-type">int</span> pointnum)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(pointnum==<span class="hljs-number">3</span>)&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isvalid</span>(s, startindex, s.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>)) &#123;<br>                res.<span class="hljs-built_in">push_back</span>(s);<br>            &#125;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=startindex;i&lt;s.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isvalid</span>(s,startindex,i))&#123;<br>                s.<span class="hljs-built_in">insert</span>(s.<span class="hljs-built_in">begin</span>()+i+<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;.&#x27;</span>);<br>                pointnum++;<br>                <span class="hljs-built_in">backtracking</span>(s,i+<span class="hljs-number">2</span>,pointnum);<br>                pointnum--;<br>                s.<span class="hljs-built_in">erase</span>(s.<span class="hljs-built_in">begin</span>()+i+<span class="hljs-number">1</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">restoreIpAddresses</span><span class="hljs-params">(string s)</span> </span>&#123;<br>        <span class="hljs-built_in">backtracking</span>(s,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å­é›†">å­é›†</h3>
<p><a
href="https://leetcode.cn/problems/subsets/description/">https://leetcode.cn/problems/subsets/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ 
<strong>äº’ä¸ç›¸åŒ</strong> ã€‚è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p>
<p>è§£é›† <strong>ä¸èƒ½</strong> åŒ…å«é‡å¤çš„å­é›†ã€‚ä½ å¯ä»¥æŒ‰
<strong>ä»»æ„é¡ºåº</strong> è¿”å›è§£é›†ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,2,3]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[]</span>,<span class="hljs-comment">[1]</span>,<span class="hljs-comment">[2]</span>,<span class="hljs-comment">[1,2]</span>,<span class="hljs-comment">[3]</span>,<span class="hljs-comment">[1,3]</span>,<span class="hljs-comment">[2,3]</span>,<span class="hljs-comment">[1,2,3]</span>]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>è¿™é“é¢˜æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ç®€å•çš„éå†å°±å¯ä»¥äº†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums,<span class="hljs-type">int</span> startindex)</span></span>&#123;<br>        res.<span class="hljs-built_in">push_back</span>(path);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=startindex;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            path.<span class="hljs-built_in">push_back</span>(nums[i]);<br>            <span class="hljs-built_in">backtracking</span>(nums,i+<span class="hljs-number">1</span>);<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">subsets</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums) &#123;<br>        <span class="hljs-built_in">backtracking</span>(nums,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å­é›†ii">å­é›†II</h3>
<p><a
href="https://leetcode.cn/problems/subsets-ii/description/">https://leetcode.cn/problems/subsets-ii/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>
ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ï¼Œè¯·ä½ è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p>
<p>è§£é›† <strong>ä¸èƒ½</strong> åŒ…å«é‡å¤çš„å­é›†ã€‚è¿”å›çš„è§£é›†ä¸­ï¼Œå­é›†å¯ä»¥æŒ‰
<strong>ä»»æ„é¡ºåº</strong> æ’åˆ—ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,2,2]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[]</span>,<span class="hljs-comment">[1]</span>,<span class="hljs-comment">[1,2]</span>,<span class="hljs-comment">[1,2,2]</span>,<span class="hljs-comment">[2]</span>,<span class="hljs-comment">[2,2]</span>]</span><br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼š</p>
<p>å‡¡æ˜¯æ¶‰åŠåˆ°å»é‡çš„æ“ä½œï¼Œéƒ½éœ€è¦ä¼˜å…ˆè¿›è¡Œæ’åºæ“ä½œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; nums, <span class="hljs-type">int</span> startindex, vector&lt;<span class="hljs-type">bool</span>&gt; used)</span></span>&#123;<br>        res.<span class="hljs-built_in">push_back</span>(path);<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=startindex;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">0</span>&amp;&amp;nums[i]==nums[i<span class="hljs-number">-1</span>]&amp;&amp;used[i<span class="hljs-number">-1</span>]==<span class="hljs-literal">false</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            path.<span class="hljs-built_in">push_back</span>(nums[i]);<br>            used[i]=<span class="hljs-literal">true</span>;<br>            <span class="hljs-built_in">backtracking</span>(nums,i+<span class="hljs-number">1</span>,used);<br>            used[i]=<span class="hljs-literal">false</span>;<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">subsetsWithDup</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums) &#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">used</span><span class="hljs-params">(nums.size(),<span class="hljs-literal">false</span>)</span></span>;<br>        <span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>()); <span class="hljs-comment">// å»é‡éœ€è¦æ’åº</span><br>        <span class="hljs-built_in">backtracking</span>(nums,<span class="hljs-number">0</span>,used);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="éé€’å‡å­åºåˆ—">éé€’å‡å­åºåˆ—</h3>
<p><a
href="https://leetcode.cn/problems/non-decreasing-subsequences/description/">https://leetcode.cn/problems/non-decreasing-subsequences/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>
ï¼Œæ‰¾å‡ºå¹¶è¿”å›æ‰€æœ‰è¯¥æ•°ç»„ä¸­ä¸åŒçš„é€’å¢å­åºåˆ—ï¼Œé€’å¢å­åºåˆ—ä¸­
<strong>è‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ </strong> ã€‚ä½ å¯ä»¥æŒ‰ <strong>ä»»æ„é¡ºåº</strong>
è¿”å›ç­”æ¡ˆã€‚æ•°ç»„ä¸­å¯èƒ½å«æœ‰é‡å¤å…ƒç´ ï¼Œå¦‚å‡ºç°ä¸¤ä¸ªæ•´æ•°ç›¸ç­‰ï¼Œä¹Ÿå¯ä»¥è§†ä½œé€’å¢åºåˆ—çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[4,6,7,7]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[4,6]</span>,<span class="hljs-comment">[4,6,7]</span>,<span class="hljs-comment">[4,6,7,7]</span>,<span class="hljs-comment">[4,7]</span>,<span class="hljs-comment">[4,7,7]</span>,<span class="hljs-comment">[6,7]</span>,<span class="hljs-comment">[6,7,7]</span>,<span class="hljs-comment">[7,7]</span>]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šnums = [<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š<span class="hljs-string">[[4,4]]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>é¦–å…ˆè¿™é“é¢˜ä¸éœ€è¦å»é‡åŒæ—¶ä¹Ÿä¸éœ€è¦æå‰è¿›è¡Œæ’åº</p>
<p>ä½†æ˜¯éœ€è¦å¯¹åŒä¸€å±‚çš„å…ƒç´ è¿›è¡Œå»é‡æ“ä½œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> startindex)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(path.<span class="hljs-built_in">size</span>()&gt;<span class="hljs-number">1</span>)&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>        &#125;<br>        unordered_set&lt;<span class="hljs-type">int</span>&gt; uset;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =startindex;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span> ((!path.<span class="hljs-built_in">empty</span>() &amp;&amp; nums[i] &lt; path.<span class="hljs-built_in">back</span>())<br>                    || uset.<span class="hljs-built_in">find</span>(nums[i]) != uset.<span class="hljs-built_in">end</span>()) &#123;<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            uset.<span class="hljs-built_in">insert</span>(nums[i]);<br>            path.<span class="hljs-built_in">push_back</span>(nums[i]);<br>            <span class="hljs-built_in">backtracking</span>(nums,i+<span class="hljs-number">1</span>);<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">findSubsequences</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums) &#123;<br>        <span class="hljs-built_in">backtracking</span>(nums,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å…¨æ’åˆ—">å…¨æ’åˆ—</h3>
<p><a
href="https://leetcode.cn/problems/permutations/description/">https://leetcode.cn/problems/permutations/description/</a></p>
<p>ç»™å®šä¸€ä¸ªä¸å«é‡å¤æ•°å­—çš„æ•°ç»„ <code>nums</code> ï¼Œè¿”å›å…¶
<em>æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—</em> ã€‚ä½ å¯ä»¥ <strong>æŒ‰ä»»æ„é¡ºåº</strong>
è¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,2,3]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[1,2,3]</span>,<span class="hljs-comment">[1,3,2]</span>,<span class="hljs-comment">[2,1,3]</span>,<span class="hljs-comment">[2,3,1]</span>,<span class="hljs-comment">[3,1,2]</span>,<span class="hljs-comment">[3,2,1]</span>]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šnums = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š<span class="hljs-string">[[0,1],[1,0]]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>è¦æ±‚è§£å…¨æ’åˆ—ï¼Œå› æ­¤å›æº¯é€€å‡ºçš„æ¡ä»¶æ˜¯å½“<strong>pathçš„é•¿åº¦å’Œnumsçš„é•¿åº¦ä¸€æ ·</strong>çš„æ—¶å€™å°±è¾¾åˆ°äº†é€€å‡ºçš„æ¡ä»¶</p>
<p>å› ä¸ºè¿™é“é¢˜<strong>æ²¡æœ‰é‡å¤</strong>çš„å…ƒç´ ï¼Œæ±‚è§£å…¨æ’åˆ—éœ€è¦æ¯æ¬¡éƒ½ä»0å¼€å§‹é€‰æ‹©ï¼Œå› æ­¤éš¾ç‚¹åœ¨äº<strong>å¦‚ä½•æ ‡è®°å‡ºå·²ç»é€‰æ‹©è¿‡</strong>çš„å…ƒç´ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, vector&lt;<span class="hljs-type">bool</span>&gt;&amp; used)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(path.<span class="hljs-built_in">size</span>()==nums.<span class="hljs-built_in">size</span>())&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(used[i]==<span class="hljs-literal">true</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            path.<span class="hljs-built_in">push_back</span>(nums[i]);<br>            used[i]=<span class="hljs-literal">true</span>;<br>            <span class="hljs-built_in">backtracking</span>(nums,used);<br>            used[i]=<span class="hljs-literal">false</span>;<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">permute</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums) &#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">used</span><span class="hljs-params">(nums.size(),<span class="hljs-literal">false</span>)</span></span>;<br>        <span class="hljs-built_in">backtracking</span>(nums,used);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å…¨æ’åˆ—ii">å…¨æ’åˆ—II</h3>
<p><a
href="https://leetcode.cn/problems/permutations-ii/">https://leetcode.cn/problems/permutations-ii/</a></p>
<p>ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— <code>nums</code>
ï¼Œ<strong><em>æŒ‰ä»»æ„é¡ºåº</em></strong> è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,1,2]</span><br>è¾“å‡ºï¼š<br><span class="hljs-comment">[<span class="hljs-comment">[1,1,2]</span>,</span><br><span class="hljs-comment"> <span class="hljs-comment">[1,2,1]</span>,</span><br><span class="hljs-comment"> <span class="hljs-comment">[2,1,1]</span>]</span><br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,2,3]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[1,2,3]</span>,<span class="hljs-comment">[1,3,2]</span>,<span class="hljs-comment">[2,1,3]</span>,<span class="hljs-comment">[2,3,1]</span>,<span class="hljs-comment">[3,1,2]</span>,<span class="hljs-comment">[3,2,1]</span>]</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>é¦–å…ˆè¿™ä¸ªå…¨æ’åˆ—æœ‰é‡å¤çš„å…ƒç´ ï¼Œå› æ­¤éœ€è¦æœ‰å»é‡çš„æ“ä½œï¼Œæ—¢ç„¶æ¶‰åŠåˆ°å»é‡é‚£éœ€è¦é‡æ–°æ’åºï¼ŒåŒæ—¶éœ€è¦è·³è¿‡é‡å¤çš„å…ƒç´ </p>
<p>ç¬¬äºŒæ­¥ï¼Œæ—¢ç„¶æ˜¯å…¨æ’åˆ—ï¼Œé‚£ä¹ˆéœ€è¦æ ‡è®°é‡å¤é€‰æ‹©çš„å…ƒç´ å¹¶é€‰æ‹©è·³è¿‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, vector&lt;<span class="hljs-type">bool</span>&gt;&amp; used)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(path.<span class="hljs-built_in">size</span>()==nums.<span class="hljs-built_in">size</span>())&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">0</span>&amp;&amp;nums[i]==nums[i<span class="hljs-number">-1</span>]&amp;&amp;used[i<span class="hljs-number">-1</span>]==<span class="hljs-literal">false</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(used[i]==<span class="hljs-literal">false</span>)&#123;<br>                used[i]=<span class="hljs-literal">true</span>;<br>                path.<span class="hljs-built_in">push_back</span>(nums[i]);<br>                <span class="hljs-built_in">backtracking</span>(nums, used);<br>                path.<span class="hljs-built_in">pop_back</span>();<br>                used[i]=<span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">permuteUnique</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums) &#123;<br>        <span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(),nums.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">used</span><span class="hljs-params">(nums.size(),<span class="hljs-literal">false</span>)</span></span>;<br>        <span class="hljs-built_in">backtracking</span>(nums,used);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="é‡æ–°å®‰æ’è¡Œç¨‹">é‡æ–°å®‰æ’è¡Œç¨‹</h3>
<p><a
href="https://leetcode.cn/problems/reconstruct-itinerary/description/">https://leetcode.cn/problems/reconstruct-itinerary/description/</a></p>
<p>ç»™ä½ ä¸€ä»½èˆªçº¿åˆ—è¡¨ <code>tickets</code> ï¼Œå…¶ä¸­
<code>tickets[i] = [fromi, toi]</code>
è¡¨ç¤ºé£æœºå‡ºå‘å’Œé™è½çš„æœºåœºåœ°ç‚¹ã€‚è¯·ä½ å¯¹è¯¥è¡Œç¨‹è¿›è¡Œé‡æ–°è§„åˆ’æ’åºã€‚æ‰€æœ‰è¿™äº›æœºç¥¨éƒ½å±äºä¸€ä¸ªä»
<code>JFK</code>ï¼ˆè‚¯å°¼è¿ªå›½é™…æœºåœºï¼‰å‡ºå‘çš„å…ˆç”Ÿï¼Œæ‰€ä»¥è¯¥è¡Œç¨‹å¿…é¡»ä»
<code>JFK</code>
å¼€å§‹ã€‚å¦‚æœå­˜åœ¨å¤šç§æœ‰æ•ˆçš„è¡Œç¨‹ï¼Œè¯·ä½ æŒ‰å­—å…¸æ’åºè¿”å›æœ€å°çš„è¡Œç¨‹ç»„åˆã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼Œè¡Œç¨‹ <code>["JFK", "LGA"]</code> ä¸
<code>["JFK", "LGB"]</code> ç›¸æ¯”å°±æ›´å°ï¼Œæ’åºæ›´é å‰ã€‚</li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240122123926323.png" alt="å®‰æ’è¡Œç¨‹" style="zoom: 67%;" /></p>
<p>æ€è·¯ï¼š</p>
<p>ã€å›°éš¾ã€‘</p>
<ul>
<li><p>é¦–å…ˆç¬¬ä¸€æ­¥ï¼šç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼Œé‡åˆ°çš„æœºåœºä¸ªæ•°ï¼Œå¦‚æœè¾¾åˆ°äº†ï¼ˆèˆªç­æ•°é‡+1ï¼‰</p></li>
<li><p>è®°å½•èˆªç­çš„æ•°é‡ï¼Œä½¿ç”¨<code>unordered_map&lt;string, map&lt;string, int&gt;&gt; targets;</code>
æ¥è®°å½•èˆªç­çš„æ˜ å°„å…³ç³»ï¼Œæˆ‘å®šä¹‰ä¸ºå…¨å±€å˜é‡ã€‚</p>
<p>å½“ç„¶æŠŠå‚æ•°æ”¾è¿›å‡½æ•°é‡Œä¼ è¿›å»ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæˆ‘æ˜¯å°½é‡æ§åˆ¶å‡½æ•°é‡Œå‚æ•°çš„é•¿åº¦ã€‚å‚æ•°é‡Œè¿˜éœ€è¦ticketNumï¼Œè¡¨ç¤ºæœ‰å¤šå°‘ä¸ªèˆªç­</p></li>
<li><p>å›æº¯çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•éå†ä¸€ä¸ªæœºåœºæ‰€å¯¹åº”çš„æ‰€æœ‰æœºåœºå‘¢ï¼Ÿ</p>
<p>è¿™é‡Œåˆšåˆšè¯´è¿‡ï¼Œåœ¨é€‰æ‹©æ˜ å°„å‡½æ•°çš„æ—¶å€™ï¼Œä¸èƒ½é€‰æ‹©<code>unordered_map&lt;string, multiset&lt;string&gt;&gt; targets</code>ï¼Œ
å› ä¸ºä¸€æ—¦æœ‰å…ƒç´ å¢åˆ multisetçš„è¿­ä»£å™¨å°±ä¼šå¤±æ•ˆï¼Œå½“ç„¶å¯èƒ½æœ‰ç‰›é€¼çš„å®¹å™¨åˆ é™¤å…ƒç´ è¿­ä»£å™¨ä¸ä¼šå¤±æ•ˆï¼Œè¿™é‡Œå°±ä¸åœ¨è®¨è®ºäº†ã€‚</p>
<p><strong>å¯ä»¥è¯´æœ¬é¢˜æ—¢è¦æ‰¾åˆ°ä¸€ä¸ªå¯¹æ•°æ®è¿›è¡Œæ’åºçš„å®¹å™¨ï¼Œè€Œä¸”è¿˜è¦å®¹æ˜“å¢åˆ å…ƒç´ ï¼Œè¿­ä»£å™¨è¿˜ä¸èƒ½å¤±æ•ˆ</strong>ã€‚</p>
<p>æ‰€ä»¥æˆ‘é€‰æ‹©äº†<code>unordered_map&lt;string, map&lt;string, int&gt;&gt; targets</code>
æ¥åšæœºåœºä¹‹é—´çš„æ˜ å°„</p></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;string&gt; res;<br>    unordered_map&lt;string, map&lt;string, <span class="hljs-type">int</span>&gt;&gt; targets;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(<span class="hljs-type">int</span> ticketnum, vector&lt;string&gt;&amp; res)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(res.<span class="hljs-built_in">size</span>()==ticketnum+<span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(pair&lt;<span class="hljs-type">const</span> string, <span class="hljs-type">int</span>&gt;&amp; target: targets[res[res.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>]])&#123;<br>            <span class="hljs-keyword">if</span>(target.second&gt;<span class="hljs-number">0</span>)&#123;<br>                res.<span class="hljs-built_in">push_back</span>(target.first);<br>                target.second--;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">backtracking</span>(ticketnum, res)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                res.<span class="hljs-built_in">pop_back</span>();<br>                target.second++;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">findItinerary</span><span class="hljs-params">(vector&lt;vector&lt;string&gt;&gt;&amp; tickets)</span> </span>&#123;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> vector&lt;string&gt;&amp; vec: tickets)&#123;<br>            targets[vec[<span class="hljs-number">0</span>]][vec[<span class="hljs-number">1</span>]]++;<br>        &#125;<br>        res.<span class="hljs-built_in">push_back</span>(<span class="hljs-string">&quot;JFK&quot;</span>);<br>        <span class="hljs-built_in">backtracking</span>(tickets.<span class="hljs-built_in">size</span>(), res);<br>        <br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="nçš‡å">Nçš‡å</h3>
<p><a
href="https://leetcode.cn/problems/n-queens/description/">https://leetcode.cn/problems/n-queens/description/</a></p>
<p><strong>n çš‡åé—®é¢˜</strong> ç ”ç©¶çš„æ˜¯å¦‚ä½•å°† <code>n</code>
ä¸ªçš‡åæ”¾ç½®åœ¨ <code>nÃ—n</code>
çš„æ£‹ç›˜ä¸Šï¼Œå¹¶ä¸”ä½¿çš‡åå½¼æ­¤ä¹‹é—´ä¸èƒ½ç›¸äº’æ”»å‡»ã€‚</p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•° <code>n</code> ï¼Œè¿”å›æ‰€æœ‰ä¸åŒçš„ <strong>n
çš‡åé—®é¢˜</strong> çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æ¯ä¸€ç§è§£æ³•åŒ…å«ä¸€ä¸ªä¸åŒçš„ <strong>n çš‡åé—®é¢˜</strong>
çš„æ£‹å­æ”¾ç½®æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆä¸­ <code>'Q'</code> å’Œ <code>'.'</code>
åˆ†åˆ«ä»£è¡¨äº†çš‡åå’Œç©ºä½ã€‚</p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šn = <span class="hljs-number">4</span><br>è¾“å‡ºï¼š[[<span class="hljs-string">&quot;.Q..&quot;</span>,<span class="hljs-string">&quot;...Q&quot;</span>,<span class="hljs-string">&quot;Q...&quot;</span>,<span class="hljs-string">&quot;..Q.&quot;</span>],[<span class="hljs-string">&quot;..Q.&quot;</span>,<span class="hljs-string">&quot;Q...&quot;</span>,<span class="hljs-string">&quot;...Q&quot;</span>,<span class="hljs-string">&quot;.Q..&quot;</span>]]<br>è§£é‡Šï¼šå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ<span class="hljs-number">4</span> çš‡åé—®é¢˜å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„è§£æ³•ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>è¿™é“é¢˜å…³é”®åœ¨äº<strong>ç”¨å¥½æ•°æ®ç»“æ„</strong>å’Œå†™å¥½<strong>åˆæ³•æ€§çš„åˆ¤æ–­</strong></p>
<p>å…³é”®åœ¨äºå®šä¹‰å¥½<code>chessboard</code>ç¬¬äºŒæ­¥æ˜¯æŠŠåˆæ³•æ€§ä½ç½®åˆ¤æ–­å†™å¥½</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;string&gt;&gt; res;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isvalid</span><span class="hljs-params">(<span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col, vector&lt;string&gt;&amp; chessboard,<span class="hljs-type">int</span> n)</span></span>&#123;<br>        <span class="hljs-comment">//æ£€æŸ¥åˆ—</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;n;j++)&#123;<br>            <span class="hljs-keyword">if</span>(chessboard[row][j]==<span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-comment">//æ£€æŸ¥è¡Œ</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>            <span class="hljs-keyword">if</span>(chessboard[i][col]==<span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-comment">//æ£€æŸ¥å¯¹è§’çº¿45</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = row - <span class="hljs-number">1</span>, j = col - <span class="hljs-number">1</span>; i &gt;=<span class="hljs-number">0</span> &amp;&amp; j &gt;= <span class="hljs-number">0</span>; i--, j--) &#123;<br>        <span class="hljs-keyword">if</span> (chessboard[i][j] == <span class="hljs-string">&#x27;Q&#x27;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">//æ£€æŸ¥å¯¹è§’çº¿135</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = row<span class="hljs-number">-1</span>,j=col+<span class="hljs-number">1</span>;i&gt;=<span class="hljs-number">0</span>&amp;&amp;j&lt;n;i--,j++)&#123;<br>            <span class="hljs-keyword">if</span>(chessboard[i][j]==<span class="hljs-string">&#x27;Q&#x27;</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;string&gt;&amp; chessboard, <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> n)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(row==n)<br>        &#123;<br>            res.<span class="hljs-built_in">push_back</span>(chessboard);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> col = <span class="hljs-number">0</span>;col&lt;n;col++)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isvalid</span>(row,col,chessboard,n))&#123;<br>                chessboard[row][col]=<span class="hljs-string">&#x27;Q&#x27;</span>;<br>                <span class="hljs-built_in">backtracking</span>(chessboard,row+<span class="hljs-number">1</span>,n);<br>                chessboard[row][col]=<span class="hljs-string">&#x27;.&#x27;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    vector&lt;vector&lt;string&gt;&gt; <span class="hljs-built_in">solveNQueens</span>(<span class="hljs-type">int</span> n) &#123;<br>        <span class="hljs-function">std::vector&lt;std::string&gt; <span class="hljs-title">chessboard</span><span class="hljs-params">(n, std::string(n, <span class="hljs-string">&#x27;.&#x27;</span>))</span></span>;<br>        <span class="hljs-built_in">backtracking</span>(chessboard,<span class="hljs-number">0</span>,n);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="è§£æ•°ç‹¬">è§£æ•°ç‹¬</h3>
<p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œé€šè¿‡å¡«å……ç©ºæ ¼æ¥è§£å†³æ•°ç‹¬é—®é¢˜ã€‚</p>
<p>æ•°ç‹¬çš„è§£æ³•éœ€ <strong>éµå¾ªå¦‚ä¸‹è§„åˆ™</strong>ï¼š</p>
<ol type="1">
<li>æ•°å­— <code>1-9</code> åœ¨æ¯ä¸€è¡Œåªèƒ½å‡ºç°ä¸€æ¬¡ã€‚</li>
<li>æ•°å­— <code>1-9</code> åœ¨æ¯ä¸€åˆ—åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚</li>
<li>æ•°å­— <code>1-9</code> åœ¨æ¯ä¸€ä¸ªä»¥ç²—å®çº¿åˆ†éš”çš„ <code>3x3</code>
å®«å†…åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚ï¼ˆè¯·å‚è€ƒç¤ºä¾‹å›¾ï¼‰</li>
</ol>
<p>æ•°ç‹¬éƒ¨åˆ†ç©ºæ ¼å†…å·²å¡«å…¥äº†æ•°å­—ï¼Œç©ºç™½æ ¼ç”¨ <code>'.'</code> è¡¨ç¤ºã€‚</p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šboard = [[<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>],[<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>],[<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>]]<br>è¾“å‡ºï¼š[[<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>],[<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>],[<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>],[<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>],[<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>],[<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>],[<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>],[<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>],[<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>]]<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ŒåŠ ä¸Š<strong>åˆæ³•æ€§åˆ¤æ–­</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isvalid</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">char</span>&gt;&gt;&amp; board, <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col, <span class="hljs-type">char</span> a)</span></span>&#123;<br>        <span class="hljs-comment">//è¡Œéå†</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">9</span>;j++)&#123;<br>            <span class="hljs-keyword">if</span>(board[row][j]==a) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-comment">//åˆ—éå†</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)&#123;<br>            <span class="hljs-keyword">if</span>(board[i][col]==a) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-comment">//æ–¹æ¡†å†…åˆ¤æ–­ï¼šå…³é”®æ‰¾åˆ°èµ·å§‹çš„æ–¹æ¡†å¯¹è§’</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i= (row/<span class="hljs-number">3</span>)*<span class="hljs-number">3</span>;i&lt;(row/<span class="hljs-number">3</span>)*<span class="hljs-number">3</span>+<span class="hljs-number">3</span>;i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=(col/<span class="hljs-number">3</span>)*<span class="hljs-number">3</span>; j&lt;(col/<span class="hljs-number">3</span>)*<span class="hljs-number">3</span>+<span class="hljs-number">3</span>;j++)&#123;<br>                <span class="hljs-keyword">if</span>(board[i][j]==a) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">backtracking</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">char</span>&gt;&gt;&amp; board)</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;board.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;board[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>();j++)&#123;<br>                <span class="hljs-keyword">if</span>(board[i][j]==<span class="hljs-string">&#x27;.&#x27;</span>)&#123;<br>                    <span class="hljs-keyword">for</span>(<span class="hljs-type">char</span> a=<span class="hljs-string">&#x27;1&#x27;</span>;a&lt;=<span class="hljs-string">&#x27;9&#x27;</span>;a++)&#123;<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isvalid</span>(board,i,j,a))&#123;<br>                            board[i][j]=a;<br>                            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">backtracking</span>(board)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                            board[i][j]=<span class="hljs-string">&#x27;.&#x27;</span>;<br>                        &#125;<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solveSudoku</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">char</span>&gt;&gt;&amp; board)</span> </span>&#123;<br>        <span class="hljs-built_in">backtracking</span>(board);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="è´ªå¿ƒç®—æ³•">è´ªå¿ƒç®—æ³•</h1>
<h3 id="åˆ†å‘é¥¼å¹²">åˆ†å‘é¥¼å¹²</h3>
<p><a
href="https://leetcode.cn/problems/assign-cookies/description/">https://leetcode.cn/problems/assign-cookies/description/</a></p>
<p>å‡è®¾ä½ æ˜¯ä¸€ä½å¾ˆæ£’çš„å®¶é•¿ï¼Œæƒ³è¦ç»™ä½ çš„å­©å­ä»¬ä¸€äº›å°é¥¼å¹²ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªå­©å­æœ€å¤šåªèƒ½ç»™ä¸€å—é¥¼å¹²ã€‚å¯¹æ¯ä¸ªå­©å­
<code>i</code>ï¼Œéƒ½æœ‰ä¸€ä¸ªèƒƒå£å€¼
<code>g[i]</code>ï¼Œè¿™æ˜¯èƒ½è®©å­©å­ä»¬æ»¡è¶³èƒƒå£çš„é¥¼å¹²çš„æœ€å°å°ºå¯¸ï¼›å¹¶ä¸”æ¯å—é¥¼å¹²
<code>j</code>ï¼Œéƒ½æœ‰ä¸€ä¸ªå°ºå¯¸ <code>s[j]</code> ã€‚å¦‚æœ
<code>s[j] &gt;= g[i]</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªé¥¼å¹² <code>j</code>
åˆ†é…ç»™å­©å­ <code>i</code>
ï¼Œè¿™ä¸ªå­©å­ä¼šå¾—åˆ°æ»¡è¶³ã€‚ä½ çš„ç›®æ ‡æ˜¯å°½å¯èƒ½æ»¡è¶³è¶Šå¤šæ•°é‡çš„å­©å­ï¼Œå¹¶è¾“å‡ºè¿™ä¸ªæœ€å¤§æ•°å€¼ã€‚</p>
<p><strong>ç¤ºä¾‹ :</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">è¾“å…¥: g = [1,2,3], s = [1,1]</span><br><span class="hljs-section">è¾“å‡º: 1</span><br><span class="hljs-section">è§£é‡Š: </span><br>ä½ æœ‰ä¸‰ä¸ªå­©å­å’Œä¸¤å—å°é¥¼å¹²ï¼Œ3ä¸ªå­©å­çš„èƒƒå£å€¼åˆ†åˆ«æ˜¯ï¼š1,2,3ã€‚<br>è™½ç„¶ä½ æœ‰ä¸¤å—å°é¥¼å¹²ï¼Œç”±äºä»–ä»¬çš„å°ºå¯¸éƒ½æ˜¯1ï¼Œä½ åªèƒ½è®©èƒƒå£å€¼æ˜¯1çš„å­©å­æ»¡è¶³ã€‚<br>æ‰€ä»¥ä½ åº”è¯¥è¾“å‡º1ã€‚<br></code></pre></td></tr></table></figure>
<p><strong>ç¤ºä¾‹ :</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">è¾“å…¥: g = [1,2], s = [1,2,3]</span><br><span class="hljs-section">è¾“å‡º: 2</span><br><span class="hljs-section">è§£é‡Š: </span><br>ä½ æœ‰ä¸¤ä¸ªå­©å­å’Œä¸‰å—å°é¥¼å¹²ï¼Œ2ä¸ªå­©å­çš„èƒƒå£å€¼åˆ†åˆ«æ˜¯1,2ã€‚<br>ä½ æ‹¥æœ‰çš„é¥¼å¹²æ•°é‡å’Œå°ºå¯¸éƒ½è¶³ä»¥è®©æ‰€æœ‰å­©å­æ»¡è¶³ã€‚<br>æ‰€ä»¥ä½ åº”è¯¥è¾“å‡º2.<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p><strong>è¿™é‡Œçš„å±€éƒ¨æœ€ä¼˜å°±æ˜¯å¤§é¥¼å¹²å–‚ç»™èƒƒå£å¤§çš„ï¼Œå……åˆ†åˆ©ç”¨é¥¼å¹²å°ºå¯¸å–‚é¥±ä¸€ä¸ªï¼Œå…¨å±€æœ€ä¼˜å°±æ˜¯å–‚é¥±å°½å¯èƒ½å¤šçš„å°å­©</strong>ã€‚</p>
<p>å¯ä»¥å°è¯•ä½¿ç”¨è´ªå¿ƒç­–ç•¥ï¼Œå…ˆå°†é¥¼å¹²æ•°ç»„å’Œå°å­©æ•°ç»„æ’åºã€‚</p>
<p>ç„¶åä»åå‘å‰éå†å°å­©æ•°ç»„ï¼Œç”¨å¤§é¥¼å¹²ä¼˜å…ˆæ»¡è¶³èƒƒå£å¤§çš„ï¼Œå¹¶ç»Ÿè®¡æ»¡è¶³å°å­©æ•°é‡ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findContentChildren</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; g, vector&lt;<span class="hljs-type">int</span>&gt;&amp; s)</span> </span>&#123;<br>        <span class="hljs-built_in">sort</span>(s.<span class="hljs-built_in">begin</span>(),s.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-built_in">sort</span>(g.<span class="hljs-built_in">begin</span>(),g.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-type">int</span> index=s.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;<br>        <span class="hljs-type">int</span> num= <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=g.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>; i&gt;=<span class="hljs-number">0</span>;i--)&#123;<br>            <span class="hljs-keyword">if</span>(index&gt;=<span class="hljs-number">0</span>&amp;&amp;s[index]&gt;=g[i])&#123;<br>                num++;<br>                index--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> num;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="æ‘†åŠ¨åºåˆ—">æ‘†åŠ¨åºåˆ—</h3>
<p><a
href="https://leetcode.cn/problems/wiggle-subsequence/description/">https://leetcode.cn/problems/wiggle-subsequence/description/</a></p>
<p>å¦‚æœè¿ç»­æ•°å­—ä¹‹é—´çš„å·®ä¸¥æ ¼åœ°åœ¨æ­£æ•°å’Œè´Ÿæ•°ä¹‹é—´äº¤æ›¿ï¼Œåˆ™æ•°å­—åºåˆ—ç§°ä¸º
<strong>æ‘†åŠ¨åºåˆ—
ã€‚</strong>ç¬¬ä¸€ä¸ªå·®ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰å¯èƒ½æ˜¯æ­£æ•°æˆ–è´Ÿæ•°ã€‚ä»…æœ‰ä¸€ä¸ªå…ƒç´ æˆ–è€…å«ä¸¤ä¸ªä¸ç­‰å…ƒç´ çš„åºåˆ—ä¹Ÿè§†ä½œæ‘†åŠ¨åºåˆ—ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼Œ <code>[1, 7, 4, 9, 2, 5]</code> æ˜¯ä¸€ä¸ª
<strong>æ‘†åŠ¨åºåˆ—</strong> ï¼Œå› ä¸ºå·®å€¼ <code>(6, -3, 5, -7, 3)</code>
æ˜¯æ­£è´Ÿäº¤æ›¿å‡ºç°çš„ã€‚</li>
</ul>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> ï¼Œè¿”å› <code>nums</code> ä¸­ä½œä¸º
<strong>æ‘†åŠ¨åºåˆ—</strong> çš„ <strong>æœ€é•¿å­åºåˆ—çš„é•¿åº¦</strong></p>
<p><strong>ç¤ºä¾‹ ï¼š</strong></p>
<figure class="highlight subunit"><table><tr><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼šnums = [1,7,4,9,2,5]<br>è¾“å‡ºï¼š6<br>è§£é‡Šï¼šæ•´ä¸ªåºåˆ—å‡ä¸ºæ‘†åŠ¨åºåˆ—ï¼Œå„å…ƒç´ ä¹‹é—´çš„å·®å€¼ä¸º (6, <span class="hljs-string">-3</span>, 5, <span class="hljs-string">-7</span>, 3) <br></code></pre></td></tr></table></figure>
<figure class="highlight subunit"><table><tr><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼šnums = [1,17,5,10,13,15,10,5,16,8]<br>è¾“å‡ºï¼š7<br>è§£é‡Šï¼šè¿™ä¸ªåºåˆ—åŒ…å«å‡ ä¸ªé•¿åº¦ä¸º 7 æ‘†åŠ¨åºåˆ—ã€‚<br>å…¶ä¸­ä¸€ä¸ªæ˜¯ [1, 17, 10, 13, 10, 16, 8] ï¼Œå„å…ƒç´ ä¹‹é—´çš„å·®å€¼ä¸º (16, <span class="hljs-string">-7</span>, 3, <span class="hljs-string">-3</span>, 6, <span class="hljs-string">-8</span>) <br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p><strong>æœ¬é¢˜å¼‚å¸¸æƒ…å†µçš„æœ¬è´¨ï¼Œå°±æ˜¯è¦è€ƒè™‘å¹³å¡</strong>ï¼Œ
å¹³å¡åˆ†ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯ ä¸Šä¸‹ä¸­é—´æœ‰å¹³å¡ï¼Œä¸€ä¸ªæ˜¯å•è°ƒæœ‰å¹³å¡ï¼Œå¦‚å›¾</p>
<p>åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯åœ¨åˆ¤æ–­æ¡ä»¶è¯­å¥çš„æ—¶å€™ï¼Œ<strong>ä¸èƒ½ç®€å•çš„ç”¨åˆ¤æ–­ç›¸ä¹˜æ³•å°äº0ä½œä¸ºåˆ¤æ–­ï¼Œå› ä¸ºå­˜åœ¨å¹³å¡çš„æƒ…å†µ</strong></p>
<figure>
<img
src="../../../../../Library/Application%20Support/typora-user-images/image-20240123150641735.png"
alt="å¼‚å¸¸æƒ…å†µéœ€è¦è€ƒè™‘" />
<figcaption aria-hidden="true">å¼‚å¸¸æƒ…å†µéœ€è¦è€ƒè™‘</figcaption>
</figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">wiggleMaxLength</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(nums.<span class="hljs-built_in">size</span>()&lt;=<span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">return</span> nums.<span class="hljs-built_in">size</span>();<br>        &#125;<br>        <span class="hljs-type">int</span> num=<span class="hljs-number">1</span>;<br>        vector&lt;<span class="hljs-type">int</span>&gt; differ;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            differ.<span class="hljs-built_in">push_back</span>(nums[i]-nums[i<span class="hljs-number">-1</span>]);<br>        &#125;<br>        <span class="hljs-type">int</span> preDiff=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;differ.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>((preDiff&lt;=<span class="hljs-number">0</span>&amp;&amp; differ[i]&gt;<span class="hljs-number">0</span>)||(differ[i]&lt;<span class="hljs-number">0</span>&amp;&amp;preDiff&gt;=<span class="hljs-number">0</span>))&#123;<br>                num++;<br>                preDiff = differ[i];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> num;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="æœ€å¤§å­æ•°ç»„å’Œ">æœ€å¤§å­æ•°ç»„å’Œ</h3>
<p><a
href="https://leetcode.cn/problems/maximum-subarray/description/">https://leetcode.cn/problems/maximum-subarray/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>
ï¼Œè¯·ä½ æ‰¾å‡ºä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚</p>
<p><strong>å­æ•°ç»„</strong> æ˜¯æ•°ç»„ä¸­çš„ä¸€ä¸ªè¿ç»­éƒ¨åˆ†ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight subunit"><table><tr><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼šnums = [<span class="hljs-string">-2</span>,1,<span class="hljs-string">-3</span>,4,<span class="hljs-string">-1</span>,2,1,<span class="hljs-string">-5</span>,4]<br>è¾“å‡ºï¼š6<br>è§£é‡Šï¼šè¿ç»­å­æ•°ç»„ [4,<span class="hljs-string">-1</span>,2,1] çš„å’Œæœ€å¤§ï¼Œä¸º 6 ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>è¿™é“é¢˜ä½¿ç”¨çš„æ˜¯å±€éƒ¨çš„æœ€ä¼˜è´ªå¿ƒçš„æ€è·¯ï¼Œå¦‚æœé‡åˆ°è®©æ€»çš„å€¼å°äº0ï¼Œé‚£ä¹ˆä¹…ç«‹åˆ»è®©æ€»çš„å€¼å˜æˆ0ï¼Œé‚£ä¹ˆä¸‹ä¸€è½®å°±ä»å¤´å¼€å§‹è®°äº†ï¼ŒåŒæ—¶maxä¼šæ¯ä¸€è½®è¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰æ¯”å½“å‰çš„æœ€å¤§å€¼å¤§ï¼Œå¦‚æœæœ‰é‚£ä¹ˆå°±è¿›è¡Œæ›¿æ¢</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">maxSubArray</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-type">int</span> res = INT32_MIN;<br>        <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums.<span class="hljs-built_in">size</span>();i++)&#123;<br>            count+=nums[i];<br>            <span class="hljs-keyword">if</span>(count&gt;res)&#123;<br>                res = count;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(count&lt;=<span class="hljs-number">0</span>) count = <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº">ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</h3>
<p><a
href="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/description/">https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>prices</code> ï¼Œå…¶ä¸­ <code>prices[i]</code>
è¡¨ç¤ºæŸæ”¯è‚¡ç¥¨ç¬¬ <code>i</code>
å¤©çš„ä»·æ ¼ã€‚åœ¨æ¯ä¸€å¤©ï¼Œä½ å¯ä»¥å†³å®šæ˜¯å¦è´­ä¹°å’Œ/æˆ–å‡ºå”®è‚¡ç¥¨ã€‚ä½ åœ¨ä»»ä½•æ—¶å€™
<strong>æœ€å¤š</strong> åªèƒ½æŒæœ‰ <strong>ä¸€è‚¡</strong>
è‚¡ç¥¨ã€‚ä½ ä¹Ÿå¯ä»¥å…ˆè´­ä¹°ï¼Œç„¶ååœ¨ <strong>åŒä¸€å¤©</strong> å‡ºå”®ã€‚</p>
<p>è¿”å› <em>ä½ èƒ½è·å¾—çš„ <strong>æœ€å¤§</strong> åˆ©æ¶¦</em> ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight tap"><table><tr><td class="code"><pre><code class="hljs tap">è¾“å…¥ï¼šprices = [7,1,5,3,6,4]<br>è¾“å‡ºï¼š7<br>è§£é‡Šï¼šåœ¨ç¬¬<span class="hljs-number"> 2 </span>å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬<span class="hljs-number"> 3 </span>å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ =<span class="hljs-number"> 5 </span>-<span class="hljs-number"> 1 </span>=<span class="hljs-number"> 4 </span>ã€‚<br>     éšåï¼Œåœ¨ç¬¬<span class="hljs-number"> 4 </span>å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 3ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬<span class="hljs-number"> 5 </span>å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ =<span class="hljs-number"> 6 </span>-<span class="hljs-number"> 3 </span>=<span class="hljs-number"> 3 </span>ã€‚<br>     æ€»åˆ©æ¶¦ä¸º<span class="hljs-number"> 4 </span>+<span class="hljs-number"> 3 </span>=<span class="hljs-number"> 7 </span>ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p><strong>æŠŠåˆ©æ¶¦åˆ†è§£ä¸ºæ¯å¤©ä¸ºå•ä½çš„ç»´åº¦ï¼Œè€Œä¸æ˜¯ä» 0 å¤©åˆ°ç¬¬ 3
å¤©æ•´ä½“å»è€ƒè™‘ï¼</strong></p>
<p>é‚£ä¹ˆæ ¹æ® prices
å¯ä»¥å¾—åˆ°æ¯å¤©çš„åˆ©æ¶¦åºåˆ—ï¼š<code>(prices[i] - prices[i - 1]).....(prices[1] - prices[0])</code></p>
<p>ç›¸å½“äºæ˜¯æ¯å¤©çš„åˆ©æ¶¦ä¹‹å·®å’Œ0çš„æ¯”è¾ƒï¼Œåªé€‰æ‹©ä¸ºæ­£çš„å€¼ï¼Œè´Ÿæ•°çš„æƒ…å†µç›´æ¥å¿½ç•¥</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs Cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; prices)</span> </span>&#123;<br>        <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;prices.<span class="hljs-built_in">size</span>();i++)&#123;<br>            res+=<span class="hljs-built_in">max</span>(prices[i]-prices[i<span class="hljs-number">-1</span>],<span class="hljs-number">0</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="åŠ¨æ€è§„åˆ’">åŠ¨æ€è§„åˆ’</h1>
<p>çŠ¶æ€è½¬ç§»å…¬å¼ï¼ˆé€’æ¨å…¬å¼ï¼‰æ˜¯å¾ˆé‡è¦ï¼Œä½†åŠ¨è§„ä¸ä»…ä»…åªæœ‰é€’æ¨å…¬å¼ã€‚</p>
<p><strong>å¯¹äºåŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œæˆ‘å°†æ‹†è§£ä¸ºå¦‚ä¸‹äº”æ­¥æ›²ï¼Œè¿™äº”æ­¥éƒ½ææ¸…æ¥šäº†ï¼Œæ‰èƒ½è¯´æŠŠåŠ¨æ€è§„åˆ’çœŸçš„æŒæ¡äº†ï¼</strong></p>
<ol type="1">
<li>ç¡®å®šdpæ•°ç»„ï¼ˆdp tableï¼‰ä»¥åŠä¸‹æ ‡çš„å«ä¹‰</li>
<li>ç¡®å®šé€’æ¨å…¬å¼</li>
<li>dpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</li>
<li>ç¡®å®šéå†é¡ºåº</li>
<li>ä¸¾ä¾‹æ¨å¯¼dpæ•°ç»„</li>
</ol>
<p><strong>æ³¨æ„ï¼šåŠ¨æ€è§„åˆ’çš„é—®é¢˜ä¸€èˆ¬åªä¼šè¾“å‡ºæœ€åçš„ä¸€ä¸ªç»“æœï¼Œä¸ä¼šè¾“å‡ºæ¯”å¦‚ä¸­é—´çš„è·¯å¾„ç­‰ç›¸å…³çš„å€¼</strong></p>
<h3 id="æ–æ³¢é‚£å¥‘æ•°åˆ—">æ–æ³¢é‚£å¥‘æ•°åˆ—</h3>
<p><a
href="https://leetcode.cn/problems/fibonacci-number/">https://leetcode.cn/problems/fibonacci-number/</a></p>
<p><strong>æ–æ³¢é‚£å¥‘æ•°</strong> ï¼ˆé€šå¸¸ç”¨ <code>F(n)</code>
è¡¨ç¤ºï¼‰å½¢æˆçš„åºåˆ—ç§°ä¸º <strong>æ–æ³¢é‚£å¥‘æ•°åˆ—</strong> ã€‚è¯¥æ•°åˆ—ç”±
<code>0</code> å’Œ <code>1</code>
å¼€å§‹ï¼Œåé¢çš„æ¯ä¸€é¡¹æ•°å­—éƒ½æ˜¯å‰é¢ä¸¤é¡¹æ•°å­—çš„å’Œã€‚ä¹Ÿå°±æ˜¯ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">F</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span> = <span class="hljs-number">0</span>ï¼Œ<span class="hljs-built_in">F</span>(<span class="hljs-number">1</span>) = <span class="hljs-number">1</span><br><span class="hljs-function"><span class="hljs-title">F</span><span class="hljs-params">(n)</span></span> = <span class="hljs-built_in">F</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-built_in">F</span>(n - <span class="hljs-number">2</span>)ï¼Œå…¶ä¸­ n &gt; <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>ç»™å®š <code>n</code> ï¼Œè¯·è®¡ç®— <code>F(n)</code> ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><code class="hljs isbl">è¾“å…¥ï¼š<span class="hljs-variable">n</span> = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š<span class="hljs-number">1</span><br>è§£é‡Šï¼š<span class="hljs-function"><span class="hljs-title">F</span>(<span class="hljs-number">2</span>) = <span class="hljs-title">F</span>(<span class="hljs-number">1</span>) + <span class="hljs-title">F</span>(<span class="hljs-number">0</span>) = <span class="hljs-number">1</span> + <span class="hljs-number">0</span> = <span class="hljs-number">1</span></span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>å› ä¸ºè¿™é“é¢˜ç»™å‡ºäº†é€’æ¨å…¬å¼ï¼š<code>F(n) = F(n - 1) + F(n - 2)</code></p>
<p>åŠ¨è§„äº”éƒ¨æ›²ï¼š</p>
<p>è¿™é‡Œæˆ‘ä»¬è¦ç”¨ä¸€ä¸ªä¸€ç»´dpæ•°ç»„æ¥ä¿å­˜é€’å½’çš„ç»“æœ</p>
<ol type="1">
<li><p>ç¡®å®šdpæ•°ç»„ä»¥åŠä¸‹æ ‡çš„å«ä¹‰ï¼šdp[i]çš„å®šä¹‰ä¸ºï¼šç¬¬iä¸ªæ•°çš„æ–æ³¢é‚£å¥‘æ•°å€¼æ˜¯dp[i]</p></li>
<li><p>ç¡®å®šé€’æ¨å…¬å¼<code>F(n) = F(n - 1) + F(n - 2)</code></p></li>
<li><p>dpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">dp[0] = 0;<br>dp[1] = 1;<br></code></pre></td></tr></table></figure></li>
<li><p>ç¡®å®šéå†é¡ºåº</p>
<p>ä»é€’å½’å…¬å¼dp[i] = dp[i - 1] + dp[i - 2];ä¸­å¯ä»¥çœ‹å‡ºï¼Œdp[i]æ˜¯ä¾èµ– dp[i
- 1] å’Œ dp[i - 2]ï¼Œé‚£ä¹ˆéå†çš„é¡ºåºä¸€å®šæ˜¯ä»å‰åˆ°åéå†çš„</p></li>
<li><p>ä¸¾ä¾‹æ¨å¯¼dpæ•°ç»„</p></li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">fib</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(n&lt;=<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> n;<br>        vector&lt;<span class="hljs-type">int</span>&gt;<span class="hljs-built_in">dp</span>(n+<span class="hljs-number">1</span>);<br>        dp[<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;<br>        dp[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;=n;i++)&#123;<br>            dp[i]=dp[i<span class="hljs-number">-1</span>]+dp[i<span class="hljs-number">-2</span>];<br>        &#125;<br>        <span class="hljs-keyword">return</span> dp[n];<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="çˆ¬æ¥¼æ¢¯">çˆ¬æ¥¼æ¢¯</h3>
<p>å‡è®¾ä½ æ­£åœ¨çˆ¬æ¥¼æ¢¯ã€‚éœ€è¦ <code>n</code> é˜¶ä½ æ‰èƒ½åˆ°è¾¾æ¥¼é¡¶ã€‚æ¯æ¬¡ä½ å¯ä»¥çˆ¬
<code>1</code> æˆ– <code>2</code>
ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight tap"><table><tr><td class="code"><pre><code class="hljs tap">è¾“å…¥ï¼šn = 2<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶ã€‚<br>1.<span class="hljs-number"> 1 </span>é˜¶ +<span class="hljs-number"> 1 </span>é˜¶<br>2.<span class="hljs-number"> 2 </span>é˜¶<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>åŠ¨æ€è§„åˆ’ç®€å•é¢˜ï¼Œé€’æ¨å…¬å¼ï¼š<code>dp[i] = dp[i-2]+dp[i-1];</code></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">climbStairs</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(n&lt;=<span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> n;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(n+<span class="hljs-number">1</span>)</span></span>;<br>        dp[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;<br>        dp[<span class="hljs-number">2</span>]=<span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">3</span>;i&lt;=n;i++)&#123;<br>            dp[i] = dp[i<span class="hljs-number">-2</span>]+dp[i<span class="hljs-number">-1</span>];<br>        &#125;<br>        <span class="hljs-keyword">return</span> dp[n];<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="æœ€å°è´¹ç”¨çˆ¬æ¥¼æ¢¯">æœ€å°è´¹ç”¨çˆ¬æ¥¼æ¢¯</h3>
<p><a
href="https://leetcode.cn/problems/min-cost-climbing-stairs/description/">https://leetcode.cn/problems/min-cost-climbing-stairs/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>cost</code> ï¼Œå…¶ä¸­ <code>cost[i]</code>
æ˜¯ä»æ¥¼æ¢¯ç¬¬ <code>i</code>
ä¸ªå°é˜¶å‘ä¸Šçˆ¬éœ€è¦æ”¯ä»˜çš„è´¹ç”¨ã€‚ä¸€æ—¦ä½ æ”¯ä»˜æ­¤è´¹ç”¨ï¼Œå³å¯é€‰æ‹©å‘ä¸Šçˆ¬ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå°é˜¶ã€‚ä½ å¯ä»¥é€‰æ‹©ä»ä¸‹æ ‡ä¸º
<code>0</code> æˆ–ä¸‹æ ‡ä¸º <code>1</code>
çš„å°é˜¶å¼€å§‹çˆ¬æ¥¼æ¢¯ã€‚è¯·ä½ è®¡ç®—å¹¶è¿”å›è¾¾åˆ°æ¥¼æ¢¯é¡¶éƒ¨çš„æœ€ä½èŠ±è´¹ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight tap"><table><tr><td class="code"><pre><code class="hljs tap">è¾“å…¥ï¼šcost = [10,15,20]<br>è¾“å‡ºï¼š15<br>è§£é‡Šï¼šä½ å°†ä»ä¸‹æ ‡ä¸º<span class="hljs-number"> 1 </span>çš„å°é˜¶å¼€å§‹ã€‚<br>- æ”¯ä»˜<span class="hljs-number"> 15 </span>ï¼Œå‘ä¸Šçˆ¬ä¸¤ä¸ªå°é˜¶ï¼Œåˆ°è¾¾æ¥¼æ¢¯é¡¶éƒ¨ã€‚<br>æ€»èŠ±è´¹ä¸º<span class="hljs-number"> 15 </span>ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>åŠ¨æ€è§„åˆ’<strong>å¯ä»¥æœ‰ä¸¤ä¸ªé€”å¾„å¾—åˆ°dp[i]ï¼Œä¸€ä¸ªæ˜¯dp[i-1]
ä¸€ä¸ªæ˜¯dp[i-2]</strong>ã€‚</p>
<p>dp[i - 1] è·³åˆ° dp[i] éœ€è¦èŠ±è´¹
<code>dp[i - 1] + cost[i - 1]</code>ã€‚</p>
<p>dp[i - 2] è·³åˆ° dp[i] éœ€è¦èŠ±è´¹
<code>dp[i - 2] + cost[i - 2]</code>ã€‚</p>
<p>é‚£ä¹ˆç©¶ç«Ÿæ˜¯é€‰ä»dp[i - 1]è·³è¿˜æ˜¯ä»dp[i - 2]è·³å‘¢ï¼Ÿ</p>
<p>ä¸€å®šæ˜¯é€‰æœ€å°çš„ï¼Œæ‰€ä»¥<code>dp[i] = min(dp[i - 1] + cost[i - 1], dp[i - 2] + cost[i - 2])</code>;</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">minCostClimbingStairs</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; cost)</span> </span>&#123;<br>        <span class="hljs-type">int</span> n = cost.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(n+<span class="hljs-number">1</span>)</span></span>;<br>        dp[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span>;<br>        dp[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;=n;i++)&#123;<br>            dp[i]=<span class="hljs-built_in">min</span>(dp[i<span class="hljs-number">-1</span>]+cost[i<span class="hljs-number">-1</span>], dp[i<span class="hljs-number">-2</span>]+cost[i<span class="hljs-number">-2</span>]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> dp[n];<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸åŒè·¯å¾„">ä¸åŒè·¯å¾„</h3>
<p>ä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª <code>m x n</code> ç½‘æ ¼çš„å·¦ä¸Šè§’
ï¼ˆèµ·å§‹ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸º â€œStartâ€
ï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾è¾¾åˆ°ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸º
â€œFinishâ€ ï¼‰ã€‚é—®æ€»å…±æœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿ</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240128142408271.png" alt="æœºå™¨äººè·¯å¾„é—®é¢˜" style="zoom:67%;" /></p>
<p>æ€è·¯ï¼š</p>
<p>ç®€å•çš„åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œåªéœ€è¦ä¿è¯æ¯æ¬¡è¿­ä»£éƒ½ä»ä¸Šé¢å’Œå·¦è¾¹è¿›è¡Œå åŠ </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">uniquePaths</span><span class="hljs-params">(<span class="hljs-type">int</span> m, <span class="hljs-type">int</span> n)</span> </span>&#123;<br>        vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;<span class="hljs-built_in">dp</span>(m, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;(n, <span class="hljs-number">0</span>));<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)&#123;<br>            dp[i][<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>            dp[<span class="hljs-number">0</span>][i]=<span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;m;i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;n;j++)&#123;<br>                dp[i][j]=dp[i<span class="hljs-number">-1</span>][j]+dp[i][j<span class="hljs-number">-1</span>];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> dp[m<span class="hljs-number">-1</span>][n<span class="hljs-number">-1</span>];<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸åŒè·¯å¾„ii">ä¸åŒè·¯å¾„II</h3>
<p><a
href="https://leetcode.cn/problems/unique-paths-ii/description/">https://leetcode.cn/problems/unique-paths-ii/description/</a></p>
<p>ä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª <code>m x n</code> ç½‘æ ¼çš„å·¦ä¸Šè§’
ï¼ˆèµ·å§‹ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸º â€œStartâ€
ï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾è¾¾åˆ°ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸º
â€œFinishâ€ï¼‰ã€‚ç°åœ¨è€ƒè™‘ç½‘æ ¼ä¸­æœ‰éšœç¢ç‰©ã€‚é‚£ä¹ˆä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’å°†ä¼šæœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿç½‘æ ¼ä¸­çš„éšœç¢ç‰©å’Œç©ºä½ç½®åˆ†åˆ«ç”¨
<code>1</code> å’Œ <code>0</code> æ¥è¡¨ç¤ºã€‚</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240128143004648.png" alt="éšœç¢ç‰©çš„æœºå™¨äººè·¯å¾„" style="zoom: 50%;" /></p>
<p>æ€è·¯ï¼š</p>
<p>å’Œä¸Šä¸€é¢˜çš„æ€è·¯ä¸€æ ·ï¼Œéƒ½æ˜¯éœ€è¦éå†è·¯å¾„å°±è¡Œï¼Œä½†æ˜¯è¿™é‡ŒåŠ å…¥äº†ä¸€ä¸ªæ–°çš„æ•°ç»„ç”¨æ¥å­˜å‚¨æœ‰éšœç¢ç‰©çš„ä½ç½®ï¼Œå› æ­¤éœ€è¦é¢å¤–è¿›è¡Œæ ‡è®°
<code>&amp;&amp;obstacleGrid[i][0]==0</code>çš„ä¿¡æ¯ï¼ŒåŒæ—¶é‡åˆ°éšœç¢ç‰©å°±ä¸æ”¹å˜å¯¹åº”çš„å€¼ï¼Œç›´æ¥
<code>continue</code>å°±å¥½</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">uniquePathsWithObstacles</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;&amp; obstacleGrid)</span> </span>&#123;<br>        vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;<span class="hljs-built_in">dp</span>(obstacleGrid.<span class="hljs-built_in">size</span>(), <span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;(obstacleGrid[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>(), <span class="hljs-number">0</span>));<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;obstacleGrid.<span class="hljs-built_in">size</span>()&amp;&amp;obstacleGrid[i][<span class="hljs-number">0</span>]==<span class="hljs-number">0</span>;i++) dp[i][<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;obstacleGrid[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>()&amp;&amp;obstacleGrid[<span class="hljs-number">0</span>][i]==<span class="hljs-number">0</span>;i++) dp[<span class="hljs-number">0</span>][i]=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;obstacleGrid.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;obstacleGrid[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>();j++)&#123;<br>                <span class="hljs-keyword">if</span>(obstacleGrid[i][j]==<span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;<br>                dp[i][j]=dp[i<span class="hljs-number">-1</span>][j]+dp[i][j<span class="hljs-number">-1</span>];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> dp[obstacleGrid.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>][obstacleGrid[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>];<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="æ•´æ•°æ‹†åˆ†">æ•´æ•°æ‹†åˆ†</h3>
<p><a
href="https://leetcode.cn/problems/integer-break/description/">https://leetcode.cn/problems/integer-break/description/</a></p>
<p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•° <code>n</code> ï¼Œå°†å…¶æ‹†åˆ†ä¸º <code>k</code> ä¸ª
<strong>æ­£æ•´æ•°</strong> çš„å’Œï¼ˆ <code>k &gt;= 2</code>
ï¼‰ï¼Œå¹¶ä½¿è¿™äº›æ•´æ•°çš„ä¹˜ç§¯æœ€å¤§åŒ–ã€‚è¿”å› <em>ä½ å¯ä»¥è·å¾—çš„æœ€å¤§ä¹˜ç§¯</em> ã€‚</p>
<p><strong>ç¤ºä¾‹ :</strong></p>
<figure class="highlight tap"><table><tr><td class="code"><pre><code class="hljs tap">è¾“å…¥: n = 2<br>è¾“å‡º: 1<br>è§£é‡Š:<span class="hljs-number"> 2 </span>=<span class="hljs-number"> 1 </span>+ 1,<span class="hljs-number"> 1 </span>Ã—<span class="hljs-number"> 1 </span>= 1ã€‚<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>ç»™å‡ºé€’æ¨å…¬å¼ä¸€ä¸ªæ˜¯<code>j * (i - j)</code>
ç›´æ¥ç›¸ä¹˜ã€‚ä¸€ä¸ªæ˜¯<code>j * dp[i - j]</code>ï¼Œç›¸å½“äºæ˜¯æ‹†åˆ†<code>(i - j)</code>ï¼Œåœ¨éå†jçš„è¿‡ç¨‹ä¸­å…¶å®éƒ½è®¡ç®—è¿‡äº†ã€‚é‚£ä¹ˆä»1éå†jï¼Œæ¯”è¾ƒ<code>(i - j) * jå’Œdp[i - j] * j</code>
å–æœ€å¤§çš„ã€‚é€’æ¨å…¬å¼ï¼š<code>dp[i] = max(dp[i], max((i - j) * j, dp[i - j] * j))</code>ï¼›</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">integerBreak</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>        dp[<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">3</span>; i &lt;= n ; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= i / <span class="hljs-number">2</span>; j++) &#123;<br>                dp[i] = <span class="hljs-built_in">max</span>(dp[i], <span class="hljs-built_in">max</span>((i - j) * j, dp[i - j] * j));<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> dp[n];<br>    &#125;<br>&#125;;<br><br></code></pre></td></tr></table></figure>
<h3 id="èƒŒåŒ…é—®é¢˜è§£é¢˜æ¡†æ¶">èƒŒåŒ…é—®é¢˜è§£é¢˜æ¡†æ¶</h3>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240129124938997.png"
alt="èƒŒåŒ…é—®é¢˜çš„åŸºæœ¬åˆ†ç±»å…³ç³»" />
<figcaption aria-hidden="true">èƒŒåŒ…é—®é¢˜çš„åŸºæœ¬åˆ†ç±»å…³ç³»</figcaption>
</figure>
<h4 id="èƒŒåŒ…">0-1èƒŒåŒ…</h4>
<p><code>dp[j]</code>ä¸º
å®¹é‡ä¸º<code>j</code>çš„èƒŒåŒ…æ‰€èƒŒçš„æœ€å¤§ä»·å€¼ï¼Œé‚£ä¹ˆå¦‚ä½•æ¨å¯¼<code>dp[j]</code>å‘¢ï¼Ÿ<code>dp[j]</code>å¯ä»¥é€šè¿‡<code>dp[j - weight[i]]</code>æ¨å¯¼å‡ºæ¥ï¼Œ<code>dp[j - weight[i]]</code>è¡¨ç¤ºå®¹é‡ä¸º<code>j - weight[i]</code>çš„èƒŒåŒ…æ‰€èƒŒçš„æœ€å¤§ä»·å€¼ã€‚</p>
<p><code>dp[j - weight[i]] + value[i]</code> è¡¨ç¤º å®¹é‡ä¸º <code>j</code>
- ç‰©å“ié‡é‡ çš„èƒŒåŒ… åŠ ä¸Š
ç‰©å“içš„ä»·å€¼ã€‚ï¼ˆä¹Ÿå°±æ˜¯å®¹é‡ä¸ºjçš„èƒŒåŒ…ï¼Œæ”¾å…¥ç‰©å“iäº†ä¹‹åçš„ä»·å€¼å³ï¼šdp[j]ï¼‰</p>
<p>æ­¤æ—¶dp[j]æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯å–è‡ªå·±<code>dp[j]</code> ç›¸å½“äº
äºŒç»´dpæ•°ç»„ä¸­çš„<code>dp[i-1][j]</code>ï¼Œå³ä¸æ”¾ç‰©å“iï¼Œä¸€ä¸ªæ˜¯å–<code>dp[j - weight[i]] + value[i]</code>ï¼Œå³æ”¾ç‰©å“iï¼ŒæŒ‡å®šæ˜¯å–æœ€å¤§çš„ï¼Œæ¯•ç«Ÿæ˜¯æ±‚æœ€å¤§ä»·å€¼ï¼Œ</p>
<p><strong>é€’æ¨å…¬å¼ï¼š</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp">dp[j] = <span class="hljs-built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);<br></code></pre></td></tr></table></figure>
<p><strong>åˆå§‹åŒ–ï¼š</strong></p>
<p>å…¨éƒ¨åˆå§‹åŒ–ä¸º0</p>
<p><strong>éå†é¡ºåºï¼š</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; weight.<span class="hljs-built_in">size</span>(); i++) &#123; <span class="hljs-comment">// éå†ç‰©å“</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = bagWeight; j &gt;= weight[i]; j--) &#123; <span class="hljs-comment">// éå†èƒŒåŒ…å®¹é‡</span><br>        dp[j] = <span class="hljs-built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>æ•´ä½“çš„ä»£ç ç»“æ„æ˜¯</strong>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test_1_wei_bag_problem</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; weight = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;<br>    vector&lt;<span class="hljs-type">int</span>&gt; value = &#123;<span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>&#125;;<br>    <span class="hljs-type">int</span> bagWeight = <span class="hljs-number">4</span>;<br>    <span class="hljs-comment">// åˆå§‹åŒ–</span><br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(bagWeight + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; weight.<span class="hljs-built_in">size</span>(); i++) &#123; <span class="hljs-comment">// éå†ç‰©å“</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = bagWeight; j &gt;= weight[i]; j--) &#123; <span class="hljs-comment">// éå†èƒŒåŒ…å®¹é‡</span><br>            dp[j] = <span class="hljs-built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; dp[bagWeight] &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="å®Œå…¨èƒŒåŒ…é—®é¢˜">å®Œå…¨èƒŒåŒ…é—®é¢˜</h4>
<p>æœ‰Nä»¶ç‰©å“å’Œä¸€ä¸ªæœ€å¤šèƒ½èƒŒé‡é‡ä¸ºWçš„èƒŒåŒ…ã€‚ç¬¬iä»¶ç‰©å“çš„é‡é‡æ˜¯weight[i]ï¼Œå¾—åˆ°çš„ä»·å€¼æ˜¯value[i]
ã€‚<strong>æ¯ä»¶ç‰©å“éƒ½æœ‰æ— é™ä¸ªï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥æ”¾å…¥èƒŒåŒ…å¤šæ¬¡ï¼‰</strong>ï¼Œæ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…é‡Œç‰©å“ä»·å€¼æ€»å’Œæœ€å¤§ã€‚</p>
<p><strong>å®Œå…¨èƒŒåŒ…å’Œ01èƒŒåŒ…é—®é¢˜å”¯ä¸€ä¸åŒçš„åœ°æ–¹å°±æ˜¯ï¼Œæ¯ç§ç‰©å“æœ‰æ— é™ä»¶</strong>ã€‚</p>
<p>åœ¨ä»£ç å±‚é¢çš„åŒºåˆ«åœ¨äºèƒŒåŒ…éå†çš„æ—¶å€™æ˜¯ä»å¤´å¼€å§‹åˆ°å°¾éå†ï¼Œ<code>int j = weight[i]; j &lt;= bagWeight; j++</code>ï¼Œå› ä¸ºæ‰€æœ‰çš„èƒŒåŒ…å†…éƒ¨éƒ½æ˜¯æ— é™çš„</p>
<p>1ã€å…ˆéå†ç‰©å“å†éå†èƒŒåŒ…</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs Cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test_CompletePack</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; weight = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;<br>    vector&lt;<span class="hljs-type">int</span>&gt; value = &#123;<span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>&#125;;<br>    <span class="hljs-type">int</span> bagWeight = <span class="hljs-number">4</span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(bagWeight + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; weight.<span class="hljs-built_in">size</span>(); i++) &#123; <span class="hljs-comment">// éå†ç‰©å“</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = weight[i]; j &lt;= bagWeight; j++) &#123; <span class="hljs-comment">// éå†èƒŒåŒ…å®¹é‡</span><br>            dp[j] = <span class="hljs-built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; dp[bagWeight] &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>2ã€å…ˆéå†èƒŒåŒ…å†éå†ç‰©å“</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt;= bagWeight; j++) &#123; <span class="hljs-comment">// éå†èƒŒåŒ…å®¹é‡</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; weight.<span class="hljs-built_in">size</span>(); i++) &#123; <span class="hljs-comment">// éå†ç‰©å“</span><br>        <span class="hljs-keyword">if</span> (j - weight[i] &gt;= <span class="hljs-number">0</span>) dp[j] = <span class="hljs-built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);<br>    &#125;<br>    cout &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="åˆ†å‰²ç­‰å’Œå­é›†">åˆ†å‰²ç­‰å’Œå­é›†</h3>
<p><a
href="https://leetcode.cn/problems/partition-equal-subset-sum/description/">https://leetcode.cn/problems/partition-equal-subset-sum/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ª<strong>åªåŒ…å«æ­£æ•´æ•°</strong>çš„<strong>éç©º</strong> æ•°ç»„
<code>nums</code>
ã€‚è¯·ä½ åˆ¤æ–­æ˜¯å¦å¯ä»¥å°†è¿™ä¸ªæ•°ç»„åˆ†å‰²æˆä¸¤ä¸ªå­é›†ï¼Œä½¿å¾—ä¸¤ä¸ªå­é›†çš„å…ƒç´ å’Œç›¸ç­‰<strong>ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,5,11,5]</span><br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šæ•°ç»„å¯ä»¥åˆ†å‰²æˆ <span class="hljs-comment">[1, 5, 5]</span> å’Œ <span class="hljs-comment">[11]</span> <br></code></pre></td></tr></table></figure>
<h1 id="å•è°ƒæ ˆ">å•è°ƒæ ˆ</h1>
<h3 id="æ¯æ—¥æ¸©åº¦">æ¯æ—¥æ¸©åº¦</h3>
<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>temperatures</code>
ï¼Œè¡¨ç¤ºæ¯å¤©çš„æ¸©åº¦ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ <code>answer</code> ï¼Œå…¶ä¸­
<code>answer[i]</code> æ˜¯æŒ‡å¯¹äºç¬¬ <code>i</code>
å¤©ï¼Œä¸‹ä¸€ä¸ªæ›´é«˜æ¸©åº¦å‡ºç°åœ¨å‡ å¤©åã€‚å¦‚æœæ°”æ¸©åœ¨è¿™ä¹‹åéƒ½ä¸ä¼šå‡é«˜ï¼Œè¯·åœ¨è¯¥ä½ç½®ç”¨
<code>0</code> æ¥ä»£æ›¿ã€‚</p>
<p><strong>ç¤ºä¾‹ 1:</strong></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">è¾“å…¥: temperatures = [<span class="hljs-number">73,74,75,71</span>,<span class="hljs-number">69,72,76,73</span>]<br>è¾“å‡º: [<span class="hljs-number">1,1,4,2</span>,<span class="hljs-number">1,1,0,0</span>]<br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>å¯ä»¥é€‰æ‹©ä½¿ç”¨<strong>å•è°ƒæ ˆçš„æ–¹æ³•</strong>æ¥æ±‚è§£ï¼Œå…·ä½“çš„æ€è·¯æ˜¯è®¾ç½®ä¸€ä¸ªæ ˆï¼Œéå†æ•°ç»„çš„æ—¶å€™å’Œæ ˆé¡¶å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œå°äºæ ˆé¡¶å…ƒç´ çš„æ—¶å€™å°±éœ€è¦å°†å½“å‰å…ƒç´ æ”¾å…¥æ ˆä¸­</p>
<p>é¦–å…ˆè¿™é“é¢˜å¿…é¡»æœ‰ä¸€ä¸ªå‘é‡æ•°ç»„æ¥å­˜å‚¨å¯¹åº”ä½ç½®çš„å…ƒç´ çš„å€¼ï¼Œ<code>vector&lt;int&gt; res(temperatures.size(),0)</code>æ–¹ä¾¿ä¿®æ”¹å¯¹åº”çš„å…ƒç´ </p>
<p>å¦‚æœå¤§äºå½“å‰çš„æ ˆé¡¶å…ƒç´ çš„å€¼ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œæ¯”è¾ƒ<code>while</code>å¾ªç¯ï¼Œåªè¦è¿˜æ˜¯å¤§äºå½“å‰æ ˆé¡¶çš„å…ƒç´ éƒ½éœ€è¦å¯¹æ ˆé¡¶çš„å…ƒç´ è¿›è¡Œ<code>pop()</code></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dailyTemperatures</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; temperatures)</span> </span>&#123;<br>        stack&lt;<span class="hljs-type">int</span>&gt; st;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(temperatures.size(),<span class="hljs-number">0</span>)</span></span>;<br>        st.<span class="hljs-built_in">push</span>(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;temperatures.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(temperatures[i]&lt;=temperatures[st.<span class="hljs-built_in">top</span>()])&#123;<br>                st.<span class="hljs-built_in">push</span>(i);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">while</span> (!st.<span class="hljs-built_in">empty</span>()&amp;&amp; temperatures[i]&gt;temperatures[st.<span class="hljs-built_in">top</span>()])&#123;<br>                    res[st.<span class="hljs-built_in">top</span>()]=i-st.<span class="hljs-built_in">top</span>();<br>                    st.<span class="hljs-built_in">pop</span>();<br>                &#125;<br>                st.<span class="hljs-built_in">push</span>(i);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="å›¾è®º">å›¾è®º</h1>
<h3 id="æ·±åº¦ä¼˜å…ˆæœç´¢ç†è®º">æ·±åº¦ä¼˜å…ˆæœç´¢ç†è®º</h3>
<h3 id="å¹¿åº¦ä¼˜å…ˆæœç´¢ç†è®º">å¹¿åº¦ä¼˜å…ˆæœç´¢ç†è®º</h3>
<h3 id="æ‰€æœ‰å¯èƒ½çš„è·¯å¾„">æ‰€æœ‰å¯èƒ½çš„è·¯å¾„</h3>
<p><a
href="https://leetcode.cn/problems/all-paths-from-source-to-target/description/">https://leetcode.cn/problems/all-paths-from-source-to-target/description/</a></p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240129130942760.png" alt="å›¾è·¯å¾„éå†" style="zoom:50%;" /></p>
<p>ç»™ä½ ä¸€ä¸ªæœ‰ <code>n</code> ä¸ªèŠ‚ç‚¹çš„
<strong>æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰</strong>ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰ä»èŠ‚ç‚¹ <code>0</code>
åˆ°èŠ‚ç‚¹ <code>n-1</code>
çš„è·¯å¾„å¹¶è¾“å‡ºï¼ˆ<strong>ä¸è¦æ±‚æŒ‰ç‰¹å®šé¡ºåº</strong>ï¼‰ <code>graph[i]</code>
æ˜¯ä¸€ä¸ªä»èŠ‚ç‚¹ <code>i</code> å¯ä»¥è®¿é—®çš„æ‰€æœ‰èŠ‚ç‚¹çš„åˆ—è¡¨ï¼ˆå³ä»èŠ‚ç‚¹
<code>i</code> åˆ°èŠ‚ç‚¹ <code>graph[i][j]</code>å­˜åœ¨ä¸€æ¡æœ‰å‘è¾¹ï¼‰ã€‚</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šgraph = <span class="hljs-string">[[1,2],[3],[3],[]]</span><br>è¾“å‡ºï¼š<span class="hljs-string">[[0,1,3],[0,2,3]]</span><br>è§£é‡Šï¼šæœ‰ä¸¤æ¡è·¯å¾„ <span class="hljs-number">0</span> -&gt; <span class="hljs-number">1</span> -&gt; <span class="hljs-number">3</span> å’Œ <span class="hljs-number">0</span> -&gt; <span class="hljs-number">2</span> -&gt; <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<p>æ·±åº¦ä¼˜å…ˆæœç´¢</p>
<p>æ³¨æ„åœ¨ç”¨dfsåšé¢˜çš„æ—¶å€™éœ€è¦åˆå§‹åŒ–<code>path.push_back(0)</code>æ¯ä¸€æ¬¡éƒ½éœ€è¦åˆå§‹åŒ–è¾“å…¥è¿™ä¸ªæ•°å€¼èµ·ç‚¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    vector&lt;<span class="hljs-type">int</span>&gt; path;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;&amp; graph, <span class="hljs-type">int</span> x)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(x == graph.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>)&#123;<br>            res.<span class="hljs-built_in">push_back</span>(path);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;graph[x].<span class="hljs-built_in">size</span>();i++)&#123;<br>            path.<span class="hljs-built_in">push_back</span>(graph[x][i]);<br>            <span class="hljs-built_in">dfs</span>(graph,graph[x][i]);<br>            path.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">allPathsSourceTarget</span>(vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;&amp; graph) &#123;<br>        path.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">0</span>);<br>        <span class="hljs-built_in">dfs</span>(graph, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h3 id="å²›å±¿æ•°é‡">å²›å±¿æ•°é‡</h3>
<p><a
href="https://leetcode.cn/problems/number-of-islands/description/">https://leetcode.cn/problems/number-of-islands/description/</a></p>
<p>ç»™ä½ ä¸€ä¸ªç”± <code>'1'</code>ï¼ˆé™†åœ°ï¼‰å’Œ
<code>'0'</code>ï¼ˆæ°´ï¼‰ç»„æˆçš„çš„äºŒç»´ç½‘æ ¼ï¼Œè¯·ä½ è®¡ç®—ç½‘æ ¼ä¸­å²›å±¿çš„æ•°é‡ã€‚å²›å±¿æ€»æ˜¯è¢«æ°´åŒ…å›´ï¼Œå¹¶ä¸”æ¯åº§å²›å±¿åªèƒ½ç”±æ°´å¹³æ–¹å‘å’Œ/æˆ–ç«–ç›´æ–¹å‘ä¸Šç›¸é‚»çš„é™†åœ°è¿æ¥å½¢æˆã€‚</p>
<p><strong>ç¤ºä¾‹ ï¼š</strong></p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šgrid = [<br>  [<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>],<br>  [<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>],<br>  [<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>],<br>  [<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>]<br>]<br>è¾“å‡ºï¼š<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>æ·±åº¦ä¼˜å…ˆæœç´¢ç‰ˆæœ¬ï¼š</p>
<p>æ€è·¯åœ¨äºåˆ©ç”¨dfsæ¥å¯¹å²›å±¿ä¸­çš„æ•°é‡è¿›è¡Œæ ‡è®°æ˜¯å¦èƒ½visitedï¼Œå¿…é¡»æ˜¯è”é€šçš„æ‰èƒ½ç»§ç»­æ ‡è®°ä¸º<code>res++</code></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">int</span> dir[<span class="hljs-number">4</span>][<span class="hljs-number">2</span>] =&#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>&#125;;<span class="hljs-comment">//å››ä¸ªæ–¹å‘</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">char</span>&gt;&gt;&amp; grid, vector&lt;vector&lt;<span class="hljs-type">bool</span>&gt;&gt;&amp; visited, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;<br>            <span class="hljs-type">int</span> nextx = x+dir[i][<span class="hljs-number">0</span>];<br>            <span class="hljs-type">int</span> nexty = y+dir[i][<span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">if</span>(nextx &lt; <span class="hljs-number">0</span>||nextx&gt;=grid.<span class="hljs-built_in">size</span>()||nexty&lt;<span class="hljs-number">0</span> ||nexty&gt;=grid[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>()) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">if</span>(!visited[nextx][nexty]&amp;&amp;grid[nextx][nexty]==<span class="hljs-string">&#x27;1&#x27;</span>)&#123;<br>                visited[nextx][nexty]=<span class="hljs-literal">true</span>;<br>                <span class="hljs-built_in">dfs</span>(grid, visited , nextx, nexty);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">numIslands</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">char</span>&gt;&gt;&amp; grid)</span> </span>&#123;<br>        <span class="hljs-type">int</span> n = grid.<span class="hljs-built_in">size</span>(), m = grid[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>();<br>        vector&lt;vector&lt;<span class="hljs-type">bool</span>&gt;&gt; visited = vector&lt;vector&lt;<span class="hljs-type">bool</span>&gt;&gt;(n,<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">bool</span>&gt;(m,<span class="hljs-literal">false</span>));<br>        <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>;j&lt;m;j++)&#123;<br>                <span class="hljs-keyword">if</span>(!visited[i][j] &amp;&amp; grid[i][j]==<span class="hljs-string">&#x27;1&#x27;</span>)&#123;<br>                    visited[i][j]=<span class="hljs-literal">true</span>;<br>                    res++;<br>                    <span class="hljs-built_in">dfs</span>(grid, visited, i,j);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>LeetCodeç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•é¢˜</tag>
        <tag>leetcode</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åŸºç¡€å·¥å…·ã€‘LinuxæŒ‡ä»¤é›†</title>
    <url>/2023/11/25/linux/</url>
    <content><![CDATA[<h2 id="linuxå‘½ä»¤é›†">Linuxå‘½ä»¤é›†</h2>
<h4 id="æŸ¥çœ‹å½“å‰è·¯å¾„çš„ä½ç½®-pwd">æŸ¥çœ‹å½“å‰è·¯å¾„çš„ä½ç½® pwd</h4>
<h4 id="æŸ¥çœ‹å‘½ä»¤å†å²">æŸ¥çœ‹å‘½ä»¤å†å²</h4>
<p>ç»ˆç«¯ä¸­è¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">history</span><br></code></pre></td></tr></table></figure>
<h4 id="æŒ‡å®šæŸ¥æ‰¾å…³é”®å­—">æŒ‡å®šæŸ¥æ‰¾å…³é”®å­—</h4>
<p>é€šè¿‡å¢åŠ grepæ¥å¢åŠ å…³é”®å­—çš„ç­›é€‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">| grep GOPROXY<br></code></pre></td></tr></table></figure>
<h4 id="å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶">å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</h4>
<ul>
<li>å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ ls</li>
<li>ls -lï¼›ls-hï¼›éƒ½æ˜¯ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯</li>
<li>ls -a æ¥æ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰</li>
<li>ç»„åˆä½¿ç”¨ ls -lha æ˜¾ç¤ºæ‰€æœ‰å¹¶åŒ…å«çš„éšè—æ–‡ä»¶ä¸”æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</li>
<li>ä½¿ç”¨diræ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å*</li>
</ul>
<h4 id="åˆ‡æ¢æ–‡ä»¶å¤¹">åˆ‡æ¢æ–‡ä»¶å¤¹</h4>
<ul>
<li><p>cd .. <em>#è¿”å›çˆ¶çº§ç›®å½•</em></p></li>
<li><table>
<thead>
<tr class="header">
<th style="text-align: center;">cd</th>
<th>åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•(/home/ç”¨æˆ·ç›®å½•)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cd ~</td>
<td>åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•(/home/ç”¨æˆ·ç›®å½•)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cd .</td>
<td>ä¿æŒåœ¨å½“å‰ç›®å½•ä¸å˜</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cd â€¦</td>
<td>åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•</td>
</tr>
<tr class="even">
<td style="text-align: center;">cd -</td>
<td>å¯ä»¥åœ¨æœ€è¿‘ä¸¤æ¬¡å·¥ä½œç›®å½•ä¹‹é—´æ¥å›åˆ‡æ¢</td>
</tr>
</tbody>
</table></li>
<li><p>ç›¸å¯¹è·¯å¾„ åœ¨è¾“å…¥è·¯å¾„æ—¶ï¼Œæœ€å‰é¢ä¸æ˜¯ / æˆ–è€… ~ï¼Œè¡¨ç¤ºç›¸å¯¹ å½“å‰ç›®å½•
æ‰€åœ¨çš„ç›®å½•ä½ç½® ç»å¯¹è·¯å¾„ åœ¨è¾“å…¥è·¯å¾„æ—¶ï¼Œæœ€å‰é¢æ˜¯ / æˆ–è€… ~ï¼Œè¡¨ç¤ºä»
<strong>æ ¹ç›®å½•/å®¶ç›®å½•</strong> å¼€å§‹çš„å…·ä½“ç›®å½•ä½ç½®</p></li>
</ul>
<h4 id="ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šä½ç½®-mv">ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šä½ç½® mv</h4>
<ul>
<li><p>mv <u>æ–‡ä»¶å</u> <u>æŒ‡å®šçš„è·¯å¾„ä½ç½®</u> -i ç”¨äºæç¤º</p></li>
<li><p>ä¿®æ”¹æ–‡ä»¶å¤¹åç§°ï¼šmv åŸæ¥çš„æ–‡ä»¶å¤¹åç§° åæ¥çš„æ–‡ä»¶å¤¹åç§°</p></li>
<li><h6 id="æ‹·è´æŸä¸ªæ–‡ä»¶å¤¹åˆ°æŒ‡å®šè·¯å¾„">æ‹·è´æŸä¸ªæ–‡ä»¶å¤¹åˆ°æŒ‡å®šè·¯å¾„</h6>
<ul>
<li><p>cp <u>å½“å‰æ–‡ä»¶å¤¹ä¸‹æŸä¸ªæ–‡ä»¶å</u>ï¼ˆå¸¦åç¼€ï¼‰ <u>ç›®æ ‡è·¯å¾„</u> -i
ç”¨äºæç¤º</p>
<table>

<thead>
<tr class="header">
<th>å‘½ä»¤</th>
<th>å¯¹åº”è‹±æ–‡</th>
<th>ä½œç”¨</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>01</td>
<td>tree [ç›®å½•å]</td>
<td>tree</td>
<td>ä»¥æ ‘çŠ¶å›¾åˆ—å‡ºæ–‡ä»¶ç›®å½•ç»“æ„</td>
</tr>
<tr class="even">
<td>02</td>
<td>cp æºæ–‡ä»¶ç›®æ ‡æ–‡ä»¶</td>
<td>copy</td>
<td>å¤åˆ¶æ–‡ä»¶æˆ–è€…ç›®å½•</td>
</tr>
<tr class="odd">
<td>03</td>
<td>mv æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶</td>
<td>move</td>
<td>ç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½•ï¼æ–‡ä»¶æˆ–è€…ç›®å½•é‡å‘½å</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
<h4 id="åˆ›å»ºæ–‡ä»¶å¤¹">åˆ›å»ºæ–‡ä»¶å¤¹</h4>
<ul>
<li>è¿›å…¥è·¯å¾„çš„ä½ç½® mkdir <u>éœ€è¦åˆ›å»ºçš„æ–‡ä»¶å¤¹çš„åç§°</u></li>
<li>é€’å½’åˆ›å»ºæ–‡ä»¶å¤¹ mkdir -p 123/456
<u>åœ¨123æ–‡ä»¶å¤¹ä¸‹é€’å½’åˆ›å»ºæ–‡ä»¶å¤¹456</u></li>
</ul>
<h4 id="æ–°å»ºæŸä¸ªæ–‡ä»¶">æ–°å»ºæŸä¸ªæ–‡ä»¶</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> 123.txt<br></code></pre></td></tr></table></figure>
<h4 id="åˆ é™¤æ–‡ä»¶å¤¹">åˆ é™¤æ–‡ä»¶å¤¹</h4>
<ul>
<li>rmdir+ éœ€è¦åˆ é™¤çš„æ–‡ä»¶å</li>
</ul>
<h4 id="åˆ é™¤æŸä¸ªæ–‡ä»¶">åˆ é™¤æŸä¸ªæ–‡ä»¶</h4>
<ul>
<li><p>ä½¿ç”¨rmæ¥å¯¹æ–‡ä»¶è¿›è¡Œåˆ é™¤ -i è¿›è¡Œåˆ é™¤å‰çš„æŸ¥è¯¢</p></li>
<li><table>
<thead>
<tr class="header">
<th>é€‰é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-f</td>
<td>å¼ºåˆ¶åˆ é™¤ï¼Œå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œæ— éœ€æç¤º</td>
</tr>
<tr class="even">
<td>-r</td>
<td>é€’å½’åœ°åˆ é™¤ç›®å½•ä¸‹çš„å†…å®¹ï¼Œ<strong>åˆ é™¤æ–‡ä»¶å¤¹
æ—¶å¿…é¡»åŠ æ­¤å‚æ•°</strong></td>
</tr>
</tbody>
</table></li>
</ul>
<h4 id="è§£å‹ç¼©æ–‡ä»¶çš„æŒ‡ä»¤">è§£å‹ç¼©æ–‡ä»¶çš„æŒ‡ä»¤</h4>
<ul>
<li><h5 id="å¯¹äºzipæ–‡ä»¶çš„æ“ä½œ">å¯¹äºZIPæ–‡ä»¶çš„æ“ä½œ</h5>
<ul>
<li>è§£å‹æ“ä½œï¼šè¿›å…¥éœ€è¦è§£å‹çš„æ–‡ä»¶çš„ä½ç½®ï¼š<strong>unzip
filename.zip</strong></li>
<li>å‹ç¼©æ–‡ä»¶ï¼šåŒç†è¿›å…¥éœ€è¦è§£å‹çš„æ–‡ä»¶å¤¹çš„ä¸Šä¸€çº§ zip filename.zip</li>
</ul></li>
</ul>
<h4 id="linuxä¸­æŸ¥çœ‹ç³»ç»Ÿä½¿ç”¨æƒ…å†µ">Linuxä¸­æŸ¥çœ‹ç³»ç»Ÿä½¿ç”¨æƒ…å†µ</h4>
<ul>
<li><p>Top æ¥æ˜¾ç¤ºCPUçš„å ç”¨æƒ…å†µï¼š</p>
<blockquote>
<table>

<thead>
<tr class="header">
<th>PID</th>
<th>è¿›ç¨‹çš„ID</th>
<th>USER</th>
<th>è¿›ç¨‹æ‰€æœ‰è€…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>PR</strong></td>
<td>è¿›ç¨‹çš„ä¼˜å…ˆçº§åˆ«ï¼Œè¶Šå°è¶Šä¼˜å…ˆè¢«æ‰§è¡Œ</td>
<td><strong>NInice</strong></td>
<td>å€¼</td>
</tr>
<tr class="even">
<td><strong>VIRT</strong></td>
<td>è¿›ç¨‹å ç”¨çš„è™šæ‹Ÿå†…å­˜</td>
<td><strong>RES</strong></td>
<td>è¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜</td>
</tr>
<tr class="odd">
<td><strong>SHR</strong></td>
<td>è¿›ç¨‹ä½¿ç”¨çš„å…±äº«å†…å­˜</td>
<td>S</td>
<td>è¿›ç¨‹çš„çŠ¶æ€ã€‚Sè¡¨ç¤ºä¼‘çœ ï¼ŒRè¡¨ç¤ºæ­£åœ¨è¿è¡Œï¼ŒZè¡¨ç¤ºåƒµæ­»çŠ¶æ€ï¼ŒNè¡¨ç¤ºè¯¥è¿›ç¨‹ä¼˜å…ˆå€¼ä¸ºè´Ÿæ•°</td>
</tr>
<tr class="even">
<td><strong>%CPU</strong></td>
<td>è¿›ç¨‹å ç”¨CPUçš„ä½¿ç”¨ç‡</td>
<td><strong>%MEM</strong></td>
<td>è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜å’Œæ€»å†…å­˜çš„ç™¾åˆ†æ¯”</td>
</tr>
<tr class="odd">
<td><strong>TIME+</strong></td>
<td>è¯¥è¿›ç¨‹å¯åŠ¨åå ç”¨çš„æ€»çš„CPUæ—¶é—´ï¼Œå³å ç”¨CPUä½¿ç”¨æ—¶é—´çš„ç´¯åŠ å€¼</td>
<td><strong>COMMAND</strong></td>
<td>è¿›ç¨‹å¯åŠ¨å‘½ä»¤åç§°</td>
</tr>
</tbody>
</table>
</blockquote></li>
<li><p><strong>top</strong>é€€å‡ºæ–¹å¼æ˜¯==ç”¨qè¿›è¡Œé€€å‡º==</p></li>
<li><p><strong>free</strong>æŸ¥çœ‹å†…å­˜çš„ä½¿ç”¨æƒ…å†µ</p>
<blockquote>
<table>

<thead>
<tr class="header">
<th>total</th>
<th>æ€»è®¡ç‰©ç†å†…å­˜çš„å¤§å°</th>
<th>used</th>
<th>å·²ä½¿ç”¨å¤šå¤§</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>free</strong></td>
<td>å¯ç”¨æœ‰å¤šå°‘</td>
<td><strong>Shared</strong></td>
<td>å¤šä¸ªè¿›ç¨‹å…±äº«çš„å†…å­˜æ€»é¢</td>
</tr>
<tr class="even">
<td><strong>Buffers/cached</strong></td>
<td>ç£ç›˜ç¼“å­˜çš„å¤§å°</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</blockquote></li>
<li><p><strong>vmstat</strong>æŒ‡ä»¤ä¹Ÿæ˜¯ç”¨äºæŸ¥çœ‹å†…å­˜çš„ä½¿ç”¨</p>
<blockquote>
<ul>
<li><p><strong>Procs(è¿›ç¨‹)</strong>ï¼š r:
è¿è¡Œé˜Ÿåˆ—ä¸­è¿›ç¨‹æ•°é‡ï¼Œè¿™ä¸ªå€¼ä¹Ÿå¯ä»¥åˆ¤æ–­æ˜¯å¦éœ€è¦å¢åŠ CPUã€‚(é•¿æœŸå¤§äº1) b:
ç­‰å¾…IOçš„è¿›ç¨‹æ•°é‡</p></li>
<li><p><strong>Memory(å†…å­˜)</strong>ï¼šswpd: ä½¿ç”¨è™šæ‹Ÿå†…å­˜å¤§å°ï¼›free:
ç©ºé—²ç‰©ç†å†…å­˜å¤§å°ï¼›buff: ç”¨ä½œç¼“å†²çš„å†…å­˜å¤§å°ï¼›cache:
ç”¨ä½œç¼“å­˜çš„å†…å­˜å¤§å°</p></li>
<li><p><strong>Swap</strong>ï¼š si:
æ¯ç§’ä»äº¤æ¢åŒºå†™åˆ°å†…å­˜çš„å¤§å°ï¼Œç”±ç£ç›˜è°ƒå…¥å†…å­˜ï¼›so:
æ¯ç§’å†™å…¥äº¤æ¢åŒºçš„å†…å­˜å¤§å°ï¼Œç”±å†…å­˜è°ƒå…¥ç£ç›˜</p></li>
<li><p><strong>IO</strong>ï¼šbi: æ¯ç§’è¯»å–çš„å—æ•°ï¼Œbo:
æ¯ç§’å†™å…¥çš„å—æ•°</p></li>
<li><p><strong>ç³»ç»Ÿ</strong>ï¼š in: æ¯ç§’ä¸­æ–­æ•°ï¼ŒåŒ…æ‹¬æ—¶é’Ÿä¸­æ–­ã€‚ cs:
æ¯ç§’ä¸Šä¸‹æ–‡åˆ‡æ¢æ•°ã€‚</p></li>
<li><p><strong>CPU(ä»¥ç™¾åˆ†æ¯”è¡¨ç¤º)</strong>ï¼šus:
ç”¨æˆ·è¿›ç¨‹æ‰§è¡Œæ—¶é—´ç™¾åˆ†æ¯”(user time) sy: å†…æ ¸ç³»ç»Ÿè¿›ç¨‹æ‰§è¡Œæ—¶é—´ç™¾åˆ†æ¯”(system
time) ï¼›wa: IOç­‰å¾…æ—¶é—´ç™¾åˆ†æ¯”ï¼› id: ç©ºé—²æ—¶é—´ç™¾åˆ†æ¯”</p></li>
</ul>
</blockquote></li>
</ul>
<h4 id="æŸ¥çœ‹ç³»ç»Ÿçš„gpu">æŸ¥çœ‹ç³»ç»Ÿçš„GPU</h4>
<p>å®æ—¶æŸ¥çœ‹GPUä½¿ç”¨æƒ…å†µ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">watch -n 1 nvidia-smi <br></code></pre></td></tr></table></figure>
<p>è¡Œä»£ç çš„æ„æ€æ˜¯åªé€‰æ‹©æŒ‡å®šæ ‡å·GPUè¿›è¡Œä½¿ç”¨ï¼Œæ‰§è¡Œå®Œè¯¥è¡Œä»£ç ä¹‹åpythonç¯å¢ƒæ— æ³•æ£€æµ‹åˆ°æŒ‡å®šGPUä¹‹å¤–çš„å…¶ä»–</p>
<h4 id="ç³»ç»Ÿç¯å¢ƒå˜é‡">ç³»ç»Ÿç¯å¢ƒå˜é‡</h4>
<p>å¯¹äºMACOSï¼Œç”¨VIMè¿›å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">vim ï½/.zshrc<br></code></pre></td></tr></table></figure>
<p>æ·»åŠ ç¯å¢ƒå˜é‡çš„è¯­å¥æ˜¯ï¼Œè¿™é‡Œä»¥å¢åŠ è·¯å¾„ä¸ºä¾‹å­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> GOPATH=<span class="hljs-string">&quot;user/workspace/golang&quot;</span><br></code></pre></td></tr></table></figure>
<p>æ·»åŠ å®Œç¯å¢ƒå˜é‡ä¹‹åï¼Œæ¿€æ´»ä¸€ä¸‹è®¾ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.zshrc<br></code></pre></td></tr></table></figure>
<p>åŒæ ·å¯¹äºLinuxç³»ç»Ÿè€Œè¨€ä¹Ÿæ˜¯ç›¸åŒçš„æ­¥éª¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">vim ~/.bashrc<br></code></pre></td></tr></table></figure>
<p>æ·»åŠ å®Œæˆä¹‹åæœ€åæ¿€æ´»ä¸€ä¸‹è®¾å®š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.bashrc<br></code></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³ç›´æ¥æŸ¥çœ‹å½“å‰æŸä¸ªç¯å¢ƒå˜é‡çš„è®¾ç½®çš„å€¼å¯ä»¥ç”¨ä»¥ä¸‹çš„å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$GOPARH</span><br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„å€¼æ˜¯å½“å‰çš„è¿™ä¸ªç¯å¢ƒå˜é‡è®¾ç½®çš„å€¼ï¼Œæ¯”å¦‚ä¼šè¾“å‡ºï¼šuser/workspace/golang</p>
<h4 id="æ˜¾ç¤ºlinuxç³»ç»Ÿçš„å…¶ä»–ä¿¡æ¯">æ˜¾ç¤ºLinuxç³»ç»Ÿçš„å…¶ä»–ä¿¡æ¯</h4>
<h5 id="æ—¶é—´å’Œæ—¥æœŸ">æ—¶é—´å’Œæ—¥æœŸ</h5>
<table>
<thead>
<tr class="header">
<th>åºå·</th>
<th>å‘½ä»¤</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>01</td>
<td>date</td>
<td>æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´</td>
</tr>
<tr class="even">
<td>02</td>
<td>cal</td>
<td>calendar æŸ¥çœ‹æ—¥å†ï¼Œ -y é€‰é¡¹å¯ä»¥æŸ¥çœ‹ä¸€å¹´çš„æ—¥å†</td>
</tr>
</tbody>
</table>
<h5 id="ç£ç›˜ä¿¡æ¯">ç£ç›˜ä¿¡æ¯</h5>
<table>
<thead>
<tr class="header">
<th>åºå·</th>
<th>å‘½ä»¤</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>01</td>
<td>df -h</td>
<td>disk free æ˜¾ç¤ºç£ç›˜å‰©ä½™ç©ºé—´</td>
</tr>
<tr class="even">
<td>02</td>
<td>du -h [ç›®å½•å]</td>
<td>disk usage æ˜¾ç¤ºç›®å½•ä¸‹çš„æ–‡ä»¶å¤§å°</td>
</tr>
</tbody>
</table>
<h5 id="è¿›ç¨‹ä¿¡æ¯">è¿›ç¨‹ä¿¡æ¯</h5>
<p>â€‹ æ‰€è°“<strong>è¿›ç¨‹</strong>ï¼Œé€šä¿—åœ°è¯´å°±æ˜¯
<strong>å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä¸€ä¸ªç¨‹åº</strong></p>
<table>
<thead>
<tr class="header">
<th>åºå·</th>
<th>å‘½ä»¤</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>01</td>
<td>ps aux</td>
<td>process status æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†çŠ¶å†µ</td>
</tr>
<tr class="even">
<td>02</td>
<td>top</td>
<td>åŠ¨æ€æ˜¾ç¤ºè¿è¡Œä¸­çš„è¿›ç¨‹å¹¶ä¸”æ’åº</td>
</tr>
<tr class="odd">
<td>03</td>
<td>kill [-9] è¿›ç¨‹ä»£å·</td>
<td>ç»ˆæ­¢æŒ‡å®šä»£å·çš„è¿›ç¨‹ï¼Œ -9 è¡¨ç¤ºå¼ºè¡Œç»ˆæ­¢</td>
</tr>
</tbody>
</table>
<h4 id="ç½‘ç»œæµ‹è¯•">ç½‘ç»œæµ‹è¯•</h4>
<p>â€‹ ping ä¸€èˆ¬ç”¨äºæ£€æµ‹å½“å‰è®¡ç®—æœºåˆ°ç›®æ ‡è®¡ç®—æœºä¹‹é—´çš„ç½‘ç»œ
<strong>æ˜¯å¦é€šç•…ï¼Œæ•°å€¼è¶Šå¤§ï¼Œé€Ÿåº¦è¶Šæ…¢</strong></p>
<figure class="highlight c#"><table><tr><td class="code"><pre><code class="hljs c#"><span class="hljs-meta"># æ£€æµ‹åˆ°ç›®æ ‡ä¸»æœºæ˜¯å¦è¿æ¥æ­£å¸¸</span><br>$ ping IPåœ°å€ www.baidu.com<br><span class="hljs-meta"># æ£€æµ‹æœ¬åœ°ç½‘å¡å·¥ä½œæ­£å¸¸</span><br>$ ping <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure>
<h4 id="gpuè¿è¡ŒæŒ‡å®š">GPUè¿è¡ŒæŒ‡å®š</h4>
<ol type="1">
<li><p>é¦–å…ˆå…ˆæŸ¥çœ‹å¯¹åº”çš„GPUå†…å­˜ï¼š<strong>nvidia-smi</strong></p></li>
<li><p>ç„¶ååœ¨ç»ˆç«¯è¾“å‡ºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">CUDA_VISIBLE_DEVICES=<span class="hljs-number">1</span> python your_model.py <br></code></pre></td></tr></table></figure>
<p>å†æˆ–è€…ä½¿ç”¨
<code>**torch.cuda.set_device()**å‡½æ•°</code>æŒ‡å®šgpuä½¿ç”¨ç¼–å·ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br>torch.cuda.set_device(<span class="hljs-number">2</span>) <span class="hljs-comment"># ä½¿ç”¨2å·GPU</span><br></code></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>åŸºç¡€å·¥å…·</category>
      </categories>
      <tags>
        <tag>åŸºç¡€å·¥å…·</tag>
        <tag>åç«¯å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ã€‘Pymarlä»£ç åˆ†æ</title>
    <url>/2024/01/19/pymarl-code/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="pymarlä»£ç ç»“æ„">Pymarlä»£ç ç»“æ„</h1>
<p>æœ¬æ–‡ç« ä¸»è¦ä»‹ç»å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ä¸­çš„PyMarlæ¡†æ¶çš„ä»£ç ç»“æ„ä»¥åŠè®­ç»ƒæµç¨‹</p>
<h2 id="main">Main</h2>
<p>Pymarlçš„ä¸»æ–‡ä»¶ï¼ˆ<code>main.py</code>)ä¸»è¦çš„ä½œç”¨æ˜¯æ„å»ºä¸€ä¸ª
<strong>sacred.Experiment</strong> ç±»çš„å¯¹è±¡ <code>ex</code>
ï¼Œ<code>ex</code> åŒ…å«ä¸‰ä¸ªé‡è¦çš„å†…ç½®å˜é‡ï¼š</p>
<ul>
<li><code>_run</code>ï¼šè¡¨ç¤ºå½“å‰å®éªŒè¿è¡Œæ—¶çš„ <strong>run</strong>
å¯¹è±¡ï¼Œ<code>_run.info</code>
å¯ç”¨äºè®°å½•å®éªŒä¸­äº§ç”Ÿçš„ç»“æœï¼Œå®éªŒåˆå§‹æ—¶æ˜¯ç©ºå­—å…¸<code>&#123;&#125;</code>ï¼›</li>
<li><code>_config</code>ï¼šè¡¨ç¤ºå½“å‰å®éªŒè¿è¡Œæ—¶çš„å‚æ•°ï¼Œå­—å…¸ç±»ï¼Œpymarlé¦–å…ˆè¯»å–é…ç½®æ–‡ä»¶ç„¶ååˆ©ç”¨<code>ex.add_config()</code>
å°†é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°æ·»åŠ åˆ°<code>_config</code>å˜é‡ä¸­ï¼›</li>
<li><code>_log</code>ï¼šä¸€ä¸ª
<strong>logger</strong>ï¼Œpymarlé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª
<strong>logging.logger</strong> ç±»çš„å¯¹è±¡<code>logger</code>ï¼Œç„¶åå°†
<code>logger</code> èµ‹ç»™äº† <code>ex.logger</code> ä¹Ÿå°±æ˜¯
<code>_log</code>ã€‚<code>_log</code> å¯ä»¥é€šè¿‡
<code>_log.info('information')</code>
åœ¨æ§åˆ¶å°æ‰“å°å®éªŒè¿‡ç¨‹ä¸­çš„ä¸­é—´ä¿¡æ¯ï¼Œæ–¹ä¾¿æˆ‘ä»¬èƒ½å¤Ÿå®šæœŸè¿½è¸ªå®éªŒçŠ¶æ€ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@ex.main</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_main</span>(<span class="hljs-params">_run, _config, _log</span>):<br>    <span class="hljs-comment"># Setting the random seed throughout the modules</span><br>    config = config_copy(_config)<br>    np.random.seed(config[<span class="hljs-string">&quot;seed&quot;</span>])<br>    th.manual_seed(config[<span class="hljs-string">&quot;seed&quot;</span>])<br>    config[<span class="hljs-string">&#x27;env_args&#x27;</span>][<span class="hljs-string">&#x27;seed&#x27;</span>] = config[<span class="hljs-string">&quot;seed&quot;</span>]<br></code></pre></td></tr></table></figure>
<h2 id="run">Run</h2>
<p>å¦‚ä½•è¿›å…¥ï¼šé€šè¿‡å€ŸåŠ©è£…é¥°å™¨å®šä¹‰ä¸€ä¸ªä¸»å‡½æ•°ï¼Œå…¶ä¸­è¿˜å®šä¹‰äº†å¦‚ä½•è¿è¡Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># run</span><br>   <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;use_per&quot;</span> <span class="hljs-keyword">in</span> _config <span class="hljs-keyword">and</span> _config[<span class="hljs-string">&quot;use_per&quot;</span>]:<br>       run_REGISTRY[<span class="hljs-string">&#x27;per_run&#x27;</span>](_run, config, _log)<br>   <span class="hljs-keyword">else</span>:<br>       run_REGISTRY[_config[<span class="hljs-string">&#x27;run&#x27;</span>]](_run, config, _log)<br></code></pre></td></tr></table></figure>
<p>å…³äºè¿™éƒ¨åˆ†<code>run_REGISTRY</code>
å­—å…¸çš„è®¾ç½®ï¼Œåœ¨åˆå§‹åŒ–ä¸­æ–‡ä»¶ä¸­ä¼šè¿›è¡ŒæŒ‡å®šï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> .run <span class="hljs-keyword">import</span> run <span class="hljs-keyword">as</span> default_run<br><span class="hljs-keyword">from</span> .interval_run <span class="hljs-keyword">import</span> run <span class="hljs-keyword">as</span> interval_run<br><br>REGISTRY = &#123;&#125;<br>REGISTRY[<span class="hljs-string">&quot;default&quot;</span>] = default_run<br>REGISTRY[<span class="hljs-string">&quot;interval_run&quot;</span>] = interval_run<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹å¼•å…¥çš„
<code>import run as default_run</code>å°±æ˜¯æŒ‡å®šäº†åœ¨æŸä¸ªæ–‡ä»¶ä¸­çš„<code>run</code>å‡½æ•°ä¸»ä½“ï¼Œé€šè¿‡æœ€<strong>å¤–å±‚çš„è£…é¥°å™¨è¿›è¡ŒæŒ‡å®š</strong>è¿è¡Œé‚£ä¸ªåˆé€‚çš„<code>run</code>å‡½æ•°</p>
<p><code>run_REGISTRY[_config['run']](_run, config, _log)</code>
è¡¨ç¤ºäº†æŒ‡å®šè¿è¡Œå“ªä¸ªå‡½æ•°ï¼Œå¹¶ä¼ é€’ç›¸å…³çš„å‚æ•°</p>
<p><code>run.py</code>
æ–‡ä»¶ä¸­<code>run</code>å‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯æ„å»ºå®éªŒå‚æ•°å˜é‡ <code>args</code>
ä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰ <code>Logger</code> ç±»çš„è®°å½•å™¨
<code>logger</code>ã€‚å†…ç½®å˜é‡<code>_config</code>çš„æ‹·è´ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°äº†<code>run</code>å‡½æ•°ä¸­ï¼Œ<code>_config</code>
æ˜¯å­—å…¸å˜é‡ï¼Œå› æ­¤æŸ¥çœ‹å‚æ•°æ—¶ï¼Œéœ€è¦åˆ©ç”¨ <code>_config[key]=value</code>ï¼Œåœ¨
<code>run</code>
å‡½æ•°ä¸­ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ª<code>namespace</code>ç±»çš„å˜é‡<code>args</code>ï¼Œå°†<code>_config</code>ä¸­çš„å‚æ•°éƒ½ä¼ ç»™äº†
<code>args</code>ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡<code>args.key=value</code>çš„æ–¹å¼æŸ¥çœ‹å‚æ•°äº†ã€‚</p>
<p>å…¶ä¸­<code>'run'</code> æŒ‡çš„æ˜¯åœ¨å‚æ•°æ–‡ä»¶ä¸­æŒ‡å®šçš„ï¼Œæ¯”å¦‚åœ¨
<code>default.yaml</code> æ–‡ä»¶ä¸­ä¼šè¿›è¡ŒæŒ‡å®šå­—å…¸ä¸­çš„å…ƒç´ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">logger = Logger(_log)<br><br>  _log.info(<span class="hljs-string">&quot;Experiment Parameters:&quot;</span>)<br>  experiment_params = pprint.pformat(_config,<br>                                     indent=<span class="hljs-number">4</span>,<br>                                     width=<span class="hljs-number">1</span>)<br>  _log.info(<span class="hljs-string">&quot;\n\n&quot;</span> + experiment_params + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç ä¸­åˆ›å»ºäº†ä¸€ä¸ª <code>Logger</code>
ç±»çš„å®ä¾‹ï¼Œç”¨äºå°è£…æ—¥å¿—è®°å½•çš„åŠŸèƒ½ï¼Œç”¨äºè®°å½•ä¿¡æ¯ï¼Œ<code>_log.info()</code>
ä½¿ç”¨çš„å°±æ˜¯ç”¨äºæ‰“å°æ—¥å¿—ä¿¡æ¯çš„è¯­å¥ï¼Œå…¶ä¸­æ¶ˆæ¯å†…å®¹å“¥å°±æ˜¯
<code>Experiment Parameters</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">run_sequential(args=args, logger=logger)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥æ˜¯ä¸»è¦çš„å®éªŒè¿è¡Œçš„æ¿å—
<strong>==<code>run_sequential</code>==</strong>ï¼Œ
å€ŸåŠ©è¿™ä¸ªæ¿å—å¯¹å®éªŒè¿è¡Œçš„å†…å®¹è¿›è¡Œç®¡ç†å’Œæ§åˆ¶ï¼Œæ¥ä¸‹æ¥å°†å¯¹è¿™ä¸ªæ¿å—çš„å®ç°è¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚å°†å‚æ•°ä»¥åŠåˆå§‹åŒ–åˆ›å»ºä¹‹åçš„æ—¥å¿—æ¿å—éƒ½ä¼ é€’è¿›è¿™ä¸ªå‡½æ•°å†…éƒ¨è¿›è¡Œè®­ç»ƒ</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-comment"># Clean up after finishing</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Exiting Main&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Stopping all threads&quot;</span>)<br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threading.<span class="hljs-built_in">enumerate</span>():<br>        <span class="hljs-keyword">if</span> t.name != <span class="hljs-string">&quot;MainThread&quot;</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Thread &#123;&#125; is alive! Is daemon: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(t.name, t.daemon))<br>            t.join(timeout=<span class="hljs-number">1</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Thread joined&quot;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Exiting script&quot;</span>)<br>    <span class="hljs-comment"># Making sure framework really exits</span><br>    os._exit(os.EX_OK)<br></code></pre></td></tr></table></figure>
<p>ç»“å°¾éƒ¨åˆ†å°±æ˜¯å¯¹è¿›ç¨‹çš„é€€å‡ºå’Œæ§åˆ¶ã€‚</p>
<h2 id="run-sequential">Run Sequential</h2>
<p>è¿™éƒ¨åˆ†æ˜¯<strong>runçš„æ ¸å¿ƒ</strong>ï¼Œä¹Ÿæ˜¯å¯¹å†…éƒ¨çš„å‡½æ•°è¿›è¡Œæ§åˆ¶å’Œè°ƒç”¨çš„å…³é”®</p>
<h3 id="macç®¡ç†å™¨">Macç®¡ç†å™¨</h3>
<p><strong>ä¸»è¦è¢«æ‰”è¿› <code>runnner</code> å’Œ <code>learner</code>
ä¸¤ä¸ªæ¿å—ä¸­ä½¿ç”¨</strong></p>
<p>å±äºè‡ªå®šä¹‰çš„<code>controller.basic_controller.BasicMAC</code>ç±»ï¼Œè¯¥å¯¹è±¡çš„ä¸»è¦ä½œç”¨æ˜¯
<strong>æ§åˆ¶æ™ºèƒ½ä½“</strong>ï¼Œå› æ­¤<code>mac</code>å¯¹è±¡ä¸­çš„ä¸€ä¸ªé‡è¦å±æ€§å°±æ˜¯<code>nn.module</code>ç±»çš„æ™ºèƒ½ä½“å¯¹è±¡<code>mac.agent</code>ï¼Œè¯¥å¯¹è±¡å®šä¹‰äº†å„ä¸ªæ™ºèƒ½ä½“çš„å±€éƒ¨Qç½‘ç»œï¼Œå³æ¥æ”¶è§‚æµ‹ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºæ™ºèƒ½ä½“å„ä¸ªåŠ¨ä½œçš„Qå€¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Setup multiagent controller here</span><br>   mac = mac_REGISTRY[args.mac](buffer.scheme, groups, args)<br></code></pre></td></tr></table></figure>
<p><code>mac</code>å¯¹è±¡æœ‰<strong>ä¸¤ä¸ªå…³é”®æ–¹æ³•</strong>ï¼š</p>
<ul>
<li><code>mac.forward(ep_batch, t, test_mode=False)</code>ï¼š<code>ep_batch</code>è¡¨ç¤ºä¸€ä¸ªepisodeçš„æ ·æœ¬ï¼Œ<code>t</code>è¡¨ç¤ºæ¯ä¸ªæ ·æœ¬åœ¨è¯¥episodeå†…çš„æ—¶é—´ç´¢å¼•ï¼Œ<code>forward()</code>æ–¹æ³•çš„ä½œç”¨æ˜¯<strong>è¾“å‡ºä¸€ä¸ªepisodeå†…æ¯</strong>ä¸ªæ—¶åˆ»çš„è§‚æµ‹å¯¹åº”çš„æ‰€æœ‰åŠ¨ä½œçš„Qå€¼ä¸<strong>éšå±‚å˜é‡</strong><code>mac.hidden_states</code>ã€‚</li>
<li><code>mac.select_actions(self, ep_batch, t_ep, t_env, bs=slice(None), test_mode=False)</code>ï¼šè¯¥æ–¹æ³•ç”¨äºåœ¨ä¸€ä¸ªepisodeä¸­æ¯ä¸ªæ—¶åˆ»<strong>ä¸ºæ‰€æœ‰æ™ºèƒ½ä½“é€‰æ‹©åŠ¨ä½œ</strong>ã€‚<code>t_ep</code>ä»£è¡¨å½“å‰æ ·æœ¬åœ¨ä¸€ä¸ªepisodeä¸­çš„æ—¶é—´ç´¢å¼•ã€‚<code>t_env</code>ä»£è¡¨å½“å‰æ—¶åˆ»ç¯å¢ƒè¿è¡Œçš„æ€»æ—¶é—´ï¼Œç”¨äºè®¡ç®—epsilon-greedyä¸­çš„epsilonã€‚</li>
</ul>
<h3 id="ç¯å¢ƒè¿è¡Œå™¨">ç¯å¢ƒè¿è¡Œå™¨</h3>
<p>é¦–å…ˆåˆå§‹åŒ–ç¯å¢ƒçš„è¿è¡Œå™¨ï¼Œè¿™éƒ¨åˆ†èƒ½å¤Ÿè·å–ç¯å¢ƒçš„ä¿¡æ¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">runner = r_REGISTRY[args.runner](args=args, logger=logger)<br></code></pre></td></tr></table></figure>
<p>å°è¯•ä»ç¯å¢ƒä¸­è·å–ç›¸å…³çš„æ•°æ®ä¿¡æ¯ï¼Œå¦‚å„ç§æ™ºèƒ½ä½“æ•°é‡ã€åŠ¨ä½œç©ºé—´ç»´åº¦ã€çŠ¶æ€çš„ç»´åº¦ç­‰</p>
<p>å…¶ä¸­<code>getattr(args, "accumulated_episodes", None)</code>
çš„æ„æ€æ˜¯ï¼Œå¦‚æœ
<code>args</code>ä¸­æœ‰<code>"accumulated_episodes"</code>ï¼Œé‚£ä¹ˆå°±è·å–ï¼Œå¦åˆ™å°±è®¾ç½®ä¸º
<code>None</code> ä¸€ç§å¾ˆä¼˜é›…çš„å†™æ³•ï¼Œä¸‹é¢çš„ä¹Ÿæ˜¯åŒç†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">env_info = runner.get_env_info()<br>args.n_agents = env_info[<span class="hljs-string">&quot;n_agents&quot;</span>]<br>args.n_actions = env_info[<span class="hljs-string">&quot;n_actions&quot;</span>]<br>args.state_shape = env_info[<span class="hljs-string">&quot;state_shape&quot;</span>]<br>args.accumulated_episodes = <span class="hljs-built_in">getattr</span>(args, <span class="hljs-string">&quot;accumulated_episodes&quot;</span>, <span class="hljs-literal">None</span>)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">getattr</span>(args, <span class="hljs-string">&#x27;agent_own_state_size&#x27;</span>, <span class="hljs-literal">False</span>):<br>        args.agent_own_state_size = get_agent_own_state_size(args.env_args)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹å°±æ˜¯å®šä¹‰éœ€è¦ç”¨åˆ°çš„å¼ºåŒ–å­¦ä¹ å­—å…¸æ•°æ®ç»“æ„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">scheme = &#123;<br>     <span class="hljs-string">&quot;state&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: env_info[<span class="hljs-string">&quot;state_shape&quot;</span>]&#125;,<br>     <span class="hljs-string">&quot;obs&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: env_info[<span class="hljs-string">&quot;obs_shape&quot;</span>], <span class="hljs-string">&quot;group&quot;</span>: <span class="hljs-string">&quot;agents&quot;</span>&#125;,<br>     <span class="hljs-string">&quot;actions&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: (<span class="hljs-number">1</span>,), <span class="hljs-string">&quot;group&quot;</span>: <span class="hljs-string">&quot;agents&quot;</span>, <span class="hljs-string">&quot;dtype&quot;</span>: th.long&#125;,<br>     <span class="hljs-string">&quot;avail_actions&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: (env_info[<span class="hljs-string">&quot;n_actions&quot;</span>],), <span class="hljs-string">&quot;group&quot;</span>: <span class="hljs-string">&quot;agents&quot;</span>, <span class="hljs-string">&quot;dtype&quot;</span>: th.<span class="hljs-built_in">int</span>&#125;,<br>     <span class="hljs-string">&quot;probs&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: (env_info[<span class="hljs-string">&quot;n_actions&quot;</span>],), <span class="hljs-string">&quot;group&quot;</span>: <span class="hljs-string">&quot;agents&quot;</span>, <span class="hljs-string">&quot;dtype&quot;</span>: th.<span class="hljs-built_in">float</span>&#125;,<br>        <span class="hljs-string">&quot;reward&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: (<span class="hljs-number">1</span>,)&#125;,<br>        <span class="hljs-string">&quot;terminated&quot;</span>: &#123;<span class="hljs-string">&quot;vshape&quot;</span>: (<span class="hljs-number">1</span>,), <span class="hljs-string">&quot;dtype&quot;</span>: th.uint8&#125;,&#125;<br>groups = &#123; <span class="hljs-string">&quot;agents&quot;</span>: args.n_agents&#125;<br>preprocess = &#123;<span class="hljs-string">&quot;actions&quot;</span>: (<span class="hljs-string">&quot;actions_onehot&quot;</span>, [OneHot(out_dim=args.n_actions)])&#125;<br>buffer = ReplayBuffer(scheme, groups, args.buffer_size, env_info[<span class="hljs-string">&quot;episode_limit&quot;</span>] + <span class="hljs-number">1</span>,<br>                          preprocess=preprocess,<br>                          device=<span class="hljs-string">&quot;cpu&quot;</span> <span class="hljs-keyword">if</span> args.buffer_cpu_only <span class="hljs-keyword">else</span> args.device)<br></code></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–è¿è¡Œç¯å¢ƒï¼Œç¡®ä¿æ‰€æœ‰å¿…è¦çš„ç»„ä»¶éƒ½å·²ç»é…ç½®å¥½ï¼Œä»¥ä¾¿å¼€å§‹è¿è¡Œæˆ–è€…è®­ç»ƒç®—æ³•ã€‚è¿™ä¸ªæ–¹æ³•å¯èƒ½ä¼šåˆ›å»ºå¿…è¦çš„æ•°æ®ç»“æ„ï¼Œè®¾ç½®å¥½æ•°æ®æµï¼Œä»¥åŠå‡†å¤‡ç¯å¢ƒæ¥æ‰§è¡Œç‰¹å®šçš„è®­ç»ƒæˆ–æµ‹è¯•å¾ªç¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">runner.setup(scheme=scheme, groups=groups, preprocess=preprocess, mac=mac)<br></code></pre></td></tr></table></figure>
<p><code>runner</code>å¯¹è±¡ä¸­æœ€å…³é”®çš„æ–¹æ³•æ˜¯ï¼š</p>
<p><code>runner.run(test_mode=False)</code>ï¼šåˆ©ç”¨å½“å‰æ™ºèƒ½ä½“<code>mac</code>åœ¨ç¯å¢ƒä¸­è¿è¡Œï¼ˆéœ€è¦ç”¨åˆ°<code>mac</code>å¯¹è±¡ï¼‰ï¼Œäº§ç”Ÿä¸€ä¸ªepisodeçš„æ ·æœ¬æ•°æ®<code>episode_batch</code>ï¼Œå­˜å‚¨åœ¨<code>runner.batch</code>ä¸­ã€‚</p>
<h3 id="bufferå­˜å‚¨å™¨">Bufferå­˜å‚¨å™¨</h3>
<p><code>buffer</code>å¯¹è±¡å±äºè‡ªå®šä¹‰çš„<code>components.episode_buffer.ReplayBuffer(EpisodeBatch)</code>ç±»ï¼Œè¯¥å¯¹è±¡çš„ä¸»è¦ä½œç”¨æ˜¯<strong>å­˜å‚¨æ ·æœ¬ä»¥åŠé‡‡æ ·æ ·æœ¬</strong>ã€‚<code>ReplayBuffer</code>çš„çˆ¶ç±»æ˜¯<code>EpisodeBatch</code>ã€‚<code>EpisodeBatch</code>ç±»å¯¹è±¡ç”¨äºå­˜å‚¨episodeçš„æ ·æœ¬ï¼Œ<code>ReplayBuffer(EpisodeBatch)</code>ç±»å¯¹è±¡åˆ™ç”¨äºå­˜å‚¨æ‰€æœ‰çš„off-policyæ ·æœ¬ï¼Œä¹Ÿå³<code>EpisodeBatch</code>ç±»å˜é‡çš„æ ·æœ¬ä¼šæŒç»­åœ°è¡¥å……åˆ°<code>ReplayBuffer(EpisodeBatch)</code>ç±»çš„å˜é‡ä¸­ã€‚åŒæ ·ç”±äºQMixç”¨çš„æ˜¯DRQNç»“æ„ï¼Œå› æ­¤<code>EpisodeBatch</code>ä¸<code>ReplayBuffer</code>ä¸­çš„æ ·æœ¬éƒ½æ˜¯ä»¥episodeä¸ºå•ä½å­˜å‚¨çš„ã€‚åœ¨<code>EpisodeBatch</code>ä¸­æ•°æ®çš„ç»´åº¦æ˜¯<code>[batch_size, max_seq_length, *shape]</code>ï¼Œ<code>ReplayBuffer</code>ç±»æ•°æ®çš„ç»´åº¦æ˜¯<code>[buffer_size, max_seq_length, *shape]</code>ã€‚<code>EpisodeBatch</code>ä¸­<code>Batch Size</code>è¡¨ç¤ºæ­¤æ—¶batchä¸­æœ‰å¤šå°‘episodeï¼Œ<code>ReplayBuffer</code>ä¸­<code>episodes_in_buffer</code>è¡¨ç¤ºæ­¤æ—¶bufferä¸­æœ‰å¤šå°‘ä¸ªepisodeçš„æœ‰æ•ˆæ ·æœ¬ã€‚<code>max_seq_length</code>åˆ™è¡¨ç¤ºä¸€ä¸ªepisodeçš„æœ€å¤§é•¿åº¦ã€‚</p>
<p><code>buffer</code>å¯¹è±¡ä¸­çš„å…³é”®æ–¹æ³•æœ‰ï¼š</p>
<ul>
<li><code>buffer.insert_episode_batch(ep_batch)</code>ï¼šå°†<code>EpisodeBatch</code>ç±»å˜é‡<code>ep_batch</code>ä¸­çš„æ ·æœ¬å…¨éƒ¨å­˜å‚¨åˆ°<code>buffer</code>ä¸­ã€‚</li>
<li><code>buffer.sample(batch_size)</code>ï¼šä»<code>buffer</code>ä¸­å–å‡º<code>batch_size</code>ä¸ªepisodeçš„æ ·æœ¬ç”¨äºè®­ç»ƒï¼Œè¿™äº›æ ·æœ¬ç»„æˆäº†<code>EpisodeBatch</code>ç±»çš„å¯¹è±¡</li>
</ul>
<h3 id="learnerå­¦ä¹ å™¨">Learnerå­¦ä¹ å™¨</h3>
<p>è‡ªå®šä¹‰çš„<code>leaners.q_learner.QLearner</code>ï¼ˆä¸å…·ä½“é€‰æ‹©å“ªä¸ªç®—æ³•æœ‰å…³ï¼‰ï¼Œè¯¥å¯¹è±¡çš„ä¸»è¦ä½œç”¨æ˜¯<strong>ä¾æ®ç‰¹å®šç®—æ³•å¯¹æ™ºèƒ½ä½“å‚æ•°è¿›è¡Œè®­ç»ƒæ›´æ–°</strong>ã€‚åœ¨QMixç®—æ³•ä¸­ï¼Œæœ‰<code>nn.module</code>ç±»çš„æ··åˆç½‘ç»œ<code>learner.mixer</code>ï¼Œå› æ­¤<code>learner</code>å¯¹è±¡éœ€è¦å­¦ä¹ çš„å‚æ•°åŒ…æ‹¬å„ä¸ªæ™ºèƒ½ä½“çš„å±€éƒ¨Qç½‘ç»œå‚æ•°<code>mac.parameters()</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Learner</span><br>    learner = le_REGISTRY[args.learner](mac, buffer.scheme, logger, args)<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­è¿™ä¸ª <code>[args.learner]</code>
å‚æ•°æ˜¯æ ¹æ®è°ƒç”¨å‘½ä»¤çš„æ—¶å€™ä¼ é€’çš„<code>config</code>çš„å‚æ•°æ–‡ä»¶<code>config.yml</code>ä¸­çš„å‚æ•°ï¼Œåœ¨å†…éƒ¨ä¼šä¸€å¹¶å°†å…¶å‚æ•°ç»Ÿä¸€æ”¶é›†ä½¿ç”¨</p>
<p><code>learner.train(batch: EpisodeBatch, t_env: int, episode_num: int)</code>ï¼š<code>batch</code>è¡¨ç¤ºå½“å‰ç”¨äºè®­ç»ƒçš„æ ·æœ¬ï¼Œ<code>t_env</code>è¡¨ç¤ºå½“å‰ç¯å¢ƒè¿è¡Œçš„æ€»æ—¶é—´æ­¥æ•°ï¼Œ<code>episode_num</code>è¡¨ç¤ºå½“å‰ç¯å¢ƒè¿è¡Œçš„æ€»episodeæ•°ï¼Œè¯¥æ–¹æ³•åˆ©ç”¨ç‰¹å®šç®—æ³•å¯¹<code>learner.params</code>è¿›è¡Œæ›´æ–°</p>
<h2 id="trainè¿‡ç¨‹">Trainè¿‡ç¨‹</h2>
<h3 id="æ”¶é›†buffer">æ”¶é›†buffer</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> th.no_grad():<br>            episode_batch = runner.run(test_mode=<span class="hljs-literal">False</span>)<br>            buffer.insert_episode_batch(episode_batch)<br></code></pre></td></tr></table></figure>
<p><code>with th.no_grad():</code>åœ¨å‰æœŸçš„æ“ä½œä¸­æˆ‘ä»¬åªéœ€è¦æ”¶é›†ç¯å¢ƒçš„äº¤äº’ä¿¡æ¯ï¼Œå› æ­¤æ­¤æ—¶ä¸éœ€è¦ç”¨åˆ°æ¢¯åº¦å’Œæ¨ç†</p>
<p><code>episode_batch = runner.run(test_mode=False)</code>
è¿™è¡Œä»£ç è°ƒç”¨äº†ä¸€ä¸ªåä¸º<code>runner</code>çš„å¯¹è±¡çš„æ–¹æ³•ã€‚è¿™ä¸ª<code>runner</code>å¯èƒ½æ˜¯ä¸€ä¸ªè´Ÿè´£æ‰§è¡Œç¯å¢ƒäº¤äº’å’Œæ”¶é›†ç»éªŒçš„æ¨¡å—ã€‚<code>test_mode=False</code>è¡¨æ˜è¿™ä¸ªè°ƒç”¨æ˜¯åœ¨è®­ç»ƒæ¨¡å¼ä¸‹è¿è¡Œçš„ï¼Œè€Œä¸æ˜¯æµ‹è¯•æ¨¡å¼åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ™ºèƒ½ä½“ï¼ˆagentï¼‰ä¼šæ ¹æ®ç­–ç•¥ï¼ˆpolicyï¼‰åœ¨ç¯å¢ƒä¸­é‡‡å–è¡ŒåŠ¨ï¼Œæ”¶é›†ä¸€ç³»åˆ—çš„å‰§é›†ï¼ˆepisodesï¼‰ï¼Œè¿™äº›å‰§é›†åŒ…å«äº†çŠ¶æ€ï¼ˆstatesï¼‰ã€åŠ¨ä½œï¼ˆactionsï¼‰ã€å¥–åŠ±ï¼ˆrewardsï¼‰ç­‰ä¿¡æ¯.</p>
<p><code>buffer.insert_episode_batch(episode_batch)</code>
è¿™è¡Œä»£ç å°†åˆšåˆšæ”¶é›†åˆ°çš„å‰§é›†æ‰¹æ¬¡ï¼ˆepisode_batchï¼‰æ’å…¥åˆ°ä¸€ä¸ªåä¸ºbufferçš„æ•°æ®ç»“æ„ä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">buffer.can_sample(args.batch_size)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥æ˜¯ç”¨æ¥åˆ¤æ–­å½“å‰çš„<code>buffer</code>çš„å®¹é‡æ˜¯å¦è¶…è¿‡äº†æ»¡è¶³é€‰æ‹©<code>batch_size</code>çš„å¤§å°ï¼Œå¦‚æœæ»¡è¶³çš„è¯é‚£ä¹ˆå°±å¯ä»¥åœ¨
<code>buffer</code> ä¸­å¼€å§‹é€‰æ‹©å¯¹åº”çš„å¤§å°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">episode_sample = buffer.sample(args.batch_size)<br></code></pre></td></tr></table></figure>
<p>ä¸Šè¿°çš„è¿‡ç¨‹æ˜¯å¯¹<code>buffer</code>ä¸­çš„å…ƒç´ å†…å®¹è¿›è¡Œé‡‡æ ·</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">max_ep_t = episode_sample.max_t_filled()<br>episode_sample = episode_sample[:, :max_ep_t]<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥æ˜¯åœ¨è¡¥å……æ—¶é—´æ­¥éª¤ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæ¯ä¸ªepisodeå¯èƒ½ä¼šæœ‰ä¸åŒé•¿åº¦ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ç”±äºæ—©åœæˆ–è¾¾åˆ°æŸä¸ªç»ˆæ­¢æ¡ä»¶è€Œé•¿åº¦ä¸ä¸€ã€‚</p>
<p>ç¬¬äºŒæ­¥æ˜¯åœ¨ä»å…¶ä¸­<code>sample</code>ä¹‹åçš„æ•°æ®å…ƒç´ è¿›è¡Œæˆªå–é€‰æ‹©çš„ç»“æœ</p>
<h3 id="train">Train</h3>
<p>å…·ä½“çš„å­¦ä¹ è¿‡ç¨‹å°±ä¼šæ‰”è¿›<code>learner</code> çš„å­¦ä¹ å™¨ä¸­è¿›è¡Œè®­ç»ƒå‚æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">learner.train(episode_sample, runner.t_env, episode)<br></code></pre></td></tr></table></figure>
<p>è°ƒç”¨å­¦ä¹ å™¨çš„<code>train</code>æ–¹æ³•æ¥å®é™…è¿›è¡Œè®­ç»ƒã€‚<code>episode_sample</code>æ˜¯ç”¨æ¥è®­ç»ƒçš„æ•°æ®ï¼Œ<code>runner.t_env</code>æ˜¯ç¯å¢ƒæ­¥æ•°ï¼ˆå¯èƒ½ç”¨äºè®°å½•æˆ–è€…è®¡ç®—æŠ˜æ‰£å› å­ç­‰ï¼‰ï¼Œ<code>episode</code>å¯èƒ½æ˜¯ä¸€ä¸ªè®¡æ•°å™¨æˆ–è€…è®°å½•å½“å‰æ˜¯ç¬¬å‡ ä¸ª<code>episode</code>çš„å˜é‡</p>
<p><strong>æ³¨æ„å¯¹äºä»·å€¼å‡½æ•°åˆ†è§£çš„æ–¹æ³•ä¼šé¢å¤–ç”¨åˆ°mixer</strong></p>
<p>ä¸ºäº†å…·ä½“åˆ†æ<code>learner</code>çš„è®­ç»ƒè¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿™é‡Œç»™å‡ºåŸºäº
<code>group</code>çš„å­¦ä¹ ä»£ç æ¥è¿›è¡Œåˆ†æ</p>
<ol type="1">
<li><p>é¦–å…ˆç¬¬ä¸€æ­¥æ˜¯è¿›è¡Œåˆå§‹åŒ–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, mac, scheme, logger, args</span>):<br>        self.args = args<br>        self.mac = mac<br>        self.target_mac = copy.deepcopy(mac)<br>        self.params = <span class="hljs-built_in">list</span>(self.mac.parameters())<br>        self.logger = logger<br>        self.device = th.device(<span class="hljs-string">&#x27;cuda&#x27;</span> <span class="hljs-keyword">if</span> args.use_cuda  <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;cpu&#x27;</span>)<br>        <span class="hljs-keyword">if</span> args.mixer == <span class="hljs-string">&quot;group&quot;</span>:<br>            self.mixer = GroupMixer(args)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">raise</span> <span class="hljs-string">&quot;mixer error&quot;</span><br>        self.target_mixer = copy.deepcopy(self.mixer)<br>        self.params += <span class="hljs-built_in">list</span>(self.mixer.parameters())<br>        <span class="hljs-comment">#å…¶ä¸­è¿™ä¸€æ­¥æ˜¯å°†æ¨¡å‹çš„å‚æ•°é‡çº§è¿›è¡Œè¾“å‡º</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Mixer Size: &#x27;</span>)<br>        <span class="hljs-built_in">print</span>(get_parameters_num(self.mixer.parameters()))<br>        <br>        <span class="hljs-keyword">if</span> self.args.optimizer == <span class="hljs-string">&#x27;adam&#x27;</span>:<br>            self.optimiser = Adam(params=self.params, lr=args.lr)<br>        <span class="hljs-keyword">else</span>:<br>            self.optimiser = RMSprop(params=self.params, lr=args.lr, alpha=args.optim_alpha, eps=args.optim_eps)<br>        self.last_target_update_episode = <span class="hljs-number">0</span><br>        self.log_stats_t = -self.args.learner_log_interval - <span class="hljs-number">1</span><br>        self.train_t = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œä¼šåˆå§‹åŒ–å®šä¹‰ä¸€äº›æ¯”å¦‚<code>mac/target mac</code>å’Œ<code>mixer/target mixer</code>çš„åˆå§‹åŒ–å‚æ•°å†…å®¹ï¼ŒåŒæ—¶å®šä¹‰ä¼˜åŒ–ç®—å­ï¼šAdam/RMSpropç­‰å†…å®¹</p></li>
<li><p>ä¼°è®¡æ‰€æœ‰æ™ºèƒ½ä½“çš„Qä»·å€¼å‡½æ•°å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">mac_out = []<br>mac_hidden = []<br>mac_group_state = []<br><br>self.mac.init_hidden(batch.batch_size)<br><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(batch.max_seq_length):<br>   agent_outs = self.mac.forward(batch, t=t)<br>   mac_hidden.append(self.mac.hidden_states)<br>   mac_group_state.append(self.mac.group_states)<br>   mac_out.append(agent_outs)<br><br>mac_out = th.stack(mac_out, dim=<span class="hljs-number">1</span>) <span class="hljs-comment">#å¾—åˆ°æ‰€æœ‰çš„æ™ºèƒ½ä½“çš„è¾“å‡ºå¹¶å †åœ¨ä¸€èµ·</span><br>mac_hidden = th.stack(mac_hidden, dim=<span class="hljs-number">1</span>)<br>mac_group_state = th.stack(mac_group_state, dim=<span class="hljs-number">1</span>)<br><br>mac_hidden = mac_hidden.detach() <span class="hljs-comment">#è¿™ä¸€æ­¥ç›¸å½“äºä»è®¡ç®—å›¾ä¸­å–æ¶ˆä¸è®¡ç®—æ¢¯åº¦</span><br></code></pre></td></tr></table></figure></li>
<li><p>å­¦ä¹ å¹¶å¾—åˆ°è”åˆçš„Qä»·å€¼å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Pick the Q-Values for the actions taken by each agent</span><br>chosen_action_qvals = th.gather(mac_out[:, :-<span class="hljs-number">1</span>], dim=<span class="hljs-number">3</span>, index=actions).squeeze(<span class="hljs-number">3</span>)<br><br> <span class="hljs-comment"># Mixer</span><br>chosen_action_qvals, w1_avg_list, sd_loss = self.mixer(chosen_action_qvals, batch[<span class="hljs-string">&quot;state&quot;</span>][:, :-<span class="hljs-number">1</span>], mac_hidden[:, :-<span class="hljs-number">1</span>], mac_group_state[:, :-<span class="hljs-number">1</span>], <span class="hljs-string">&quot;eval&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥ä¸­è°ƒç”¨<code>mixer</code>çš„å‡½æ•°æ¥å­¦ä¹ è”åˆçš„åŠ¨ä½œä»·å€¼å‡½æ•°</p></li>
<li><p>è®¡ç®—target Qçš„å€¼</p>
<p>æœ€å¼€å§‹çš„æ­¥éª¤å’ŒQå‡½æ•°çš„å¤„ç†è¿‡ç¨‹ä¸€æ ·æ¥å­¦ä¹ æ¯ä¸ªæ™ºèƒ½ä½“çš„ä»·å€¼å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> th.no_grad():<br>            target_mac_out = []<br>            target_mac_hidden = []<br>            target_mac_group_state = []<br><br>            self.target_mac.init_hidden(batch.batch_size)<br>            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(batch.max_seq_length):<br>                target_agent_outs = self.target_mac.forward(batch, t=t)<br>                target_mac_hidden.append(self.target_mac.hidden_states)<br>                target_mac_group_state.append(self.target_mac.group_states)<br>                target_mac_out.append(target_agent_outs)<br></code></pre></td></tr></table></figure>
<p>è®¡ç®—å¾—åˆ°ç›®æ ‡çš„è”åˆåŠ¨ä½œä»·å€¼å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Calculate n-step Q-Learning targets</span><br>target_max_qvals, _, _ = self.target_mixer(target_max_qvals, batch[<span class="hljs-string">&quot;state&quot;</span>], target_mac_hidden, target_mac_group_state, <span class="hljs-string">&quot;target&quot;</span>)<br></code></pre></td></tr></table></figure></li>
<li><p>è®¡ç®—TD target</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">targets = build_td_lambda_targets(rewards, terminated, mask, target_max_qvals, <br>                                            self.args.n_agents, self.args.gamma, self.args.td_lambda)<br></code></pre></td></tr></table></figure>
<p>ç›¸å½“äºè®¡ç®— <span class="math inline">\(r+\gamma
Q_{taregt}\)</span></p></li>
<li><p>è®¡ç®—TD error</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">td_error = (chosen_action_qvals - targets.detach())<br>td_error = <span class="hljs-number">0.5</span> * td_error.<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure></li>
<li><p>æ³¨æ„å¡«å……çš„éƒ¨åˆ†</p>
<ul>
<li><code>mask = mask.expand_as(td_error)</code>è¿™ä¸€è¡Œä»£ç ä¸­ï¼Œ<code>mask</code>å®ƒçš„å…ƒç´ ä¸º<code>True</code>çš„åœ°æ–¹è¡¨ç¤ºå¯¹åº”çš„åºåˆ—å…ƒç´ æ˜¯æœ‰æ•ˆçš„ï¼Œè€Œ<code>False</code>çš„åœ°æ–¹è¡¨ç¤ºå¯¹åº”çš„åºåˆ—å…ƒç´ æ˜¯å¡«å……çš„ï¼ˆæˆ–ä¸å­˜åœ¨çš„ï¼Œåœ¨åºåˆ—çš„å¼€å§‹éƒ¨åˆ†ï¼‰</li>
<li><code>expand_as</code>æ–¹æ³•ä¼šå°†<code>mask</code>å¼ é‡æ‰©å±•åˆ°ä¸<code>td_error</code>ç›¸åŒçš„å¤§å°ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†ä¿è¯åœ¨è®¡ç®—<code>masked_td_error</code>æ—¶ï¼Œ<code>mask</code>èƒ½å¤Ÿè¦†ç›–<code>td_error</code>çš„æ¯ä¸ªå…ƒç´ ã€‚</li>
<li><code>masked_td_error = td_error * mask</code>åœ¨è¿™ä¸€è¡Œä¸­ï¼Œç»“æœ<code>masked_td_error</code>åªæœ‰åœ¨maskä¸º<code>True</code>çš„ä½ç½®æ‰ä¼šæœ‰éé›¶å€¼ï¼Œè€Œåœ¨<code>mask</code>ä¸º<code>False</code>çš„ä½ç½®ï¼ˆå³å¡«å……çš„éƒ¨åˆ†ï¼‰å°†ä¼šæ˜¯é›¶ã€‚</li>
<li><code>td_loss = masked_td_error.sum() / mask.sum()</code>æœ€åä¸€è¡Œä»£ç è®¡ç®—äº†<code>masked_td_error</code>çš„æ€»å’Œï¼Œç„¶åé™¤ä»¥<code>mask</code>çš„æ€»å’Œï¼Œè¿™æ ·å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ ‡é‡æŸå¤±å€¼ï¼Œè¿™ä¸ªå€¼åªåŒ…å«äº†æœ‰æ•ˆåºåˆ—å…ƒç´ çš„è´¡çŒ®ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†åœ¨è®¡ç®—æŸå¤±æ—¶å¿½ç•¥å¡«å……çš„éƒ¨åˆ†ï¼Œå› ä¸ºè¿™äº›éƒ¨åˆ†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸åº”è¯¥å½±å“æ¨¡å‹çš„å­¦ä¹ .</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">mask</span> = mask.expand_as(td_error)<br><span class="hljs-attr">masked_td_error</span> = td_error * mask<br><span class="hljs-attr">td_loss</span> = masked_td_error.sum() / mask.sum()<br></code></pre></td></tr></table></figure></li>
<li><p>æœ€åçš„ä¼˜åŒ–ç®—å­çš„éƒ¨åˆ†åå‘ä¼ æ’­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">self.optimiser.zero_grad()<br>loss.backward()<br>grad_norm = th.nn.utils.clip_grad_norm_(self.params, self.args.grad_norm_clip)<br>self.optimiser.step()<br></code></pre></td></tr></table></figure></li>
<li><p>æŒ‰ç…§ä¸€å®šçš„æ—¶é—´æ­¥é•¿æ›´æ–°ç›®æ ‡ç½‘ç»œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> (episode_num - self.last_target_update_episode) / self.args.target_update_interval &gt;= <span class="hljs-number">1.0</span>:<br>     self._update_targets()<br>     self.last_target_update_episode = episode_num<br></code></pre></td></tr></table></figure>
<p>æ ¹æ®éœ€è¦å¯ä»¥é€‰æ‹©æ‰“å°å‡ºlog</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> t_env - self.log_stats_t &gt;= self.args.learner_log_interval:<br>            self.logger.log_stat(<span class="hljs-string">&quot;loss_td&quot;</span>, td_loss.item(), t_env)<br>            self.logger.log_stat(<span class="hljs-string">&quot;grad_norm&quot;</span>, grad_norm, t_env)<br>            mask_elems = mask.<span class="hljs-built_in">sum</span>().item()<br>            self.logger.log_stat(<span class="hljs-string">&quot;td_error_abs&quot;</span>, (masked_td_error.<span class="hljs-built_in">abs</span>().<span class="hljs-built_in">sum</span>().item()/mask_elems), t_env)<br>            self.logger.log_stat(<span class="hljs-string">&quot;q_taken_mean&quot;</span>, (chosen_action_qvals * mask).<span class="hljs-built_in">sum</span>().item()/(mask_elems * self.args.n_agents), t_env)<br>            self.logger.log_stat(<span class="hljs-string">&quot;target_mean&quot;</span>, (targets * mask).<span class="hljs-built_in">sum</span>().item()/(mask_elems * self.args.n_agents), t_env)<br>            self.logger.log_stat(<span class="hljs-string">&quot;total_loss&quot;</span>, loss.item(), t_env)<br>            self.logger.log_stat(<span class="hljs-string">&quot;lasso_loss&quot;</span>, lasso_loss.item(), t_env)<br>            self.logger.log_stat(<span class="hljs-string">&quot;sd_loss&quot;</span>, sd_loss.item(), t_env)          <br>            self.log_stats_t = t_env<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="test">Test</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n_test_runs):<br>                runner.run(test_mode=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™ä¸ªåœ°æ–¹å°±æ˜¯å¯¹ç®—æ³•è¿›è¡Œæµ‹è¯•äº†</p>
]]></content>
      <categories>
        <category>å¼ºåŒ–å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>å¼ºåŒ–å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ã€‘Pymarlç¯å¢ƒé…ç½®</title>
    <url>/2023/10/22/pymarl%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<p>SMACæ˜¯åŸºäºæš´é›ªæ˜Ÿé™…äº‰éœ¸II
RTSæ¸¸æˆçš„åä½œå¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ é¢†åŸŸçš„ç ”ç©¶ç¯å¢ƒã€‚SMACåˆ©ç”¨æ˜Ÿé™…äº‰éœ¸2æœºå™¨å­¦ä¹ APIå’ŒDeepMindçš„PySC2ä¸ºè‡ªä¸»ä»£ç†æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ¥å£ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»åœ¨å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ä¸­çš„éªŒè¯å¹³å°SAMCå’ŒPymarlçš„é…ç½®å’Œå®‰è£…è¿‡ç¨‹</p>
<p>ç¯å¢ƒåœ°å€ï¼š<a
href="https://github.com/oxwhirl/pymarl">https://github.com/oxwhirl/pymarl</a></p>
<p>ä¾èµ–ç¯å¢ƒï¼š<a
href="https://github.com/oxwhirl/smac">https://github.com/oxwhirl/smac</a></p>
<p>ä¸»è¦é’ˆå¯¹Ubuntuä¸‹çš„Pymarlç¯å¢ƒçš„é…ç½®ï¼ˆMACå’ŒWindowsç±»ä¼¼ï¼‰</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231022145734342.png"
alt="SMAC" />
<figcaption aria-hidden="true">SMAC</figcaption>
</figure>
<h2 id="å®‰è£…starcraftii">å®‰è£…StarCraftII</h2>
<h3 id="windowsmac">Windows/Mac</h3>
<p>ç›´æ¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£…æœ€æ–°ç‰ˆï¼Œéœ€è¦åŠ é€Ÿå™¨æˆ–è€…æ›´æ¢äºšæœï¼š<a
href="https://sc2.blizzard.cn/landing">https://sc2.blizzard.cn/landing</a></p>
<p>å®‰è£…åœ°å›¾ï¼š<a
href="https://link.zhihu.com/?target=https%3A//github.com/oxwhirl/smac/releases/download/v0.1-beta1/SMAC_Maps.zip">https://link.zhihu.com/?target=https%3A//github.com/oxwhirl/smac/releases/download/v0.1-beta1/SMAC_Maps.zip</a></p>
<p>å°†åœ°å›¾æ”¾åœ¨Mapsæ–‡ä»¶å¤¹ä¸‹</p>
<h3 id="ubuntu">Ubuntu</h3>
<p>åœ¨Ubuntuç³»ç»Ÿä¸­ï¼Œå®‰è£…éœ€è¦ç‰ˆæœ¬çš„SCIIå³å¯<a
href="https://github.com/Blizzard/s2client-proto#downloads">https://github.com/Blizzard/s2client-proto#downloads</a></p>
<p>ä¸‹è½½å‹ç¼©åŒ…ä¹‹åå®‰è£…å¹¶è§£å‹æ”¾åˆ°ç”¨æˆ·åæ–‡ä»¶å¤¹ä¸‹ï¼šï½/StarCraftII/</p>
<p>å¦‚æœæ²¡æœ‰æŠŠSCIIå®‰è£…åˆ°ç”¨æˆ·åä¹‹ä¸‹ï¼Œè¿™ä¸ªåœ°æ–¹çš„è·¯å¾„å¯ä»¥æ ¹æ®æ”¾ç½®çš„ä½ç½®æ¥è¿›è¡Œæ›´æ”¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">vim ~/.bashrc<br></code></pre></td></tr></table></figure>
<p>åœ¨æœ€åä¸€è¡Œå¢åŠ ç¯å¢ƒå˜é‡ï¼Œè¿™é‡Œå¯ä»¥æ›´æ”¹æ˜Ÿé™…äº‰éœ¸çš„ä½ç½®ç´¢å¼•åˆ°ä»»ä½•æƒ³è¦æ”¾ç½®çš„ä½ç½®</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">SC2PATH</span>=~/StarCraftII/<br></code></pre></td></tr></table></figure>
<p>æ·»åŠ å®Œä¹‹åæ›´æ–°ç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.bashrc<br></code></pre></td></tr></table></figure>
<p>æ·»åŠ SAMCçš„åœ°å›¾ï¼šLinuxç³»ç»Ÿåœ¨ä¸‹è½½SCIIçš„æ—¶å€™å°±è‡ªå¸¦äº†åœ°å›¾</p>
<h2 id="å®‰è£…smac">å®‰è£…SMAC</h2>
<p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…pytorch</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">conda create -n pymarl python=<span class="hljs-number">3.8</span> -y<br>conda activate pymarl   <br><span class="hljs-comment"># CUDA 10.2 ä¾‹å­å…·ä½“çš„çš„CUDAç‰ˆæœ¬æ ¹æ®è‡ªå·±çš„æœåŠ¡å™¨æ¥å®š</span><br>conda install pytorch==<span class="hljs-number">1.10</span><span class="hljs-number">.0</span> torchvision==<span class="hljs-number">0.11</span><span class="hljs-number">.0</span> torchaudio==<span class="hljs-number">0.10</span><span class="hljs-number">.0</span> cudatoolkit=<span class="hljs-number">10.2</span> -c pytorch<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥åˆ©ç”¨è™šæ‹Ÿç¯å¢ƒä¸­çš„pipæ¥å®‰è£…</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">pip install git+https://github.com/oxwhirl/smac.git<br></code></pre></td></tr></table></figure>
<p>æˆ–è€…å¯ä»¥åˆ©ç”¨gitè¿›è¡Œå®‰è£…ï¼Œå…ˆgit
cloneä¸‹è½½ä¸‹æ¥ç„¶åè¿›å…¥æ–‡ä»¶å¤¹ä¸­è¿›è¡Œå®‰è£…</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">git clone https://github.com/oxwhirl/smac.git<br>pip install -e smac/<br></code></pre></td></tr></table></figure>
<p>å¦‚æœpip installå®‰è£…å¤±è´¥å¯ä»¥è€ƒè™‘å‡çº§pipï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">pip install --upgrade pip<br></code></pre></td></tr></table></figure>
<p>å¦‚æœå®‰è£…çš„å†…å®¹å¤±è´¥äº†å¯ä»¥æ‰‹åŠ¨å®‰è£…ï¼Œæ¯”å¦‚pymarlè¿è¡Œæ‰€ä¾èµ–çš„åŒ…æœ‰ä»¥ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">pip install sacred numpy scipy matplotlib seaborn pyyaml pygame pytest probscale imageio snakeviz tensorboard-logger<br><br></code></pre></td></tr></table></figure>
<p>æˆ–è€…æ ¹æ®<a
href="https://github.com/oxwhirl/pymarl/tree/master/docker">https://github.com/oxwhirl/pymarl/tree/master/docker</a>ä¸­çš„bashè„šæœ¬ä¸­Dockerfileä¾èµ–å†…å®¹è¿›è¡Œå®‰è£…</p>
<h2 id="pymarlä¸scii">Pymarlä¸SCII</h2>
<h3 id="é‡‡ç”¨ä¸Šè¿°å®‰è£…æ­¥éª¤">é‡‡ç”¨ä¸Šè¿°å®‰è£…æ­¥éª¤</h3>
<p>å¯¹äºä¸Šè¿°çš„æ“ä½œå®Œæˆæ“ä½œä¹‹åï¼Œä¸‹è½½pymarlçš„ç¯å¢ƒåŒ…å¹¶è¿›å…¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">git clone git@github.com:oxwhirl/pymarl.git<br>cd pymarl<br></code></pre></td></tr></table></figure>
<p>å°†ä¸Šè¿°å®‰è£…çš„SCIIæ–‡ä»¶å¤¹å¤åˆ¶åˆ°pymarlçš„srcçš„3dpartyä¹‹ä¸‹</p>
<h3 id="å¦‚æœåˆ©ç”¨dockerå®‰è£…">å¦‚æœåˆ©ç”¨Dockerå®‰è£…</h3>
<p>æˆ–è€…æ ¹æ®pymarlä¸­çš„å†…å®¹å¯¹ä¸Šè¿°ç¯å¢ƒè¿›è¡Œè‡ªåŠ¨é…ç½®ï¼ˆéœ€è¦Dockerï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> docker<br>bash build.sh<br></code></pre></td></tr></table></figure>
<p>åŒæ—¶å®‰è£…SCIIå’ŒSMAC</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">bash install_sc2.sh<br></code></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•ç¯å¢ƒ">æµ‹è¯•ç¯å¢ƒ</h2>
<h3 id="æµ‹è¯•åœ°å›¾ä¿¡æ¯">æµ‹è¯•åœ°å›¾ä¿¡æ¯</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">python -m smac.<span class="hljs-built_in">bin</span>.map_list <br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231022153907123.png" alt="Maps show" style="zoom:67%;" /></p>
<h3 id="æµ‹è¯•ç¯å¢ƒä¿¡æ¯">æµ‹è¯•ç¯å¢ƒä¿¡æ¯</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">python -m smac.examples.random_agents<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231022153709693.png" alt="test agents" style="zoom: 50%;" /></p>
<h3 id="æµ‹è¯•pymarlç¯å¢ƒ">æµ‹è¯•Pymarlç¯å¢ƒ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">python src/main.py --config=qmix --env-config=sc2 <span class="hljs-keyword">with</span> env_args.map_name=2s3z<br></code></pre></td></tr></table></figure>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231022153651418.png"
alt="test pymarl" />
<figcaption aria-hidden="true">test pymarl</figcaption>
</figure>
<h2 id="ä¾èµ–åŒ…çš„ç‰ˆæœ¬é—®é¢˜">ä¾èµ–åŒ…çš„ç‰ˆæœ¬é—®é¢˜</h2>
<p>å½“è¿è¡Œpymarlçš„æ—¶å€™å®¹æ˜“å› ä¸ºä¾èµ–åŒ…äº§ç”Ÿé—®é¢˜</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240104210308852.png"
alt="image-20240104210308852" />
<figcaption aria-hidden="true">image-20240104210308852</figcaption>
</figure>
<p>åŸå› æ˜¯
<code>sacred</code>ç‰ˆæœ¬ä¸å¯¹åŠ²ï¼Œåªéœ€è¦å°†ç‰ˆæœ¬é™ä½åˆ°0.7.5è¿™ä¸ªé—®é¢˜å°±èƒ½è§£å†³</p>
<h2 id="é¢å¤–è®¾ç½®">é¢å¤–è®¾ç½®</h2>
<p>åœ¨åˆ©ç”¨pymarlè¿›è¡Œå®éªŒçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20231022154059365.png"
alt="some bug" />
<figcaption aria-hidden="true">some bug</figcaption>
</figure>
<p>éœ€è¦è¿›è¡Œè®¾ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">vim torch/_tensor.py<br></code></pre></td></tr></table></figure>
<p>å°†757è¡Œçš„å†…å®¹è¿›è¡Œä¿®æ”¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">-: self.numpy()<br>+: self.cpu().numpy()<br></code></pre></td></tr></table></figure>
<h2 id="è°·æ­Œè¶³çƒç¯å¢ƒ">è°·æ­Œè¶³çƒç¯å¢ƒ</h2>
<p>Google Research
Footballï¼šhttps://github.com/google-research/football</p>
<h4 id="å®‰è£…linuxä¾èµ–ç¯å¢ƒ">å®‰è£…Linuxä¾èµ–ç¯å¢ƒ</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo apt-get install git cmake build-essential libgl1-mesa-dev libsdl2-dev \<br>libsdl2-image-dev libsdl2-ttf-dev libsdl2-gfx-dev libboost-all-dev \<br>libdirectfb-dev libst-dev mesa-utils xvfb x11vnc python3-pip<br><br>python3 -m pip install --upgrade pip setuptools psutil wheel<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥éå¸¸é‡è¦ï¼Œå¿…é¡»åˆç†å®‰è£…ç›¸åº”çš„åŒ…ã€‚</p>
<h4 id="å®‰è£…gfootball">å®‰è£…GFootball</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">python3 -m pip install gfootball<br></code></pre></td></tr></table></figure>
<p>æˆ–è€…ç”¨githubçš„ä»“åº“æ¥è¿›è¡Œå®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/google-research/football.git<br><span class="hljs-built_in">cd</span> football<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥é€‰æ‹©ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">python3 -m venv football-env<br><span class="hljs-built_in">source</span> football-env/bin/activate<br></code></pre></td></tr></table></figure>
<p>å®‰è£…ä¾èµ–åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">python3 -m pip install .<br></code></pre></td></tr></table></figure>
<h4 id="è¿è¡Œç»“æœå±•ç¤º">è¿è¡Œç»“æœå±•ç¤ºï¼š</h4>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240106145437351.png" alt="è°·æ­Œè¶³çƒç»“æœå±•ç¤º" style="zoom:50%;" /></p>
<h4 id="é‡åˆ°çš„é—®é¢˜">é‡åˆ°çš„é—®é¢˜</h4>
<p>ç¼–è¯‘é”™è¯¯ï¼Œç¼ºå°‘boostçš„åŒ…ï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240106145036965.png"
alt="ç¼–è¯‘é”™è¯¯" />
<figcaption aria-hidden="true">ç¼–è¯‘é”™è¯¯</figcaption>
</figure>
<p>é€‰æ‹©å®‰è£…å¦‚ä¸‹åŒ…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda install anaconda::py-boost<br></code></pre></td></tr></table></figure>
<p>ç¬¬äºŒä¸ªé”™è¯¯ï¼š</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240106145218372.png" alt="é”™è¯¯äºŒ" style="zoom:67%;" /></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libffi.so.7<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å¼ºåŒ–å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>å¼ºåŒ–å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ·±åº¦å­¦ä¹ ã€‘PyTorchä½¿ç”¨æ‰‹å†Œ</title>
    <url>/2023/10/22/pytorch/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»pytorchä¸­çš„åŸºæœ¬ä½¿ç”¨ï¼ŒåŒ…æ‹¬å¦‚ä½•å¯¼å…¥æ•°æ®é›†ï¼Œå¦‚ä½•æ­å»ºå¹¶è®­ç»ƒç½‘ç»œä»¥åŠå¯è§†åŒ–çš„å†…å®¹ï¼ŒåŸºæœ¬æ¶µç›–äº†æ·±åº¦å­¦ä¹ ä¸­ç»å…¸ç®—æ³•çš„ä½¿ç”¨ä»¥åŠç›¸å…³çš„ä¾‹å­</p>
<h2 id="basics">Basics</h2>
<h3 id="è®¡ç®—æ¢¯åº¦ä¾‹å­">è®¡ç®—æ¢¯åº¦ä¾‹å­</h3>
<p>å¼•å…¥åŸºæœ¬éœ€è¦ç”¨åˆ°çš„åŒ…ï¼Œæ·±åº¦å­¦ä¹ ä¸­torchå¤„ç†å¤§éƒ¨åˆ†å¼ é‡çš„è¿ç®—ï¼Œè€Œtorch.nnåˆ™æ˜¯å¯¹torchçš„ç½‘ç»œä¸­çš„ä¸€äº›è¿ç®—ï¼Œè¿™äº›éƒ½æ˜¯å¿…é¡»ç”¨åˆ°çš„åŒ…ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch <br><span class="hljs-keyword">import</span> torchvision<br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms<br></code></pre></td></tr></table></figure>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨å¼ é‡è¿›è¡Œè¿ç®—ï¼Œæ­¤æ—¶ä¼šæ¶‰åŠåˆ°è®¡ç®—å¼ é‡çš„æ¢¯åº¦ç­‰é—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œç»™å‡ºä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨å¼ é‡æ¥è¿›è¡Œæ¢¯åº¦è®¡ç®—ï¼š</p>
<p>åˆå§‹åŒ–å®šä¹‰å¼ é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">x = torch.tensor(<span class="hljs-number">1.</span>, requires_grad=<span class="hljs-literal">True</span>)<br>w = torch.tensor(<span class="hljs-number">2.</span>, requires_grad=<span class="hljs-literal">True</span>)<br>b = torch.tensor(<span class="hljs-number">3.</span>, requires_grad=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>å»ºç«‹<strong>è®¡ç®—å›¾ computational graph</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">y = w * x + b    <span class="hljs-comment"># y = 2 * x + 3</span><br></code></pre></td></tr></table></figure>
<p>è®¡ç®—æ¢¯åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">y.backward()<br><span class="hljs-built_in">print</span>(x.grad)    <span class="hljs-comment"># x.grad = 2 </span><br><span class="hljs-built_in">print</span>(w.grad)    <span class="hljs-comment"># w.grad = 1 </span><br><span class="hljs-built_in">print</span>(b.grad)    <span class="hljs-comment"># b.grad = 1 </span><br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ·±åº¦å­¦ä¹ ã€‘æ¨èç³»ç»Ÿ</title>
    <url>/2024/01/16/rec/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="æ¨èç³»ç»Ÿå­¦ä¹ èµ„æ–™">æ¨èç³»ç»Ÿå­¦ä¹ èµ„æ–™</h1>
<ul>
<li><a
href="https://zhuanlan.zhihu.com/p/407871839">ä»é›¶å•æ’æ¨èç³»ç»Ÿæ–‡ç« æ±‡æ€»ç›®å½•</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/119248677">æ·±åº¦æ¨èç³»ç»Ÿ
ç‹å–†</a></li>
<li><a
href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;__biz=MzI5NTU2ODQzMg==&amp;scene=1&amp;album_id=2893245558629466114&amp;count=3#wechat_redirect">æ¨èç³»ç»Ÿç®—æ³•å®æˆ˜è¯¾ç¨‹</a></li>
</ul>
<h1 id="æ¨èç³»ç»Ÿç®€ä»‹">æ¨èç³»ç»Ÿç®€ä»‹</h1>
<p>æœç´¢å¼“|æ“éœ€è¦ç”¨æˆ·ä¸»åŠ¨è¾“å…¥è‡ªå·±çš„æ„å›¾ï¼Œæœ‰æ—¶å€™ï¼Œç”¨æˆ·å¹¶ä¸çŸ¥é“è‡ªå·±éœ€è¦ä»€ä¹ˆï¼Œæœ‰äº›éœ€æ±‚ã€æ„æ„¿ï¼Œæ˜¯ç”¨æˆ·è‡ªå·±éƒ½æ„è¯†ä¸åˆ°çš„ã€‚å› ä¸ºç”¨æˆ·æä¸å‡ºéœ€æ±‚ï¼Œå°±"æ— æ‰€äº‹äº‹"ï¼Œæ˜¾ç„¶è¿™æ˜¯å¯¹å®è´µæµé‡çš„å·¨å¤§æµªè´¹ï¼Œä¸åˆ©äºå»ºç«‹ç”¨æˆ·ç²˜æ€§ã€‚å°†è‡ªå·±æ‹¥æœ‰çš„ã€ç”¨æˆ·å¯èƒ½å–œæ¬¢çš„å†…å®¹ä¸»åŠ¨å±•ç¤ºç»™ç”¨æˆ·ï¼Œä»è€Œç•™ä½ç”¨æˆ·èŠ±è´¹æ›´å¤šçš„æ—¶é—´ä¸é‡‘é’±ã€‚è¿™å°±æ˜¯<strong>æ¨èç³»ç»Ÿ</strong>ã€‚</p>
<p>å­¦ä¹ æ¨èç³»ç»Ÿç®—æ³•éœ€è¦æ³¨æ„ä»¥ä¸‹çš„å…³é”®è¦ç‚¹ï¼š</p>
<ul>
<li>è®°å¿†æ€§ä¸æ‹“å±•æ€§</li>
<li>æ¨èç³»ç»Ÿçš„é«˜ç»´ç¨€ç–çš„ç±»åˆ«ç‰¹å¾</li>
<li>ç‰¹å¾çš„Embedding</li>
<li>ç‰¹å¾çš„äº¤å‰ç»“æ„</li>
</ul>
<h2 id="æ¨èç³»ç»Ÿçš„ä¾‹å­">æ¨èç³»ç»Ÿçš„ä¾‹å­</h2>
<p>å‡è®¾ä¸€ä¸ªæç®€ç‰ˆçš„æ¨èç³»ç»Ÿä¸­ï¼Œä¹Ÿæœ‰ä¸¤ç±»è§’è‰²:ç”¨æˆ·å’Œç‰©æ–™ã€‚</p>
<ul>
<li>ç”¨æˆ·(User)
å°±æ˜¯æ¨èç³»ç»Ÿè¦æœåŠ¡çš„å¯¹è±¡ã€‚ç”¨æˆ·ä¹Ÿæ˜¯æ¨èç³»ç»Ÿçš„é‡è¦è´¡çŒ®è€…ã€‚ç”¨æˆ·é€šè¿‡"å¤§æ‹‡æŒ‡æŠ•ç¥¨"
å¸®æ¨èç³»ç»Ÿåˆ†è¾¨å‡ºå†…å®¹ã€ä¿¡æ¯çš„çœŸå‡ä¼˜åŠ£ã€‚</li>
<li>ç‰©æ–™(Item)ï¼Œç”¨äºç»Ÿç§°è¦æ¨èå‡ºå»çš„ä¿¡æ¯ã€å†…å®¹ã€‚ä¸åŒåœºæ™¯ä¸‹ï¼Œç‰©æ–™ä¼šæœ‰ä¸åŒçš„å†…æ¶µ:ç”µå•†æ¨èä¸­,ç‰©æ–™å°±æ˜¯å•†å“ï¼›å†…å®¹æ¨èä¸­ï¼Œç‰©æ–™å°±æ˜¯ä¸€ç¯‡æ–‡ç« ã€ä¸€é¦–æ­Œï¼›ç¤¾äº¤æ¨èä¸­ï¼Œç‰©æ–™å°±æ˜¯å¦ä¸€ä¸ªäººã€‚</li>
</ul>
<p>å»ºç«‹æ¨èç³»ç»Ÿçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li>ç¬¬ä¸€æ­¥æ˜¯<strong>ç»™ç‰©æ–™æ‰“æ ‡ç­¾</strong>ã€‚æ¯”å¦‚å¯¹ä¸€ä¸ªè§†é¢‘ã€Šè±†ç“£è¯„åˆ†9.3ï¼Œæœ€ææ€–çš„å–œå‰§ç”µå½±ï¼šæ¥šé—¨çš„ä¸–ç•Œã€‹ï¼Œæˆ‘ä»¬ç»™å®ƒæ‰“ä¸Š"ç”µå½±ã€å–œå‰§ã€çœŸäººç§€ã€é‡‘å‡¯ç‘'è¿™æ ·çš„æ ‡ç­¾ã€‚</li>
<li>ç¬¬äºŒæ­¥ï¼Œå»ºç«‹<strong>å€’æ’ç´¢å¼•</strong>ï¼Œå°†æ‰€æœ‰ç‰©æ–™ç»„ç»‡èµ·æ¥ï¼Œå€’æ’ç´¢å¼•ç±»ä¼¼ä¸€ä¸ªHashMap,
é”®æ˜¯æ ‡ç­¾ï¼Œå€¼æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«ç€è¢«æ‰“ä¸Šè¿™ä¸ªæ ‡ç­¾çš„æ‰€æœ‰è§†é¢‘ã€‚</li>
<li>ç¬¬ä¸‰æ­¥ï¼Œæ¨èç³»ç»Ÿæ¥åˆ°ä¸€ä¸ªç”¨æˆ·çš„æ¨èè¯·æ±‚ã€‚æ¨èç³»ç»Ÿæ ¹æ®ä»è¯·æ±‚ä¸­æå–å‡ºæ¥çš„ç”¨æˆ·IDï¼Œä»<strong>æ•°æ®åº“ä¸­æ£€ç´¢</strong>å‡ºè¯¥ç”¨æˆ·çš„å…´è¶£çˆ±å¥½ã€‚å‡è®¾è¯¥ç”¨æˆ·è¿‡å»çœ‹è¿‡10ä¸ªè§†é¢‘ï¼Œå…¶ä¸­7ä¸ªå¸¦æœ‰"å–œå‰§"çš„æ ‡ç­¾ï¼Œ3ä¸ªå¸¦æœ‰"è¶³çƒ"çš„æ ‡ç­¾ï¼Œåˆ™æå–å‡ºæ¥çš„è¯¥ç”¨æˆ·çš„å…´è¶£çˆ±å¥½å°±æ˜¯{"å–œå‰§":
0.7, "è¶³çƒ": 0.3}ï¼Œ
å…¶ä¸­é”®è¡¨ç¤ºç”¨æˆ·æ„Ÿå…´è¶£çš„æ ‡ç­¾ï¼Œåé¢çš„æ•°å­—è¡¨ç¤ºç”¨æˆ·å¯¹è¿™ä¸ªæ ‡ç­¾çš„å–œå¥½ç¨‹åº¦ã€‚</li>
<li>ç¬¬å››æ­¥ï¼Œ<strong>å¬å›</strong>ï¼Œæ‹¿ç”¨æˆ·æ„Ÿå…´è¶£çš„æ¯ä¸ªæ ‡ç­¾å»<strong>å€’æ’ç´¢å¼•ä¸­æ£€ç´¢</strong>ã€‚å‡è®¾"å–œå‰§"è¿™ä¸ªæ ‡ç­¾å¯¹åº”çš„å€’æ’é“¾ä¸­åŒ…å«Aã€Bä¸¤ä¸ªè§†é¢‘ï¼Œ"è¶³çƒ"æ ‡ç­¾å¯¹åº”çš„å€’æ’é“¾ä¸­åŒ…å«Cã€Dã€
Eä¸¤ä¸ªè§†é¢‘ã€‚æ±‡æ€»èµ·æ¥ï¼Œæ¨èç³»ç»Ÿä¸ºè¯¥ç”¨æˆ·æ‰¾åˆ°äº†5ä¸ªä»–å¯èƒ½æ„Ÿå…´è¶£çš„è§†é¢‘ã€‚è¿™ä¸ªè¿‡ç¨‹å«ä½œ"å¬å›"
(Retrieval) ï¼ŒæŸ¥å¯»å€’æ’ç´¢å¼•åªæ˜¯å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼ã€‚</li>
<li>ç¬¬äº”æ­¥ï¼Œæ¨èç³»ç»Ÿä¼šçŒœæµ‹ç”¨æˆ·å¯¹è¿™5ä¸ªè§†é¢‘çš„å–œçˆ±ç¨‹åº¦ï¼Œå†æŒ‰ç…§å–œçˆ±ç¨‹åº¦é™åºæ’åˆ—ï¼Œå°†ç”¨æˆ·æœ€å¯èƒ½å–œæ¬¢çš„è§†é¢‘æ’åœ¨æœ€æ˜¾çœ¼çš„ç¬¬ä¸€ä½,
è®©ç”¨æˆ·ä¸€çœ¼å°±èƒ½çœ‹åˆ°ã€‚è¿™ä¸ªè¿‡ç¨‹å«ä½œ<strong>"æ’åº" (Ranking)</strong>
ã€‚è‡³äºå¦‚ä½•çŒœæµ‹ç”¨æˆ·çš„å–œçˆ±ç¨‹åº¦ï¼Œåœ¨è¿™ä¸ªæç®€ç‰ˆçš„æ¨èç³»ç»Ÿä¸­ï¼Œè¿™é‡Œåªä½¿ç”¨ä¸€ä¸ªç®€å•çš„è¯„ä»·è§„åˆ™ï¼š<span
class="math display">\[Score(u,g,v)=Like(u,g)\times Q(v)\]</span>
<ol type="1">
<li>uè¡¨ç¤ºå‘å‡ºè¯·æ±‚çš„ç”¨æˆ·</li>
<li>gè¡¨ç¤ºç”¨æˆ·uå–œæ¬¢çš„ä¸€ä¸ªæ ‡ç­¾</li>
<li>vè¡¨ç¤ºï¼Œåœ¨ç¬¬å››æ­¥ä¸­ï¼Œæ ¹æ®æ ‡ç­¾gä»å€’æ’ç´¢å¼•ä¸­æå–å‡ºæ¥çš„ä¸€ä¸ªè§†é¢‘</li>
<li>Like(u,g)è¡¨ç¤ºç”¨æˆ·uå¯¹æ ‡ç­¾gçš„å–œçˆ±ç¨‹åº¦ã€‚æ¯”å¦‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒLike(u,"å–œ
å‰§")=0.7</li>
<li>Q(v)è¡¨ç¤ºè§†é¢‘vçš„è´¨é‡ã€‚å¯ä»¥ç”±vçš„å„ç§åéªŒæ¶ˆè´¹æŒ‡æ ‡æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚å¯ä»¥ç”¨ç‚¹å‡»ç‡(CTR)
æ¥è¡¨ç¤º</li>
<li>Score(u, g, v)è¡¨ç¤ºæ¨èç³»ç»ŸçŒœæµ‹çš„ç”¨æˆ·uå¯¹è§†é¢‘vçš„å–œçˆ±ç¨‹åº¦ã€‚</li>
</ol></li>
<li>ç¬¬å…­æ­¥æ¨èç³»ç»Ÿå¯¹æ’åºç»“æœè¿›è¡Œæˆªæ–­ï¼Œåªä¿ç•™å‰4ä¸ªè§†é¢‘ï¼Œè¿”å›ç»™ç”¨æˆ·ã€‚</li>
<li>ç¬¬ä¸ƒæ­¥ï¼Œç”¨æˆ·æŒ‰ç…§[B, C,
A,D]çš„é¡ºåºçœ‹åˆ°äº†4ä¸ªè§†é¢‘ï¼Œç‚¹å‡»å¹¶è§‚çœ‹äº†è§†é¢‘Bã€‚ç”¨æˆ·è¡Œä¸ºï¼Œå³"ç”¨æˆ·uç‚¹
å‡»è§†é¢‘B, A/C/Dæ›å…‰æœªç‚¹å‡»"ï¼Œè¢«è®°å½•è¿›æ—¥å¿—ï¼Œå‘é€ç»™æ¨èç³»ç»Ÿã€‚</li>
<li>ç¬¬å…«æ­¥ï¼Œæ¨èç³»ç»Ÿæ¥æ”¶åˆ°äº†ç”¨æˆ·åé¦ˆï¼Œå¹¶æ®æ­¤æ›´æ–°ç”¨æˆ·çš„å…´è¶£çˆ±å¥½ã€‚</li>
</ol>
<p>ä»¥ä¸Šæ˜¯æ¯”è¾ƒç®€å•çš„æ¨èç³»ç»Ÿçš„ä¾‹å­ï¼Œå…·ä½“çš„å®ç°è¿‡ç¨‹ä¸­å¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€ƒè™‘çš„ä¸œè¥¿ä¼šéå¸¸å¤šï¼Œå› æ­¤å…·ä½“å®ç°ä¸Šå¯èƒ½éœ€è¦è¿›ä¸€æ­¥çš„è€ƒè™‘ã€‚</p>
<h2 id="æ¨å¹¿æœç®€ä»‹">æ¨å¹¿æœç®€ä»‹</h2>
<p>å«ä¹‰ï¼šæ¨èã€å¹¿å‘Šã€æœç´¢ã€‚<strong>ç”¨æˆ·éœ€æ±‚è¡¨è¾¾æ–¹å¼ï¼š</strong>æ¨èã€æœç´¢<strong>ã€‚ä¿¡æ¯æœåŠ¡å¯¹è±¡ï¼š</strong>æ¨æœã€å¹¿å‘Š</p>
<h3 id="ç›¸åŒç‚¹">ç›¸åŒç‚¹</h3>
<ul>
<li>åŠŸèƒ½æ¶æ„ç›¸åŒï¼šéƒ½éµå¾ªå…ˆå¬å›å†æ’åº</li>
<li>æ•°æ®æ¶æ„ç›¸åŒï¼šéƒ½éµå¾ªä½¿ç”¨Lambdaæ¶æ„(åç»­ä¼šæåˆ°)</li>
<li>æŠ€æœ¯æ ˆç›¸åŒï¼Œé¢å‘çš„åŠŸèƒ½ç›¸åŒï¼Œéƒ½éœ€è¦é«˜åº¦ä¸ªæ€§åŒ–è®¾è®¡(éƒ½ååˆ†ä¾èµ–äºç”¨æˆ·çš„ç”»åƒ)</li>
</ul>
<h3 id="ä¸åŒç‚¹">ä¸åŒç‚¹</h3>
<ul>
<li><strong>æ¨è&amp;æœç´¢</strong></li>
</ul>
<p>æ¨èå’Œæœç´¢çš„æœ€å¤§å·®å¼‚åœ¨äºç”¨æˆ·è¡¨è¾¾æ„å›¾çš„æ–¹å¼ä¸åŒï¼Œç”¨æˆ·è¾“å…¥æ˜¾å¼çš„æŸ¥è¯¢è¯­å¥æ¥è¡¨æ˜è‡ªå·±çš„æ„å›¾
<span class="math display">\[
F_{search}(t|q,u)
\]</span></p>
<ul>
<li>uè¡¨ç¤ºå½“å‰ç”¨æˆ·ï¼Œqè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„æŸ¥è¯¢è¯­å¥ï¼Œtè¡¨ç¤ºæŸä¸€ä¸ªå€™é€‰ç‰©æ–™</li>
<li>Fsearchè¡¨ç¤ºæœç´¢æ¨¡å‹ï¼Œ è¡¡é‡ç‰©æ–™tå¯¹ç”¨æˆ·uè¾“å…¥çš„æŸ¥è¯¢qçš„åŒ¹é…ç¨‹åº¦</li>
<li>ç”¨æˆ·ä¿¡æ¯uä¹Ÿæ˜¯å…¬å¼çš„è¾“å…¥æ¡ä»¶ã€‚ä¸åŒç”¨æˆ·è¾“å…¥ç›¸åŒçš„æŸ¥è¯¢è¯­å¥qï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯ä¸ä¸€æ ·çš„</li>
</ul>
<p>æ¨èä¸­ï¼Œç”¨æˆ·æ— é¡»æ˜¾å¼è¡¨è¾¾å…¶æ„å›¾ã€‚æ¨èç³»ç»Ÿé€šè¿‡è‡ªå·±çš„é•¿æœŸè§‚å¯Ÿï¼ŒçŒœæµ‹ç”¨æˆ·æ„å›¾ï¼Œå®Œæˆæ¨è
<span class="math display">\[
F_{recommend}(t|u)
\]</span></p>
<ul>
<li>è¡¨ç¤ºæ¨èæ¨¡å‹ï¼Œè¡¡é‡ç‰©æ–™tå¯¹ç”¨æˆ·uçš„åŒ¹é…ç¨‹åº¦</li>
</ul>
<p>qè¡¨ç¤ºç‰©æ–™å¯¹ç”¨æˆ·æŸ¥è¯¢çš„åŒ¹é…ç¨‹åº¦ï¼Œæœç´¢æœ‰æ˜¾å¼çš„åŒ¹é…ç¨‹åº¦ï¼Œä½†æ˜¯æ¨èæ²¡æœ‰ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>æœç´¢ï¼šæŸ¥è¯¢è¯­å¥ä¸ç‰©æ–™ä¿¡æ¯äº¤å‰</p></li>
<li><p>æ¨èï¼šç”¨æˆ·ä¿¡æ¯ä¸ç‰©æ–™ä¿¡æ¯äº¤å‰</p></li>
<li><p><strong>æ¨æœ&amp;å¹¿å‘Š</strong></p></li>
</ul>
<p>æœ€ç»ˆç›®æ ‡æ€§ï¼šï¼ˆä¼˜åŒ–æŒ‡æ ‡ï¼‰</p>
<ul>
<li>æ¨æœæ˜¯ä¸ºäº†åˆ¶é€ æµé‡ï¼Œç»™äºˆç”¨æˆ·æœ€ä½³çš„ä½¿ç”¨ä½“éªŒ</li>
<li>å¹¿å‘Šæ˜¯ä¸ºäº†å˜ç°æµé‡ï¼Œè¦å…¼é¡¾ç”¨æˆ·ã€å¹¿å‘Šä¸»ã€å¹³å°ä¸‰æ–¹é¢çš„åˆ©ç›Šï¼Œå‚ä¸æ–¹æ›´å¤šã€æ›´å¤æ‚ï¼Œä¼˜åŒ–èµ·æ¥éš¾åº¦æ›´é«˜</li>
</ul>
<p>å®ç°æµç¨‹ï¼š</p>
<ul>
<li>æ¨æœç›®æ ‡å³åˆ»å®Œæˆï¼Œæ¯”å¦‚ç‚¹å‡»å’Œæ’­æ”¾</li>
<li>å¹¿å‘Šæ˜¯æ·±å±‚æ¬¡çš„è½¬åŒ–ï¼Œéœ€è¦ç”¨æˆ·é€‰æ‹©å¹¶ä¸‹è½½APPï¼Œå­˜åœ¨è¾ƒå¤§çš„å»¶æ—¶åé¦ˆé—®é¢˜ï¼ŒæˆåŠŸè½¬åŒ–çš„æ­£æ ·æœ¬è¶Šç¨€ç–ï¼Œå»ºæ¨¡éš¾åº¦è¶Šé«˜ã€‚</li>
</ul>
<p>é¢„æµ‹ç²¾åº¦çš„è¦æ±‚ï¼š</p>
<ul>
<li>æ¨èä¸æœç´¢å¯¹é¢„æµ‹å‡ºæ¥çš„CTR/CVRåªè¦æ±‚"ç›¸å¯¹å‡†ç¡®æ€§"ï¼Œå³å®ƒä»¬çš„é¢„æµ‹ç²¾åº¦èƒ½å¤Ÿå°†ç”¨æˆ·æœ€å–œæ¬¢çš„ç‰©æ–™æ’åœ¨æœ€å‰é¢ï¼Œè¿™å°±è¶³å¤Ÿäº†</li>
<li>å¹¿å‘Šå¯¹é¢„æµ‹ç²¾åº¦è¦æ±‚"ç»å¯¹å‡†ç¡®æ€§"ã€‚åœ¨æ¨¡å‹çš„é¢„æµ‹ç»“æœå‡ºæ¥ä¹‹åï¼Œå¹¿å‘Šè¿˜éœ€è¦å¯¹å…¶ä¿®æ­£ã€æ ¡å‡†ã€‚æ¯•ç«Ÿåˆ¶ä½œã€æŠ•æ”¾å¹¿å‘Šè¿˜å­˜åœ¨ä¸€å®šæŠ€æœ¯ã€è´¢åŠ›ä¸Šçš„é—¨æ§›ã€‚</li>
</ul>
<h1 id="æ¨èç³»ç»Ÿæ¨¡å‹æ¶æ„">æ¨èç³»ç»Ÿæ¨¡å‹æ¶æ„</h1>
<p>æ ¹æ®åˆ’åˆ†è§’åº¦ä¸åŒï¼Œå°†åˆ†æˆâ€œåŠŸèƒ½æ¶æ„â€å’Œâ€œæ•°æ®æ¶æ„â€ä¸¤ä¸ªæ¿å—</p>
<h2 id="åŠŸèƒ½æ¶æ„">åŠŸèƒ½æ¶æ„</h2>
<p>ä¸ºäº†åº”å¯¹æµ·é‡çš„å€™é€‰é›†åˆï¼Œç°ä»£å¤§å‹æ¨èç³»ç»Ÿéƒ½é‡‡ç”¨ç”±<strong>"å¬å›â†’ç²—æ’â†’ç²¾æ’â†’
é‡æ’"</strong>å››ä¸ªç¯èŠ‚ç»„æˆçš„åˆ†çº§æ¨èæ¨¡å¼ï¼Œåœ¨æ¨èé“¾è·¯ä¸­è¶Šé å‰çš„ç¯èŠ‚ï¼Œé¢å¯¹çš„å€™é€‰é›†åˆè¶Šå¤§ï¼Œå› æ­¤è¦é‡‡ç”¨æŠ€æœ¯è¾ƒç®€å•ã€ç²¾åº¦ç¨é€Šã€é€Ÿåº¦è¾ƒå¿«çš„ç®—æ³•ï¼Œç‰ºç‰²éƒ¨åˆ†ç²¾åº¦æ¢é€Ÿåº¦ï¼›åä¹‹ï¼Œé“¾è·¯é åçš„ç¯èŠ‚ï¼Œé¢å¯¹çš„å€™é€‰é›†åˆè¾ƒå°ï¼Œæœ‰æ¡ä»¶é‡‡ç”¨æŠ€æœ¯è¾ƒå¤æ‚ã€ç²¾åº¦é«˜ã€é€Ÿåº¦è¾ƒæ…¢çš„ç®—æ³•ï¼Œç‰ºç‰²éƒ¨åˆ†é€Ÿåº¦æ¢ç²¾åº¦ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240118142732765.png"
alt="æ¨èåŠŸèƒ½çš„ç»“æ„" />
<figcaption aria-hidden="true">æ¨èåŠŸèƒ½çš„ç»“æ„</figcaption>
</figure>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGE5NDI3YTkxNzUzYmNjODhmNTdhNWY3YmYzZjQxNjNfYXlpcWFEZ3NIQkxob2JvakRPNUZOQkNvWldyRlVYYWFfVG9rZW46WlNuMWJwbHZBbzBBUjh4cXVqY2NnSkFsbkxiXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="æ¨èç³»ç»Ÿçš„åŠŸèƒ½æ¶æ„" />
<figcaption aria-hidden="true">æ¨èç³»ç»Ÿçš„åŠŸèƒ½æ¶æ„</figcaption>
</figure>
<h3 id="å¬å›">å¬å›</h3>
<p>å¬å›æ¨¡å—çš„ç¬¬ä¸€è¦åŠ¡å°±æ˜¯"å¿«"ï¼Œå¯ä»¥ç‰ºç‰²ä¸€éƒ¨åˆ†ç²¾åº¦ï¼Œ
åªè¦èƒ½æ‰¾åˆ°ä¸ç”¨æˆ·å…´è¶£æ¯”è¾ƒåŒ¹é…çš„ç‰©æ–™å°±å¥½ï¼Œè€Œéæœ€åŒ¹é…çš„ï¼Œå› ä¸ºåè€…æ˜¯ä¸‹æ¸¸æ’åºæ¨¡å—çš„ç›®æ ‡ã€‚</p>
<p>å¬å›æ¨¡å—ä¸»è¦ä¾èµ–<strong>"ç¦»çº¿è®¡ç®—+åœ¨çº¿ç¼“å­˜"</strong>æ¨¡å¼æ¥å®ç°å¯¹ä¸Šç™¾ä¸‡å€™é€‰é›†çš„å¿«é€Ÿç­›é€‰ã€‚ä¸Šç™¾ä¸‡çš„å€™é€‰ç‰©æ–™åœ¨ç¦»çº¿å°±å¤„ç†å¥½ï¼Œå¤„ç†ç»“æœè¢«å­˜å…¥æ•°æ®åº“å¹¶å»ºç«‹å¥½ç´¢å¼•ï¼Œçº¿ä¸Šå¬å›æ—¶ï¼ŒåªèŠ±è´¹ä¸€ä¸ªåœ¨ç´¢å¼•ä¸­çš„æ£€ç´¢æ—¶é—´ï¼Œæ—¶é—´å¼€é”€éå¸¸å°ã€‚</p>
<p>ç¦»çº¿å¤„ç†ç‰©æ–™æ—¶è‚¯å®šä¸çŸ¥é“å°†æ¥è¦è®¿é—®çš„ç”¨æˆ·æ˜¯è°ï¼Œå¬å›æ¨¡å‹åœ¨ç»“æ„ä¸ç‰¹å¾ä¸Šï¼Œéƒ½ä¸èƒ½å‡ºç°<strong>ç”¨æˆ·ä¿¡æ¯ä¸ç‰©æ–™ä¿¡æ¯çš„äº¤å‰</strong>ã€‚è¿™ä¸ªç‰¹ç‚¹é™åˆ¶äº†å¬å›æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ï¼Œä¹Ÿå°±é™åˆ¶äº†åˆ¶çº¦äº†å¬å›æ¨¡å‹çš„é¢„æµ‹ç²¾åº¦ã€‚</p>
<p>ä¸ºäº†å¼¥è¡¥ç²¾åº¦ä¸Šçš„ä¸è¶³ï¼Œå¬å›æ¨¡å—ä¸€èˆ¬é‡‡ç”¨<strong>å¤šè·¯å¬å›</strong>çš„æ–¹å¼ï¼Œä»¥æ•°é‡å¼¥è¡¥è´¨é‡ã€‚æ¯è·¯å¬å›åªå…³æ³¨ç”¨æˆ·ä¿¡æ¯æˆ–ç‰©æ–™ä¿¡æ¯çš„ä¸€ä¸ªä¾§é¢ï¼Œæ¯”å¦‚æœ‰çš„åªè´Ÿè´£å¬å›å½“ä¸‹æœ€ç«çˆ†çš„å†…å®¹ï¼Œæœ‰çš„åªæ ¹æ®ç”¨æˆ·å–œçˆ±çš„"æ ‡ç­¾"è¿›è¡Œå¬å›ï¼Œè™½ç„¶å•ç‹¬ä¸€è·¯å¬å›çš„è§†è§’æ˜¯
ç‰‡é¢çš„ï¼Œä½†æ˜¯å¤šè·¯å¬å›çš„ç»“æœæ±‡æ€»èµ·æ¥ï¼Œå–é•¿è¡¥çŸ­ï¼ŒæŸ¥æ¼è¡¥ç¼ºï¼Œå°±èƒ½è¦†ç›–ç”¨æˆ·å…´è¶£çš„æ–¹æ–¹é¢é¢ã€‚</p>
<p><strong>åŒºåˆ†å¬å›å’Œæ’åºï¼š</strong></p>
<ul>
<li><p>å¬å›æ˜¯ä»ä¸€å¤§å †ç‰©æ–™ä¸­æ’é™¤ä¸ç”¨æˆ·å…´è¶£å…«æ†å­æ‰“ä¸ç€çš„ï¼Œç•™ä¸‹è¿˜æ¯”è¾ƒåˆç”¨æˆ·å“å‘³çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¬å›å¥½æ¯”ç»å†è¿‡ç¤¾ä¼šå†ç»ƒï¼Œæ— è®ºå“ªç§"ä¸é è°±"ï¼Œä»–éƒ½è§è¯†è¿‡ã€‚</p></li>
<li><p>ç²¾æ’æ˜¯ä»ä¸€å°æ‹¨å„¿è¿˜ä¸é”™çš„ç‰©æ–™ä¸­ï¼Œç²¾æŒ‘ç»†é€‰ï¼Œä¼˜ä¸­é€‰ä¼˜ï¼ŒæŒ‘å‡ºå¯¹ç”¨æˆ·æ¥è¯´æœ€å¥½çš„ç‰©æ–™ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç²¾æ’å¥½æ¯”è¿˜åœ¨æ ¡å›­ä¸­çš„ä¹–å­¦ç”Ÿï¼Œè§è¿‡æœ€ä¸é è°±çš„äººä¸è¿‡æ˜¯å€Ÿæ©¡çš®ä¸è¿˜çš„åŒæ¡Œã€‚</p></li>
</ul>
<h4 id="ä¼ ç»Ÿå¬å›ç®—æ³•"><strong>ä¼ ç»Ÿå¬å›ç®—æ³•</strong></h4>
<ul>
<li>åŸºäºç‰©æ–™å±æ€§çš„å€’æ’ç´¢å¼•</li>
<li>åŸºäºç»Ÿè®¡çš„ååŒè¿‡æ»¤ç®—æ³•
<ul>
<li>åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ï¼šç»™ç”¨æˆ·Aæ‰¾åˆ°ä¸ä»–ç›¸ä¼¼çˆ±å¥½çš„ç”¨æˆ·Bï¼ŒæŠŠBå–œæ¬¢çš„ä¸œè¥¿æ¨èç»™A</li>
<li>åŸºäºç‰©æ–™çš„ååŒè¿‡æ»¤ï¼šç”¨æˆ·Aå–œæ¬¢ç‰©æ–™Cï¼Œæ‰¾åˆ°ä¸Aç›¸ä¼¼çš„å…¶ä»–ç‰©æ–™Dï¼ŒæŠŠDæ¨èç»™A</li>
</ul></li>
<li>çŸ©é˜µåˆ†è§£ç®—æ³•(Matrix Factorization, MF)</li>
</ul>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152608169.(null)"
alt="çŸ©é˜µåˆ†è§£ç®—æ³•å›¾ç¤ºä¾‹" />
<figcaption aria-hidden="true">çŸ©é˜µåˆ†è§£ç®—æ³•å›¾ç¤ºä¾‹</figcaption>
</figure>
<h4
id="å‘é‡åŒ–å¬å›ç»Ÿä¸€å»ºæ¨¡æ¡†æ¶"><strong>å‘é‡åŒ–å¬å›ç»Ÿä¸€å»ºæ¨¡æ¡†æ¶</strong></h4>
<p>å¦‚ä½•å®šä¹‰è´Ÿæ ·æœ¬ã€å¦‚ä½•å®šä¹‰è¯æ ·æœ¬ã€å¦‚ä½•ç”ŸæˆEmbeddingã€å¦‚ä½•å®šä¹‰ä¼˜åŒ–ç›®æ ‡</p>
<p>å®šä¹‰ï¼šå°†å¬å›é—®é¢˜å»ºæ¨¡æˆå‘é‡ç©ºé—´ä¸­çš„è¿‘é‚»æœç´¢é—®é¢˜</p>
<p>åˆ†ç±»ï¼šä¸¤ç±»å®ä½“QTï¼Œå¯ä»¥æ˜¯ç‰©æ–™-ç”¨æˆ·ã€ç”¨æˆ·-ç”¨æˆ·ã€ç‰©æ–™-ç‰©æ–™</p>
<p>æ–¹æ³•æµç¨‹ï¼š</p>
<ol type="1">
<li>è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶å°†QTæ˜ å°„åˆ°åŒä¸€ä¸ªå‘é‡ç©ºé—´</li>
<li>æ„å»ºèµ·ç´¢å¼•å‘é‡æ•°æ®åº“</li>
<li>å¯¹äºä¼ å…¥çš„Qå®ä¾‹å…ˆè¿›è¡ŒEmbedding å†è¿›è¡Œè¿‘é‚»æœç´¢</li>
</ol>
<p>å»ºæ¨¡æ–¹æ³•ï¼š</p>
<ul>
<li>å¦‚ä½•å®šä¹‰æ­£æ ·æœ¬ï¼ˆå“ªäº›qå’Œtåœ¨å‘é‡ç©ºé—´ä¸­åº”è¯¥è¿‘ï¼‰
<ul>
<li>qtéƒ½æ˜¯ç‰©æ–™ï¼šæ—¶é—´é—´éš”å¾ˆè¿‘çš„ç”¨æˆ·è¡Œä¸ºåºåˆ—äº¤äº’è¿‡çš„ç‰©æ–™è®¤ä¸ºå¾ˆè¿‘ï¼Œç›¸ä¼¼æ€§</li>
<li>qæ˜¯ç”¨æˆ·tæ˜¯ç‰©æ–™ï¼šç”¨æˆ·äº¤äº’è¿‡çš„ç‰©æ–™è®¤ä¸ºæ˜¯ç›¸è¿‘çš„ï¼ŒåŒ¹é…æ€§</li>
<li>qtéƒ½æ˜¯ç”¨æˆ·ï¼šæ¯”å¦‚å­ªç”Ÿç½‘ç»œï¼Œqæ˜¯ç”¨æˆ·ä¸€åŠçš„äº¤äº’å†å²ï¼Œtæ˜¯åŒä¸€ç”¨æˆ·å¦ä¸€åŠçš„äº¤äº’å†å²ï¼ŒåŒä¸€æ€§</li>
</ul></li>
<li>å¦‚ä½•å®šä¹‰è´Ÿæ ·æœ¬ï¼ˆå“ªäº›qå’Œtåœ¨å‘é‡ç©ºé—´ä¸­åº”è¯¥è¿œï¼‰
<ul>
<li><strong>è´Ÿæ ·æœ¬ä¸ºç‹</strong>ï¼Œè´Ÿæ ·æœ¬é€‰æ‹©å¯¹æ¨¡å‹å¾ˆé‡è¦</li>
<li><strong>ç¦»çº¿è®­ç»ƒçš„æ•°æ®åˆ†å¸ƒåº”è¯¥ä¸çº¿ä¸ŠæœåŠ¡çš„æ•°æ®åˆ†å¸ƒä¿æŒä¸€è‡´</strong></li>
<li>æ³¨æ„ å¬å›å’Œæ’åº
å€™é€‰é›†å®Œå…¨ä¸åŒï¼š<strong>å¬å›</strong>è¦è®©æ¨¡å‹è§è¿‡æœ€åŒ¹é…ä¹Ÿè¦è§æœ€ä¸é è°±ï¼Œå› æ­¤<strong>å¬å›çš„è´Ÿæ ·æœ¬ä¸»è¦ä¾é éšæœºé‡‡æ ·ç”Ÿæˆï¼Œä¸èƒ½ï¼ˆåªï¼‰æ‹¿â€œæ›å…‰æœªç‚¹å‡»â€ä½œä¸ºè´Ÿæ ·æœ¬</strong></li>
<li>æ³¨æ„Easy
Negativeé—®é¢˜ï¼Œè´Ÿæ ·æœ¬è¦å’Œqæœ‰ç»†èŠ‚å·®å¼‚ï¼Œå¢åŠ éš¾åº¦ï¼›<code>easy:hard=100:1</code></li>
</ul></li>
<li>å¦‚ä½•å°†qå’Œtæ˜ å°„æˆEmbedding
<ul>
<li><strong>æ’åºé¼“åŠ±ç‰¹å¾äº¤å‰ï¼Œå¬å›è¦æ±‚è§£è€¦</strong></li>
<li>æ’åºä½¿ç”¨äº†å¤§é‡çš„äº¤å‰ç»Ÿè®¡ç‰¹å¾ï¼Œæ’åºå°†ç”¨æˆ·ç‰¹å¾ã€ç‰©æ–™ç‰¹å¾ã€äº¤å‰ç»Ÿè®¡ç‰¹å¾æ‹¼æ¥</li>
<li>å¬å›è§£è€¦ï¼Œä¸ç”¨çŸ¥é“ç”¨æˆ·çš„è¯·æ±‚æå‰è®¡ç®—å¥½ç‰©æ–™å‘é‡ï¼Œé¿å…è®¡ç®—äº¤å‰ç‰¹å¾è€—æ—¶</li>
</ul></li>
<li>å¦‚ä½•å®šä¹‰ä¼˜åŒ–ç›®æ ‡å’ŒæŸå¤±å‡½æ•°
<ul>
<li>NCE Loss</li>
<li>Sampled Softmax Loss</li>
<li>Pairwise Loss</li>
</ul></li>
</ul>
<h3 id="ç²¾æ’">ç²¾æ’</h3>
<p>ä»»åŠ¡ç›®æ ‡ï¼šç²¾æ’çš„ä»»åŠ¡æ˜¯ä»ä¸Šæ¸¸å±‚å±‚ç­›é€‰å‡ºæ¥çš„åƒä½™å·è¿˜æ¯”è¾ƒç¬¦åˆç”¨æˆ·å…´è¶£çš„ç‰©æ–™ä¸­ï¼Œ<strong>ç²¾æŒ‘ç»†é€‰</strong>å‡ºç™¾ä½™ä¸ªæœ€åˆç”¨æˆ·å“å‘³çš„ç‰©æ–™ã€‚</p>
<p>è®¾è®¡é‡ç‚¹ï¼šç²¾æ’çš„è®¾è®¡é‡ç‚¹æ˜¯æå‡é¢„æµ‹ç²¾åº¦ã€‚æ‰€ä»¥ä¸åŒäºå¬å›ã€ç²—æ’ä¸å…è®¸ç”¨æˆ·ä¿¡æ¯ä¸ç‰©æ–™ä¿¡æ¯äº¤å‰ï¼Œç²¾æ’æ¨¡å‹çš„å‘åŠ›<strong>é‡ç‚¹å°±æ˜¯è®©ç‰©æ–™ä¿¡æ¯ä¸ç”¨æˆ·ä¿¡æ¯æ›´åŠ å……åˆ†åœ°äº¤å‰</strong>ï¼Œä¸ºæ­¤ä¸šç•Œåœ¨ç²¾æ’å¼•å…¥äº†æ›´å¤šæ›´å¤æ‚çš„<strong>äº¤å‰ç‰¹å¾</strong>ï¼Œ</p>
<h4 id="ç‰¹å¾äº¤å‰æ–¹æ³•"><strong>ç‰¹å¾äº¤å‰æ–¹æ³•</strong></h4>
<ul>
<li>ä¼ ç»Ÿæ–¹æ³•ï¼šFTRL</li>
<li>FMï¼šå¼•å…¥äº†äºŒé˜¶ç‰¹å¾äº¤å‰ï¼ˆæ‰‹åŠ¨äºŒé˜¶ç‰¹å¾äº¤å‰ï¼‰</li>
<li>Wide&amp;Deepï¼šå…¼é¡¾è®°å¿†ä¸æ‰©å±•</li>
<li>DeepFM ï¼šèåˆäºŒé˜¶äº¤å‰ï¼ˆå®ç°äº†è‡ªåŠ¨äºŒé˜¶ç‰¹å¾äº¤å‰ï¼‰</li>
<li>DCNï¼šèƒ½å¤ŸæŒ‡å®šä»»æ„æ˜¾å¼äº¤å‰</li>
<li>Autolntï¼šåŸºäºTransformerä½œç‰¹å¾äº¤å‰</li>
</ul>
<h4 id="ç”¨æˆ·è¡Œä¸ºåºåˆ—å»ºæ¨¡"><strong>ç”¨æˆ·è¡Œä¸ºåºåˆ—å»ºæ¨¡</strong></h4>
<p>æœ¬è´¨ï¼šå°†ç”¨æˆ·è¡Œä¸ºåºåˆ—æç‚¼å¹¶å‹ç¼©æˆ<strong>ç”¨æˆ·å…´è¶£çš„Embedding</strong></p>
<ul>
<li>DINï¼šåˆ©ç”¨Attentionï¼Œå°†å½“å‰çš„ç‰©æ–™tä½œä¸ºç”¨æˆ·å†å²åºåˆ—çš„Query</li>
<li>åŒå±‚Attentionè¡Œä¸ºåºåˆ—ï¼šç¬¬ä¸€å±‚Attentionå†å²è¡Œä¸ºåºåˆ—å†…éƒ¨çš„ä¾èµ–å…³ç³»ï¼›ç¬¬äºŒå±‚æ˜¯å½“å‰ç‰©æ–™å’Œå†å²è¡Œä¸ºåºåˆ—</li>
<li>SIMï¼šå°†â€œè½¯è¿‡æ»¤â€å˜æˆâ€œç¡¬è¿‡æ»¤â€ï¼Œç›¸å½“äºä»é•¿åºåˆ—é€‰æ‹©çŸ­åºåˆ—è¿›è¡ŒDIN</li>
</ul>
<h3 id="ç²—æ’">ç²—æ’</h3>
<p>å¬å›çš„ç²¾åº¦ä¸è¶³ï¼Œæ‰€ä»¥ç”¨æ•°é‡å¼¥è¡¥è´¨é‡ï¼Œå€¾å‘äºå¬å›æ›´å¤šç‰©æ–™ï¼Œé€å¾€ä¸‹æ¸¸ã€‚ç²¾æ’ä¸ºäº†æå‡é¢„æµ‹ç²¾åº¦ï¼Œä¸æ–­åŠ å¤§æ¨¡å‹å¤æ‚åº¦ï¼Œè€Œç‰ºç‰²äº†æ¨¡å‹çš„ååèƒ½åŠ›ã€‚
å¦‚æœè®©å¬å›ç›´æ¥å¯¹æ¥ç²¾æ’ï¼Œç¬¨é‡çš„ç²¾æ’æ— æ³•é¢å¯¹å¬å›é€æ¥çš„è¶Šæ¥è¶Šå¤šçš„å€™é€‰ç‰©æ–™ï¼Œç²—æ’æ¥åœ¨å¬å›åé¢ï¼Œä¸€èˆ¬å°†å¬å›çš„10000ä¸ªç»“æœå†è¿‡æ»¤æ‰9æˆï¼Œå†äº¤ç»™ç²¾æ’é‡ç‚¹è€ƒå¯Ÿã€‚ç²—æ’å¤¹åœ¨å¬å›ä¸ç²¾æ’ä¹‹é—´ï¼Œåˆæ˜¯ä¸€ä¸ª<strong>é€Ÿåº¦ä¸ç²¾åº¦æŠ˜è¡·å¦¥å</strong>çš„äº§ç‰©ã€‚</p>
<ul>
<li>ä¸€æ–¹é¢ï¼Œç”±äºå€™é€‰é›†è§„æ¨¡æ¯”å¬å›å°å¾—å¤šï¼Œç›¸æ¯”å¬å›ï¼Œç²—æ’æ¨¡å‹å¯ä»¥æ¥å…¥æ›´å¤šç‰¹å¾ï¼Œä½¿ç”¨æ›´å¤æ‚çš„ç»“æ„ã€‚</li>
<li>å¦ä¸€æ–¹é¢ï¼Œç”±äºå€™é€‰é›†æ¯”ç²¾æ’è¿˜å¤§å¾—å¤šï¼Œç²—æ’æ¨¡å‹æ¯”ç²¾æ’åˆç®€å•å¤ªå¤šã€‚æ¯”å¦‚ä¸»æµç²—æ’æ¨¡å‹ä»ç„¶ä¾èµ–"ç¦»çº¿è®¡ç®—+åœ¨çº¿ç¼“å­˜"æ¨¡å¼æ¥å¤„ç†å€™é€‰ç‰©æ–™ï¼Œæ‰€ä»¥<strong>ä»ç„¶ä¸èƒ½ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯ä¸ç‰©æ–™ä¿¡æ¯äº¤å‰çš„ç‰¹å¾ä¸ç»“æ„</strong>ã€‚</li>
</ul>
<h4 id="åŸºäºæ”¹è¿›çš„åŒå¡”æ¨¡å‹">åŸºäºæ”¹è¿›çš„åŒå¡”æ¨¡å‹</h4>
<ul>
<li>å¬å›éœ€è¦å‘é‡æ•°æ®åº“å»ºç«‹ç´¢å¼•ï¼Œç²—æ’ä¸éœ€è¦ç´¢å¼•</li>
<li>è´Ÿæ ·æœ¬çš„é€‰æ‹©ï¼Œå¯ä»¥æ‹¿â€œæ›å…‰æœªç‚¹å‡»â€å½“è´Ÿæ ·æœ¬</li>
<li>æŸå¤±å‡½æ•°ï¼Œç²—æ’çš„æŸå¤±å‡½æ•°éœ€è¦è€ƒè™‘ç”¨æˆ·å®é™…åé¦ˆï¼Œå¬å›ä¸éœ€è¦</li>
<li>å¬å›ANNå¿«é€Ÿæœç´¢è¿‘é‚»ä½¿ç”¨ç‚¹ç§¯å®ç°äº¤å‰ï¼Œç²—æ’å¯ä»¥é€‰æ‹©ä»»æ„çš„äº¤å‰æ–¹å¼
<ul>
<li>åŒå¡”ç»“æ„çš„é—®é¢˜ï¼šç»†ç²’åº¦ä¿¡æ¯åœ¨å¡”ä¸­è¢«æ¶ˆè€—ï¼Œå¦‚ä½•ä¿ç•™æ›´å¤šçš„å¡”ä¸­è¾“å‡ºä¿¡æ¯</li>
<li>åŠ¨æ€è°ƒæ•´è¾“å…¥ä¿¡æ¯ï¼Œå‡å°‘å™ªå£°ä¿¡æ¯çš„è¾“å…¥</li>
<li>é‡è¦çš„ä¿¡æ¯èµ°æ·å¾„ï¼ŒResNet</li>
</ul></li>
</ul>
<h4 id="åŸºäºçŸ¥è¯†è’¸é¦">åŸºäºçŸ¥è¯†è’¸é¦</h4>
<h3 id="é‡æ’">é‡æ’</h3>
<p>ç›¸ä¼¼å†…å®¹(æ¯”å¦‚ç›¸åŒè¯é¢˜ã€ç›¸åŒæ ‡ç­¾)ä¼šè¢«ç²—æ’æ¨¡å‹æ‰“ä¸Šç›¸è¿‘çš„åˆ†æ•°ï¼Œä»è€Œåœ¨ç»“æœé›†ä¸­æ’åœ¨ç›¸è¿‘çš„ä½ç½®ã€‚å¦‚æœå°†è¿™æ ·çš„æ’åºç»“æœç›´æ¥å‘ˆç°ç»™ç”¨æˆ·ï¼Œç”¨æˆ·è¿çœ‹å‡ æ¡ç›¸ä¼¼å†…å®¹ï¼Œå¾ˆå®¹æ˜“å®¡ç¾ç–²åŠ³ï¼Œä»è€Œä¼¤å®³ç”¨æˆ·ä½“éªŒã€‚æ‰€ä»¥ï¼Œç²¾æ’ç»“æœè¿˜éœ€è¦ç»è¿‡é‡æ’ã€‚é‡æ’çš„ä¸»è¦ç›®çš„ä¸æ˜¯ä¸ºäº†è¿‡æ»¤ç­›é€‰ï¼Œè€Œæ˜¯ä¸ºäº†è°ƒæ•´ç²¾æ’ç»“æœçš„é¡ºåºï¼Œ<strong>å°†ç›¸ä¼¼å†…å®¹æ‰“æ•£</strong>ï¼Œä¿è¯ç”¨æˆ·åœ¨ä¸€å±ä¹‹å†…çœ‹åˆ°çš„æ¨èç»“æœï¼Œä¸°å¯Œè€Œå¤šæ ·ã€‚</p>
<h4 id="åŸºäºå¯å‘å¼è§„åˆ™">åŸºäºå¯å‘å¼è§„åˆ™</h4>
<p><strong>æ»‘åŠ¨çª—å£æ‰“æ•£æ³•</strong></p>
<p>ä¸€ç§å¸¸è§çš„æ‰“æ•£è§„åˆ™å«åš"æ»‘çª—æ‰“æ•£"ï¼Œå³åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºKçš„æ»‘åŠ¨çª—å£(Sliding
Window, SW)å†…,ç›¸ä¼¼ç‰©æ–™æœ€å¤šå‡ºç°næ¬¡ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­</p>
<ul>
<li>åˆå§‹æ—¶ï¼Œæ‰€æœ‰ç‰©æ–™æŒ‰ç…§ç²¾æ’æ‰“åˆ†ä»å¤§åˆ°å°æ’åºï¼›</li>
<li>åœ¨ç¬¬1ä¸ªæ»‘çª—å†…ï¼Œç‰©æ–™2å’Œ3æ˜¯ç›¸åŒç±»åˆ«ï¼Œè¿åæ‰“æ•£ç›®æ ‡ï¼Œç‰©æ–™4å’Œ3å¯¹è°ƒï¼›</li>
<li>åœ¨ç¬¬2ä¸ªæ»‘çª—å†…ï¼Œè¿˜æ˜¯ç‰©æ–™2å’Œ3è¿åæ‰“æ•£ç›®æ ‡ï¼Œç‰©æ–™3å’Œ5å¯¹è°ƒï¼›</li>
<li>åœ¨ç¬¬3ä¸ªæ»‘çª—å†…ï¼Œæ¯ä¸ªç±»åˆ«åªå‡ºç°ä¸€æ¬¡ï¼Œæ»¡è¶³æ‰“æ•£ç›®æ ‡ï¼Œè·¯è¿‡ï¼›</li>
<li>åœ¨ç¬¬4ä¸ªæ»‘çª—å†…ï¼Œç‰©æ–™5å’Œ6è¿åæ‰“æ•£ç›®æ ‡ï¼Œç‰©æ–™6å’Œ7å¯¹è°ƒï¼›</li>
<li>å¦‚æœæ»‘åŠ¨åˆ°æœ€åä¸€æ¬¡çª—å£ï¼Œè¿˜ä¸æ»¡è¶³æ‰“æ•£ç›®æ ‡ï¼Œä½†æ˜¯åé¢å·²ç»æ²¡æœ‰ç‰©æ–™å¯å¯¹è°ƒäº†ï¼Œä¸åšå¤„ç†ã€‚</li>
</ul>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjA4NGYwOWRkZDU4ZGNiYThkNWQ5MzhjNjg4ZWM0YzlfbHY0dkwwZUtzTW9SQnFJM0ZZVXZ6d2phTUlEWVBjNHJfVG9rZW46V0FJemIxa0R5bzVwS0p4dzF2UGNHSm5Mbk9jXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p><strong>åˆ†æ¡¶æ‰“æ•£æ³•</strong></p>
<p>é¦–å…ˆæŒ‰ç…§ä¸åŒç±»åˆ«å°†æ’å¥½åºçš„ç‰©æ–™æ”¾å…¥æŒ‰ç…§<strong>æŸä¸ªæŒ‡æ ‡åˆ’åˆ†çš„æ¡¶</strong>ä¸­ï¼Œç´§æ¥ç€å‡åŒ€åœ°ä»æ¯ä¸ªæ¡¶ä¸­æŠ½å–å¯¹åº”çš„ç‰©æ–™æ¥ä¿è¯ç‰©æ–™ä¸ç›¸ä¼¼</p>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=MTZjN2YxNmNjMTRhZGNmZGY1NjZkMjMwNDhjM2ZhYTlfYkpOU01rZ0lEWDRGQ0x1S3NxanptV0pyU0MwQjRjd1pfVG9rZW46VEUyOGJ3TjlHb1BKYzl4Mktxc2MzMFJUbmtiXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h4 id="åŸºäºè´ªå¿ƒç®—æ³•">åŸºäºè´ªå¿ƒç®—æ³•</h4>
<p><span class="math display">\[N e x t=\underset{t \in R \backslash
S}{\operatorname{argmax}} \lambda \operatorname{Sim}_1(u, t)-(1-\lambda)
\operatorname{Sim}_2(S, t)\]</span></p>
<ul>
<li>$$$$ æ˜¯å…¨ä½“ç²¾æ’ç»“æœ, ä¹Ÿå°±æ˜¯é‡æ’çš„å…¨ä½“å€™é€‰é›†ã€‚</li>
<li>$<span class="math display">\[$ æ˜¯å½“å‰çš„é‡æ’ç»“æœé›†ã€‚å½“
\]</span><span class="math display">\[ çš„é•¿åº¦è¾¾åˆ°æŒ‡å®šé•¿åº¦æ—¶, é‡æ’ç»“æŸ,
å°† \]</span>$$ å±•ç¤ºç»™ç”¨æˆ·ã€‚</li>
<li><span class="math display">\[R \backslash \]</span>
è¡¨ç¤ºè¿˜æœªæ’å…¥é‡æ’ç»“æœé›†çš„æ‰€æœ‰ç²¾æ’ç»“æœã€‚</li>
<li><span class="math display">\[\operatorname{Sim}_1(u, t\]</span>
ä»£è¡¨å½“å‰å€™é€‰ç‰©æ–™ $<span class="math display">\[$ ä¸å‘èµ·è¯·æ±‚çš„ç”¨æˆ·
\]</span>$$ ä¹‹é—´çš„ç›¸å…³æ€§, å¯ä»¥ç”¨ç²¾æ’æ‰“åˆ†è¡¨ç¤ºã€‚</li>
<li><span class="math display">\[\operatorname{Sim}_2(S, t\]</span>
æ˜¯å½“å‰ç‰©æ–™ $<span class="math display">\[$ ä¸å½“å‰é‡æ’ç»“æœé›†åˆ
\]</span>$$ çš„ç›¸ä¼¼åº¦ã€‚è¿™ä¸ªæ•°å€¼è¶Šå°, å°†åŠ å…¥ <span
class="math inline">\(S\)</span>, å¯¹é‡æ’ç»“æœå¤šæ ·æ€§çš„æå‡è¶Šå¤§ã€‚</li>
<li><span class="math display">\[\lambda \operatorname{Sim}_1(u,
t)-(1-\lambda) \operatorname{Sim}_2(S, t\]</span> ä»£è¡¨å°†å€™é€‰ç‰©æ–™ $<span
class="math display">\[$ åŠ å…¥ \]</span><span class="math display">\[
å¸¦æ¥çš„è¾¹é™…æ”¶ç›Š, æ˜¯ç›¸å…³æ€§ä¸å¤šæ ·æ€§çš„æŠ˜ä¸­, \]</span>$$ æ˜¯ç»„åˆçš„æƒé‡ã€‚</li>
</ul>
<p>å…¶ä½™çš„æ–¹æ³•ï¼šåŸºäºè¡Œåˆ—å¼ç‚¹è¿‡ç¨‹ã€åŸºäºä¸Šä¸‹æ–‡æ„ŸçŸ¥ç­‰æ–¹æ³•</p>
<h2 id="æ•°æ®æ¶æ„">æ•°æ®æ¶æ„</h2>
<p>é™¤äº†ä¸Šé¢ä»‹ç»çš„åŠŸèƒ½æ¶æ„ï¼Œæ¨èç³»ç»Ÿä¸­çš„æ¨¡å—è¿˜å¯ä»¥æŒ‰ç…§æ•°æ®ç”Ÿäº§ã€è®¡ç®—ã€å­˜å‚¨çš„ä¸åŒæ–¹å¼è¿›è¡Œåˆ’åˆ†ï¼Œä¹Ÿå°±æ˜¯æ¨èç³»ç»Ÿçš„æ•°æ®æ¶æ„ã€‚</p>
<p>æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li>å†·æ•°æ®ï¼šå­˜å‚¨åœ¨Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ(Hadoop Distributed File System,
HDFS)ä¸Šçš„é‚£éƒ¨åˆ†æ—¥å¿—æ•°æ®</li>
<li>çƒ­æ•°æ®ï¼šHDFSåªæ”¯æŒæ‰¹é‡è¯»å†™çš„æ€§è´¨æ‰€é™ï¼Œè¿˜æœ‰è®¸å¤šç”¨æˆ·è¡Œä¸ºæœªå¾—åŠç»„æˆç”¨æˆ·æ—¥å¿—ï¼Œæˆ–è€…æœªæ¥å¾—åŠè½ç›˜åœ¨HDFSä¸Šçš„æ•°æ®</li>
</ul>
<p>ä¸ºäº†åº”å¯¹äº’è”ç½‘å¤§æ•°æ®ç³»ç»Ÿçš„å¤æ‚æ€§ï¼ŒLambdaæ¶æ„åº”è¿è€Œç”Ÿã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152608613.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>å°†æ•°æ®è¯·æ±‚æ‹†è§£ä¸ºåˆ†åˆ«é’ˆå¯¹å†·ã€çƒ­æ•°æ®çš„ä¸¤ä¸ªå­è¯·æ±‚ã€‚</li>
<li>é’ˆå¯¹å†·æ•°æ®çš„è¯·æ±‚ï¼Œ
ç”±<strong>"ç¦»çº¿å±‚"</strong>æ‰¹é‡å®Œæˆè®¡ç®—ï¼Œå…¶ç»“æœç”±<strong>"è¿‘çº¿å±‚"</strong>ç¼“å­˜å¹¶æä¾›å¿«é€ŸæŸ¥è¯¢ã€‚</li>
<li>é’ˆå¯¹çƒ­æ•°æ®çš„è¯·æ±‚ï¼Œ
ç”±<strong>"åœ¨çº¿å±‚"</strong>åŸºäºæµå¼ç®—æ³•è¿›è¡Œå¤„ç†ã€‚</li>
<li>æ±‡æ€»ä»å†·ã€çƒ­æ•°æ®åˆ†åˆ«è·å¾—çš„å­ç»“æœï¼Œå¾—åˆ°æœ€ç»ˆçš„è®¡ç®—ç»“æœã€‚</li>
</ul>
<h3 id="ç¦»çº¿å±‚">ç¦»çº¿å±‚</h3>
<p>ä¸ºäº†è®¡ç®—å¯ä»¥å¯åŠ¨ä¸€ä¸ªå°æ—¶çº§çš„å®šæ—¶ä»»åŠ¡ï¼Œæ¯ä¸ªå°æ—¶éƒ½å‘å‰å›æº¯ä¸€å‘¨çš„ç”¨æˆ·è¡Œä¸ºæ—¥å¿—ï¼Œ
ç»Ÿè®¡è¿™ä¸ªæ—¶é—´çª—å£å†…æ¯ä¸ªè§†é¢‘Vçš„æ›å…‰æ•°ä¸ç‚¹å‡»æ•°ã€‚ä¸ºäº†åŠ é€Ÿï¼Œæˆ‘ä»¬å¯ä»¥å®šæ—¶è·‘å¦ä¸€ä¸ªå°æ—¶çº§çš„æ‰¹é‡ä»»åŠ¡ï¼Œç»Ÿè®¡æ¯ä¸ªå°æ—¶å†…æ¯ä¸ªè§†é¢‘çš„æ›å…‰ã€ç‚¹å‡»æ€»æ•°ï¼Œå¹¶ä¿å­˜ç»“æœã€‚å¦å¤–ï¼Œè¿™äº›å°æ—¶çº§çš„ä¸­é—´ç»“æœä¹Ÿèƒ½å¤Ÿè¢«å…¶ä»–ä¸Šå±‚è®¡ç®—ä»»åŠ¡æ‰€å¤ç”¨ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚</p>
<p>ä»¥ä¸Šè¿™äº›<strong>å®šæ—¶æ‰«ææ—¥å¿—çš„æ‰¹é‡è®¡ç®—ä»»åŠ¡</strong>ï¼Œå°±æ„æˆäº†Lambdaæ¶æ„ä¸­çš„"ç¦»çº¿å±‚"ã€‚æŠ€æœ¯ä¸Šï¼Œè¿™äº›æ‰¹é‡è®¡ç®—ä»»åŠ¡å¯ä»¥å‡­å€ŸHadoopã€Sparkã€
Flinkç­‰å¤§æ•°æ®æ¡†æ¶æ¥å®Œæˆï¼Œè€Œå¤šä¸ªä»»åŠ¡ä¹‹é—´çš„ååŒå¯ä»¥ç”±Airflowæ¥å®Œæˆã€‚</p>
<h3 id="è¿‘çº¿å±‚">è¿‘çº¿å±‚</h3>
<p>HDFSæ˜¯ä¸€ç§æ“…é•¿æ‰¹é‡è¯»å†™ï¼Œä½†éšæœºè¯»å†™æ•ˆç‡æä½çš„å­˜å‚¨ä»‹è´¨ï¼Œä¸åˆ©äºçº¿ä¸Šå¿«é€Ÿè¯»å–ã€‚ä¸ºäº†æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œæˆ‘ä»¬å°†ç¦»çº¿æ‰¹é‡è®¡ç®—çš„ç»“æœå¯¼å…¥Cassandraã€Redisè¿™æ ·çš„"é”®
~å€¼" (Key-Valueï¼Œ KV)
å‹æ•°æ®åº“ã€‚è¿™äº›<strong>èµ·ç¼“å­˜ã€åŠ é€Ÿè®¿é—®</strong>ä½œç”¨çš„KVæ•°æ®åº“å°±æ„æˆäº†Lambdaæ¶æ„ä¸­çš„"è¿‘çº¿å±‚"ã€‚</p>
<h3 id="åœ¨çº¿å±‚">åœ¨çº¿å±‚</h3>
<p>å› ä¸ºHDFSåªæ”¯æŒæ‰¹é‡è¯»å†™ï¼Œæ‰€ä»¥ç”¨æˆ·è¡Œä¸ºä»å‘ç”Ÿåˆ°è¢«è®°å½•åœ¨HDFSä¸Šï¼Œä¹‹é—´å­˜åœ¨ç€å°æ—¶çº§åˆ«çš„å»¶æ—¶ã€‚ç”¨æˆ·æœ€æ–°çš„è¡Œä¸ºéƒ½æœªèƒ½ä½“ç°åœ¨ç¦»çº¿æ‰¹é‡è®¡ç®—çš„ç»“æœä¸­ã€‚</p>
<p>"åœ¨çº¿å±‚"æ­£æ˜¯ä¸ºäº†å¼¥è¡¥ä¸Šè¿™å—çŸ­æ¿ã€‚è¿™ä¸€å±‚å‡­å€ŸStormã€Flinkç­‰æµå¼è®¡ç®—æ¡†æ¶ï¼Œå¯¹æ¥ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®æµï¼Œ<strong>ä¸ç­‰æ•°æ®è½åœ°ï¼Œå°±ç›´æ¥å¯¹å®ƒä»¬è¿›è¡Œåˆ†æè®¡ç®—</strong>ï¼Œè®¡ç®—ç»“æœä¹Ÿç¼“å­˜åœ¨Redisè¿™æ ·æ”¯æŒéšæœºè¯»å†™çš„æ•°æ®åº“ä¸­ï¼Œæ–¹ä¾¿çº¿ä¸ŠæŸ¥è¯¢ã€‚</p>
<h1 id="æ¨èç³»ç»Ÿçš„ç‰¹å¾å·¥ç¨‹">æ¨èç³»ç»Ÿçš„ç‰¹å¾å·¥ç¨‹</h1>
<p>å¥½çš„ç‰¹å¾å·¥ç¨‹èƒ½å¤Ÿå°†æ•°æ®å¤„ç†å¾—æ›´åŠ é€‚é…æ¨¡å‹ï¼Œèƒ½å¤Ÿè®©æ¨¡å‹å‘æŒ¥æœ€å¤§çš„æ€§èƒ½</p>
<h2 id="ç‰¹å¾å·¥ç¨‹çš„å¿…è¦æ€§">ç‰¹å¾å·¥ç¨‹çš„å¿…è¦æ€§</h2>
<ul>
<li>DNNä¸‡èƒ½å‡½æ•°æ¨¡æ‹Ÿå™¨å¹¶ä¸å¯é ï¼Œè¾“å…¥æ•°æ®æœªç»å¤„ç†ä¼šå½±å“DNNæ€§èƒ½çš„å‘æŒ¥</li>
<li>DNNçš„è‡ªåŠ¨åŒ–ç‰¹å¾å·¥ç¨‹å¯¹äºå¤§é‡çš„æ•°æ®å­˜åœ¨è€—æ—¶ç­‰é—®é¢˜</li>
</ul>
<h2 id="ç‰¹å¾æå–">ç‰¹å¾æå–</h2>
<p>è¿™ä¸€éƒ¨åˆ†ä¼šä»‹ç»å¦‚ä½•å¯¹å„ç±»ä¸åŒçš„ç‰¹å¾æå–çš„æ–¹æ³•</p>
<h3 id="ç‰©æ–™ç‰¹å¾">ç‰©æ–™ç‰¹å¾</h3>
<ul>
<li><strong>ç‰©æ–™è‡ªèº«å±æ€§</strong>
<ul>
<li>åœ¨è§†é¢‘æ¨èåœºæ™¯ä¸‹ï¼Œè§†é¢‘çš„ä½œè€…ã€ä½œè€…ç­‰çº§ã€ä½œè€…ç²‰ä¸æ•°ã€æŠ•ç¨¿æ ç›®ã€è§†é¢‘æ ‡é¢˜ä¸ç®€ä»‹ã€ä¸Šä¼ æ—¶é—´ã€
æ—¶é•¿ã€æ¸…æ™°åº¦ç­‰ä¿¡æ¯ï¼Œéƒ½å±äºç‰©æ–™å±æ€§ã€‚</li>
<li>åœ¨ç”µå•†åœºæ™¯ä¸‹ï¼Œå•†å“æ ‡é¢˜ä¸ç®€ä»‹ã€å°é¢å›¾ç‰‡ã€æ‰€å±å•†é“ºã€å•†é“ºç­‰çº§ã€å“ç‰Œã€ä»·æ ¼ã€æŠ˜æ‰£ã€ç‰©æ–™æ–¹å¼ã€ä¸Šæ¶æ—¶é—´ç­‰ä¿¡æ¯ï¼Œéƒ½å±äºç‰©æ–™å±æ€§ã€‚</li>
<li>ç‰©æ–™çš„å”¯ä¸€æ ‡è¯†(tem
ID)ä¹Ÿæ˜¯é‡è¦çš„ç‰¹å¾<strong>ï¼ˆé«˜ç»´ã€ç¨€ç–ï¼‰</strong>Item
IDå½“æˆç‰¹å¾èƒ½å¤Ÿåœ¨ç‰©æ–™ä¾§æä¾›æœ€ä¸ªæ€§åŒ–çš„ä¿¡æ¯ã€‚</li>
</ul></li>
<li><strong>ç‰©æ–™çš„ç±»åˆ«ä¸æ ‡ç­¾</strong></li>
</ul>
<p>æ‰€è°“ç‰©æ–™çš„é™æ€ç”»åƒï¼Œæ˜¯æŒ‡ä¸ä¾èµ–ç”¨æˆ·åé¦ˆï¼Œåªé€šè¿‡åˆ†æç‰©æ–™å†…å®¹å°±èƒ½è·å¾—çš„ç‰©æ–™çš„<strong>ç±»åˆ«ã€æ ‡ç­¾</strong>ç­‰ä¿¡æ¯ã€‚</p>
<ul>
<li><p>å¯ä»¥ç”¨"è‡ªç„¶è¯­è¨€å¤„ç†" (Natural Language Processing, NLP)
ç®—æ³•ï¼Œæ¯”å¦‚BERT[5]ï¼Œ
åˆ†æç‰©æ–™çš„æ ‡é¢˜ã€æ‘˜è¦ã€è¯„è®ºç­‰ã€‚å¦‚æœæ˜¯æ–‡ç« è¿˜å¯ä»¥åˆ†ææ­£æ–‡ï¼Œå¦‚æœæ˜¯è§†é¢‘è¿˜å¯ä»¥åˆ†æå­—å¹•ã€‚</p></li>
<li><p>æˆ‘ä»¬å¯ä»¥ç”¨"è®¡ç®—æœºè§†è§‰" (ComputerVision, CV)
ç®—æ³•ï¼Œæ¯”å¦‚CNNæ¨¡å‹[6]ï¼Œ
åˆ†æç‰©æ–™çš„å°é¢ï¼Œæˆ–è€…è§†é¢‘çš„å…³é”®å¸§ã€‚å†…å®¹åˆ†æçš„ç»“æœå°±æ„æˆäº†ç‰©æ–™çš„é™æ€ç”»åƒã€‚</p></li>
<li><p><strong>åŸºäºå†…å®¹çš„Embedding</strong></p></li>
</ul>
<p>åˆ©ç”¨CNNæˆ–BERTä¹‹ç±»çš„æ¨¡å‹ï¼Œä»ä¸€ç¯‡æ–‡ç« ã€ä¸€ä¸ªè§†é¢‘ä¸­æç‚¼å‡ºå‡ ä¸ªæ ‡ç­¾ï¼Œå…¶ç»“æœæ˜¯è¶…çº§ç¨€ç–çš„ã€‚</p>
<p>è¿™å›æ‹¿æ¨¡å‹çš„<strong>æŸä¸€å±‚çš„è¾“å‡º</strong>ï¼Œå½“æˆç‰©æ–™ç‰¹å¾ï¼Œ<strong>å–‚å…¥ä¸Šå±‚æ¨¡å‹</strong>ã€‚å°½ç®¡è¿™ä¸ªå‘é‡ä¸å¦‚é‚£å‡ ä¸ªæ ‡ç­¾å¥½ç†è§£ï¼Œä½†æ˜¯å®ƒæœ‰32ä½æˆ–64ä½é‚£ä¹ˆé•¿ï¼Œé‡Œé¢è•´å«çš„ä¿¡æ¯è¦æ¯”å‡ ä¸ªæ ‡ç­¾ä¸°å¯Œä¸€äº›ã€‚</p>
<ul>
<li><strong>ç‰©æ–™çš„åŠ¨æ€ç”»åƒ</strong></li>
</ul>
<p>ç‰©æ–™çš„åŠ¨æ€ç”»åƒï¼ŒæŒ‡å®ƒä»¬çš„åéªŒç»Ÿè®¡æ•°æ®ï¼Œåæ˜ äº†ç‰©æ–™çš„å—æ¬¢è¿ç¨‹åº¦ï¼Œæ˜¯ç‰©æ–™ä¾§æœ€æœ€é‡è¦çš„ç‰¹å¾ã€‚ç‰©æ–™çš„åŠ¨æ€ç”»åƒå¯ä»¥ä»ä»¥ä¸‹ä¸¤ä¸ªç»´åº¦æ¥è¿›è¡Œåˆ»ç”»:</p>
<ul>
<li><p>æ—¶é—´ç²’åº¦:å…¨ç”Ÿå‘½å‘¨æœŸã€è¿‡å»ä¸€å‘¨ã€è¿‡å»1å¤©ã€è¿‡å»1å°æ—¶</p></li>
<li><p>ç»Ÿè®¡å¯¹è±¡: CTRã€å¹³å‡æ’­æ”¾è¿›åº¦ã€ å¹³å‡æ¶ˆè´¹æ—¶é•¿ã€æ’å</p></li>
<li><p><strong>ç”¨æˆ·ç»™ç‰©æ–™åå‘æ ‡ç­¾</strong></p></li>
</ul>
<p>å°†æ¶ˆè´¹è¿‡æŸä¸ªç‰©æ–™çš„ç”¨æˆ·èº«ä¸Šçš„æ ‡ç­¾ï¼Œä¼ é€’<strong>ç§¯ç´¯åˆ°è¿™ä¸ªç‰©æ–™èº«ä¸Šï¼Œä¸°å¯Œç‰©æ–™ç”»åƒ</strong>ã€‚</p>
<p>æ¯”å¦‚ä¸€ç¯‡å…³äºæŸè¶³çƒæ˜æ˜Ÿå…«å¦ç»¯é—»çš„æ–‡ç« ï¼Œç”±äºè¯¥çƒæ˜Ÿçš„åå­—å‡ºç°é¢‘ç¹ï¼ŒNLPç®—æ³•å¯èƒ½ä¼šç»™å®ƒæ‰“ä¸Š"ä½“è‚²"æ ‡</p>
<p>ç­¾ã€‚ä½†æ˜¯åéªŒæ•°æ®æ˜¾ç¤ºï¼Œå¸¦"ä½“è‚²"æ ‡ç­¾çš„ç”¨æˆ·ä¸å¤ªå–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œåè€Œå¸¦"å¨±ä¹"æ ‡ç­¾çš„ç”¨æˆ·æ›´å–œæ¬¢ï¼Œæ˜¾ç„¶è¿™</p>
<p>ç¯‡æ–‡ç« ä¹Ÿåº”è¯¥è¢«æ‰“ä¸Š"å¨±ä¹"çš„æ ‡ç­¾ã€‚ç±»ä¼¼çš„ï¼Œç»™ç‰©æ–™æ‰“ä¸Šè¯¸å¦‚"æ–‡é’å–œæ¬¢çš„ç”µå½±æ¦œç¬¬3å"ã€æˆ–è€…"æ•°ç è¿·æœ€å–œ</p>
<p>æ¬¢çš„æ‰‹æœº"è¿™æ ·çš„åå‘æ ‡ç­¾ï¼Œéƒ½åŒ…å«äº†éå¸¸é‡è¦çš„ä¿¡æ¯ï¼Œèƒ½å¤Ÿå¸®åŠ©æå‡æ¨¡å‹æ€§èƒ½ã€‚</p>
<h3 id="ç”¨æˆ·ç‰¹å¾">ç”¨æˆ·ç‰¹å¾</h3>
<ul>
<li><strong>ç”¨æˆ·çš„é™æ€ç”»åƒ</strong></li>
</ul>
<p>é™æ€ç”»åƒå°±æ˜¯äººå£å±æ€§(e.g.,
æ€§åˆ«ã€å¹´é¾„ã€èŒä¸šã€ç±è´¯)ã€ç”¨æˆ·å®‰è£…çš„APPåˆ—è¡¨ç­‰æ¯”è¾ƒç¨³å®šçš„æ•°æ®ä¿¡æ¯ã€‚</p>
<p>ç”±äºäº’è”ç½‘å¤§å‚çš„ä¸»æ‰“APPçš„å­˜é‡è€ç”¨æˆ·å±…å¤šï¼Œè¡Œä¸ºä¸°å¯Œï¼Œèƒ½å¤Ÿæä¾›è¶³å¤Ÿçš„è®­ç»ƒæ•°æ®ï¼Œå› æ­¤åœ¨å¤§å‚çš„å®è·µä¸­è¿˜æ˜¯éå¸¸å–œæ¬¢æ‹¿User
IDå½“ç‰¹å¾çš„ã€‚</p>
<ul>
<li><strong>ç”¨æˆ·çš„åŠ¨æ€ç”»åƒ</strong></li>
</ul>
<p>ç”¨æˆ·çš„åŠ¨æ€ç”»åƒå°±æ˜¯ä»ç”¨æˆ·çš„å†å²è¡Œä¸ºä¸­æå–å‡ºæ¥çš„ä»–çš„å…´è¶£çˆ±å¥½ã€‚</p>
<p>æœ€ç®€å•ç›´æ¥çš„åŠ¨æ€ç”»åƒå°±æ˜¯ï¼Œå°†ç”¨æˆ·ä¸€æ®µæ—¶é—´å†…ç”¨æˆ·äº¤äº’è¿‡çš„ç‰©æ–™çš„Item
IDæŒ‰æ—¶é—´é¡ºåºç»„æˆçš„é›†åˆã€‚å°†è¿™ä¸ªé›†åˆæ‰”è¿›æ¨¡å‹ï¼Œè®©æ¨¡å‹è‡ªåŠ¨ä»ä¸­æå–å‡ºç”¨æˆ·å…´è¶£ã€‚æœ€ç®€å•çš„æå–æ–¹å¼æ— éå°±æ˜¯å°†æ¯ä¸ªltemIDå…ˆEmbeddingï¼Œå†æŠŠå¤šä¸ªEmbeddingèšåˆ(ä¹Ÿç§°"æ± åŒ–"ï¼Œ
Poolingï¼Œæ¯”å¦‚é‡‡ç”¨åŠ å’Œæˆ–å¹³å‡)æˆä¸€ä¸ªå‘é‡ï¼Œè¿™ä¸ªå‘é‡å°±æ˜¯ç”¨æˆ·å…´è¶£çš„æŠ½è±¡è¡¨è¾¾ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152608785.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p>è‡³äºå¯ä»¥ç»Ÿè®¡å“ªäº›æŒ‡æ ‡æ¥åæ˜ ç”¨æˆ·å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹6ä¸ªç»´åº¦å±•å¼€ï¼Œåšåˆ°ä¸é‡ä¸æ¼ï¼š</p>
<ul>
<li>ç”¨æˆ·ç²’åº¦ï¼Œå¯ä»¥æ˜¯å•ä¸ªç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ç¾¤ç”¨æˆ·ã€‚é’ˆå¯¹ä¸€ä¸ªç”¨æˆ·ç¾¤ä½“çš„ç»Ÿè®¡ï¼Œæœ‰åˆ©äºæ–°ç”¨æˆ·å†·å¯ã€‚</li>
<li>æ—¶é—´ç²’åº¦ï¼Œæ¯”å¦‚æœ€è¿‘çš„100æ¬¡æ›å…‰ï¼Œå†æ¯”å¦‚è¿‡å»1å°æ—¶ã€1å‘¨ã€1æœˆã€‚</li>
<li>ç‰©æ–™å±æ€§ï¼Œæ¯”å¦‚è§†é¢‘çš„ä¸€äºŒçº§ç±»åˆ«ã€æ ‡ç­¾ã€ä½œè€…ï¼Œå†æ¯”å¦‚å•†å“çš„åˆ†ç±»ã€å“ç‰Œã€åº—é“ºã€ä»·ä½ã€‚</li>
<li>åŠ¨ä½œç±»å‹ï¼Œå¯ä»¥æ˜¯æ­£å‘çš„ï¼Œæ¯”å¦‚ç‚¹å‡»ã€ç‚¹èµã€è½¬å‘ç­‰ï¼Œä¹Ÿå¯ä»¥æ˜¯è´Ÿå‘çš„ï¼Œæ¯”å¦‚å¿½ç•¥ã€ç‚¹è¸©ã€‚</li>
<li>ç»Ÿè®¡å¯¹è±¡ï¼Œæ¯”å¦‚æ¬¡æ•°ã€æ—¶é•¿ã€é‡‘é¢ç­‰ã€‚</li>
<li>ç»Ÿè®¡æ–¹æ³•ï¼Œæ¯”å¦‚åŠ å’Œã€æ±‚å¹³å‡ã€è®¡ç®—å„ç§æ¯”ä¾‹ç­‰ã€‚</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Š6ä¸ªç»´åº¦çš„äº¤å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºä¸€ç³»åˆ—çš„ç»Ÿè®¡æŒ‡æ ‡æ¥åæ˜ ç”¨æˆ·åœ¨å„ä¸ªæ—¶é—´è·¨åº¦ã€å„ä¸ªç»´åº¦ä¸Šçš„å…´è¶£</p>
<h3 id="äº¤å‰ç‰¹å¾">äº¤å‰ç‰¹å¾</h3>
<p>DNNå¹¶éä¸‡èƒ½ï¼Œå…¶äº¤å‰èƒ½åŠ›ä¹Ÿæœ‰é™ï¼›å¦ä¸€æ–¹é¢ï¼Œæ‰‹åŠ¨äº¤å‰çš„ç‰¹å¾çŠ¹å¦‚åŠ å·¥å¥½çš„é£Ÿæï¼Œä¸ªä¸­ä¿¡æ¯æ›´å®¹æ˜“è¢«æ¨¡å‹æ¶ˆåŒ–å¸æ”¶ã€‚å› æ­¤ï¼Œåœ¨æ¨èæ¨¡å‹çš„æ·±åº¦å­¦ä¹ æ—¶ä»£ï¼Œäº¤å‰ç‰¹å¾ä¾ç„¶å¤§æœ‰å¯ä¸ºï¼Œå€¼å¾—é‡è§†ã€‚</p>
<p>åœ¨å…·ä½“äº¤å‰æ–¹å¼ä¸Šï¼Œåˆæœ‰åš<strong>"ç¬›å¡å°”ç§¯"</strong>ä¸åš<strong>"å†…ç§¯"</strong>ä¸¤ç§æ–¹å¼ã€‚</p>
<ul>
<li><strong>ç¬›å¡å°”ç§¯äº¤å‰</strong></li>
</ul>
<p>ç¬›å¡å°”äº¤å‰å°±æ˜¯å°†ä¸¤ä¸ªFieldå†…çš„Featureä¸¤ä¸¤ç»„åˆï¼Œç»„æˆä¸€ä¸ªæ–°çš„Fieldã€‚
æ¯”å¦‚ç”¨æˆ·æ„Ÿå…´è¶£çš„ç”µå½±ç±»åˆ«æœ‰{"åŠ¨ä½œç‰‡"ã€ç§‘å¹»ç‰‡"}ï¼Œè€Œå½“å‰å€™é€‰ç‰©æ–™çš„æ ‡ç­¾æ˜¯("æ–½ç“¦è¾›æ ¼"ã€"ç»ˆç»“è€…"
ã€"æœºå™¨äºº"}ï¼Œ
è¿™ä¸¤ä¸ªFieldåšç¬›å¡å°”äº¤å‰çš„ç»“æœå°±æ˜¯{"åŠ¨ä½œç‰‡+æ–½ç“¦è¾›æ ¼"ï¼Œâ€œåŠ¨ä½œç‰‡
+ç»ˆç»“è€…"ï¼Œ"åŠ¨ä½œç‰‡+æœºå™¨äºº"ï¼Œ
"ç§‘å¹»ç‰‡+æ–½ç“¦è¾›æ ¼"ï¼Œç§‘å¹»ç‰‡+ç»ˆç»“è€…"ï¼Œ"ç§‘å¹»ç‰‡+æœºå™¨äºº"}ï¼Œæ˜¾ç„¶"åŠ¨ä½œç‰‡+æ–½ç“¦è¾›æ ¼"ã€"ç§‘å¹»ç‰‡+æœºå™¨äºº"éƒ½æ˜¯éå¸¸å¼ºçƒˆçš„ä¿¡å·ï¼Œæœ‰åŠ©äºæ¨¡å‹åˆ¤æ–­ç”¨æˆ·ä¸ç‰©æ–™é—´çš„åŒ¹é…ç¨‹åº¦ã€‚</p>
<ul>
<li><strong>å†…ç§¯äº¤å‰</strong></li>
</ul>
<p>ç‚¹ç§¯ï¼Œå³é€‰å®šä¸€ä¸ªç”»åƒç»´åº¦(æ¯”å¦‚æ ‡ç­¾ã€åˆ†ç±»)ï¼Œå°†ç”¨æˆ·åœ¨è¿™ä¸ªç»´åº¦ä¸Šçš„å…´è¶£ï¼Œå’Œç‰©æ–™åœ¨è¿™ä¸ªç»´åº¦ä¸Šçš„å±æ€§ï¼Œæƒ³åƒæˆä¸¤ä¸ªç¨€ç–å‘é‡ï¼Œè¿™ä¸¤ä¸ªå‘é‡åšç‚¹ç§¯ç»“æœåæ˜ å‡ºç”¨æˆ·å’Œç‰©æ–™åœ¨è¿™ä¸ªç”»åƒç»´åº¦ä¸Šçš„åŒ¹é…ç¨‹åº¦ã€‚</p>
<p><strong>ç‚¹ç§¯ç»“æœè¶Šå¤§ï¼Œè¯´æ˜ç”¨æˆ·ä¸å€™é€‰ç‰©æ–™åœ¨è¿™ä¸ªç»´åº¦ä¸Šè¶ŠåŒ¹é…</strong>ã€‚</p>
<p>æ¯”å¦‚ç”¨æˆ·æ„Ÿå…´è¶£çš„æ ‡ç­¾æ˜¯Tagsuser ={"å¦å…‹": 0.8, "è¶³çƒ": 0.4ï¼Œ "äºŒæˆ˜":
0.6, "å°çƒ": -0.3}ï¼Œ
æ¯ä¸ªæ ‡ç­¾åé¢çš„æ•°å­—è¡¨ç¤ºç”¨æˆ·å¯¹è¿™ä¸ªæ ‡ç­¾çš„å–œçˆ±ç¨‹åº¦ï¼Œå¯ä»¥æ‹¿ç”¨æˆ·åœ¨è¿™ä¸ªæ ‡ç­¾ä¸Šçš„åéªŒæŒ‡æ ‡æ¥è¡¨ç¤ºï¼Œè€Œå½“å‰å€™é€‰ç‰©æ–™çš„æ ‡ç­¾æ˜¯Tagsitem
={"å¦å…‹": 1ï¼Œ "äºŒæˆ˜": 0.5ï¼Œ"ä¸€æˆ˜": 0.8}ã€‚
å°†Tagsuserä¸æ˜¯Tagsitem'åšç‚¹ç§¯ï¼Œä¹Ÿå°±æ˜¯å°†å…±åŒæ ‡ç­¾å¯¹åº”çš„åˆ†æ•°ç›¸ä¹˜å†ç›¸åŠ ï¼Œç»“æœæ˜¯1.3ï¼Œè¡¨ç¤ºç”¨æˆ·ä¸å½“å‰å€™é€‰ç‰©æ–™åœ¨"æ ‡ç­¾"è¿™ä¸ªç»´åº¦ä¸Šçš„åŒ¹é…ç¨‹åº¦ã€‚</p>
<h3 id="åå·®ç‰¹å¾">åå·®ç‰¹å¾</h3>
<ul>
<li>æ— æ³•åšåˆ°ç»å¯¹å…¬å¹³ï¼Œæ²¡ç‚¹å‡»ä¸ä»£è¡¨ä¸å–œæ¬¢ï¼Œç‚¹å‡»çš„æœªå¿…å–œæ¬¢ï¼Œåå·®Bias</li>
</ul>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=NDc4NmViNDYwODYxZTFmNmQzZmYyOTkyNjY4ZTI1NDFfelBIb0IxVUdYbWFmT3phcmx2QjJUU1ZlRFJDdXRlUlRfVG9rZW46VHRSbmJCV25sb2JUNnN4Y1BTT2Nab1BHbkdlXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li><strong>Above Click:</strong>
åªæœ‰åœ¨ç‚¹å‡»ç‰©æ–™ä¸Šæ–¹çš„æœªç‚¹å‡»çš„ç‰©æ–™æ‰è¢«å½“ä½œè´Ÿæ ·æœ¬ï¼Œæ²¡è¢«ç‚¹å‡»çš„ä¸”ä¸åœ¨ç‚¹å‡»ä¸Šæ–¹çš„å°±ä¸æ”¾è¿›è®­ç»ƒçš„é›†åˆä¸­ï¼Œå°±ä¸å½“æˆè®­ç»ƒæ ·æœ¬</li>
</ul>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=YTkyNjFmYTU2OTc1MjhhZjliYWMwNmVmZjNjMzk1MTBfV2wyaWRQWGV4MEMxSXBDam1UZlNNYnhVYTN4RTJKSEZfVG9rZW46UGNEVWJSWVU0b1FtMWF4MHpGVWNJNzlwbkVkXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œä¼šå°†è¿™ä¸ªåå·®ç‰¹å¾ä¸èƒ½å’Œæ­£å¸¸ç‰¹å¾ä¸€èµ·å–‚å…¥DNNï¼Œå¦åˆ™ä¼šæ”¹å˜æ’åºç»“æœ</li>
</ul>
<h2 id="æ•°æ®ç‰¹å¾å¤„ç†">æ•°æ®ç‰¹å¾å¤„ç†</h2>
<h3 id="å¤„ç†ç¼ºå¤±å€¼">å¤„ç†ç¼ºå¤±å€¼</h3>
<ul>
<li>è®­ç»ƒæ¨¡å‹æ¥é¢„æµ‹ç¼ºå¤±å€¼</li>
</ul>
<p>æ¯”å¦‚å¯¹äºæ–°ç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œåˆ©ç”¨æ¯”è¾ƒå®¹æ˜“è·å¾—çš„äººå£å±æ€§(æ¯”å¦‚æ€§åˆ«ã€å¹´é¾„ç­‰)é¢„æµ‹æ–°ç”¨æˆ·å¯¹æŸä¸ªå†…å®¹åˆ†ç±»ã€æ ‡ç­¾çš„å–œçˆ±ç¨‹åº¦(æ¯”å¦‚å¯¹æŸç±»å†…å®¹çš„CTR)ã€‚å†æ¯”å¦‚å¯¹äºæ–°ç‰©æ–™ï¼Œæˆ‘ä»¬å¯ä»¥è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œåˆ©ç”¨ç‰©æ–™çš„é™æ€ç”»åƒ(æ¯”å¦‚åˆ†ç±»ã€æ ‡ç­¾ã€å“ç‰Œã€ä»·ä½)é¢„æµ‹å®ƒçš„åŠ¨æ€ç”»åƒ(CTRã€
å¹³å‡è§‚çœ‹æ—¶é•¿ã€å¹³å‡é”€å”®é¢ç­‰)ã€‚</p>
<h3 id="æ ‡å‡†åŒ–å¤„ç†">æ ‡å‡†åŒ–å¤„ç†</h3>
<p>æ ‡å‡†åŒ–çš„ç›®çš„æ˜¯å°†ä¸åŒé‡çº²ã€ä¸åŒå–å€¼èŒƒå›´çš„æ•°å€¼ç‰¹å¾éƒ½å‹ç¼©åˆ°åŒä¸€ä¸ªæ•°å€¼èŒƒå›´å†…ï¼Œä½¿å®ƒä»¬å½¼æ­¤å¯æ¯”ã€‚æœ€å¸¸ç”¨çš„æ ‡å‡†åŒ–æ˜¯z-scoreæ ‡å‡†åŒ–</p>
<p><span class="math display">\[x^*=(x-\mu)/\sigma\]</span></p>
<ul>
<li>xæ˜¯æŸæ¡æ ·æœ¬åœ¨ç‰¹å¾Fçš„åŸå§‹å–å€¼ã€‚</li>
<li>Î¼ã€Ïƒåˆ†åˆ«æ˜¯ç‰¹å¾Fåœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„å‡å€¼å’Œæ ‡å‡†å·®ã€‚</li>
<li>x*æ˜¯æŸæ¡æ ·æœ¬åœ¨ç‰¹å¾Fçš„æ ‡å‡†åŒ–ç»“æœï¼Œç§°ä¸ºz-scoreã€‚</li>
</ul>
<p>æ ‡å‡†åŒ–æ•°æ®</p>
<ul>
<li>ç›®çš„ï¼šå°†ä¸åŒé‡çº²ã€ä¸åŒå–å€¼èŒƒå›´çš„æ•°å€¼å‹ç¼©åˆ°ä¸€ä¸ªæ•°å€¼èŒƒå›´å†…</li>
<li>æ ‡å‡†åŒ–z-scoreæ–¹æ³•ï¼š<span
class="math display">\[x^*=(x-\mu)/\sigma\]</span>åˆ†åˆ«æ˜¯å‡å€¼å’Œæ ‡å‡†å·®</li>
</ul>
<h3 id="æ•°æ®å¹³æ»‘ä¸æ¶ˆå">æ•°æ®å¹³æ»‘ä¸æ¶ˆå</h3>
<p>ç›®æ ‡ï¼š<strong>å…‹æœå°æ ·æœ¬çš„è´Ÿé¢å½±å“</strong>ï¼Œæé«˜è®¡ç®—ç»“æœçš„ç½®ä¿¡åŒºé—´</p>
<p>æ¨èç³»ç»Ÿä¸­ç»å¸¸è¦è®¡ç®—å„ç§æ¯”ç‡ä½œä¸ºç‰¹å¾ï¼Œæ¯”å¦‚ç‚¹å‡»ç‡ã€ç‚¹èµç‡ã€è´­ä¹°ç‡ã€å¤è´­ç‡ç­‰ã€‚è®¡ç®—è¿™äº›æ¯”ç‡æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ ·æœ¬å¤ªå°‘ï¼Œå¯¼è‡´è®¡ç®—ç»“æœä¸å¯ä¿¡ã€‚æ¯”å¦‚è®¡ç®—ä¸€ä»¶å•†å“ï¼Œ
åªè¢«æ›å…‰äº†ä¸€æ¬¡å¹¶è¢«è´­ä¹°äº†ï¼Œç”±æ­¤æˆ‘ä»¬å°±è¯´å®ƒçš„è´­ä¹°ç‡æ˜¯100%ï¼Œä»è€Œè®¤å®šå®ƒæ˜¯çˆ†æ¬¾ï¼Œåº”è¯¥å¤§åŠ›æ¨èï¼Œæ˜¾ç„¶è¿™æ˜¯ç«™ä¸ä½è„šçš„ã€‚ä¸ºå…‹æœå°æ ·æœ¬çš„è´Ÿé¢å½±å“ï¼Œæé«˜è®¡ç®—ç»“æœçš„ç½®ä¿¡æ°´å¹³ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨"å¨å°”é€ŠåŒºé—´å¹³æ»‘"ï¼š</p>
<p><span
class="math display">\[p^*=\frac{p+\frac{z^2}{2n}-z(\frac{p(1-p)}{n}+\frac{z^2}{4n^2})^{1/2}}{1+{2n}\frac{z^2}{n}}\]</span></p>
<ul>
<li>zæ˜¯ä¸€ä¸ªè¶…å‚ï¼Œä»£è¡¨å¯¹åº”æŸä¸ªç½®ä¿¡æ°´å¹³çš„z-scoreã€‚æ¯”å¦‚å½“æˆ‘ä»¬å¸Œæœ›è®¡ç®—ç»“æœæœ‰95%çš„ç½®ä¿¡æ°´å¹³æ—¶ï¼Œzåº”è¯¥</li>
</ul>
<p>ç­‰äº1.96ã€‚pæ˜¯ç”¨ç®€å•æ–¹æ³•è®¡ç®—å‡ºçš„æ¯”ç‡ã€‚æ¯”å¦‚å½“pä»£è¡¨ç‚¹å‡»ç‡æ—¶ï¼Œå°±æ˜¯æ‹¿ç‚¹å‡»æ ·æœ¬æ•°é™¤ä»¥æ›å…‰æ ·æœ¬æ•°ã€‚</p>
<ul>
<li><span
class="math display">\[p^*\]</span>æ˜¯å¹³æ»‘åçš„æ¯”ç‡ã€‚næ˜¯æ ·æœ¬æ•°é‡ã€‚</li>
</ul>
<h3 id="åˆ†æ¡¶ç¦»æ•£åŒ–">åˆ†æ¡¶ç¦»æ•£åŒ–</h3>
<p>åœ¨æ¨èæ¨¡å‹ä¸­ï¼Œä½¿ç”¨ç±»åˆ«ç‰¹å¾å…·æœ‰èƒ½æ›´å¥½åæ˜ éçº¿æ€§å…³ç³»ã€ä¾¿äºå­˜å‚¨ä¸è®¡ç®—ç­‰å¤šæ–¹é¢ä¼˜åŠ¿ï¼Œå› æ­¤åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢å°†<strong>å®æ•°ç‰¹å¾ç¦»æ•£æˆç±»åˆ«ç‰¹å¾</strong>ã€‚</p>
<p>ç¦»æ•£æ–¹æ³•å°±æ˜¯åˆ†æ¡¶ï¼Œå³å°†å®æ•°ç‰¹å¾çš„å€¼åŸŸåˆ’åˆ†ä¸ºè‹¥å¹²åŒºé—´ï¼Œåˆç§°ä¸º"æ¡¶"ï¼Œçœ‹å®æ•°ç‰¹å¾è½è¿›å“ªä¸ªæ¡¶ï¼Œå°±ä»¥é‚£ä¸ªæ¡¶çš„æ¡¶å·ä½œä¸ºç±»åˆ«ç‰¹å¾å€¼ã€‚æ¯”å¦‚ï¼ŒæŸç”¨æˆ·åœ¨æœ€è¿‘ä¸€å°æ—¶çœ‹äº†5ä¸ªè§†é¢‘ï¼Œå¦‚æœç”¨å®æ•°ç‰¹å¾æè¿°ï¼Œç‰¹å¾æ˜¯"æœ€è¿‘1å°æ—¶çœ‹çš„è§†é¢‘æ•°"ï¼Œç‰¹å¾å€¼æ˜¯5ã€‚è€Œå¦‚æœç¦»æ•£æˆç±»åˆ«ç‰¹å¾ï¼Œæ•´ä¸ªç‰¹å¾å¯ä»¥è¡¨ç¤ºæˆ"ast1hour_
<em>0</em> _10"è¿™
ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¯¥ç”¨æˆ·åœ¨æœ€è¿‘1å°æ—¶çœ‹çš„è§†é¢‘æ•°åœ¨0~10ä¹‹é—´ã€‚</p>
<p>åˆ†æ¡¶æœ‰ä¸‰ç§å®ç°æ–¹å¼:</p>
<ul>
<li>ç­‰å®½åˆ†æ¡¶:å³å°†ç‰¹å¾å€¼åŸŸå¹³å‡åˆ’åˆ†ä¸ºäº†Nç­‰ä»½,æ¯ä»½ç®—ä¸€ä¸ªæ¡¶ã€‚</li>
<li>ç­‰é¢‘åˆ†æ¡¶:å°†æ•´ä¸ªå€¼åŸŸçš„Nä¸ªåˆ†ä½æ•°(Percentile)
ä½œä¸ºå„æ¡¶çš„è¾¹ç•Œï¼Œä¿è¯è½å…¥å„ä¸ªæ¡¶çš„æ ·æœ¬ä¸ªæ•°å¤§è‡´è¦ç›¸ç­‰ã€‚</li>
<li>æ¨¡å‹åˆ†æ¡¶ï¼šå¯¹å®æ•°ç‰¹å¾Fåˆ†æ¡¶ï¼Œã€‚ç¬¬1é˜¶æ®µï¼Œå•ç‹¬æ‹¿ç‰¹å¾Fä¸ç›®æ ‡å€¼æ‹Ÿåˆä¸€æ£µç®€å•çš„å†³ç­–æ ‘ã€‚ç¬¬2é˜¶æ®µæ‰è¿›è¡Œåˆ†æ¡¶ï¼Œå°†æŸä¸ªç‰¹å¾ä¸­Fçš„å®æ•°å–å€¼få–‚è¿›å†³ç­–æ ‘ï¼Œfæœ€ç»ˆè½è¿›çš„é‚£ä¸ªå¶å­èŠ‚ç‚¹çš„ç¼–å·å°±æ˜¯fçš„ç¦»æ•£åŒ–ç»“æœã€‚</li>
</ul>
<h2 id="ç±»åˆ«ç‰¹å¾çš„å¤„ç†">ç±»åˆ«ç‰¹å¾çš„å¤„ç†</h2>
<p>é¦–å…ˆæ˜ç¡®ä¸€ä¸‹<strong>æ¨èç³»ç»Ÿçš„ç‰¹å¾ç©ºé—´ï¼šé«˜ç»´ã€ç¨€ç–</strong>çš„ç‰¹ç‚¹</p>
<h3 id="å¢å¼ºç±»åˆ«ç‰¹å¾è¡¨è¾¾">å¢å¼ºç±»åˆ«ç‰¹å¾è¡¨è¾¾</h3>
<ul>
<li>Embeddingè‡ªåŠ¨å­¦ä¹ å¹¶æ‹“å±•å†…æ¶µï¼Œå­¦ä¹ <strong>éšè¯­ä¹‰</strong>æ‹“å±•å•ä¸ªç‰¹å¾çš„å†…æ¶µï¼Œæ‰©å±•å•ä¸ªç‰¹å¾çš„å†…æ¶µ</li>
<li>å¤šç‰¹å¾äº¤å‰ï¼Œé€‰æ‹©ç”¨æˆ·å¤šä¸ªä¸åŒçš„<strong>ç‰¹å¾</strong>è¿›è¡Œäº¤å‰ä¸€æ¬¡æ¥å¢å¼ºç‰¹å¾çš„è¡¨è¾¾èƒ½åŠ›ï¼Œæ¯”å¦‚â€œ20å²â€å’Œâ€œç¨‹åºå‘˜â€çš„ç‰¹å¾äº¤å‰ï¼Œâ€œæ ¼å­è¡¬è¡«â€ä½œä¸ºæ¨èé€‰æ‹©</li>
</ul>
<h3 id="ç±»åˆ«ç‰¹å¾çš„é«˜ç»´æ€§">ç±»åˆ«ç‰¹å¾çš„é«˜ç»´æ€§</h3>
<ul>
<li>æ•°æ®ä½çš„å¾ˆé«˜ï¼Œéœ€è¦ä¸Šç™¾ä¸‡çš„æ ‡ç­¾ï¼Œå¤šç»´ç‰¹å¾äº¤å‰</li>
<li><strong>Parameter Serveræ¶æ„</strong>ç¼“è§£é«˜ç»´æ•°æ®çš„éš¾åº¦</li>
<li>åˆ†æ•£äº†å‚æ•°å­˜å‚¨æ£€ç´¢çš„å‹åŠ›ï¼Œé™ä½äº†å¸¦å®½èµ„æºä¸æ—¶é—´å¼€é”€</li>
</ul>
<h3 id="ç±»åˆ«ç‰¹å¾çš„ç¨€ç–">ç±»åˆ«ç‰¹å¾çš„ç¨€ç–</h3>
<ul>
<li>FTRLè‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡ï¼Œå¸¸è§çš„ç‰¹å¾å—è®­æœºä¼šå¤šï¼Œç½•è§ç‰¹å¾å—è®­æœºä¼šå°‘</li>
<li>DINæ¨¡å‹æå‡ºè‡ªé€‚åº”è°ƒæ•´æ­£åˆ™ç³»æ•°</li>
</ul>
<h3 id="ç‰¹å¾å¦‚ä½•è¡¨å¾">ç‰¹å¾å¦‚ä½•<strong>è¡¨å¾</strong></h3>
<ul>
<li>å»ºç«‹å­—ç¬¦ä¸²åˆ°æ•°å­—çš„æ˜ å°„è¡¨ï¼Œç¼ºç‚¹åœ¨äºéœ€è¦æ›´æ–°ç»´æŠ¤ä¸”å¯¹äºå¤§è§„æ¨¡è€Œè¨€æ¯”è¾ƒéš¾ä»¥è´Ÿæ‹…</li>
</ul>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=OTY4NDhmYTRiY2ViZGJjYWYxMDdjNWI0MTgwNDgyOWZfYjdCMmlkU2pKaHZNUEltNnBDTFBxTWQwTE5aaUVEZkZfVG9rZW46STBpMGJoa0lpb3k0SlR4M01Fa2NidWx5bnVkXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>ç‰¹å¾å“ˆå¸ŒFeature Hashing
<ul>
<li>Feature Hashingè´Ÿè´£å°†è¾“å…¥çš„å­—ç¬¦ä¸²æ˜ å°„æˆä¸€ä¸ª[0,
N)ä¹‹é—´çš„æ•´æ•°ï¼ŒNæ˜¯EmbeddingçŸ©é˜µçš„æ€»è¡Œæ•°ï¼Œæ˜ å°„å¾—åˆ°çš„æ•´æ•°ä»£è¡¨è¯¥ç±»åˆ«ç‰¹å¾çš„Embeddingåœ¨EmbeddingçŸ©é˜µä¸­çš„è¡Œå·ã€‚</li>
<li>Feature
Hashingå¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œå…ˆè®¡ç®—è¾“å…¥çš„å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œå†æ‹¿å“ˆå¸Œå€¼å¯¹EmbeddingçŸ©é˜µè¡Œæ•°Nå–ä½™æ•°ã€‚å½“ç„¶å®é™…å®ç°è¦æ›´å¤æ‚ä¸€äº›ï¼Œä»¥å‡å°‘å‘ç”Ÿ"å“ˆå¸Œå†²çª"
(Hash Collision)çš„å¯èƒ½æ€§ã€‚</li>
<li>åªè¦Embeddingçš„é•¿åº¦ç›¸åŒï¼Œè‹¥å¹²Fieldå¯ä»¥å…±äº«ä¸€ä¸ªFeature
Hashæ¨¡å—ä¸èƒŒåçš„EmbeddingçŸ©é˜µã€‚ç›¸æ¯”äºè®©å„ä¸ªFieldæ‹¥æœ‰ç‹¬ç«‹çš„EmbeddingçŸ©é˜µï¼Œè¿™ç§å…±äº«æ–¹å¼å¯¹ç©ºé—´çš„åˆ©ç”¨ç‡æ›´é«˜ï¼Œæ˜¯å¤§å‹æ¨èæ¨¡å‹çš„ä¸»æµä½œæ³•ã€‚</li>
</ul></li>
</ul>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWZhZjNlODk0MTAzM2I3YWI5NTIxNTJiNDUzZjc2ZTJfSzkyalBacmxtRVYyOWNxalpubmZGdDY2MUhYbEJWYkFfVG9rZW46RDA1dWJpQmhRb25mVWZ4Y3BncGNqd1FWbjBkXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h1 id="æ¨èç³»ç»Ÿçš„embedding">æ¨èç³»ç»Ÿçš„Embedding</h1>
<h2 id="embeddingçš„å¿…è¦æ€§"><strong>Embeddingçš„å¿…è¦æ€§</strong></h2>
<p>å¯¹äºæ¨èç³»ç»Ÿè€Œè¨€ï¼š<strong>è®°å¿†+æ‹“å±•</strong></p>
<p><strong>è®°å¿†</strong>èƒ½å¤Ÿå¤„ç†80%çš„éœ€æ±‚ï¼Œä½†æ˜¯ä¸ªæ€§åŒ–å¤ªå¼±ï¼ˆè¯„åˆ†ï¼‰</p>
<ul>
<li>Logistic Regression
èƒ½å¤Ÿå¾ˆå¥½çš„å®ç°è®°å¿†åŠŸèƒ½ï¼Œè®°ä½ä¸€äº›æ¯”è¾ƒç»å…¸çš„å…³è”æ ‡ç­¾</li>
<li>æ‰€æœ‰çš„æ¨¡å¼ï¼Œéƒ½ä¾èµ–äººå·¥è¾“å…¥ã€‚æ‰€ä»¥åœ¨æ¨èæ¨¡å‹çš„LRæ—¶ä»£ï¼Œç‰¹å¾ç¨‹æ—¢éœ€è¦åˆ›æ„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€é¡¹ä½“åŠ›æ´»ã€‚</li>
<li>LRæœ¬èº«å¹¶ä¸èƒ½å¤Ÿå‘æ˜å‡ºæ–°æ¨¡å¼ï¼Œå®ƒåªè´Ÿè´£è¯„ä¼°å„æ¨¡å¼çš„é‡è¦æ€§ã€‚è¿™ä¸ªé‡è¦æ€§æ˜¯é€šè¿‡å¤§é‡çš„å†å²æ•°æ®æ‹Ÿåˆå¾—åˆ°çš„ã€‚</li>
<li>LR
(è¯„åˆ†å¡)æ¨¡å‹ï¼Œå¼ºäºè®°å¿†ï¼Œä½†æ˜¯å¼±äºæ‰©å±•ã€‚ã€ä¸­å›½é¡¾å®¢æ¥äº†æ¨é¥ºå­ï¼Œç¾å›½å®¢æˆ·æ¥äº†æ¨.ç«é¸¡ï¼Œæ•ˆæœéƒ½ä¸é”™ï¼Œæ¯•ç«ŸLRè®°æ€§å¥½ã€‚ä½†æ˜¯ï¼Œå½“ä¸€ä¸ªä¸­å›½å®¢æˆ·æ¥äº†ï¼Œä½ çš„æ¨èç³»ç»Ÿä¼šç»™ä»–æ¨èä¸€åªç«é¸¡å—ï¼Ÿå¦‚æœä½ çš„æ¨èç³»ç»Ÿåªæœ‰LRï¼Œåªæœ‰è®°å¿†åŠŸèƒ½ï¼Œç­”æ¡ˆæ˜¯:ä¸ä¼šã€‚</li>
<li>å› ä¸º&lt;ä¸­å›½äººï¼Œç«é¸¡&gt;æ¯•ç«Ÿå±äºå°ä¼—æ¨¡å¼ï¼Œåœ¨å†å²æ ·æœ¬ç½•æœ‰å‡ºç°ï¼ŒLRçš„L1æ­£åˆ™ç›´æ¥å°†æ‰“åˆ†ç½®ä¸º0ï¼Œä»è€Œè¢«ä»è¯„åˆ†å¡ä¸­å‰”é™¤ã€‚</li>
</ul>
<p><strong>æ‹“å±•</strong>å°†ç»†ç²’åº¦å˜æˆç²—ç²’åº¦ï¼Œå€ŸåŠ©æ·±åº¦å­¦ä¹ çš„Embedding</p>
<ul>
<li>åœ¨è®­ç»ƒLRæ¨¡å‹çš„æ—¶å€™ï¼Œæ¯æ¡æ ·æœ¬é™¤äº†å°†åŸæ¥ç»†ç²’åº¦çš„æ¦‚å¿µ&lt;æ˜¥èŠ‚ï¼Œ
ä¸­å›½äººï¼Œé¥ºå­&gt;å’Œ&lt;æ„Ÿæ©èŠ‚ï¼Œç¾å›½äººï¼Œç«é¸¡&gt;ä½œä¸ºç‰¹å¾ï¼Œä¹Ÿå°†æ‰©å±•åçš„&lt;èŠ‚æ—¥ï¼Œå’ŒèŠ‚æ—¥ç›¸å…³çš„é£Ÿç‰©&gt;ä½œä¸ºç‰¹å¾ï¼Œä¸€åŒå–‚å…¥LRæ¨¡å‹ã€‚</li>
<li>è¿™æ ·è®­ç»ƒåçš„"è¯„åˆ†å¡"å·¥ä½œé‡å¤§ï¼ŒåŠ³ç¥è´¹åŠ›ã€‚æ¯”å¦‚é¥ºå­ã€ç«é¸¡è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œè¿˜èƒ½ä¸èƒ½ä»å…¶ä»–è§’åº¦æ‹†è§£ï¼Œä»è€Œå‘ç°æ›´å¤šçš„ç›¸ä¼¼æ€§?è¿™å°±è¦å—åˆ°å·¥ç¨‹å¸ˆçš„ä¸šåŠ¡æ°´å¹³ã€ç†è§£èƒ½åŠ›ã€åˆ›æ„æ°´å¹³çš„åˆ¶çº¦ã€‚</li>
<li>ä½¿ç”¨<strong>Embeddingå°±æ˜¯å¾ˆæœ‰å¿…è¦</strong>çš„</li>
</ul>
<h2 id="å…±äº«ç‹¬å embedding"><strong>å…±äº«/ç‹¬å Embedding</strong></h2>
<h3 id="å…±äº«embedding">å…±äº«Embedding</h3>
<p>æ‰€è°“å…±äº«Embeddingï¼Œæ˜¯æŒ‡åŒä¸€å¥—Embeddingè¦å–‚å…¥æ¨¡å‹çš„å¤šä¸ªåœ°æ–¹ï¼Œå‘æŒ¥å¤šä¸ªä½œç”¨ã€‚å…±äº«Embeddingçš„å¥½å¤„æœ‰äºŒï¼š</p>
<ul>
<li>èƒ½å¤Ÿç¼“è§£ç”±äºç‰¹å¾ç¨€ç–ã€æ•°æ®ä¸è¶³æ‰€å¯¼è‡´çš„è®­ç»ƒä¸å……åˆ†ã€‚</li>
<li>EmbeddingçŸ©é˜µä¸€èˆ¬éƒ½å¾ˆå¤§ï¼Œ å¤ç”¨èƒ½å¤ŸèŠ‚çœå­˜å‚¨ç©ºé—´ã€‚</li>
</ul>
<p>å†æ¯”å¦‚ï¼Œå¬å›æ¨¡å‹ä¸­çš„åŒå¡”æ¨¡å‹ä¾‹å­ï¼Œ</p>
<ul>
<li>Item ID Embeddingæ—¢æ˜¯é‡è¦çš„ç‰©æ–™ç‰¹å¾ï¼Œè¦å–‚å…¥ltem Towerï¼›</li>
<li>åŒæ—¶ï¼Œç”¨æˆ·è¡Œä¸ºåºåˆ—ä½œä¸ºæœ€é‡è¦çš„ç”¨æˆ·ä¾§ç‰¹å¾ï¼Œä¹Ÿæ˜¯ç”±ä¸€ç³»åˆ—çš„Item
IDç»„æˆï¼Œ å› æ­¤ltem ID Embeddingä¹Ÿè¦å–‚å…¥User Towerã€‚</li>
</ul>
<p>å¦‚æœé€‰æ‹©è®©å–‚å…¥User Towerå’ŒItem Towerçš„Item ID
Embeddingå…±äº«åŒä¸€ä¸ªEmbeddingçŸ©é˜µ,æ¨¡å‹ç»“æ„å¦‚å›¾</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152609558.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h3 id="ç‹¬å embedding">ç‹¬å Embedding</h3>
<p>å…±äº«Embeddingæœ€å¤§çš„ä¼˜ç‚¹ï¼Œå°±æ˜¯ç¼“è§£å› ä¸ºæ•°æ®ä¸è¶³è€Œå¯¼è‡´çš„ç¨€ç–ç‰¹å¾è®­ç»ƒä¸å……åˆ†çš„é—®é¢˜ã€‚ä½†æ˜¯å„äº’è”ç½‘å¤§å‚æœ€ä¸ç¼ºçš„å°±æ˜¯æ•°æ®ï¼Œè¿™æ—¶å…±äº«Embeddingçš„ç¼ºé™·å°±æš´éœ²å‡ºæ¥ï¼Œå³ä¸åŒç›®æ ‡åœ¨è®­ç»ƒåŒä¸€å¥—Embeddingæ—¶å¯èƒ½ç›¸äº’å¹²æ‰°ã€‚</p>
<p>ä¾‹å­ï¼šAPPçš„å®‰è£…ã€ å¯åŠ¨ã€å¸è½½ï¼Œå¯¹äºè¦å­¦ä¹ çš„APP
Embeddingæœ‰ç€ä¸åŒçš„è¦æ±‚ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œ"å®‰è£…"ä¸"å¯åŠ¨"ä¸¤ä¸ªFieldè¦æ±‚APP
Embeddingèƒ½å¤Ÿåæ˜ å‡ºAPPä¸ºä»€ä¹ˆèƒ½å¤Ÿæ‹›äººå–œæ¬¢ï¼Œè€Œ"å¸è½½"è¿™ä¸ªFieldè¦èƒ½å¤Ÿåæ˜ å‡ºAPPä¸ºä»€ä¹ˆæ‹›äººçƒ¦ï¼Œæ‰€ä»¥å¤§å‚ä¸€èˆ¬é€‰æ‹©è®©"è£…/å¯/å¸"ä¸‰ä¸ªFieldå„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„EmbeddingçŸ©é˜µã€‚</p>
<p>æ›´æœ‰ç”šè€…ï¼Œå¤§å‚çš„æ¨èç³»ç»Ÿéƒ½æ˜¯<strong>å¤šç›®æ ‡</strong>çš„ï¼Œæ¯”å¦‚è¦åŒæ—¶ä¼˜åŒ–ç‚¹å‡»ç‡ã€è´­ä¹°ç‡ã€è½¬å‘ç‡ã€....
ç­‰å¤šä¸ªç›®æ ‡ã€‚æœ‰ä¸€äº›é‡è¦ç‰¹å¾ï¼Œ
åœ¨å‚ä¸ä¸åŒç›®æ ‡çš„å»ºæ¨¡æ—¶ï¼Œä¹Ÿè¦ä½¿ç”¨ä¸åŒçš„Embeddingã€‚</p>
<ul>
<li>ä¸åŒçš„ä»»åŠ¡ä½¿ç”¨ä¸åŒçš„Embeddingçš„æ–¹æ³•</li>
<li>å¦‚æœåœ¨ç‰¹å¾äº¤å‰çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯å…±äº«Embeddingï¼Œä¼šäº§ç”Ÿ<strong>ç›¸äº’å¹²æ‰°</strong>çš„æƒ…å†µï¼ˆä¸åŒéœ€æ±‚è¦æ±‚ä¸åŒEmbeddingï¼‰</li>
<li>FFMç®—æ³•ï¼šæ¯ä¸ªç‰¹å¾åœ¨ä¸ä¸åŒç‰¹å¾äº¤å‰çš„æ—¶å€™ï¼Œæ ¹æ®å¯¹æ–¹ç‰¹å¾æ‰€å±çš„Fieldè¦ä½¿ç”¨ä¸åŒçš„Embedding</li>
<li>CANç®—æ³•ï¼šæ—¢è¦ä½¿ç”¨ä¸åŒçš„Embeddingè¿›è¡Œç‰¹å¾äº¤å‰ï¼Œä½†æ˜¯åˆä¸æƒ³è¦å¤ªå¤šçš„å‚æ•°å¯¼è‡´è®­ç»ƒçš„éš¾åº¦å¢åŠ </li>
</ul>
<h2 id="parameter-serverè®­ç»ƒæ¡†æ¶">Parameter Serverè®­ç»ƒæ¡†æ¶</h2>
<h3 id="ä¼ ç»Ÿçš„è®­ç»ƒæ–¹å¼">ä¼ ç»Ÿçš„è®­ç»ƒæ–¹å¼</h3>
<p>ä¼ ç»Ÿåˆ©ç”¨Hadoop/Sparkçš„åˆ†å¸ƒå¼è®­ç»ƒæ–¹æ³•å¿½ç•¥äº†<strong>é«˜ç»´ç¨€ç–ç‰¹å¾ç©ºé—´ï¼Œ</strong>ç›´æ¥è®©masterå¤„ç†ä¼šå‚æ•°é‡å¾ˆå¤§ï¼Œä¼ ç»Ÿçš„è®­ç»ƒæ–¹å¼ï¼š</p>
<ol type="1">
<li>å°†è®­ç»ƒæ•°æ®åˆ†æ•£åˆ°æ‰€æœ‰SlaveèŠ‚ç‚¹ã€‚</li>
<li>MasterèŠ‚ç‚¹å°†æ¨¡å‹çš„æœ€æ–°å‚æ•°å¹¿æ’­åˆ°æ‰€æœ‰SlaveèŠ‚ç‚¹ã€‚</li>
<li>æ¯ä¸ªSlaveèŠ‚ç‚¹æ”¶åˆ°æœ€æ–°çš„å‚æ•°åï¼Œç”¨æœ¬åœ°è®­ç»ƒæ•°æ®ï¼Œå…ˆå‰ä»£å†å›ä»£ï¼Œè®¡ç®—å‡ºæ¢¯åº¦å¹¶.ä¸Šä¼ è‡³Masterã€‚</li>
<li>MasterèŠ‚ç‚¹æ”¶é›†é½æ‰€æœ‰SlaveèŠ‚ç‚¹å‘æ¥çš„æ¢¯åº¦åï¼Œå¹³å‡ä¹‹ï¼Œå†ç”¨å¹³å‡åçš„æ¢¯åº¦æ›´æ–°æ¨¡å‹å‚æ•°ã€‚</li>
<li>å›åˆ°æ­¥éª¤1ï¼Œå¼€å§‹ä¸‹ä¸€è½®è®­ç»ƒã€‚</li>
</ol>
<p>"é«˜ç»´ç¨€ç–çš„ç‰¹å¾ç©ºé—´"ï¼Œé€ æˆäº†ä¸¤ä¸ªå›°éš¾:</p>
<ol type="1">
<li>æ¨èç³»ç»Ÿçš„ç‰¹å¾åŠ¨è¾„ä¸Šäº¿ã€ä¸Šåäº¿ï¼Œæ¯ä¸ªç‰¹å¾çš„Embeddingæ˜¯16ä½ã€
32ä½ç”šè‡³æ›´é•¿ï¼Œè¿™ä¹ˆå¤§çš„å‚æ•°é‡æ˜¯ä¸€å°Masteræ‰€å®¹çº³ä¸ä¸‹çš„ã€‚</li>
<li>æ¯è½®è®­ç»ƒä¸­ï¼ŒMasterèŠ‚ç‚¹éƒ½è¦å°†è¿™ä¹ˆå¤§çš„å‚æ•°é‡å¹¿æ’­åˆ°å„SlaveèŠ‚ç‚¹ï¼Œæ¯ä¸ªSlaveè¿˜è¦å°†ç›¸åŒå¤§å°çš„æ¢¯åº¦å›ä¼ ï¼Œå æ®çš„å¸¦å®½ã€é€ æˆçš„æ—¶å»¶ç»å¯¹è¾¾ä¸åˆ°åœ¨çº¿å®æ—¶è®­ç»ƒçš„éœ€æ±‚ã€‚</li>
</ol>
<h3 id="psè®­ç»ƒæ–¹å¼">PSè®­ç»ƒæ–¹å¼</h3>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=OWZlZWYzYTc2NTRjYWVlYWY1MTFlMzY3MzQ4NTMyZWFfTkpFUzNkRUlxcG1KRmx1UHpxVHNsNmJsb1Jyb3RHSDFfVG9rZW46U1FXbmI4UWg0b3E4eDd4Y1NpOWN5OFFFbmdjXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p>è®­ç»ƒæ­¥éª¤ï¼š</p>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=MzVjZGIwNGIwMWJjNGVlOGQ4ZTRlY2IzMjg2MTJhNGNfbWlFNEJSSlF2TUxyZkV2RHp0UHpIV1JqcHhYVXh2cjBfVG9rZW46UEVQYWI3NTF4b1ZvZ2h4QVB6a2N3S1hobkRkXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p>PSè®­ç»ƒæ¨¡å¼æ˜¯Data Parallelism(æ•°æ®å¹¶è¡Œ)å’ŒModel
Parallelism(æ¨¡å‹å¹¶è¡Œ)çš„è®¡ç®—èŒƒå¼çš„ç»“åˆï¼Œå…·ä½“çš„è®­ç»ƒæµç¨‹è§å¦‚ä¸‹å›¾ï¼š</p>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=NWY4MzVlZmE0ZDc1YTRiNjNiNGFmYjg1YmJmNjJhNzhfUVpxTkMzQVJyZ2VEa3BiSnhHZDhSODdMWEV1YUtZT1VfVG9rZW46TnpRbGJ0OHZibzBvaWd4Z0RhYmNqY01VbkZmXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h3 id="pså¹¶å‘ç­–ç•¥">PSå¹¶å‘ç­–ç•¥</h3>
<ul>
<li><strong>åŒæ­¥å¹¶å‘(BSP)</strong>
<ul>
<li><p>å„Workerå®Œæˆè‡ªå·±çš„æœ¬è½®è®¡ç®—ï¼Œå°†æ¢¯åº¦æ±‡æŠ¥ç»™Serverï¼Œç„¶åé˜»å¡ç­‰å¾…ã€‚</p></li>
<li><p>Serveråœ¨æ”¶é›†é½æ‰€æœ‰Workerä¸ŠæŠ¥çš„æ¢¯åº¦åï¼Œèšåˆæ¢¯åº¦ï¼Œç”¨SGDç®—æ³•æ›´æ–°è‡ªå·±è´Ÿè´£çš„é‚£éƒ¨åˆ†æ¨¡å‹å‚æ•°ã€‚</p></li>
<li><p>Serveré€šçŸ¥å„Workerè§£é™¤é˜»å¡ã€‚</p></li>
<li><p>Workeræ¥åˆ°è§£é™¤é˜»å¡çš„é€šçŸ¥ï¼Œä»Serveræ‹‰å–æ›´æ–°è¿‡çš„æ¨¡å‹å‚æ•°ï¼Œå¼€å§‹ä¸‹ä¸€è½®è®­ç»ƒã€‚</p></li>
<li><p>è¿™ç§æ¨¡å¼çš„ä¼˜ç‚¹æ˜¯ï¼Œå¤šä¸ªWorkerèŠ‚ç‚¹æ›´æ–°Serverï¼Œä¸Šçš„å‚æ•°æ—¶ä¸ä¼šå‘ç”Ÿå†²çªï¼Œæ‰€ä»¥åˆ†å¸ƒå¼è®­ç»ƒçš„æ•ˆæœèµåŒäºå•æœºè®­ç»ƒçš„æ•ˆæœã€‚ç¼ºç‚¹æ˜¯ï¼Œä¸€è½®è¿­ä»£ä¸­ï¼Œé€Ÿåº¦å¿«çš„èŠ‚ç‚¹è¦åœä¸‹æ¥ç­‰å¾…é€Ÿåº¦æ…¢çš„èŠ‚ç‚¹ï¼Œä»è€Œå½¢æˆäº†"çŸ­æ¿æ•ˆåº”"ï¼Œæ…¢èŠ‚ç‚¹å°±èƒ½æ‹–ç´¯æ•´ä¸ªé›†ç¾¤çš„è®¡ç®—é€Ÿåº¦ã€‚</p></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=YWZkM2ZmNTFlM2RiNTkyMmEzNjExYzM1NWViMzQ0OTFfY1pQcUF6SnJDOTNGTUk2ODB6RlNicnNTWnRRdmRFSGFfVG9rZW46SHd2RmJHTG1Lb1hwRHp4ZmRhWmNObGVxbmhkXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
</ul></li>
<li><strong>å¼‚æ­¥å¹¶å‘(ASP)</strong>
<ul>
<li><p>ASPåœ¨æ¯å°workeræ¨é€å®Œè‡ªå·±çš„æ¢¯åº¦ä¹‹å’Œï¼Œä¸ç”¨ç­‰å¾…å…¶ä»–workerï¼Œå°±å¯ä»¥å¼€å§‹è®­ç»ƒä¸‹ä¸€ä¸ªbatchçš„æ•°æ®ï¼Œæ²¡æœ‰çŸ­æ¿æ•ˆåº”</p></li>
<li><p>ä½†æ˜¯ç”±äºç¼ºä¹åŒæ­¥æ§åˆ¶ï¼ŒASPå¯ èƒ½å‘ç”Ÿ"æ¢¯åº¦å¤±æ•ˆ" (Stale
Gradient)çš„é—®é¢˜ï¼Œä»è€Œå½±å“æ”¶æ•›é€Ÿåº¦ã€‚ä¸¾ä¸€ä¸ªæåº¦ç®€åŒ–çš„ä¾‹å­ï¼š</p></li>
<li><p>å½“å‰Serverç«¯ ä¸Šæ¨¡å‹å‚æ•°çš„ç‰ˆæœ¬æ˜¯<span
class="math display">\[\theta_0\]</span>ï¼Œæœ‰ä¸¤ä¸ªWorkerèŠ‚ç‚¹ï¼Œéƒ½ä»Serveræ‹‰å–<span
class="math display">\[\theta_0\]</span>ï¼ŒåŒæ—¶å¼€å§‹ä¸€è½®è®­ç»ƒã€‚</p></li>
<li><p>Worker
1çš„é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œå¾ˆå¿«è®­ç»ƒå®Œæœ¬åœ°æ•°æ®å¹¶å‘Serverä¸ŠæŠ¥æ¢¯åº¦g1ã€‚</p></li>
<li><p>Serveræ”¶åˆ°g1åï¼Œæ ¹æ®SGDç®—æ³•è¿­ä»£ä¸€ æ­¥(æ­¥é•¿ä¸º<span
class="math display">\[\lambda\]</span>)ï¼Œå°†Serverç«¯çš„å‚æ•°å€¼ç”±<span
class="math display">\[\theta_0\]</span>æ›´æ–°ä¸º<span
class="math display">\[\theta_1=\theta_0-g_1\]</span>ã€‚</p></li>
<li><p>æ­¤æ—¶Worker 2æ‰å®Œæˆè®¡ç®—å¹¶å‘ServeræŠ¥äº†è‡ªå·±çš„æ¢¯åº¦g2ã€‚</p></li>
<li><p>Serveræ”¶åˆ°g2åï¼Œå¦‚æœåƒ<span
class="math display">\[\theta_2=\theta_1-\lambda
g_2\]</span>è¿™æ ·æ›´æ–°æ¨¡å‹å‚æ•°ï¼Œåè€Œå¯èƒ½æŸå®³æ”¶æ•›ã€‚è¿™æ˜¯å› ä¸ºg2æ˜¯Worker
2åŸºäº<span
class="math display">\[\theta_0\]</span>è®¡ç®—å¾—åˆ°çš„ï¼Œè€ŒServerç«¯çš„å‚
æ•°æ­¤æ—¶å·²ç»å˜æˆäº†<span
class="math display">\[\theta_1\]</span>ï¼Œg2å·²ç»å¤±æ•ˆã€‚</p></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=YTg1NzdmM2Q5ZDk5ZTQzODQyMGQ3Njc3ZThkODNmMmRfMVd1a1A4cGFOTkhtUVo5Q2pFRkdLc1BwSFhWbkZvRFpfVG9rZW46SDJ6Q2JpYUQ5b1BWSFp4MjZ0ZGNwUjkybktjXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
</ul></li>
</ul>
<p>å¾—ç›Šäºæ¨èç³»ç»Ÿä¸­çš„<strong>ç‰¹å¾è¶…çº§ç¨€ç–</strong>çš„ç‰¹ç‚¹ï¼Œåœ¨ä¸€è½®è¿­ä»£ä¸­ï¼Œå„ä¸ªWorkerèŠ‚ç‚¹çš„å±€éƒ¨è®­ç»ƒæ•°æ®æ‰€åŒ…å«çš„éé›¶ç‰¹å¾ï¼Œç›¸äº’é‡å å¾—å¹¶ä¸ä¸¥é‡ã€‚å¤šä¸ªWorkerèŠ‚ç‚¹åŒæ—¶æ›´æ–°åŒä¸€ä¸ªç‰¹å¾çš„å‚æ•°çš„å¯èƒ½æ€§éå¸¸å°ï¼Œæ‰€ä»¥Serverç«¯
çš„å†²çªä¹Ÿå°±æ²¡æœ‰é‚£ä¹ˆé¢‘ç¹å’Œä¸¥é‡ï¼ŒASPæ¨¡å¼åœ¨æ¨èç³»ç»Ÿä¸­ä¾ç„¶æ¯”è¾ƒå¸¸ç”¨çš„ã€‚</p>
<ul>
<li><strong>åŠåŒæ­¥åŠå¼‚æ­¥å¹¶å‘(SSP)</strong></li>
</ul>
<p>åŠåŒæ­¥åŠå¼‚æ­¥(Staleness Synchronous Parallel, SSP) æ˜¯BSPä¸
ASPçš„æŠ˜è¡·æ–¹æ¡ˆã€‚SSPå…è®¸å„WorkerèŠ‚ç‚¹åœ¨ä¸€å®šè¿­ä»£è½®æ•°ä¹‹å†…ä¿æŒå¼‚æ­¥ã€‚å¦‚æœå‘ç°æœ€å¿«WorkerèŠ‚ç‚¹ä¸æœ€æ…¢WorkerèŠ‚ç‚¹çš„è¿­ä»£æ­¥æ•°ä¹‹å·®å·²ç»è¶…è¿‡äº†å…è®¸çš„æœ€å¤§å€¼ï¼Œæ‰€æœ‰Workeréƒ½è¦åœä¸‹æ¥è¿›è¡Œä¸€æ¬¡<strong>å‚æ•°åŒæ­¥</strong>ã€‚SSPå¸Œæœ›é€šè¿‡æŠ˜è¡·ï¼Œå®ç°"è®¡ç®—æ•ˆç‡"ä¸"æ”¶æ•›ç²¾åº¦"ä¹‹é—´çš„å¹³è¡¡ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152610714.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h1 id="å†·å¯åŠ¨">å†·å¯åŠ¨</h1>
<p>æ¨èç³»ç»Ÿçš„å†·å¯é—®é¢˜æ˜¯æŒ‡ï¼š
é’ˆå¯¹<strong>è¾ƒå°‘æ¶ˆè´¹è®°å½•</strong>çš„æ–°ç”¨æˆ·ã€æ–°ç‰©æ–™çš„æ¨èã€‚å£°æ˜ä¸€ä¸‹,
æœ¬ç« æåˆ°çš„æ–°ç”¨æˆ·ï¼Œæ—¢åŒ…æ‹¬é‚£äº›åˆæ¬¡ä½¿ç”¨APPã€æ²¡æœ‰ä»»ä½•å†å²è¡Œä¸ºçš„çº¯æ–°ç”¨æˆ·ï¼Œä¹ŸåŒ…æ‹¬é‚£äº›è™½ç„¶APPå®‰è£…äº†å¾ˆä¹…ã€ä½†å¶å°”ä½¿ç”¨çš„ä½æ´»è·ƒç”¨æˆ·ã€‚æ–°ç‰©æ–™çš„å®šä¹‰ä¹Ÿç±»ä¼¼ã€‚</p>
<p>å†·å¯æ˜¯å›°æ‰°æ¨èç³»ç»Ÿçš„ä¸€å¤§éš¾é¢˜ã€‚</p>
<ul>
<li>ä¸€æ–¹é¢, å†·å¯éå¸¸é‡è¦ã€‚å¯¹æ–°ç”¨æˆ·è€Œè¨€, ç°åœ¨äº’è”ç½‘è¡Œä¸šç«äº‰æ¿€çƒˆ,
æ‹‰æ–°ã€è·å®¢æˆæœ¬å±…é«˜ä¸ä¸‹, å¥½ä¸å®¹æ˜“æ‹‰æ¥çš„æ–°ç”¨æˆ·,
å¦‚æœæ¨¡å‹æ‰¿æ¥åšå¾—ä¸å¥½è€Œè®©å…¶æµå¤±æ‰, å‰é¢çš„åŠªåŠ›ä¹Ÿå°±ç™½ç™½æµªè´¹äº†;
å¯¹æ–°ç‰©æ–™è€Œè¨€,æ–°ç‰©æ–™æ¨èä¸å‡ºå», æ—¢ä¼šè®©ç”¨æˆ·å¤±å»æ–°é²œæ„Ÿè€ŒåŠ é€Ÿæµå¤±,
ä¹Ÿä¼šæ‰“å‡»åˆ›ä½œè€…çš„ç§¯ææ€§, ä¸åˆ©äºå»ºç«‹è‰¯å¥½çš„å†…å®¹ç”Ÿæ€ã€‚</li>
<li>å¦ä¸€æ–¹é¢, å†·å¯åˆç›¸å½“å›°éš¾ã€‚æ¯•ç«Ÿ"å·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Š", å†å¼ºå¤§çš„æ¨¡å‹,
æ²¡æœ‰ä¿¡æ¯å–‚è¿›å», ä¹Ÿå‘æŒ¥ä¸å‡ºä»€ä¹ˆä½œç”¨ã€‚è€Œä¸”,
å¾ˆå¤šç»å…¸çš„æ¨èç®—æ³•ä»æ ¹æœ¬ä¸Šå°±ä¸æ”¯æŒæ–°ç”¨æˆ·ä¸æ–°ç‰©æ–™, æ¯”å¦‚Item <span
class="math display">\[2 \mathrm{Vec\]</span>
å¯¹ä¸æ›¾åœ¨è®­ç»ƒé›†ä¸­å‡ºç°çš„ç‰©æ–™å°±æ— æ³•è·å¾—å…¶Embedding,
æ¯”å¦‚DIN/SIMè¦å¯¹ç”¨æˆ·å†å²è¡Œä¸ºåºåˆ—åšAttention,
åœ¨æ–°ç”¨æˆ·èº«ä¸Šä¹Ÿå°±æ²¡æœ‰äº†ç”¨æ­¦ä¹‹åœ°ã€‚</li>
</ul>
<p>æ—¢ç„¶å†·å¯æ˜¯å¦‚æ­¤é‡è¦ä¸”è‰°å·¨,
ä¸šç•Œæ¶Œç°å‡ºäº†è®¸å¤šæ–¹æ³•æ¥åº”å¯¹è¿™ä¸€éš¾é¢˜ã€‚å…¶ä¸­ä¸ä¹ä¸€äº›ç®€å•ã€ç»å…¸çš„ç­–ç•¥,æ¯”å¦‚:</p>
<ul>
<li>ç»™æ–°ç”¨æˆ·æ¨èå…¨ç½‘æœ€çƒ­é—¨çš„ç‰©æ–™ã€‚</li>
<li>ä¸ä¾èµ–æ¶ˆè´¹è®°å½•, é‡è§†ä½¿ç”¨åŸºæœ¬å±æ€§ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„æ€§åˆ«ä¸å¹´é¾„,
ç‰©æ–™çš„åˆ†ç±»ä¸æ ‡ç­¾ï¼‰ã€‚</li>
</ul>
<h2 id="ä»£è¡¨ç®—æ³•">ä»£è¡¨ç®—æ³•</h2>
<ol type="1">
<li><p>Banditç®—æ³•</p>
<ol type="1">
<li><p><strong>å¤šè‡‚è€è™æœºé—®é¢˜ï¼šæœ¬è´¨å°±æ˜¯å¹³è¡¡æ¢ç´¢å’Œåˆ©ç”¨</strong></p></li>
<li><p>å¤šè‡‚è€è™æœºé—®é¢˜ä¸"å†·å¯åŠ¨"é—®é¢˜æ˜¯éå¸¸ç›¸ä¼¼çš„:</p></li>
<li><ul>
<li>å¯¹äºæ–°ç”¨æˆ·å†·å¯åŠ¨, æ¯ä¸ªæ–°ç”¨æˆ·å°±æ˜¯ä¸€å°è€è™æœº,
æ¯ä¸ªå…´è¶£å¤§ç±»ï¼ˆæ¯”å¦‚ï¼šç”µå½±ã€éŸ³ä¹ã€å†›äº‹ã€ä½“è‚²ã€......)
å°±æ˜¯è€è™æœºçš„ä¸€ä¸ªæ‰‹æŸ„ã€‚å‘è¯¥æ–°ç”¨æˆ·å±•ç¤ºæŸä¸ªå…´è¶£ç±»ç›®ä¸‹çš„ç‰©æ–™,
ç›¸å½“äºæ‹‰åŠ¨æŸä¸€æ ¹æ‰‹æŸ„ã€‚ç”¨æˆ·çš„åé¦ˆï¼ˆæ¯”å¦‚ç‚¹å‡»ï¼‰çŠ¹å¦‚è€è™æœºåå‡ºçš„é‡‘å¸ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡æœ‰é™æ¬¡è¯•æ¢,
ä½¿å¾—åˆ°çš„ç”¨æˆ·æ­£åé¦ˆæœ€å¤§åŒ–ï¼Œä¹Ÿå°±æ‘¸æ¸…äº†ç”¨æˆ·å…´è¶£ï¼Œä½¿ç”¨æˆ·è·å¾—äº†è‰¯å¥½çš„åˆä½“éªŒï¼Œå¢å¼ºAPPå¯¹æ–°ç”¨æˆ·çš„ç²˜æ€§ã€‚</li>
<li>å¯¹äºæ–°ç‰©æ–™å†·å¯åŠ¨, æ‰€æœ‰ç”¨æˆ·ç»„æˆä¸€å°è€è™æœº,
å€™é€‰æ–°å“æ± ä¸­çš„æ¯ä¸ªæ–°ç‰©æ–™ç›¸å½“äºä¸€æ ¹æ‰‹æŸ„ã€‚æ›å…‰æŸä¸ªæ–°ç‰©æ–™ç›¸å½“äºæ‹‰åŠ¨ä¸€æ¬¡æ‰‹æŸ„ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡æœ‰é™æµé‡çš„è¯•æ¢,
æ‰¾åˆ°æ–°å“æ± ä¸­æœ€ä¼˜è´¨çš„å€™é€‰ç‰©æ–™,
çŠ¹å¦‚åœ¨å¤šè‡‚è€è™æœºä¸­æ‰¾åˆ°é‚£æ ¹èƒ½åå‡ºæœ€å¤šé‡‘å¸çš„æ‰‹æŸ„ã€‚</li>
</ul></li>
<li><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿé‰´MABé—®é¢˜çš„æˆç†Ÿç®—æ³•æ¥è§£å†³æ¨èç³»ç»Ÿä¸­çš„å†·å¯åŠ¨é—®é¢˜ã€‚</p></li>
<li><p>MABé—®é¢˜æœ€æœ´ç´ ã€æœ€åˆçº§çš„è§£æ³•å°±æ˜¯å°†Næ¬¡å°è¯•åˆ’åˆ†æˆ"æ¢ç´¢ï¼ˆExploreï¼‰"ä¸"å¼€å‘ï¼ˆExploitï¼‰"å…ˆåä¸¤ä¸ªé˜¶æ®µ:</p></li>
<li><ul>
<li>å…ˆ"æ¢ç´¢", ä¹Ÿå°±æ˜¯å°†æ¯ä¸ªæ‰‹æŸ„éƒ½æ‹‰åŠ¨ $<span class="math display">\[$
æ¬¡ã€‚ç»Ÿè®¡ \]</span>{R}(i<span class="math display">\[ ä¸ºæ‹‰åŠ¨ç¬¬
\]</span><span class="math display">\[ æ ¹æ‰‹æŸ„ \]</span>$$
æ¬¡å¾—åˆ°çš„å¹³å‡æ”¶ç›Šã€‚</li>
<li>å†"å¼€å‘", æ‰¾åˆ°å¹³å‡æ”¶ç›Šæœ€å¤§çš„é‚£æ ¹æ‰‹æŸ„ <span
class="math display">\[a_{\max }=\operatorname{argmax}_i
\bar{R}(i)\]</span>ï¼Œç„¶åå°†å‰©ä½™çš„æœºä¼šå…¨éƒ¨ç”¨æ¥æ‹‰åŠ¨ <span
class="math display">\[a_{\max \text { ã€‚ }\]</span></li>
</ul></li>
<li><p><strong>Epsilon Greedy</strong></p></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=NGQ4NDMwYWRiYjEzNmFiOWFlYWU0Njg4Nzc5NmYyMzNfcjFCdjlnVXBkQ3dDV01SeUJHR2NSdmdvYWw2WmNrV2ZfVG9rZW46Tk1JWmJ0ckZLb0lHRFV4NDk2bWN0ZnJ1bk5kXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><p><strong>UCBç®—æ³•ï¼Œæ¯æ¬¡å°è¯•éƒ½é€‰æ‹©æ”¶ç›Šæœ€é«˜çš„</strong></p></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=Yzk4YTNjNGYzM2U0ZjYxY2RlMGE5ZDRmY2QxNzg4MTlfSUVXcXRDVGNtNVpRWG5TbGtZa1JMVWZxTkRIcWczVTNfVG9rZW46UE9IUmJvd3F1b1JRWWV4eTRHQ2NYRURibmcyXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><p>ç¬¬ $$$$æ ¹æ‰‹æŸ„çš„æ”¶ç›Šä¸Šé™ï¼Œå¦‚å…¬å¼æ‰€ç¤ºã€‚</p></li>
<li><p><span class="math display">\[U C B(i)=\bar{R}(i)+c \sqrt{\frac{2
\log N}{n_i}}\]</span></p></li>
<li><ul>
<li><span class="math display">\[\bar{R}(i\]</span> è¡¨ç¤ºç¬¬
$$$$æ ¹æ‰‹æŸ„çš„å¹³å‡æ”¶ç›Š</li>
<li><span class="math display">\[\sqrt{\frac{2 \log N}{n_i}\]</span>
è¡¨ç¤ºç¬¬ $<span class="math display">\[$æ ¹æ‰‹æŸ„çš„æ”¶ç›Šçš„ä¸ç¡®å®šæ€§ã€‚
\]</span><span class="math display">\[ æ˜¯åˆ°ç›®å‰ä¸ºæ­¢ä¸€å…±å°è¯•çš„æ€»æ¬¡æ•°,
\]</span>n_<span class="math display">\[ æ˜¯å…¶ä¸­æ‹‰åŠ¨ç¬¬ \]</span><span
class="math display">\[æ ¹æ‰‹æŸ„çš„æ¬¡æ•°ã€‚å¯è§, \]</span>n_<span
class="math display">\[ è¶Šå°, å³ç¬¬
\]</span>$$æ ¹æ‰‹æŸ„å°è¯•å¾—è¶Šå°‘ï¼Œå…¶æ”¶ç›Šçš„ä¸ç¡®å®šæ€§è¶Šé«˜, ä¹Ÿå°±æ˜¯æ½œåŠ›è¶Šå¤§,
å°è¯•çš„æœºä¼šä¹Ÿå°±åº”è¯¥å¢åŠ ã€‚</li>
<li>$$$$ è¡¨ç¤º"æ”¶ç›Šå‡å€¼"ä¸"æ”¶ç›Šæ½œåŠ›"ä¹‹é—´çš„è°ƒèŠ‚æƒé‡, å’ŒDecay Epsilon
Greedyä¸€æ ·, cä¹Ÿéšæ—¶é—´è¡°å‡ï¼ŒåæœŸ"æ¢ç´¢"åº”è¯¥é™ä½ï¼Œè€Œä¸»è¦ä»¥"å¼€å‘"ä¸ºä¸»ã€‚</li>
</ul></li>
<li><p>ä»å…¬å¼(8-1)å¯ä»¥çœ‹å‡º, ä¸€æ ¹æ‰‹æŸ„çš„æ”¶ç›Šä¸Šé™é«˜,
åªæœ‰ä¸¤ç§å¯èƒ½æ€§ï¼š</p></li>
<li><ul>
<li>è¦ä¹ˆæ˜¯è¿™æ ¹æ‰‹æŸ„çš„å¹³å‡æ”¶ç›Šé«˜ã€‚æ­¤æ—¶, é€‰æ‹©ä¸Šé™æœ€é«˜çš„æ‰‹æŸ„,
å°±æ˜¯åœ¨<strong>"å¼€å‘"</strong>ã€‚</li>
<li>è¦ä¹ˆæ˜¯è¿™æ ¹æ‰‹æŸ„çš„æ”¶ç›Šæ½œåŠ›é«˜ã€‚æ­¤æ—¶, é€‰æ‹©ä¸Šé™æœ€é«˜çš„æ‰‹æŸ„,
å°±æ˜¯åœ¨<strong>"æ¢ç´¢"</strong>ã€‚</li>
</ul></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=YzJjNWYwNDQ1ZGRjMDA4Y2M1YzQxOWJlZjI4YWFhNTBfb1gxQ1kxQ0lkek1nSVJpWnM2UDNqY2M2MXU5ZnRsSFdfVG9rZW46UjVMemJ5MklIb0JWVWd4MjdzR2NPTTlLbnFiXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><p><strong>Bayesian Bandit</strong></p></li>
<li><p>åŸºäºBayesiançš„MABé—®é¢˜æ±‚è§£æ–¹æ³•å¦‚ä¸‹:</p></li>
<li><ul>
<li>å‡å®šç¬¬ $<span class="math display">\[$ æ ¹æ‰‹æŸ„çš„å¹³å‡æ”¶ç›Šéµå¾ªå…ˆéªŒæ¦‚ç‡
\]</span>p({R}(i)$$</li>
<li>ç»è¿‡è‹¥å¹²æ¬¡å®éªŒ, ç¬¬ $<span class="math display">\[$
æ ¹æ‰‹æŸ„æ”¶åˆ°ä¸€æ‰¹åé¦ˆ \]</span>D_i={r_1, r_2, , r_{n_i}$$</li>
<li>æ ¹æ®Bayeså…¬å¼, ç¬¬ $<span class="math display">\[$
æ ¹æ‰‹æŸ„çš„å¹³å‡æ”¶ç›Šçš„åéªŒæ¦‚ç‡
-    \]</span>p({R}(i) D_i) p(D_i {R}(i)) p({R}(i)$$</li>
<li>æ­¤æ—¶è®©æˆ‘ä»¬é€‰æ‹©æ‰‹æŸ„æ—¶,
æˆ‘ä»¬åªéœ€è¦ä»å„æ‰‹æŸ„æ”¶ç›Šçš„åéªŒæ¦‚ç‡ä¸­éšæœºé‡‡æ ·ä¸€ä¸ªæ•°å­—,
ç„¶åé€‰æ‹©é‡‡æ ·æ•°å­—æœ€å¤§çš„é‚£æ ¹æ‰‹æŸ„å»æ‹‰åŠ¨å³å¯ã€‚</li>
</ul></li>
<li><p>å½“å„æ‰‹æŸ„çš„æ”¶ç›Šé 0 å³ 1 ï¼ˆè¿™ä¸€ç‚¹éå¸¸é€‚ç”¨äºæ¨èåœºæ™¯,
æ¯”å¦‚ç‚¹å‡»ä¸å¦ï¼‰æ—¶,
æˆ‘ä»¬å¯ä»¥ç”¨Bernoulliåˆ†å¸ƒæ¥æè¿°ã€‚è€Œè¿™ä¸ªBernoulliçš„å‡å€¼ï¼ˆå³æ¯æ ¹æ‰‹æŸ„çš„å¹³å‡æ”¶ç›Šï¼‰å¯ä»¥ç”¨Bernoulliåˆ†å¸ƒçš„å…±è½­åˆ†å¸ƒBetaåˆ†å¸ƒæ¥æè¿°ï¼Œå¥½å¤„æ˜¯å…ˆéªŒåˆ†å¸ƒä¸åéªŒåˆ†å¸ƒéƒ½éµå¾ªåŒæ ·çš„å½¢å¼ï¼Œæ–¹ä¾¿Bayeså…¬å¼çš„è®¡ç®—ã€‚è¿™ç§Bayesian
Banditç®—æ³•è¢«ç§°ä¸º Thompson Sampling, å¯ç”¨äºè¯•æ¢æ–°ç”¨æˆ·çš„å…´è¶£åˆ†å¸ƒ,
å¦‚ä»£ç ä»£ç  8-3æ‰€ç¤ºã€‚</p></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDUyYmY4NzU1MGI4NTU2MjA3M2JkNTA0MDY1MjE5MjRfWEtZUWhSbU9xaUw1VkRyT0VoOEo1RnJxa2ZwWDROZUlfVG9rZW46U1p3NGJFNFNpb2dkSzN4dzhrVGNTTTI2bk1kXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><ul>
<li>å°†æ¯ä¸ªæ–°ç”¨æˆ·è®¾æƒ³æˆä¸€å°è€è™æœº,
å‡è®¾ä¸€å…±æœ‰Kä¸ªå…´è¶£åˆ†ç±»ï¼ˆæ¯”å¦‚ï¼šå†›äº‹ã€å†å²ã€ç”µå½±ã€éŸ³ä¹ã€......)ï¼Œç›¸å½“äºæ¯ä¸ªæ–°ç”¨æˆ·çš„è€è™æœºæœ‰
$$$$ ä¸ªæ‰‹æŸ„å¯é€‰æ‹©ã€‚</li>
<li>ç¬¬ 2 è¡Œï¼šå‘å½“å‰æ–°ç”¨æˆ·å±•ç¤ºç¬¬ <span
class="math display">\[\mathrm{k\]</span>
ä¸ªå…´è¶£åˆ†ç±»çš„å¹³å‡æ”¶ç›Šç”¨Betaåˆ†å¸ƒæ¥æè¿°, æ¶‰åŠåˆ°ä¸¤ä¸ªå‚æ•° <span
class="math display">\[\alpha_\]</span> å’Œ <span
class="math display">\[\beta_\]</span> ã€‚è¿™é‡Œå°† <span
class="math display">\[\alpha_\]</span> å’Œ <span
class="math display">\[\beta_\]</span> éƒ½åˆå§‹åŒ–ä¸º 1 ,
Betaåˆ†å¸ƒé€€åŒ–æˆå¹³å‡åˆ†å¸ƒ</li>
<li>ç¬¬7è¡Œï¼šé€‰æ‹©é‡‡æ ·éšæœºæ•°æœ€å¤§çš„é‚£ä¸ªå…´è¶£åˆ†ç±»ã€‚
ä¸‰æ ¹æ‰‹æŸ„é‡‡æ ·åˆ°çš„éšæœºæ•°åˆ†åˆ«ä¸º [0.1,0.75,0.2]ï¼Œæ‰€ä»¥åº”è¯¥é€‰æ‹©ç¬¬ 2
ä¸ªæ‰‹æŸ„ä»£è¡¨çš„å…´è¶£åˆ†ç±»ã€‚</li>
<li>ç¬¬ 8 è¡Œï¼šå°†é€‰ä¸­çš„å…´è¶£åˆ†ç±» <span class="math display">\[c_\]</span>
ä¸­ä¼˜è´¨ç‰©æ–™æ¨èç»™æ–°ç”¨æˆ·ã€‚è‡³äºå¦‚ä½•è·å¾—ä¸€ä¸ªå…´è¶£åˆ†ç±»ä¸‹çš„ä¼˜è´¨ç‰©æ–™,
æ–¹æ³•å°±å¤šç§å¤šæ ·äº†, å¯ä»¥é€šè¿‡å¤§æ•°æ®ç»Ÿè®¡, ä¹Ÿå¯ä»¥è®©è¿è¥å›¢é˜Ÿäººå·¥ç®¡é€‰ã€‚</li>
</ul></li>
</ol></li>
<li><p><strong>å…ƒå­¦ä¹ (Meta</strong> <strong>Learning)</strong></p>
<ol type="1">
<li><p>å…ƒå­¦ä¹ ä»‹ç»</p>
<ul>
<li><p>é¦–å…ˆæ³¨æ„, å–‚å…¥Meta Learningçš„åŸºæœ¬æ•°æ®å•ä½ä¸å†æ˜¯ä¸€æ¡æ¡å•ç‹¬çš„æ ·æœ¬,
è€Œæ˜¯ä¸€ä¸ªä¸ª<strong>"ä»»åŠ¡"ï¼ˆTaskï¼‰</strong>ã€‚ä¸€ä¸ªTaskå†…éƒ¨åˆåŒ…å«ä¸¤ä¸ªæ•°æ®é›†,
ä¸€ä¸ªè®­ç»ƒé›†ï¼ˆå…ƒå­¦ä¹ é¢†åŸŸåˆç§°Support Setï¼‰, ä¸€ä¸ªæµ‹è¯•é›†ï¼ˆå…ƒå­¦ä¹ é¢†åŸŸåˆç§°Query
Setï¼‰ã€‚</p></li>
<li><p>å¦‚å›¾æ‰€ç¤º, ç¬¬ä¸€ä¸ªTaskæ˜¯ç”¨äºåˆ†ç±»æ°´æœå›¾ç‰‡ã€‚è®­ç»ƒTask 1æ—¶,
å°†å…¶ä¸­çš„è®­ç»ƒé›† (ä¸€æ‰¹æ°´æœå›¾ç‰‡å’Œæ ‡æ³¨) å–‚å…¥æ¨¡æ¿<span
class="math display">\[ F_{\phi}\]</span>, è®­ç»ƒå¾—åˆ°ä¸€ä¸ªæ°´æœåˆ†ç±»å™¨ <span
class="math display">\[f_{\theta_1^*}, \theta_1^\]</span>
æ˜¯è®­ç»ƒå¾—åˆ°çš„æœ€ä¼˜æƒé‡ã€‚è¿™ä¸ªæ­¥éª¤åªç”¨åˆ°å•ç‹¬ä¸€ä¸ª Taskçš„æ•°æ®,
æ‰€ä»¥è¢«ç§°ä¸º"ä»»åŠ¡å†…å­¦ä¹ "Within-Task Learningã€‚</p></li>
<li><p>å†å°†Task 1 ä¸­çš„æµ‹è¯•é›†å–‚å…¥è®­ç»ƒå¥½çš„æ¨¡å‹<span
class="math display">\[f_{\theta_1^*}\]</span>, è®¡ç®—å‡ºåœ¨æµ‹è¯•é›†ä¸Šçš„æŸå¤±
<span class="math display">\[l_\]</span> ã€‚</p></li>
<li><p>åŒç†, å°†Task 2 ä¸­çš„è®­ç»ƒé›† (äº¤é€šå·¥å…·çš„å›¾ç‰‡å’Œæ ‡æ³¨) å–‚å…¥æ¨¡æ¿ <span
class="math display">\[ F_{\phi}\]</span>, è®­ç»ƒå¾—åˆ°ä¸€ä¸ªäº¤é€šå·¥å…·åˆ†ç±»å™¨
<span class="math display">\[f_{\theta^{2 *}\]</span> , <span
class="math display">\[\theta_2^\]</span> æ˜¯è®­ç»ƒå¾—åˆ°çš„æœ€ä¼˜æƒé‡ã€‚å†æ‹¿Task
2 ä¸­çš„æµ‹è¯•é›†å–‚å…¥ <span class="math display">\[f_{\theta^{2 *}\]</span> ,
è®¡ç®—å¾—åˆ°æµ‹è¯•é›†çš„æŸå¤± <span class="math display">\[l_\]</span>
ã€‚</p></li>
<li><p>å‡è®¾è®­ç»ƒä¸€ä¸ªæ‰¹æ¬¡ (Batch) æœ‰ $$$$ ä¸ªä»»åŠ¡,
æ€»æŸå¤±å°±æ˜¯æ‰€æœ‰ä»»åŠ¡çš„æµ‹è¯•é›†ä¸Šçš„æŸå¤±ä¹‹å’Œã€‚è¿™ä¸ªæ­¥éª¤ç”¨åˆ°äº†ä¸€ä¸ªBatchå†…æ‰€æœ‰ä»»åŠ¡çš„æ•°æ®,
æ‰€ä»¥è¢«ç§°ä¸º"è·¨ä»»åŠ¡å­¦ä¹ "ï¼ˆAcross-Task Learningï¼‰ã€‚</p></li>
<li><p><span class="math display">\[L_{\text {meta }}(\phi)=\sum_{n=1}^N
l_n=\sum_{n=1}^N L\left(D_n^{\text {test }} \mid
\theta_n^*\right)\]</span></p></li>
<li><ul>
<li>Læ˜¯æ‰€æœ‰ä»»åŠ¡å…±ç”¨çš„æŸå¤±å‡½æ•°</li>
<li><span class="math display">\[l_\]</span> æ˜¯ç¬¬ $$$$
ä¸ªä»»åŠ¡åœ¨å…¶æµ‹è¯•é›†ä¸Šçš„æŸå¤±</li>
<li><span class="math display">\[D_n^{\text {test }\]</span> æ˜¯ç¬¬ $$$$
ä¸ªä»»åŠ¡ä¸­çš„æµ‹è¯•é›†ï¼ˆå³Query Setï¼‰</li>
<li><span class="math display">\[\theta_n^\]</span> æ˜¯ç¬¬ $$$$
ä¸ªä»»åŠ¡è®­ç»ƒå¾—åˆ°çš„æœ€ä¼˜å‚æ•°</li>
</ul></li>
</ul></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152611540.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><p><strong>MAMLç®—æ³•</strong></p>
<ul>
<li><p>Model-Agnostic Meta-Learning (MAML)æ˜¯ä¸€ç±»ç‰¹æ®Šçš„å…ƒå­¦ä¹ ,
æœ‰ä¸¤ä¸ªç‰¹ç‚¹:</p></li>
<li><p>æ¨¡æ¿é…ç½® <span class="math display">\[\ph\]</span> ä»…é™äºæ¨¡å‹å‚æ•°
<span class="math display">\[\thet\]</span> çš„åˆå§‹å€¼ã€‚</p></li>
<li><p>æŸå¤±å‡½æ•° <span class="math display">\[L_{\text {meta
}}(\phi\]</span> <strong>å¯¹</strong> <span
class="math display">\[\ph\]</span> <strong>å¯å¯¼,</strong> ä»è€Œå¯ä»¥é€šè¿‡
SGDçš„æ–¹å¼æ±‚è§£å‡ºæœ€ä¼˜ <span class="math display">\[\ph\]</span> ,
ä¹Ÿå°±æ˜¯æœ€ä¼˜çš„ <span class="math display">\[\thet\]</span> åˆå€¼ã€‚</p></li>
<li><p>æå‡ºMAMLæ˜¯ä¸ºäº†è§£å†³"å°æ ·æœ¬è®­ç»ƒ"ï¼ˆFew-Shot Learningï¼‰çš„é—®é¢˜,
ä¹Ÿå°±æ˜¯æ–°ä»»åŠ¡æ²¡æœ‰è¶³å¤Ÿå¤šçš„æ•°æ®å°†æ¨¡å‹å‚æ•°ä»å¤´è®­ç»ƒå¥½ã€‚MAMLçš„è§£å†³æ€è·¯æ˜¯:</p></li>
<li><p>é€šè¿‡è‹¥å¹²ç»„ä»»åŠ¡ï¼ˆæ¯”å¦‚Task 1 æ˜¯åˆ†è¾¨ä¸åŒæ°´æœ, Task 2
æ˜¯åˆ†è¾¨ä¸åŒçš„äº¤é€šå·¥å…·ï¼‰, å­¦ä¹ å‡ºä¸€å¥—é«˜è´¨é‡çš„å‚æ•°åˆå€¼ <span
class="math display">\[\ph\]</span></p></li>
<li><p>å½“é¢å¯¹ä¸€ä¸ªæ–°ä»»åŠ¡ï¼ˆæ¯”å¦‚åˆ†è¾¨ä¸åŒåŠ¨ç‰©æ—¶ï¼‰æ—¶, ç”±è¿™æ®µé«˜è´¨é‡çš„å‚æ•°åˆå€¼
<span class="math display">\[\ph\]</span> å‡ºå‘,
åªéœ€è¦ç»è¿‡å°‘é‡æ ·æœ¬çš„è¿­ä»£, å°±èƒ½è¾¾åˆ°é€‚åˆæ–°ä»»åŠ¡çš„æœ€ä¼˜å‚æ•° <span
class="math display">\[\theta^\]</span>,
ä»è€Œè§£å†³äº†æ–°ä»»åŠ¡æ ·æœ¬ä¸è¶³çš„é—®é¢˜ã€‚</p></li>
<li><p>å…·ä½“è§£æ³•ä¸Š, å°½ç®¡ç†è®ºä¸Šä»åˆå€¼ <span
class="math display">\[\ph\]</span> å‡ºå‘,
éœ€è¦ç»è¿‡å¤šè½®è®­ç»ƒè¿­ä»£æ‰èƒ½å¾—åˆ°æœ€ä¼˜å‚æ•° <span
class="math display">\[\theta^\]</span> ã€‚ä½†æ˜¯,
ä»å‡å°‘è®­ç»ƒæ ·æœ¬æ•°çš„å®é™…ç›®æ ‡å‡ºå‘, æˆ‘ä»¬å‡è®¾åˆå€¼ <span
class="math display">\[\ph\]</span> åªç»è¿‡ä¸€æ¬¡æ¢¯åº¦ä¸‹é™å°±å¾—åˆ°æœ€ä¼˜å‚æ•°
<span class="math display">\[\theta^\]</span>, å¦‚å…¬å¼æ‰€ç¤ºã€‚</p></li>
<li><p><span class="math display">\[\theta_n^*=\phi-\alpha
\frac{\partial L\left(D_n^{\text {train }} \mid \phi\right)}{\partial
\phi}\]</span></p></li>
<li><p><span class="math display">\[\ph\]</span>
æ˜¯æ‰€æœ‰ä»»åŠ¡å…±äº«çš„å‚æ•°åˆå€¼</p></li>
<li><p><span class="math display">\[\theta_n^\]</span> æ˜¯ç¬¬ $<span
class="math display">\[$ ä¸ªä»»åŠ¡çš„æœ€ä¼˜æ¨¡å‹å‚æ•°, å‡è®¾ç”± \]</span>$$
é€šè¿‡ä¸€æ¬¡æ¢¯åº¦ä¸‹é™å°±èƒ½å¾—åˆ°</p></li>
<li><p>Læ˜¯æ‰€æœ‰ä»»åŠ¡å…±äº«çš„æŸå¤±å‡½æ•°</p></li>
<li><p><span class="math display">\[L\left(D_n^{\text {train }} \mid
\phi\right\]</span> æ˜¯æ¨¡å‹ä»¥åˆå€¼ <span
class="math display">\[\ph\]</span> ä¸ºå‚æ•°, åœ¨ç¬¬ $<span
class="math display">\[$ ä¸ªä»»åŠ¡çš„è®­ç»ƒé›† \]</span>D_n^{$$
ä¸Šçš„æŸå¤±</p></li>
<li><p><span class="math display">\[\alph\]</span> æ˜¯è¿­ä»£æ­¥é•¿</p></li>
</ul></li>
<li><p>å¦‚ä½•ä½œç”¨äºå†·å¯åŠ¨çš„æ¨èç³»ç»Ÿä»»åŠ¡å‘¢ï¼Ÿ</p>
<ul>
<li><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°å°†MAMLåº”ç”¨äºæ¨èåœºæ™¯æ‰€è¦åšçš„ç¬¬ä¸€ä¸ªæ”¹è¿›,
å°±æ˜¯ä¿®æ­£å…¶åº”ç”¨èŒƒå›´ï¼š</p></li>
<li><p>å¯¹äºæ¨èæ¨¡å‹çš„å¤§éƒ¨åˆ†å‚æ•°, åŒ…æ‹¬DNNæƒé‡å’Œå¸¸è§„ç‰¹å¾çš„Embedding,
æ–°ä»»åŠ¡ï¼ˆå³æ–°ç”¨æˆ·/æ–°ç‰©æ–™ï¼‰åº”è¯¥ç›´æ¥å¤ç”¨è€ä»»åŠ¡ï¼ˆå³è€ç”¨æˆ·/è€ç‰©æ–™ï¼‰å·²ç»è®­ç»ƒå¥½çš„ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯å‚æ•°çš„è´¨é‡ï¼Œåˆèƒ½èŠ‚çœèµ„æºã€‚æ‰€ä»¥,
MAMLå®Œå…¨æ²¡å¿…è¦å­¦ä¹ è¿™äº›å‚æ•°çš„æœ€ä¼˜åˆå€¼ã€‚</p></li>
<li><p>æ¯ä¸ªæ–°ä»»åŠ¡åªæœ‰ID Embeddingæ˜¯è¿™ä¸ªä»»åŠ¡ç‹¬æœ‰çš„, æ˜¯æ— æ³•å¤ç”¨è€ä»»åŠ¡çš„,
å¸Œæœ›èƒ½å¤Ÿä»ä¸€ä¸ªæœ€ä¼˜åˆå€¼å‡ºå‘åªç»è¿‡å°‘é‡æ•°æ®å°±å¿«é€Ÿè¿­ä»£è‡³æœ€ä¼˜çŠ¶æ€ã€‚è€Œè¿™ä¸ªæœ€ä¼˜çš„User
ID Embeddingåˆå€¼, æˆ–æœ€ä¼˜çš„Item ID Embeddingçš„åˆå€¼,
æ˜¯å”¯ä¸€éœ€è¦MAMLå­¦ä¹ çš„æ¨¡æ¿é…ç½®ã€‚</p></li>
<li><p>ä¼˜åŒ–ç›®æ ‡æ”¹é€ </p></li>
<li><p>MAMLåœ¨æ¨èåœºæ™¯ä¸‹çš„å”¯ä¸€ä»»åŠ¡å°±æ˜¯å°†æœ€ä¼˜çš„ID Embeddingåˆå€¼ <span
class="math display">\[\ph\]</span> å­¦ä¹ å‡ºæ¥,
è€Œåœ¨å†·å¯çš„ä¸åŒé˜¶æ®µå‘æŒ¥ç€ä¸åŒä½œç”¨ã€‚ä»¥æ–°ç”¨æˆ·å†·å¯ä¸ºä¾‹:</p></li>
<li><p>ç¬¬1ä¸ªé˜¶æ®µæ˜¯Cold-Startï¼ˆä¸ºäº†å’Œé€šç¯‡æ‰€æŒ‡çš„å¹¿ä¹‰å†·å¯ç›¸åŒºåˆ«,
æˆ‘ç§°ä¹‹ä¸º"çº¯å†·å¯"ï¼‰ï¼šç”¨æˆ·ç”Ÿå¹³ç¬¬ä¸€æ¬¡å‘æœ¬æ¨èæœåŠ¡å‘å‡ºè¯·æ±‚ï¼Œé¢„æµ‹ç¨‹åºåœ¨çº¿ä¸ŠæœåŠ¡çš„æ¨¡å‹çš„Embeddingå±‚æ‰¾ä¸åˆ°è¯¥ç”¨æˆ·User
IDå¯¹åº”çš„ Embedding, å°±æ‹¿ <span class="math display">\[\ph\]</span>
ä»£æ›¿å–‚è¿›æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚æ­¤æ—¶, <span class="math display">\[\ph\]</span>
ç›´æ¥å½±å“äº†æ–°ç”¨æˆ·çš„åˆä½“éªŒã€‚</p></li>
<li><p>ç¬¬2ä¸ªé˜¶æ®µæ˜¯Warm-Upï¼ˆçƒ­èº«ï¼‰ï¼šç¬¬1ä¸ªé˜¶æ®µçš„ç”¨æˆ·åé¦ˆå›ä¼ è‡³åœ¨çº¿å­¦ä¹ 
(Online Learning) ç¨‹åº, è®­ç»ƒç¨‹åºåœ¨Parameter Serverä¸­æŸ¥ä¸åˆ°æ–°ç”¨æˆ·User
IDå¯¹åº”çš„Embedding, å°±æ‹¿ <span class="math display">\[\ph\]</span>
å½“åˆå€¼, åˆ©ç”¨æ–°ç”¨æˆ·çš„åé¦ˆæ•°æ®, é€šè¿‡ä¸€æ¬¡æ¢¯åº¦ä¸‹é™å°±å¾—åˆ°äº†è¯¥æ–°ç”¨æˆ·User ID
Embeddingçš„æœ€æ–°å€¼ <span class="math display">\[\theta^\]</span> ã€‚ <span
class="math display">\[\theta^\]</span> è¢«æ‰“åˆ°çº¿ä¸Š, ä½œä¸ºæ–°çš„ User ID
Embedding, ä¸ºè¯¥ç”¨æˆ·çš„ç¬¬"äºŒ"æ¬¡ï¼ˆç†æƒ³äº†ä¸€ç‚¹,
å‡è®¾åœ¨çº¿æ›´æ–°è¶³å¤ŸåŠæ—¶ï¼‰è¯·æ±‚æœåŠ¡ã€‚</p></li>
<li></li>
</ul></li>
</ol></li>
<li><p><strong>å¯¹æ¯”å­¦ä¹ (Contrastive Learning)</strong></p>
<ol type="1">
<li><p>å¯¹æ¯”å­¦ä¹ å±äº<strong>è‡ªç›‘ç£å­¦ä¹ çš„ä¸€ç±»</strong></p></li>
<li><p>ä¸€ä¸ªå®Œæ•´çš„åˆ†ç±»æ¨¡å‹å¯ä»¥ç”±"ç‰¹å¾ç¼–ç "ï¼ˆEncodingï¼‰ä¸"åˆ†
(Classification) ä¸¤é˜¶æ®µã€‚</p></li>
<li><ul>
<li>ç‰¹å¾ç¼–ç ï¼ˆEncodingï¼‰é˜¶æ®µï¼šä¸€å¼ å›¾ç‰‡å¯ä»¥ç”±ä¸€ä¸ªé•¿åº¦ç­‰äº <span
class="math display">\[H \times W \times \]</span> çš„å¤§å‘é‡è¡¨ç¤º, å…¶ä¸­
<span class="math display">\[H / W / \]</span>
åˆ†åˆ«æ˜¯å›¾ç‰‡çš„é«˜/å®½/é€šé“ä¸ªæ•°ï¼ˆæ¯”å¦‚RGBä¸‰è‰²å¯ä»¥ç†è§£ä¸º 3
ä¸ªé€šé“ï¼‰ã€‚å…¶ä¸­å•ä¸ªç»´åº¦çš„ä¿¡æ¯å«é‡éƒ½æœ‰é™,
è€Œä¸”éš¾å…åŒ…å«å™ªå£°ã€‚Encoderæˆ–æ˜¯è¿‡æ»¤æ‰åŸå§‹è¾“å…¥ä¸­çš„å™ªå£°,
æˆ–æ˜¯å°†è‹¥å¹²å¼±ä¿¡æ¯çš„åŸå§‹ç‰¹å¾äº¤å‰ã€èšåˆæˆä¸€ä¸ªå¼ºä¿¡æ¯çš„ç‰¹å¾, ä»è€Œå°†åŸæ¥ <span
class="math display">\[H \times W \times \]</span> çš„åŸå§‹ç‰¹å¾å‹ç¼©æˆä¸€ä¸ª
$<span class="math display">\[$ ç»´çš„&quot;æœ‰æ•ˆç‰¹å¾&quot;, å…¶ä¸­
\]</span>K H W $$ ã€‚"æœ‰æ•ˆç‰¹å¾"è™½ç„¶é•¿åº¦å˜çŸ­äº†,
ä½†æ˜¯å´ä¿ç•™äº†åŸå§‹ç‰¹å¾ä¸­ç»å¤§éƒ¨åˆ†çš„ä¿¡æ¯, æ˜¯åŸå§‹ç‰¹å¾çš„"ç²¾å"ã€‚</li>
<li>åˆ†ç±» (Classification)
é˜¶æ®µï¼šå°†å‰ä¸€é˜¶æ®µæå–å‡ºæ¥çš„"æœ‰æ•ˆç‰¹å¾"ï¼Œç»è¿‡ç®€å•æ˜ å°„ï¼Œå°±å¾—åˆ°äº†æœ€ç»ˆåˆ†ç±»ã€‚</li>
</ul></li>
<li><p>å¸¸è§„æœºå™¨å­¦ä¹ ä¸­,
"ç‰¹å¾ç¼–ç "ä¸"åˆ†ç±»"æ˜¯ç”±ä¸€ä¸ªæ¨¡å‹é€šè¿‡ç«¯åˆ°ç«¯å­¦ä¹ æ¥å®Œæˆçš„ã€‚ä½†æ˜¯ç”±äºç°åœ¨æ ‡æ³¨ç¨€ç–,
æˆ‘ä»¬åªå¥½å°†"ç‰¹å¾ç¼–ç "ä¸"åˆ†ç±»"ç‰©ç†æ‹†åˆ†æˆä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å‹ã€‚</p></li>
<li><ul>
<li>"ç‰¹å¾ç¼–ç "é˜¶æ®µ, é€šè¿‡"è‡ªç›‘ç£"ï¼ˆSelf-Supervised Learning,
SSLï¼‰æ–¹å¼æ¥å­¦ä¹ ã€‚æ‰€è°“"è‡ªç›‘ç£å­¦ä¹ ", æ˜¯æŒ‡ä¸ä¾èµ–äººå·¥æ ‡æ³¨,
é€šè¿‡æŒ–æ˜æœªæ ‡æ³¨æ ·æœ¬å†…éƒ¨å­˜åœ¨çš„ç»“æ„ã€å…³è”,
å°†"ç‰¹å¾ç¼–ç "è¿™ä¸ªæ¨¡å—è®­ç»ƒå‡ºæ¥ã€‚ä¼ ç»Ÿçš„é™å™ªè‡ªç¼–ç å™¨ï¼ˆDenoising
AutoEncoderï¼‰ï¼ŒWord2Vecå’ŒTransformerä¸­é€šè¿‡å¥å­çš„ä¸€éƒ¨åˆ†é¢„æµ‹å¦ä¸€éƒ¨åˆ†,
å’Œè¿™é‡Œè¦è®²çš„å¯¹æ¯”å­¦ä¹ , éƒ½å±äº"è‡ªç›‘ç£å­¦ä¹ "çš„èŒƒç•´ã€‚</li>
<li>"åˆ†ç±»"é˜¶æ®µ, è¿˜æ˜¯éœ€è¦é€šè¿‡"<strong>ç›‘ç£" (Supervised)
æ–¹å¼æ¥å­¦ä¹ </strong>ã€‚ä½†æ˜¯ç”±äºç¼–ç é˜¶æ®µæå–å‡ºæ¥çš„"æœ‰æ•ˆç‰¹å¾"çš„é•¿åº¦å·²ç»å¤§å¤§ç¼©çŸ­,
æ‰€ä»¥â€œåˆ†ç±»"æ¨¡å‹åªéœ€è¦å°‘é‡æ ‡æ³¨æ•°æ®å°±èƒ½è¢«å……åˆ†è®­ç»ƒ,
ä»è€Œç¼“è§£äº†æ ‡æ³¨ç¨€ç–çš„é—®é¢˜ã€‚</li>
</ul></li>
<li><figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTIxZWNhOTQwOWY5Y2NkZGJhMmExZWM5YTI2NmQ2ZGZfVllFZlFtN2tlVlNScjVUZjZVdDdUSk94RkpIMFE1dUlfVG9rZW46SnpER2I1MGc4bzVzZFB4UkZQa2NEODQ4bjdiXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><ul>
<li>æˆ‘ä»¬æœ‰ä¸€å¼ åŸå§‹å›¾ç‰‡ $<span
class="math display">\[$  å°½ç®¡æˆ‘ä»¬å¾ˆå®¹æ˜“çŸ¥é“è¿™æ˜¯ä¸€å¼ ç‹¼çŠ¬çš„å›¾ç‰‡, ä½†æ˜¯
\]</span><span class="math display">\[
æ²¡æœ‰è¢«æ ‡æ³¨ã€‚æ¨¡å‹å¹¶ä¸çŸ¥é“,ä¹Ÿæ— éœ€çŸ¥é“ \]</span>$$ çš„ç±»åˆ«ã€‚</li>
<li>æˆ‘ä»¬é€šè¿‡ä¸€äº›æ‰‹æ®µ, ä»åŸå§‹å›¾ç‰‡è¡ç”Ÿå‡ºå¤šå¼ ä¸å…¶ç›¸ä¼¼çš„å›¾ç‰‡,
è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º"æ•°æ®å¢å¼º"ï¼ˆData Augmentation) ã€‚æ¯”å¦‚ä¸­çš„æ•°æ®å¢å¼º,
å°±æ˜¯å°†åŸå§‹å›¾ç‰‡ <span class="math display">\[P^{\prime \prime\]</span>
é»‘ç™½åŒ–"å¾—åˆ°å¢å¼ºç‰ˆå›¾ç‰‡ <span class="math display">\[P_{a u\]</span>
ã€‚å…¶ä»–å¯¹äºå›¾ç‰‡çš„æ•°æ®å¢å¼ºæ–¹å¼è¿˜åŒ…æ‹¬ï¼šæ—‹è½¬ã€é•œåƒã€å‰ªè£ç­‰ã€‚</li>
<li>å†ä»å…¨ä½“å›¾ç‰‡ä¸­éšæœºæŠ½å–ä¸€å¼ å›¾ç‰‡ <span class="math display">\[P_{r
a\]</span> ã€‚å‡è®¾å€™é€‰é›†è¶³å¤Ÿåºå¤§,
æˆ‘ä»¬ä¸å¤ªå¯èƒ½å†æŠ½åˆ°åŒä¸€ç±»åˆ«çš„å›¾ç‰‡,æ¯”å¦‚ä¸­å°±æŠ½åˆ°ä¸€å¼ é›ªé¸®çš„å›¾ç‰‡ã€‚å½“ç„¶æ¨¡å‹åŒæ ·æ— éœ€çŸ¥é“å…¶ç±»åˆ«ã€‚</li>
<li>å°†åŸå§‹å›¾ç‰‡ $<span class="math display">\[$ ã€å¢å¼ºå›¾ç‰‡ \]</span>P_{a
u<span class="math display">\[ å’Œéšæœºå›¾ç‰‡ \]</span>P_{r a<span
class="math display">\[ , éƒ½å–‚å…¥Encoderè¿›è¡Œæç‚¼å‹ç¼©,
å¾—åˆ°ä¸‰è€…çš„&quot;æœ‰æ•ˆç‰¹å¾&quot;å‘é‡ \]</span>V ã€ <em>{a u<span
class="math display">\[ å’Œ \]</span></em>{r a$$ ã€‚</li>
<li>æˆ‘ä»¬è®¡ç®— <span class="math display">\[\boldsymbol{V\]</span> ä¸
<span class="math display">\[\mathbf{V}_{a u\]</span> ä¹‹é—´çš„ç›¸ä¼¼åº¦ <span
class="math display">\[s_{+}=\operatorname{Sim}\left(\mathbf{V},
\mathbf{V}_{a u}\right)\]</span>, æ¨¡å‹çš„è®­ç»ƒç›®æ ‡æ˜¯æœ€å¤§åŒ– <span
class="math display">\[s_{+}\]</span>, å³åŸæ ·æœ¬ä¸å…¶å¢å¼ºç‰ˆåœ¨å‘é‡ç©ºé—´é‡Œ,
åº”è¯¥è¶Šè¿‘è¶Šå¥½ã€‚</li>
<li>æˆ‘ä»¬è®¡ç®— <span class="math display">\[\mathbf{V\]</span> ä¸ <span
class="math display">\[\mathbf{V}_{r a\]</span> ä¹‹é—´çš„ç›¸ä¼¼åº¦ <span
class="math display">\[s_{-}=\operatorname{Sim}\left(\mathbf{V},
\mathbf{V}_{r a}\right)\]</span>, æ¨¡å‹çš„è®­ç»ƒç›®æ ‡æ˜¯æœ€å°åŒ– <span
class="math display">\[s_{-}\]</span>,
å³åŸæ ·æœ¬ä¸éšæœºæŠ½å–çš„å…¶ä»–æ ·æœ¬åœ¨å‘é‡ç©ºé—´é‡Œ, åº”è¯¥è¶Šè¿œè¶Šå¥½ã€‚</li>
</ul></li>
<li><p>å†å°†è®­ç»ƒå¥½çš„åˆ†ç±»å™¨ç”¨äºå°æ ·æœ¬å­¦ä¹ ä¸­</p></li>
<li><figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152611886.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure></li>
<li><p>å¦‚ä½•å°†<strong>å¯¹æ¯”å­¦ä¹ ç”¨äºæ¨èç³»ç»Ÿ</strong></p>
<ul>
<li><p>æ¨èç³»ç»Ÿä¸­çš„æµ·é‡æ•°æ®æ ‡æ³¨å­˜åœ¨è´«å¯Œå·®è·çš„é—®é¢˜ï¼Œå°±æ˜¯æ‰€è°“çš„<strong>äºŒå…«æ³•åˆ™</strong>ï¼Œå°‘æ•°çš„ç‰©æ–™æˆ–è€…ç”¨æˆ·æ‹¥æœ‰äº†å¤§é‡çš„æ ‡æ³¨ä¿¡æ¯ï¼Œä½†æ˜¯å¤§é‡çš„ç‰©æ–™æˆ–è€…ç”¨æˆ·æ‰€æ‹¥æœ‰çš„æ ‡æ³¨ä¿¡æ¯å¾ˆå°‘</p></li>
<li><p>å¯¹æ¯”å­¦ä¹ åœ¨æ¨èç³»ç»Ÿçš„ä¸»è¦ä½œç”¨å°±æ˜¯<strong>â€œçº åâ€</strong></p></li>
<li><p>é€šè¿‡"æ•°æ®å¢å¼º", æˆ‘ä»¬ä»å°‘æ•°ç”¨æˆ·/ç‰©æ–™è¡ç”Ÿå‡ºæ›´å¤šæ ·æœ¬,
æ”¾å¤§å°‘æ•°ç¾¤ä½“åœ¨è®­ç»ƒæ ·æœ¬ä¸­çš„éŸ³é‡ã€‚</p></li>
<li><p>å¯¹æ¯”å­¦ä¹ ä½œä¸ºè¾…åŠ©ä»»åŠ¡,
è¦è®©æ¨¡å‹å¤šè§è¯†ä¸€äº›å¹³æ—¥é‡Œè¢«å…¶å¿½è§†çš„å°‘æ•°äººç¾¤å’Œå°ä¼—ç‰©æ–™ã€‚è®©å¹³å¸¸å¬æƒ¯äº†"é˜³æ˜¥ç™½é›ª"çš„æ¨¡å‹,
ä¹Ÿå¤šå¤šæ„Ÿå—ä¸€ä¸‹"ä¸‹é‡Œå·´äºº"ã€‚</p></li>
<li><p>å› ä¸ºåœ¨è®­ç»ƒé˜¶æ®µä¸å°‘æ•°ç¾¤ä½“éƒ½"äº²å¯†æ¥è§¦"è¿‡äº†,
è¢«å¯¹æ¯”å­¦ä¹ è°ƒæ•™è¿‡çš„æ¨¡å‹çº¿ä¸Šé¢„æµ‹æ—¶,
ä¼šå°‘ä¸€ä»½åŠ¿åˆ©,å¯¹å°ä¼—äººç¾¤ä¸ç‰©æ–™å‹å¥½ä¸€äº›ã€‚</p></li>
<li></li>
<li><p>æ—¢ç„¶æ˜ç¡®äº†å¯¹æ¯”å­¦ä¹ çš„ç›®æ ‡æ˜¯ä¸ºäº†Debias, é‚£ä¹ˆè®­ç»ƒæ—¶,
æˆ‘ä»¬å¿…é¡»æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹</p></li>
<li><p>ç¬¬ä¸€ç‚¹, å‚ä¸å¯¹æ¯”å­¦ä¹ çš„æ ·æœ¬, å’Œå‚ä¸ä¸»ä»»åŠ¡çš„æ ·æœ¬,
æœ€å¥½æ¥è‡ªä¸åŒçš„æ ·æœ¬ç©ºé—´</p>
<ul>
<li>ä¸»ä»»åŠ¡, éœ€è¦æ‹Ÿåˆç”¨æˆ·ä¸ç‰©æ–™ä¹‹é—´çš„çœŸå®äº’åŠ¨,
è®­ç»ƒæ•°æ®è¿˜æ˜¯ä»¥æ›å…‰æ•°æ®ä¸ºä¸», ä¹Ÿå°±æ˜¯ä»¥è€ç”¨æˆ·ã€è€ç‰©æ–™ä¸ºä¸»ã€‚</li>
<li>å¯¹æ¯”å­¦ä¹ , æ—¢ç„¶æ˜¯ä¸ºäº†æ”¾å¤§å°‘æ•°ç¾¤ä½“æ ·æœ¬çš„å½±å“åŠ›,
å…¶è®­ç»ƒæ ·æœ¬åº”è¯¥ä»¥é²œæœ‰æ›å…‰æœºä¼šçš„å°‘æ•°äººç¾¤å’Œå°ä¼—ç‰©æ–™ä¸ºä¸»ã€‚æ¯”å¦‚,
è¶Šå°‘æ›å…‰çš„ç”¨æˆ·æˆ–ç‰©æ–™, ä»–ä»¬çš„æ ·æœ¬è¢«è¡ç”Ÿã€å¢å¼ºå¾—åº”è¯¥è¶Šå¤š; åä¹‹,
å°±åº”è¯¥å°‘å¢å¼ºæˆ–ä¸å¢å¼ºã€‚</li>
</ul></li>
<li><p>ç¬¬äºŒç‚¹, ä¸»ä»»åŠ¡ä¸å¯¹æ¯”å­¦ä¹ ä»»åŠ¡ä¹‹é—´, å¿…é¡»å…±äº«å‚æ•°ã€‚</p>
<ul>
<li>è¿‘å¹´æ¥ç»™æˆ‘çš„æ„Ÿè§‰, å‚æ•°å…±äº«ã€ç»“æ„å…±äº«åœ¨æ¨èç®—æ³•ä¸­,
è¶Šæ¥è¶Šä¸å—å¾…è§ã€‚æ¯”å¦‚, å¤šä»»åŠ¡åœºæ™¯ä¸‹,æµè¡Œè®©åŒä¸€ä¸ªç‰¹å¾å¯¹ä¸åŒç›®æ ‡,
æ‹¥æœ‰ä¸åŒEmbedding; é€šç¯‡éƒ½åœ¨è®²å‚æ•°ç‹¬ç«‹æ€§, åŒä¸€ä¸ªç‰¹å¾ä¸ä¸åŒç‰¹å¾äº¤å‰æ—¶,
éƒ½è¦ä½¿ç”¨ä¸åŒçš„Embeddingã€‚</li>
<li>ä½†æ˜¯, å¯¹äºå¯¹æ¯”å­¦ä¹ , å‚æ•°å…±äº«æ˜¯å¿…é¡»çš„ã€‚å¦åˆ™,
ä¸»æ¨¡å‹ä¸å¯¹æ¯”å­¦ä¹ è¾…åŠ©æ¨¡å‹, å„å­¦å„çš„, ä¸»æ¨¡å‹ä¸­çš„Biasä¾æ—§å­˜åœ¨,
å¯¹æ¯”å­¦ä¹ å­¦äº†ä¸ªå¯‚å¯ã€‚</li>
<li><img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=NTQwYzA5MTAxZTQzYjBkY2ZiZjNjN2QzMTUxMDA2YjlfWThoNmFJN2ROTFp2N0FtSlk1SGlUbE9ISlNhYkNrYmVfVG9rZW46WVdJUWJMNkFQb3k1R0F4VFU2ZGN4YnhCbnFyXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
title="fig:" alt="img" /></li>
</ul></li>
</ul></li>
<li><p>åŒºåˆ†å¯¹æ¯”å­¦ä¹ å’Œå‘é‡åŒ–å¬å›</p>
<ul>
<li>é¦–å…ˆ, å‘é‡å¬å›å±äº<strong>"æœ‰ç›‘ç£å­¦ä¹ "</strong>ã€‚U2|å¬å›ä¸­,
ç”¨æˆ·ä¸å…¶ç‚¹å‡»è¿‡çš„ç‰©æ–™åœ¨å‘é‡ç©ºé—´æ˜¯ç›¸è¿‘çš„ã€‚åœ¨ 121 å¬å›ä¸­,
è¢«åŒä¸€ä¸ªç”¨æˆ·ç‚¹å‡»è¿‡çš„ç‰©æ–™åœ¨å‘é‡ç©ºé—´ä¸­æ˜¯ç›¸è¿‘çš„ã€‚è¿™äº›æ­£æ ·æœ¬éƒ½æ¥æºäºç”¨æˆ·åé¦ˆï¼ˆæ ‡æ³¨ï¼‰ã€‚åä¹‹,å¯¹æ¯”å­¦ä¹ å±äº<strong>"è‡ªç›‘ç£å­¦ä¹ ",</strong>
ä¸éœ€è¦ç”¨æˆ·æ ‡æ³¨ã€‚ç”¨æˆ·ä¸å…¶å¢å¼ºç‰ˆæœ¬, ç‰©æ–™ä¸å…¶å¢å¼ºç‰ˆæœ¬,
è¿™äº›æ­£æ ·æœ¬éƒ½æ˜¯æˆ‘ä»¬æ ¹æ®ä¸€å®šè§„åˆ™åˆ¶é€ å‡ºæ¥çš„ã€‚</li>
<li>å…¶æ¬¡,
å‘é‡å¬å›é‡ç‚¹<strong>å…³æ³¨çš„æ˜¯è´Ÿæ ·æœ¬</strong>ã€‚å¤§å‹æ¨èç³»ç»Ÿä¸­çš„ç”¨æˆ·åé¦ˆæºæºä¸æ–­,
æ­£æ ·æœ¬ä»æ¥éƒ½ä¸æ˜¯é—®é¢˜ã€‚åä¹‹, å¯¹äºå¯¹æ¯”å­¦ä¹ ,
é‡ç‚¹ã€éš¾ç‚¹æ°æ°æ˜¯å¦‚ä½•åˆ¶é€ æ­£æ ·æœ¬ã€‚ä¹Ÿå°±æ˜¯ç»™å®šç”¨æˆ·æˆ–ç‰©æ–™,
å¦‚ä½•"å¢å¼º"å‡ºä¸å…¶ç›¸ä¼¼çš„ç”¨æˆ·æˆ–ç‰©æ–™ä¿¡æ¯ã€‚å› ä¸ºæ¨èæ¨¡å‹ä¸­çš„ç‰¹å¾,
ä»¥ç±»åˆ«ç‰¹å¾ä¸ºä¸»,
é«˜ç»´ã€ç¨€ç–ä¸”ç›¸äº’å…³è”ï¼ˆæ¯”å¦‚è¢«ä¸€ä¸ªç”¨æˆ·ç‚¹å‡»è¿‡çš„å¤šä¸ªç‰©æ–™ä¹‹é—´å¯èƒ½å­˜åœ¨æ—¶åºã€å› æœå…³ç³»ï¼‰ï¼Œç®€å•ç²—æš´åœ°"å¢å¼º"ï¼Œåè€Œé™ä½äº†äº§ç”Ÿçš„æ­£æ ·æœ¬çš„å¯ä¿¡åº¦ã€‚å› æ­¤,
é˜…è¯»å°†å¯¹æ¯”å­¦ä¹ åº”ç”¨äºæ¨èåœºæ™¯çš„æ–‡ç« , é‡ç‚¹æ˜¯çœ‹å…¶"æ•°æ®å¢å¼º"æ–¹æ³•æœ‰ä½•åˆ›æ–°,
å…¶ä»–æ–¹é¢å¦‚è´Ÿæ ·æœ¬ç­–ç•¥ã€æ¨¡å‹ç»“æ„ã€æŸå¤±è®¾è®¡å¾€å¾€éƒ½æ˜¯å‘é‡å¬å›ä¸­çš„å¸¸è§„å¥—è·¯ï¼Œæ— ç”šæ–°æ„ã€‚</li>
<li>æœ€å, å‘é‡<strong>åŒ–å¬å›æ˜¯ä¸»ä»»åŠ¡</strong>,
æ¯”å¦‚æ›¿ç”¨æˆ·æ‰¾åˆ°ä»–å–œæ¬¢çš„ç‰©æ–™, å¯¹æ¨èæ•ˆæœè´Ÿç›´æ¥è´£ä»»ã€‚åä¹‹, å¯¹æ¯”å­¦ä¹ çš„ç›®çš„,
ä»…ä»…æ˜¯ä¸ºäº†çº æ­£æ¨¡å‹å¯¹å°ä¼—ç”¨æˆ·ã€å†·é—¨ç‰©æ–™è¿™äº›å°‘æ•°æ´¾çš„åè§ã€‚å¯¹æ¯”å­¦ä¹ ä½œä¸ºè¾…åŠ©ä»»åŠ¡,
åªå­˜åœ¨äºè®­ç»ƒé˜¶æ®µï¼Œå¹¶ä¸ä¸Šçº¿ï¼Œé—´æ¥å½±å“æ¨èæ•ˆæœã€‚</li>
</ul></li>
</ol></li>
</ol>
<h1 id="æ¨èç³»ç»Ÿçš„å¤šä»»åŠ¡å¤šåœºæ™¯">æ¨èç³»ç»Ÿçš„å¤šä»»åŠ¡å¤šåœºæ™¯</h1>
<h2 id="å¤šä»»åŠ¡æ¨è">å¤šä»»åŠ¡æ¨è</h2>
<p>å¤šä»»åŠ¡å»ºæ¨¡(Multi-Task) ï¼Œ æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºå¤šç›®æ ‡å»ºæ¨¡(Multi-Objective)</p>
<ul>
<li>æ¯”å¦‚è§†é¢‘æ¨èåœºæ™¯ä¸‹ï¼Œ
æˆ‘ä»¬æ¨èå‡ºå»çš„ç»“æœï¼Œæ—¢æƒ³è®©ç”¨æˆ·ç‚¹å‡»ï¼Œç‚¹å‡»ä¹‹ååˆå¸Œæœ›è§‚çœ‹çš„æ—¶é—´å°½é‡é•¿ï¼Œè¿˜æƒ³è®©ç”¨æˆ·å¤šå¤šè¯„è®ºã€è½¬å‘ã€‚å› æ­¤ï¼Œéœ€è¦åŒæ—¶å»ºæ¨¡ç‚¹å‡»ç‡ã€è§‚çœ‹æ—¶é•¿ã€è¯„è®ºç‡å’Œè½¬å‘ç‡è¿™4ä¸ªç›®æ ‡ã€‚</li>
<li>æ¯”å¦‚ç”µå•†åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬æ¨èå‡ºå»çš„å•†å“ï¼Œæ—¢æƒ³è®©ç”¨æˆ·å¤šå¤šç‚¹å‡»ï¼Œè¿˜å¸Œæœ›ç”¨æˆ·å¤šå¤šä¸‹å•è´­ä¹°(æœ¯è¯­å«è½¬åŒ–)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦åŒæ—¶å»ºæ¨¡ä¸‰ä¸ªç›®æ ‡:ä¸€ä»¶å•†å“ä»æ›å…‰åˆ°ç‚¹å‡»çš„æ¦‚ç‡(ç‚¹å‡»ç‡ï¼ŒCTR)ã€ä»ç‚¹å‡»åˆ°è´­ä¹°çš„æ¦‚ç‡(è½¬åŒ–ç‡,
CVR)å’Œä»æ›å…‰åˆ°è´­ä¹°çš„æ¦‚ç‡(CTCVR)ã€‚</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆä¸ä¸ºæ¯ä¸ªç›®æ ‡å•ç‹¬å»ºæ¨¡?</strong></p>
<p>è¿™ä¹ˆåšå¤ªæµªè´¹èµ„æºï¼Œå¤§å‚çš„æ¨èæ¨¡å‹æœ¬æ¥å°±å¯¹å†…å­˜ã€ç®—åŠ›æ¶ˆè€—å·¨å¤§ã€‚å¦‚æœæ¯ä¸ªç›®æ ‡å•ç‹¬å»ºæ¨¡ï¼Œéœ€è¦å°†å†…å­˜ã€ç®—åŠ›çš„æ¶ˆè€—éƒ½ä¹˜ä¸Š10ï¼Œè¿™ç¬”é¢„ç®—ææ€•å¾ˆéš¾æ‰¹å¾—ä¸‹æ¥ã€‚</p>
<p>å…¶æ¬¡ï¼Œç”¨æˆ·è½¬åŒ–æ˜¯ä¸€ä¸ªé“¾æ¡ï¼Œæ¯”å¦‚å…ˆç‚¹å‡»ï¼Œå†åŠ å…¥è´­ç‰©è½¦ï¼Œæœ€åè´­ä¹°ã€‚åœ¨è¿™ä¸ªé“¾æ¡è¶Šé åçš„ç¯èŠ‚ï¼Œä»·å€¼è¶Šå¤§ï¼Œä½†æ˜¯å¯ç”¨äºè®­ç»ƒçš„æ­£æ ·æœ¬ä¹Ÿå°±è¶Šå°‘ï¼Œéå¸¸æœ‰å¿…è¦å°†æ‰€æœ‰ç¯èŠ‚æ”¾åœ¨ä¸€èµ·è”åˆè®­ç»ƒ</p>
<p><strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥å»ºæ¨¡ç»ˆæç›®æ ‡?</strong></p>
<p>ä»¥ç”µå•†åœºæ™¯ä¸ºä¾‹ï¼Œç”¨æˆ·æœ€ç»ˆæ²¡æœ‰è´­ä¹°(å³æœªè½¬åŒ–)ï¼Œå¹¶ä¸ä»£è¡¨ç”¨æˆ·å°±ä¸€å®šä¸å–œæ¬¢æ¨èç»“æœï¼Œä¹Ÿå¾ˆæœ‰å¯èƒ½æ˜¯å› ä¸ºå•†å“ä»·æ ¼è¶…å‡ºäº†è¿™åç”¨æˆ·çš„æ¶ˆè´¹èƒ½åŠ›ã€‚å¦‚æœåªä»¥æé«˜CTCVRä¸ºå”¯ä¸€ç›®æ ‡ï¼ŒAPPæ¨èç»™è¿™åç”¨æˆ·çš„å°±éƒ½æ˜¯åœ¨ä»–æ¶ˆè´¹èƒ½åŠ›ä¹‹å†…çš„ä¸­ä½ç«¯å•†å“ã€‚å¯èƒ½ä¼šæš‚æ—¶æé«˜é”€å”®é¢ï¼Œä½†æ˜¯ä¼šå¸¦æ¥ä¸¤æ–¹é¢çš„å±å®³:</p>
<ul>
<li>å®¹æ˜“é€ æˆç”¨æˆ·çš„å®¡ç¾ç–²åŠ³ï¼Œå¯¹ç”¨æˆ·çš„é•¿æœŸç•™å­˜ä¸åˆ©ã€‚</li>
<li>ä¹Ÿå¤±å»ç»™ç”¨æˆ·"ç§è‰"çš„æœºä¼šã€‚ä¸‡ä¸€å“ªä¸€å¤©ï¼Œç”¨æˆ·ç‹ ä¸‹å¿ƒæ¥æƒ³å‰æ‰‹ï¼ŒAPPå´æ¨èä¸å‡ºæ¥é«˜ç«¯å•†å“,</li>
</ul>
<p>ä¹Ÿå°±ç™½ç™½æµªè´¹äº†ä¸€æ¬¡æé«˜é”€å”®é¢çš„æœºä¼šã€‚</p>
<h3 id="å¤šä»»åŠ¡æ–¹æ³•">å¤šä»»åŠ¡æ–¹æ³•</h3>
<h4 id="å¹¶å‘å»ºæ¨¡">å¹¶å‘å»ºæ¨¡</h4>
<p>è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªç›®æ ‡ç‹¬ç«‹å»ºæ¨¡ï¼Œå¿½ç•¥äº†ä¸åŒç›®æ ‡ä¹‹é—´çš„å› æœå…³ç³»ã€‚</p>
<ol type="1">
<li>Share Bottomå…±äº«åº•å±‚</li>
</ol>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152612199.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>åº•å±‚ç»“æ„æ¯”å¦‚Embeddingå±‚å’Œåº•å±‚çš„DNN,ä¸ºæ‰€æœ‰ä»»åŠ¡å…±äº«çš„ã€‚</li>
<li>æ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±ç‹¬ç«‹çš„"å¡”" ç»“æ„ï¼ŒShared
Bottomçš„è¾“å‡ºä½œä¸ºæ¯ä¸ªå¡”çš„è¾“å…¥ã€‚</li>
</ul>
<p>è¿™ç§ç»“æ„çš„ä¼˜ç‚¹æ˜¯å®ç°äº†å¤šä»»åŠ¡ä¹‹é—´çš„"çŸ¥è¯†è¿ç§»"ã€‚æ¯”å¦‚ï¼Œä»»åŠ¡Açš„æ­£æ ·æœ¬å¤šï¼Œä»»åŠ¡Bçš„æ­£æ ·æœ¬å°‘ã€‚å¦‚æœä»»åŠ¡Bå•ç‹¬è®­ç»ƒï¼Œå¯¹"å…±äº«åº•å±‚"çš„è®­ç»ƒä¸ä¼šå¤ªå……åˆ†ã€‚è€Œè”åˆä»»åŠ¡Aä¸Bï¼Œæ•°æ®ä¸°å¯Œçš„ä»»åŠ¡Aèƒ½å¤Ÿå°†"å…±äº«åº•å±‚"è®­ç»ƒåˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„çŠ¶æ€ï¼Œè®©Båœ¨æ­¤åŸºç¡€ä¸Šç»§ç»­è®­ç»ƒï¼Œäº‹åŠåŠŸå€ã€‚</p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œä¸åŒä»»åŠ¡ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶éæˆ‘ä»¬æƒ³åƒçš„é‚£èˆ¬ç›¸è¾…ç›¸æˆã€‚ä¸åŒä»»åŠ¡å¯¹åº•å±‚å…±äº«å‚æ•°çš„æ¢¯åº¦æ–¹å‘å­˜åœ¨åˆ†æ­§ï¼Œè™½è¯´è¿˜ä¸è‡³äºå—è¾•åŒ—è¾™ã€ç›¸äº’æ‹†å°ï¼Œä½†ä¹Ÿåšä¸åˆ°"å¿ƒå¾€ä¸€å—æƒ³ï¼ŒåŠ²å¾€ä¸€å¤„ä½¿"ã€‚</p>
<ol type="1">
<li>Multi-gate Mixture-of-Experts</li>
</ol>
<p>æ²¿ç€æ‹†è§£å…±äº«éƒ¨åˆ†çš„æ€è·¯ï¼ŒMixture-of-Experts (MoE)
å°†"å…±äº«åº•å±‚"æ‹†åˆ†æˆè‹¥å¹²å°å‹DNNï¼Œ<strong>æ¯ä¸ªDNNç§°ä¸ºä¸€ä¸ªExpert</strong>ï¼Œå†ç”±ä¸€ä¸ªé—¨æ§ç½‘ç»œ"
(Gate) æ§åˆ¶æ¯ä¸ªExpertå¯¹æŸä¸ªä»»åŠ¡çš„å‚ä¸ç¨‹åº¦ã€‚</p>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmM4ZTkxYjNjNDBlY2VjOWY5Mzk1ZDBiYjQ4MmI1NmZfTmxzWWpQOU5jckR3MHAyR1pTVjhodlV2dUt2TEJKbkZfVG9rZW46SG92WmJBOHJjb25Qc3V4N0RoRmNQTnNibnBoXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p>MoEä¸­ç¬¬ $$$$ ä¸ªç›®æ ‡çš„é¢„æµ‹å€¼, å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><span class="math display">\[y_k=h_k\left(\sum_{i=1}^n
g(\mathbf{x})_i \operatorname{Expert}_i(\mathbf{x})\right)\]</span></p>
<ul>
<li><span class="math display">\[\mathrm{x\]</span> æ˜¯è¾“å…¥çš„ç‰¹å¾å‘é‡,
<span class="math display">\[y_\]</span> æ˜¯æ ¹æ®è®¡ç®—å‡ºçš„ç¬¬ <span
class="math display">\[\mathrm{k\]</span> ä¸ªç›®æ ‡çš„é¢„æµ‹å€¼ã€‚</li>
<li>ä¸€å…±åˆ›å»ºäº†nä¸ªExpert, Expert <span class="math display">\[t_\]</span>
ä»£è¡¨ç¬¬ <span class="math display">\[\mathrm{i\]</span>
ä¸ªExpertçš„ç½‘ç»œæ¨¡å‹ã€‚</li>
<li><span class="math display">\[\mathrm{g\]</span> ä»£è¡¨é—¨æ§æ¨¡å‹, <span
class="math display">\[g(\mathbf{x}\]</span> å°†è¾“å…¥ç‰¹å¾æ˜ å°„æˆä¸€ä¸ª $<span
class="math display">\[$ ç»´é•¿çš„æ•°ç»„, \]</span>g()_<span
class="math display">\[ æ˜¯å…¶ä¸­çš„ç¬¬ \]</span><span
class="math display">\[ ä½, è¡¨ç¤ºç¬¬ \]</span><span
class="math display">\[ ä¸ªExpertçš„æƒé‡ã€‚å…·ä½“å®ç°ä¸Š, \]</span>$$
å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å¤šå±‚å…¨é“¾æ¥ç½‘ç»œ (MLP), å…¶æœ€åä¸€å±‚ä½¿ç”¨Softmaxåšæ¿€æ´»å‡½æ•°,
ä½¿å„Expertçš„æƒé‡ä¹‹å’Œç­‰äº 1 ã€‚</li>
<li><span class="math display">\[h_\]</span> ä»£è¡¨ç¬¬ $<span
class="math display">\[$ ä¸ªä»»åŠ¡çš„Towerç»“æ„ï¼ˆå›¾ 7-2ä¸­çš„Tower Aå’ŒTower B),
å–‚å…¥ \]</span>h_$$ çš„æ˜¯å„ä¸ªExpertè¾“å‡ºçš„åŠ æƒå’Œã€‚</li>
</ul>
<p>Multi-gate Mixture-of-Experts (MMoE) åœ¨MoEçš„åŸºç¡€ä¸Š, è¿›ä¸€æ­¥æ‹†è§£,
ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152612493.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>MoEä¸­åªæœ‰ä¸€ä¸ªGate, æ›¿æ‰€æœ‰ä»»åŠ¡å†³å®šå„Expertçš„æƒé‡ã€‚</li>
<li>MMoEä¸­, æ¯ä¸ªä»»åŠ¡éƒ½æœ‰è‡ªå·±çš„Gate,
è¡¡é‡å„Expertå¯¹äºæœ¬ä»»åŠ¡çš„é‡è¦æ€§ã€‚</li>
</ul>
<ol type="1">
<li>Progressive Layered Extraction</li>
</ol>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152612659.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>é¦–å…ˆ, å¯¹æ¨¡å‹çš„å…±äº«éƒ¨åˆ†ç»§ç»­æ‹†è§£ã€‚åœ¨MMoEä¸­,
æ‰€æœ‰Expertä¸ºæ‰€æœ‰ä»»åŠ¡æ‰€å…±äº«ã€‚è€Œåœ¨PLEä¸­, å°†æ‰€æœ‰
Experåˆ’åˆ†ä¸º"ä»»åŠ¡ç‹¬å "ï¼ˆTask Specificï¼‰å’Œ"ä»»åŠ¡å…±äº«"ï¼ˆTask
Sharedï¼‰ä¸¤å¤§ç±»ï¼Œå‰è€…åªå‚ä¸å•ä¸€ä»»åŠ¡ï¼Œåè€…å‚ä¸æ‰€æœ‰ä»»åŠ¡ã€‚æ¯”å¦‚å›¾7-5ä¸­,
"Experts A"ä¸­çš„æ‰€æœ‰Experts, åªå‚ä¸å¯¹ä»»åŠ¡Açš„å»ºæ¨¡ã€‚è€Œå»ºæ¨¡ä»»åŠ¡
Aï¼Œæ˜¯ç”±"Experts A"ä¸"Experts Shared"ä¸­çš„æ‰€æœ‰Expertså…±åŒå‚ä¸çš„ã€‚</li>
<li>å…¶æ¬¡, MMoEä¸­åªæœ‰ä¸€å±‚Experts,
Expertsä¹‹é—´çš„äº¤äº’æ¯”è¾ƒå¼±ã€‚è€ŒPLEä¸­å¼•å…¥äº†å¤šå±‚Experts,
Expertsä¹‹é—´çš„äº¤äº’å±‚å±‚é€’è¿›ã€æ·±åŒ–ã€‚</li>
</ul>
<p>PLEçš„ç¬¬ $<span class="math display">\[$ å±‚è¦è¾“å‡º \]</span>N+$$
ä¸ªå‘é‡, å¦‚å…¬å¼(7-3)æ‰€ç¤º</p>
<p><span class="math display">\[\left[\mathbf{x}_1^k, \ldots,
\mathbf{x}_N^k, \mathbf{x}_s^k\right]\]</span></p>
<ul>
<li>$$$$ æ˜¯æ‰€æœ‰ä»»åŠ¡çš„ä¸ªæ•°</li>
<li><span class="math display">\[\mathbf{x}_t^k, t \in[1, \ldots,
N\]</span> è¡¨ç¤ºç¬¬ $<span class="math display">\[$ å±‚å¯¹ä»»åŠ¡ \]</span>$$
çš„å»ºæ¨¡ç»“æœ</li>
<li><span class="math display">\[\mathbf{x}_s^\]</span> è¡¨ç¤ºç¬¬ $$$$
å±‚å¯¹å…±äº«ä¿¡æ¯çš„å»ºæ¨¡ç»“æœ</li>
</ul>
<p>åœ¨ç¬¬ <span class="math display">\[\mathrm{k\]</span> å±‚å»ºæ¨¡æ—¶,
é¦–å…ˆå°†ä¸‹å±‚çš„è¾“å‡ºå–‚å…¥æœ¬å±‚çš„å„Experts</p>
<p><span class="math display">\[\begin{aligned} &amp; E
O_t^k=\left[E_{t, 1}^k\left(\mathbf{x}_t^{k-1}\right), \ldots, E_{t,
m_t}^k\left(\mathbf{x}_t^{k-1}\right)\right], t \in[1, \ldots, N] \\
&amp; E O_s^k=\left[E_{s, 1}^k\left(\mathbf{x}_s^{k-1}\right), \ldots,
E_{s, m_s}^k\left(\mathbf{x}_s^{k-1}\right)\right]
\end{aligned}\]</span></p>
<ul>
<li><span class="math display">\[\mathrm{x}_t^{k-1\]</span> æ˜¯ç¬¬ <span
class="math display">\[k-\]</span> å±‚å¯¹ä»»åŠ¡ $$$$ çš„å»ºæ¨¡ç»“æœ</li>
<li><span class="math display">\[E O_t^\]</span> è¡¨ç¤ºç¬¬ $<span
class="math display">\[$ å±‚ä»»åŠ¡ \]</span>$$
ç‹¬å çš„é‚£äº›Expertsçš„è¾“å‡ºå‘é‡çš„é›†åˆ</li>
<li><span class="math display">\[E_{t, i}^\]</span> ä»£è¡¨ç¬¬ $<span
class="math display">\[$ å±‚ä»»åŠ¡ \]</span><span class="math display">\[
ç‹¬å çš„ç¬¬ \]</span>$$ ä¸ªExpert</li>
<li><span class="math display">\[m_\]</span> æ˜¯ä»»åŠ¡ $$$$
ç‹¬å çš„æ‰€æœ‰Expertsçš„ä¸ªæ•°</li>
<li><span class="math display">\[\mathbf{x}_s^{k-1} ã€ E O_s^k ã€ E_{s,
i}^k ã€ m_\]</span> ä»£è¡¨ç±»ä¼¼å«æ„, åªä¸è¿‡æ˜¯é’ˆå¯¹å…±äº«ä¿¡æ¯çš„</li>
</ul>
<p>æœ€ç»ˆå‚ä¸ç¬¬ $<span class="math display">\[$ å±‚ä»»åŠ¡ \]</span><span
class="math display">\[ å»ºæ¨¡çš„æ˜¯ \]</span>E O_t^<span
class="math display">\[ å’Œ \]</span>E O_s^<span class="math display">\[
ä¸­çš„æ‰€æœ‰ \]</span>m_t+m_<span class="math display">\[
ä¸ªExpertsã€‚å…ˆè®¡ç®—è¿™äº›Expertsçš„æƒé‡, å¦‚å…¬å¼ \]</span>(7-5$$ æ‰€ç¤ºã€‚</p>
<p><span
class="math display">\[\mathbf{C}_t^k=G_t^k\left(\mathbf{x}_t^{k-1}\right)
\in R^{m_t+m_s}\]</span></p>
<ul>
<li><span class="math display">\[G_t^\]</span> æ˜¯ç¬¬ $<span
class="math display">\[$ å±‚é’ˆå¯¹ä»»åŠ¡ \]</span>\mathrm{t$$ çš„é—¨æ§å‡½æ•°</li>
<li><span class="math display">\[\mathbf{C}_t^\]</span> æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º
<span class="math display">\[m_t+m_\]</span> çš„æ•°ç»„, è¡¨ç¤ºå¯¹å‚ä¸ç¬¬ $<span
class="math display">\[$ å±‚ä»»åŠ¡ \]</span><span class="math display">\[
å»ºæ¨¡çš„æ˜¯ \]</span>E O_t^<span class="math display">\[ å’Œ \]</span>E
O_s^$$ ä¸­æ‰€æœ‰Expertsçš„æƒé‡ã€‚</li>
</ul>
<p>ç„¶å, å°†æƒé‡ä¸Expertsçš„è¾“å‡ºåŠ æƒåŠ å’Œ, å¾—åˆ°ç¬¬ $<span
class="math display">\[$ å±‚å¯¹ä»»åŠ¡ \]</span>$$ çš„å»ºæ¨¡ç»“æœ <span
class="math inline">\(\mathbf{x}_t^k\)</span>, å¦‚å…¬å¼(7-6)æ‰€ç¤º,
å…¶ä¸­ç¬¦å·"||"è¡¨ç¤ºå°†ä¸¤ä¸ªæ•°ç»„æ‹¼æ¥ä¸€èµ·ã€‚</p>
<p><span class="math display">\[\mathbf{x}_t^k=\sum_{i=1}^{m_t+m_s}
\mathbf{C}_t^k[i] \times\left(E O_t^k \| E O_s^k\right)[i]\]</span></p>
<p>ç¬¬ $<span class="math display">\[$ å±‚å¯¹å…±äº«ä¿¡æ¯ \]</span>_s^$$
çš„å»ºæ¨¡, ä¸å¯¹æŸä¸ªç‰¹å®šç›®æ ‡çš„å»ºæ¨¡ç±»ä¼¼,
åªä¸è¿‡è¦è®©æœ¬å±‚æ‰€æœ‰Expertså‚ä¸å…¶ä¸­ã€‚</p>
<p><span class="math display">\[\begin{aligned} \mathbf{C}_s^k &amp;
=G_s^k\left(\mathbf{x}_s^{k-1}\right) \in R^{T E} \\ \mathbf{x}_s^k
&amp; =\sum_{i=1}^{T E} \mathbf{C}_s^k[i] \times\left(E O_1^k\|\ldots\|
E O_N^k \| E O_s^k\right)[i] \end{aligned}\]</span></p>
<h4 id="ä¸²è¡Œå»ºæ¨¡">ä¸²è¡Œå»ºæ¨¡</h4>
<p>ä¸²è¡Œå»ºæ¨¡ä¸»è¦ç”¨äºç”µå•†åœºæ™¯ã€‚å¦‚åŒå‰é¢æåˆ°çš„ï¼Œç”µå•†ä¸šåŠ¡éœ€è¦å°†ä¸‰ä¸ªæ¦‚ç‡CTR/CVR/CTCVRéƒ½é¢„ä¼°æ¸…æ¥šï¼Œåœ¨é¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å°šæœªæ›å…‰çš„ç‰©æ–™é¢„æµ‹åŒ…æ‹¬CVRåœ¨å†…çš„åˆ†æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œè®­ç»ƒæ•°æ®ä¸­çš„ç‰©æ–™ä¸<strong>é¢„æµ‹æ—¶çš„ç‰©æ–™é›†åˆå­˜åœ¨æ˜æ˜¾å·®å¼‚</strong>ï¼Œå¯¼è‡´"æ ·æœ¬é€‰æ‹©è¯¯å·®"
(Sample Selection Bias, SSB)ï¼Œä¸¥é‡å½±å“æ¨¡å‹æ•ˆæœã€‚</p>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=Y2VlZTY1OTEwN2ExYTBjZWQ5NTBkZWIzOGQyN2Y0NTJfWXI0WWQ0V0FpUHk2eHpZQ0hCVGlNaXVHcWVNRDEyeUFfVG9rZW46S1F3b2JBWGZZb2YwRUR4aDN4eWNxcTNWbjliXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ol type="1">
<li><strong>ESMM</strong></li>
</ol>
<p>ä¸ºäº†å…‹æœä»¥ä¸Šæ ·æœ¬é€‰æ‹©åå·®ï¼Œé˜¿é‡Œçš„Entire Space Multi- task Model (ESMM)
çš„è§£å†³æ€è·¯æ˜¯:</p>
<ul>
<li>å°†CVRä¸CTRã€CTCVRä¸€æ ·ï¼Œéƒ½å»ºæ¨¡åœ¨"æ›å…‰æ ·æœ¬ç©ºé—´"ä¸Š(ç†è®ºä¸Šï¼Œè¿™äº›ä»»åŠ¡éƒ½åº”è¯¥å»ºæ¨¡åœ¨ç²—æ’ç»“æœé›†ä¸Šï¼Œä½†æ˜¯å®ç°èµ·æ¥æœ‰éš¾åº¦ï¼Œæ‰€ä»¥å¤§å®¶éƒ½çº¦å®šä¿—æˆå»ºæ¨¡åœ¨"æ›å…‰æ ·æœ¬"ä¸Šäº†ï¼Œå…¶ä¸­çš„SSBå°±å¿½ç•¥ä¸è®¡äº†)ã€‚</li>
<li>ä½†æ˜¯,æ¯•ç«Ÿ"æ›å…‰æœªç‚¹å‡»"çš„æ ·æœ¬ä¸ç¬¦åˆCVRçš„å®šä¹‰ï¼Œå› æ­¤CVRåªèƒ½ä½œä¸ºéšè—ç›®æ ‡ï¼Œåœ¨å…¶ä»–ç›®æ ‡è¢«ä¼˜åŒ–çš„åŒæ—¶ï¼Œè¢«é—´æ¥ä¼˜åŒ–ã€‚</li>
</ul>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=MDdjNjQxOTFlY2ZhMGNjYWExNWI2YjU0MDU2NzY3MGJfMkhoVXFMY0JXcXpjSGhWS3Z0bkRhNWs4SmFwVjkzVGtfVG9rZW46UUgwQ2JGamhybzVVbEt4S002NGNHOWhPbk9kXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>æ•´ä¸ªæ¨¡å‹ç”±"CTRæ¨¡å—"ä¸"CVRæ¨¡å—"ç»„æˆ, å–‚å…¥çš„éƒ½æ˜¯æ›å…‰æ ·æœ¬</li>
<li>å›¾ 7-7ä¸­çš„Embedding Layerã€Field-wise
Poolingã€MLPéƒ½æ˜¯å¸¸è§„æ“ä½œã€‚å€¼å¾—æ³¨æ„çš„æ˜¯, CTRæ¨¡å—ä¸CVR
æ¨¡å—çš„åº•å±‚Embeddingæ˜¯å…±äº«çš„,
æœ‰åˆ©äºæ­£ä¾‹ä¸°å¯Œçš„CTRä»»åŠ¡å‘æ­£ä¾‹ç¨€ç–çš„CVRä»»åŠ¡è¿›è¡Œ"çŸ¥è¯†è¿ç§»"ã€‚</li>
<li>åœ¨åˆ†åˆ«é¢„æµ‹å¾—åˆ°"æ›å…‰ <span class="math display">\[\rightarro\]</span>
ç‚¹å‡»"æ¦‚ç‡ <span class="math inline">\(\mathrm{pCTR}\)</span>, å’Œ"ç‚¹å‡»
<span class="math display">\[\rightarro\]</span> è´­ä¹°"æ¦‚ç‡pCVRå,
ESMMæ ¹æ®æ¡ä»¶æ¦‚ç‡å…¬å¼, å¾—åˆ°"æ›å…‰ <span
class="math display">\[\rightarro\]</span> è´­ä¹°"æ¦‚ç‡ <span
class="math display">\[p C T C V R=p C T R \times p C V \]</span>
ã€‚</li>
<li>ç”±äº
pCTRå’ŒpCTCVRéƒ½æ˜¯å»ºç«‹åœ¨"æ›å…‰æ ·æœ¬ç©ºé—´"ä¸Šçš„ï¼Œå¯ä»¥è¢«ç›´æ¥ä¼˜åŒ–ï¼Œæ€»æŸå¤±å‡½æ•°å¦‚å…¬å¼(7-9)æ‰€ç¤ºã€‚æ³¨æ„è¿™é‡ŒCVRæ²¡æœ‰è¢«ç›´æ¥ä¼˜åŒ–,
è€Œæ˜¯ä½œä¸º <span class="math display">\[\mathrm{PCTCVR\]</span>
çš„ç»„æˆéƒ¨åˆ†è¢«é—´æ¥ä¼˜åŒ–ã€‚è€Œä¸”CVRä¹Ÿæ˜¯è¢«å…¨ä½“"æ›å…‰æ•°æ®"è®­ç»ƒå‡ºæ¥çš„,
æ¶ˆé™¤äº†è®­ç»ƒä¸é¢„æµ‹ä¸¤é˜¶æ®µé—´çš„"æ ·æœ¬é€‰æ‹©åå·®"ã€‚</li>
</ul>
<p><span class="math display">\[\begin{aligned} L\left(\mathbf{W}_{c t
r}, \mathbf{W}_{c v r}\right) &amp; =\sum_{i=1}^N B C E\left(y_i, d n
n_{c t r}\left(\mathbf{x}_i ; \mathbf{W}_{c t r}\right)\right) \\ &amp;
+\sum_{i=1}^N B C E\left(z_i, d n n_{c t r}\left(\mathbf{x}_i ;
\mathbf{W}_{c t r}\right) \times d n n_{c v r}\left(\mathbf{x}_i ;
\mathbf{W}_{c v r}\right)\right) \end{aligned}\]</span></p>
<ul>
<li><span class="math display">\[\mathbf{x}_\]</span> æ˜¯ç¬¬æ¶¤æ ·æœ¬çš„ç‰¹å¾,
<span class="math display">\[y_\]</span> ä»£è¡¨ç¬¬ $<span
class="math display">\[$ æ¡æ ·æœ¬æ˜¯å¦ç‚¹å‡», \]</span>z_<span
class="math display">\[ ä»£è¡¨ç¬¬ \]</span><span class="math display">\[
æ¡æ ·æœ¬æ˜¯å¦è´­ä¹°, \]</span>$$ ä»£è¡¨æ ·æœ¬æ€»æ•°</li>
<li><span class="math display">\[d n n_{c t r\]</span> å’Œ <span
class="math display">\[d n n_{c v r\]</span> åˆ†åˆ«CTRæ¨¡å—ä¸CVRæ¨¡å—, <span
class="math display">\[\mathbf{W}_{c t r}, \mathbf{W}_{c v r\]</span>
åˆ†åˆ«ä»£è¡¨ä¸¤æ¨¡å—ä¸­è¦å­¦ä¹ çš„æƒé‡</li>
<li>BCEï¼ˆBinary Cross Entropyï¼‰ä»£è¡¨äºŒé˜¶äº¤å‰ç†µå‡½æ•°ã€‚</li>
</ul>
<ol type="1">
<li><strong>ESM2</strong></li>
</ol>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152613215.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p>ESM2è¦é¢„æµ‹ 4 ä¸ªæ¦‚ç‡, åœ¨å›¾ 7-10ä¸­ä»å·¦è‡³å³åˆ†åˆ«æ˜¯:</p>
<ul>
<li>"æ›å…‰ <span class="math display">\[\rightarro\]</span> ç‚¹å‡»"çš„æ¦‚ç‡,
CTR, è®°ä¸º <span class="math display">\[y_1=P(c=1 \mid v=1)\]</span>,
å…¶ä¸­ $<span class="math display">\[$ è¡¨ç¤ºæ›å…‰, \]</span>$$
è¡¨ç¤ºç‚¹å‡»ã€‚</li>
<li>"ç‚¹å‡» <span class="math display">\[\rightarro\]</span>
ç›´æ¥è¡Œä¸º"çš„æ¦‚ç‡, è®°ä¸º <span class="math display">\[y_2=P(a=1 \mid
c=1\]</span> ã€‚å…¶ä¸­ $$$$ è¡¨ç¤º"ç›´æ¥è¡Œä¸º" (Direct Action, DActionï¼‰,
æ˜¯æŒ‡åƒ"åŠ å…¥è´­ç‰©è½¦"ã€"åŠ å…¥æ„¿æœ›æ¸…å•"è¿™æ ·ä¸è´­ä¹°å¼ºç›¸å…³çš„è¡Œä¸ºã€‚</li>
<li>"ç›´æ¥è¡Œä¸º <span class="math display">\[\rightarro\]</span>
è´­ä¹°"çš„æ¦‚ç‡, è®°ä¸º <span class="math display">\[y_3=P(b=1 \mid
a=1)\]</span>, å…¶ä¸­ $$$$ è¡¨ç¤ºè´­ä¹°ã€‚</li>
<li>"å…¶ä»–è¡Œä¸º <span class="math display">\[\rightarro\]</span>
è´­ä¹°"çš„æ¦‚ç‡, è®°ä¸º <span class="math display">\[y_4=P(b=1 \mid
a=0\]</span> ã€‚</li>
</ul>
<p>åŸºäºä»¥ä¸Š 4 ä¸ªæ¦‚ç‡, ESM2è¦ä¼˜åŒ–ä¸‰ä¸ªç›®æ ‡ã€‚æœ€ç®€å•çš„å°±æ˜¯"æ›å…‰ <span
class="math display">\[\rightarro\]</span> ç‚¹å‡»", æŸå¤±å‡½æ•°å¦‚å…¬å¼ <span
class="math display">\[(7-10\]</span> æ‰€ç¤ºã€‚</p>
<p><span class="math display">\[L o s s_1=\sum_{i=1}^N B C E\left(c_i,
p_i^{c t r}\right)=\sum_{i=1}^N B C E\left(c_i, y_{1
i}\right)\]</span></p>
<ul>
<li><span class="math display">\[c_\]</span> ä»£è¡¨ç¬¬æ¶¤æ ·æœ¬æ˜¯å¦ç‚¹å‡»</li>
<li><span class="math display">\[p_i^{c t r}=y_{1 i\]</span>
æ˜¯æ¨¡å‹é¢„æµ‹çš„ç¬¬ $$$$ æ¡æ ·æœ¬çš„CTR</li>
<li>$$$$ æ˜¯æ‰€æœ‰æ ·æœ¬æ•°é‡, BCEä»£è¡¨äºŒé˜¶äº¤å‰ç†µæŸå¤±å‡½æ•°</li>
</ul>
<p>ç¬¬äºŒä¸ªç›®æ ‡æ˜¯"æ›å…‰ <span class="math display">\[\rightarro\]</span>
ç›´æ¥è¡Œä¸º", å¦‚å…¬å¼(7-11)å’Œå…¬å¼(7-12)æ‰€ç¤ºã€‚</p>
<p><span class="math display">\[\begin{aligned} p_i^{\text {ctavr }}=
&amp; P\left(a_i=1 \mid v_i=1\right) \\ = &amp; P\left(a_i=1 \mid
c_i=1\right) \times P\left(c_i=1 \mid v_i=1\right) \\ = &amp; y_{2 i}
y_{1 i} \\ &amp; \text { Loss }_2=\sum_{i=1}^N B C E\left(a_i,
p_i^{\text {ctavr }}\right) \end{aligned}\]</span></p>
<ul>
<li><span class="math display">\[p_i^{c t a v r\]</span>
ä»£è¡¨æ¨¡å‹é¢„æµ‹å‡ºçš„ç¬¬ $<span class="math display">\[$ ä¸ªæ ·æœ¬&quot;æ›å…‰
\]</span>$$ ç›´æ¥è¡Œä¸º"çš„æ¦‚ç‡</li>
<li><span class="math display">\[a_\]</span> ä»£è¡¨ç¬¬ $$$$
æ¡æ ·æœ¬å‘ç”Ÿäº†ç›´æ¥è¡Œä¸º</li>
</ul>
<p>ç¬¬ä¸‰ä¸ªç›®æ ‡æ˜¯"æ›å…‰ <span class="math display">\[\rightarro\]</span>
è´­ä¹°"ï¼Œå¦‚å…¬å¼(7-13) (7-15)æ‰€ç¤ºã€‚</p>
<p><span class="math display">\[\begin{gathered} p_i^{c v
r}=P\left(b_i=1 \mid c_i=1\right) \\ =P\left(b_i=1 \mid a_i=0\right)
\times P\left(a_i=0 \mid c_i=1\right)+P\left(b_i=1 \mid a_i=1\right)
\times P\left(a_i=1 \mid c_i=1\right) \\ =y_{4 i}\left(1-y_{2
i}\right)+y_{3 i} y_{2 i} \\ p_i^{\text {ctcvr }}=p_i^{c t r} \times
p_i^{c v r}=y_{1 i}\left(y_{4 i}\left(1-y_{2 i}\right)+y_{3 i} y_{2
i}\right) \\ \operatorname{Loss}_3=\sum_{i=1}^N B C E\left(b_i, p_i^{c t
c v r}\right) \end{gathered}\]</span></p>
<ul>
<li><span class="math display">\[p_i^{c v r\]</span> ä»£è¡¨æ¨¡å‹é¢„æµ‹å‡ºçš„ç¬¬
$<span class="math display">\[$ æ¡æ ·æœ¬&quot;ç‚¹å‡» \]</span>$$
è´­ä¹°"çš„æ¦‚ç‡</li>
<li><span class="math display">\[p_i^{\text {ctcvr }\]</span>
ä»£è¡¨æ¨¡å‹é¢„æµ‹å‡ºçš„ç¬¬ $<span class="math display">\[$ æ¡æ ·æœ¬&quot;æ›å…‰
\]</span>$$ è´­ä¹°"çš„æ¦‚ç‡</li>
<li><span class="math display">\[b_\]</span> ä»£è¡¨ç¬¬ $$$$
æ¡æ ·æœ¬æ˜¯å¦è´­ä¹°</li>
</ul>
<p>æœ€ç»ˆESM2è¦ä¼˜åŒ–çš„ç›®æ ‡æ˜¯ä¸‰ä¸ªç›®æ ‡çš„æŸå¤±ä¹‹å’Œï¼Œå…¶ä¸­ <span
class="math display">\[w_1 ã€ w_2 ã€ w_\]</span>
æ˜¯ä¸‰ä¸ªç”¨äºè°ƒèŠ‚æŸå¤±æƒé‡çš„è¶…å‚æ•°ã€‚å’ŒESMMä¸€æ ·, è¿™é‡ŒCVRæ˜¯ä½œä¸ºéšè—ç›®æ ‡,
è¢«é—´æ¥ä¼˜åŒ–ã€‚</p>
<p><span class="math display">\[\text { Loss }=w_1 \text { Loss }_1+w_2
\text { Loss }_2+w_3 \text { Loss }_3\]</span></p>
<ol type="1">
<li>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¾‹å¦‚<strong>ESCM2</strong>ã€<strong>çŸ¥è¯†è¿ç§»</strong>ç­‰ç­‰</li>
</ol>
<h2 id="å¤šåœºæ™¯æ¨è">å¤šåœºæ™¯æ¨è</h2>
<p>å¤šåœºæ™¯æ¨èï¼Œå…³æ³¨çš„æ˜¯æŒ‡ä½¿ç”¨æ¨èæœåŠ¡çš„ç”¨æˆ·ä¸­ï¼Œå­˜åœ¨ç€<strong>å·®å¼‚æ˜æ˜¾çš„ä¸åŒæ¶ˆè´¹æ¨¡å¼</strong>ã€‚</p>
<ul>
<li>åŒä¸€ä¸ªè§†é¢‘APPï¼Œ"å•åˆ—æ¨¡å¼"è®©ç”¨æˆ·æœ‰"æ²‰æµ¸å¼"æ£€éªŒï¼Œæ¯æ¬¡åªçœ‹åˆ°å½“å‰è§†é¢‘ï¼Œçœ‹ä¸åˆ°å…¶ä»–å€™é€‰è§†é¢‘ï¼›è€Œ"åŒåˆ—æ¨¡å¼"å…è®¸ç”¨æˆ·ä¸€æ¬¡æ€§çœ‹åˆ°å¤šä¸ªå€™é€‰è§†é¢‘ï¼Œæœ‰æ›´å¤šé€‰æ‹©è‡ªç”±ã€‚è¿™ä¸¤ç§äº§å“æ¨¡å¼ä¸‹çš„ç”¨æˆ·è¡Œä¸ºæ¨¡å¼ï¼Œå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚</li>
<li>ä¸€ä¸ªæä¾›å…¨çƒæœåŠ¡çš„APP,ä¸åŒå›½å®¶çš„ç”¨æˆ·çš„æ¶ˆè´¹æ¨¡å¼ï¼Œæ˜æ˜¾ä¸åŒã€‚</li>
<li>åŒä¸€ä¸ªAPPï¼Œä¸åŒç”Ÿå‘½å‘¨æœŸçš„ç”¨æˆ·å·®å¼‚æ˜æ˜¾ï¼Œéœ€è¦æ¨èç³»ç»Ÿæœ‰ä¸åŒçš„åº”å¯¹ç­–ç•¥ã€‚å¯¹ä½æ´»è·ƒç”¨æˆ·ï¼Œæ¨èç»“æœè¦ä»¥çƒ­é—¨ç‰©æ–™ä¸ºä¸»ï¼›</li>
</ul>
<p>æ³¨æ„å¤šåœºæ™¯æ¨èä¸å‡ ä¸ªç›¸å…³æ¦‚å¿µçš„å¼‚åŒ:</p>
<ul>
<li><strong>å¤šåœºæ™¯æ¨èvs.å¤šä»»åŠ¡/å¤šç›®æ ‡æ¨è</strong>ã€‚å¤šåœºæ™¯ç ”ç©¶çš„æ˜¯å¦‚ä½•ç”¨ä¸€ä¸ªæ¨¡å‹å°†è¡Œä¸ºæ¨¡å¼æœ‰æ˜æ˜¾å·®å¼‚çš„ä¸åŒç”¨æˆ·ç¾¤ä½“éƒ½æœåŠ¡å¥½ï¼Œè€Œæ— è®ºç”¨æˆ·æ¥è‡ªå“ªä¸ªç¾¤ä½“ï¼Œæ¨¡å‹å¯èƒ½éƒ½è¦é¢„æµ‹å¤šä¸ªç›®æ ‡ã€‚æ‰€ä»¥ï¼Œå¤šåœºæ™¯ä¸å¤šç›®æ ‡æ˜¯ç›¸äº’æ­£äº¤çš„ä¸¤ä¸ªç»´åº¦</li>
<li><strong>å¤šåœºæ™¯æ¨èvs.
è·¨åœºæ™¯(è·¨åŸŸ)æ¨è</strong>ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¤šåœºæ™¯æ¨èæŒ‡çš„æ˜¯ç”¨ä¸€å¥—æ¨¡å‹æ¥æœåŠ¡æ‰€æœ‰ç”¨æˆ·ï¼Œ
è€Œè·¨åœºæ™¯æ¨èéœ€è¦ç”¨ä¸åŒæ¨¡å‹æ¥æœåŠ¡ä¸åŒç”¨æˆ·ï¼Œè€Œå¤šä¸ªæ¨¡å‹ä¹‹é—´å­˜åœ¨çŸ¥è¯†è¿ç§»ã€‚æ¯”å¦‚æŸå…¬å¸å·²ç»æœ‰ä¸€æ¬¾å›¾æ–‡APPç§¯ç´¯äº†å¤§æ‰¹æ´»è·ƒç”¨æˆ·ï¼Œç°åœ¨è¯¥å…¬å¸æ–°æ¨å‡ºäº†ä¸€æ¬¾è§†é¢‘APPã€‚</li>
</ul>
<h3 id="ç‰¹å¾ä½ç½®">ç‰¹å¾ä½ç½®</h3>
<p>è¦æƒ³æ¨¡å‹èƒ½å¤Ÿè¯†åˆ«å‡ºä¸åŒåœºæ™¯ã€ä¸åŒç”¨æˆ·ç¾¤ä½“å¹¶åŒºåˆ«å¯¹å¾…,
é¦–å…ˆè¦è®¾è®¡å‡º"åœºæ™¯æŒ‡ç¤º" (Scenario Indicator)ç‰¹å¾ã€‚æ¯”å¦‚:</p>
<ul>
<li>"APPæ¨¡å¼"èƒ½å¤ŸåŒºåˆ†ç”¨æˆ·è¯·æ±‚æ˜¯æ¥è‡ª"å•åˆ—æ¨¡å¼"è¿˜æ˜¯"åŒåˆ—æ¨¡å¼"ã€‚</li>
<li>ä¸ºäº†åŒºåˆ†ä¸åŒå›½å®¶çš„ç”¨æˆ·ï¼Œå›½ç±ã€è¯­è¨€åº”å½“è¢«çº³ä¸ºç‰¹å¾ã€‚</li>
<li>ä¸ºäº†åŒºåˆ†"ä½æ´»ç”¨æˆ·"ä¸"é«˜æ´»ç”¨æˆ·"ã€‚"è¿‘7å¤©ç”¨æˆ·æ´»è·ƒå¤©æ•°"ã€"æ˜¯å¦æ–°æ³¨å†Œç”¨æˆ·"ã€"ç”¨æˆ·æ˜¯å¦ç™»é™†"è¿™äº›éƒ½åº”è¯¥è¢«ç”¨ä½œç‰¹å¾ã€‚</li>
</ul>
<p>ä½†æ˜¯ä»…ä»…è®¾è®¡å‡ºä»¥ä¸Šç‰¹å¾, è¿˜æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚å¦‚ä½•å°†è¿™äº›ç‰¹å¾åŠ å…¥æ¨¡å‹,
ä¹Ÿå¤§æœ‰è®²ç©¶ã€‚æœ¬ä¹¦å‰é¢æ›¾ç»åå¤å¼ºè°ƒ,
"DNNæ˜¯ä¸‡èƒ½å‡½æ•°æ¨¡æ‹Ÿå™¨"çš„ç¥è¯å·²ç»ç ´ç­ã€‚å¦‚æœæŠŠ"åœºæ™¯æŒ‡ç¤º"ç‰¹å¾åŠ åˆ°DNNåº•éƒ¨ï¼Œè®©å®ƒä»¬çš„ä¿¡æ¯"æŒ‰éƒ¨å°±ç­"å±‚å±‚ä¸Šä¼ ,
ææ€•å†é‡è¦çš„ä¿¡æ¯åˆ°è¾¾é¡¶éƒ¨æ—¶, ä¹Ÿä¸å‰©ä¸‹å¤šå°‘äº†ã€‚å¦å¤–,
DNNçš„åº•å±‚å¾€å¾€ç”±è®¸å¤šField Embeddingæ‹¼æ¥è€Œæˆï¼Œ
åŠ¨è¾„ä¸Šåƒç»´æ˜¯å°æ„æ€ã€‚è¿™æ—¶ä½ å†æ–°åŠ å…¥ä¸€ä¸¤ä¸ª"åœºæ™¯æŒ‡æ ‡"ç‰¹å¾,
"æ³¯ç„¶ä¼—äººçŸ£"ï¼Œææ€•ä¹Ÿä¸ä¼šå¤ªå¥‡æ€ªã€‚</p>
<p>ä¸ºè§£å†³ä»¥ä¸Šé—®é¢˜,
ä¸šç•Œå¸¸è§çš„ä½œæ³•æ˜¯å°†"åœºæ™¯æŒ‡ç¤º"ç‰¹å¾åŠ åˆ°ç¦»æœ€ç»ˆç›®æ ‡è¿‘ä¸€ç‚¹çš„åœ°æ–¹ã€‚</p>
<ul>
<li>"åœºæ™¯æŒ‡ç¤º"ç‰¹å¾ï¼Œé€šè¿‡ä¸€ä¸ªéå¸¸æµ…çš„ç½‘ç»œ, å¾—åˆ°logit scene</li>
<li>å…¶ä»–å¯¹åœºæ™¯ä¸æ•æ„Ÿçš„ç‰¹å¾ï¼ŒæŒ‰ç…§å¸¸è§„å¤„ç†ï¼Œç»è¿‡æ¯”è¾ƒå¤æ‚çš„ç½‘ç»œï¼Œå¾—åˆ°logit
common</li>
</ul>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152613359.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<p>è¿™æ ·åš, ä½¿"åœºæ™¯æŒ‡ç¤º"ç‰¹å¾å¯¹æœ€ç»ˆé¢„æµ‹ç»“æœçš„å½±å“ç›´æ¥æœ‰åŠ›,
é¿å…è‡ªDNNåº•éƒ¨å±‚å±‚ä¸Šä¼ å¸¦æ¥çš„ä¿¡æ¯æŸå¤±,æ›´æœ‰æœºä¼šå°†å¦‚æ­¤é‡è¦çš„å…ˆéªŒçŸ¥è¯†è´¯å½»åˆ°"é¡¶"ã€‚</p>
<h3 id="æ¨¡å‹ç»“æ„">æ¨¡å‹ç»“æ„</h3>
<p>å¤šåœºæ™¯æ¨èæ¨¡å‹ç”±ä¸¤å¤§éƒ¨åˆ†ç»„æˆ:</p>
<ul>
<li>åœºæ™¯å…±äº«éƒ¨åˆ†: éœ€è¦å…±äº«ç»“æ„å’Œå‚æ•°æ¥å»ºæ¨¡æ¥å»ºæ¨¡å¤šåœºæ™¯ä¹‹é—´çš„å…±æ€§,
è®©æ•°æ®ä¸°å¯Œçš„åœºæ™¯å°†å…±äº«å‚æ•°å……åˆ†è®­ç»ƒ, å€Ÿæ­¤å‘æ•°æ®ç¨€å°‘çš„åœºæ™¯è¿ç§»çŸ¥è¯†ã€‚</li>
<li>åœºæ™¯ç‹¬ç«‹éƒ¨åˆ†ï¼šå„åœºæ™¯ä¹Ÿéœ€è¦ç‹¬ç«‹çš„ç»“æ„ä¸å‚æ•°,
ä»¥å»ºæ¨¡è¯¥åœºæ™¯çš„ç‰¹æ®Šæ€§ã€‚</li>
</ul>
<p>ä»£è¡¨ç®—æ³•ï¼š</p>
<ol type="1">
<li>Split&amp;Mergeï¼šå°†å…±äº«ç»“æ„å’Œå„åœºæ™¯ç‹¬æœ‰çš„ç»“æ„ä¸²è”èµ·æ¥</li>
</ol>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=NmE5OTI2NmIwNDkxMDFjMGI3YjBkOWNkNzU5OTY0MjdfYzBJRGZrNzNmU2VrVEN1ZmRNOExKcFlyb2hldWF2amFfVG9rZW46TXRZQmJYOEY1b2dxdlp4Q3FNcmNPYTRKbnRjXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ol type="1">
<li><strong>HMoE</strong></li>
</ol>
<p>åœ¨æ™®é€š"ä¸²è”"ç»“æ„çš„åŸºç¡€ä¸Š, é˜¿é‡Œäº2020å¹´æå‡ºäº†Hybrid
Mixture-of-Expertsï¼ˆHMoEï¼‰ç»“æ„ã€‚HMoEçš„ç†è®ºå‡è®¾æ˜¯, å¯¹æŸä¸ªæ ·æœ¬,
é™¤äº†å…¶æ‰€åœ¨åœºæ™¯çš„æ¨¡å‹çš„æ‰“åˆ†, å…¶ä»–åœºæ™¯çš„æ¨¡å‹æ‰“åˆ†ä¹Ÿæœ‰å€Ÿé‰´æ„ä¹‰ã€‚æ‰€ä»¥,
HMoEåœ¨"åœºæ™¯ç‹¬ç«‹éƒ¨åˆ†"å¼•å…¥äº†MoEç»“æ„,
æ¯ä¸ªåœºæ™¯ä¸‹çš„æ¨¡å‹éƒ½ç›¸å½“äºä¸€ä¸ªExpertã€‚ä¸€æ¡æ ·æœ¬è¦ç»è¿‡å¤šä¸ªExpertæ‰“åˆ†,
å†å¯¹å„Expertçš„æ‰“åˆ†åŠ æƒç›¸åŠ , å¾—åˆ°æœ€ç»ˆå¾—åˆ†ã€‚</p>
<figure>
<img
src="https://hw1g2gf4y6m.feishu.cn/space/api/box/stream/download/asynccode/?code=NTk2YTAwMGY2MGU0ZmU3NmJmNjY5Mzc1ZjdkZmJhZjBfOU9PcnZUTng1TXQxWmVQVFJCV2JnYVo1d2N2NHIzR1NfVG9rZW46RHg4T2JPUGdNb1ZwMHp4ZEwwcWNtTWlYblVoXzE3MDUzODk5NjU6MTcwNTM5MzU2NV9WNA"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ol type="1">
<li><strong>STAR</strong></li>
</ol>
<p>é˜¿é‡Œäº2021å¹´æå‡ºSTARå‹ç»“æ„, çªç ´äº†ä¼ ç»Ÿçš„ä¸²è”æ¨¡å¼,
å°†"åœºæ™¯å…±äº«éƒ¨åˆ†"ä¸"åœºæ™¯ç‹¬ç«‹éƒ¨åˆ†"æ›´ç´§å¯†åœ°"äº¤ç»‡"åœ¨ä¸€èµ·ã€‚è®¡ç®—è¿‡ç¨‹å¦‚å…¬å¼(7-37)æ‰€ç¤º,
ç½‘ç»œç»“æ„å¦‚å›¾7-16æ‰€ç¤ºã€‚</p>
<p><span class="math display">\[\begin{aligned} y_p &amp; =D N
N\left(\mathbf{x}_p ; \mathbf{W}_p^*\right) \\ \mathbf{W}_p^* &amp;
=\left[\mathbf{W}_{p, 1}^*, \ldots, \mathbf{W}_{p, K}^*\right] \\
\mathbf{W}_{p, i}^* &amp; =\mathbf{W}_{p, i} \otimes \mathbf{W}_i
\end{aligned}\]</span></p>
<ul>
<li>ç¬¬ $<span class="math display">\[$ ä¸ªåœºæ™¯çš„è¾“å…¥ $\mathbf{x}_p$,
ç»è¿‡ä¸€ä¸ªDNNç»“æ„, å¾—åˆ°ç¬¬ \]</span><span class="math display">\[
ä¸ªåœºæ™¯çš„è¾“å‡º \]</span>y_<span class="math display">\[ ã€‚è¿™ä¸ªDNNçš„å‚æ•°æ˜¯
\]</span>_p^$$ ã€‚</li>
<li><span class="math display">\[\mathbf{W}_p^*=\left[\mathbf{W}_{p,
1}^*, \ldots, \mathbf{W}_{p, K}^*\right\]</span> æ˜¯é•¿åº¦ä¸º $<span
class="math display">\[$ çš„æ•°ç»„, \]</span>_{p, i}^<span
class="math display">\[ æ˜¯DNNç¬¬ \]</span><span class="math display">\[
å±‚çš„æƒé‡, \]</span>$$ æ˜¯DNNçš„æ€»å±‚æ•°ã€‚</li>
<li><span class="math display">\[\mathbf{W}_{p, i}^\]</span> æ˜¯ç”±ç¬¬
$<span class="math display">\[$ ä¸ªåœºæ™¯ç‹¬æœ‰ç»“æ„çš„ç¬¬ \]</span><span
class="math display">\[ å±‚æƒé‡ \]</span><em>{p, i}<span
class="math display">\[, ä¸å…±äº«ç»“æ„çš„ \]</span><span
class="math display">\[ å±‚æƒé‡ \]</span></em>{i}<span
class="math display">\[ï¼Œé€šè¿‡æŒ‰ä½ç›¸ä¹˜ (ç”¨ \]</span>$$ è¡¨ç¤º)å¾—åˆ°ã€‚</li>
</ul>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152613918.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h3 id="æ¨¡å‹å‚æ•°">æ¨¡å‹å‚æ•°</h3>
<p>åŠ¨æ€æƒé‡æ³•</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152614074.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<ul>
<li>æŠŠ"åœºæ™¯æŒ‡ç¤º"ï¼ˆScenario Indicatorï¼‰ç‰¹å¾ <span
class="math display">\[\boldsymbol{z\]</span>ï¼Œå–‚è¿›"æƒé‡ç”Ÿæˆå™¨"ï¼ˆWeight
Generator, WGï¼Œç”ŸæˆåŠ¨æ€æƒé‡å‘é‡ <span class="math display">\[\mathbf{D
W}=W G(\mathbf{z}\]</span> ã€‚</li>
<li>å†å°† <span class="math display">\[\boldsymbol{D}
\boldsymbol{W\]</span> å˜å½¢ï¼ˆReshapeï¼‰æˆä¸€ä¸ªåˆé€‚å½¢çŠ¶çš„DNN, è®°ä¸º <span
class="math display">\[F_{\mathrm{DW}\]</span> æˆ– <span
class="math display">\[F_{W G(\mathbf{z})\]</span>ã€‚æ¯”å¦‚, å‡è®¾ <span
class="math display">\[\boldsymbol{D} \boldsymbol{W\]</span>
çš„é•¿åº¦æ˜¯<span class="math display">\[640=32 \times 16+16 \times
8\]</span>, æ‰€ä»¥ <span class="math display">\[\boldsymbol{D}
\boldsymbol{W\]</span> å¯ä»¥å˜å½¢ä¸ºä¸€ä¸ªä¸‰å±‚çš„MLPï¼Œæ¯å±‚çš„ç¥ç»å…ƒä¸ªæ•°åˆ†åˆ«ä¸º
<span class="math display">\[[32,16,8\]</span>ã€‚</li>
<li>å°†è¿™ä¸ªæ ¹æ®"åœºæ™¯æŒ‡ç¤º"ç‰¹å¾åŠ¨æ€ç”Ÿæˆçš„ç½‘ç»œ<span
class="math display">\[F_{W
G(\mathbf{z})}\]</span>ï¼Œåº”ç”¨äºåœ¨æ•´ä¸ªæ¨èæ¨¡å‹çš„å…³é”®ä½ç½®ã€‚</li>
</ul>
<p>å¤§å‹æ¨èç³»ç»Ÿç»å¸¸è¦åŒæ—¶è§£å†³<strong>"å¤šåœºæ™¯+å¤šç›®æ ‡"</strong>çš„æ¨èé—®é¢˜,
å³ä¸ä»…ä¸€ä¸ªæ¨¡å‹è¦åº”å¯¹å¤šä¸ªåœºæ™¯,
è€Œä¸”åœ¨æ¯ä¸ªåœºæ™¯ä¸‹è¿˜è¦åŒæ—¶é¢„æµ‹å¤šä¸ªç›®æ ‡ã€‚é˜¿é‡Œäº2022å¹´æå‡ºM2Mï¼ˆMulti-scenario
Multi-taskï¼‰ç»“æ„ï¼Œè¿ç”¨"åŠ¨æ€æƒé‡"æ¨¡å¼è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<p>M2Mæ•´ä½“ä¸Šè¿˜æ˜¯éµå¾ªäº†ç»å…¸çš„MMoEç»“æ„, åªä¸è¿‡åœ¨ä¸¤ä¸ªå…³é”®ä½ç½®, "è¯„ä¼°å¤šä¸ª
Expertçš„é‡è¦æ€§çš„Gate"ä¸"å„ä»»åŠ¡ç‹¬æœ‰çš„Tower",
é‡‡ç”¨äº†æ ¹æ®"åœºæ™¯æŒ‡ç¤º"ç‰¹å¾åŠ¨æ€ç”Ÿæˆçš„æƒé‡, ä»¥æ›´å¥½åœ°é€‚åº”ä¸åŒåœºæ™¯çš„ç‰¹ç‚¹ã€‚</p>
<figure>
<img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/(null)-20240116152614240.(null)"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åç«¯å¼€å‘ã€‘Go-kitä¸Ginæ¡†æ¶</title>
    <url>/2024/01/23/go-kit/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="go-kitæ¡†æ¶">Go-kitæ¡†æ¶</h1>
<p>Go-kit
æ˜¯ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œã€æ˜“äºä½¿ç”¨çš„<strong>åˆ†å¸ƒå¼å¾®æœåŠ¡æ¡†æ¶</strong>ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ„å»ºå¥å£®ã€å¯ç»´æŠ¤å’Œå¯æµ‹è¯•çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å®ƒé€šè¿‡æä¾›ä¸€ç³»åˆ—å¯ç»„åˆçš„ç»„ä»¶ï¼Œè§£å†³äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¸¸è§é—®é¢˜ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚Go-kit
çš„æ ¸å¿ƒç†å¿µæ˜¯é€šè¿‡å¯æ’æ‹”çš„ç»„ä»¶æ¥å®ç°å¾®æœåŠ¡çš„åŠŸèƒ½ï¼Œè¿™äº›ç»„ä»¶åŒ…æ‹¬æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è¯·æ±‚è¿½è¸ªã€æ—¥å¿—è®°å½•å’Œç›‘æ§ç­‰ã€‚</p>
<h2 id="go-kitåŸºæœ¬æ¶æ„">Go-kitåŸºæœ¬æ¶æ„</h2>
<p>Go-kit
åŒ…å«äº†ä¸€äº›åŸºæœ¬çš„ç»„ä»¶ï¼Œå¦‚æœåŠ¡ç«¯ç‚¹ï¼ˆEndpointï¼‰ã€ä¼ è¾“å±‚ï¼ˆTransportï¼‰ã€æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚æœåŠ¡ç«¯ç‚¹æ˜¯
Go-kit ä¸­å¾®æœåŠ¡çš„åŸºæœ¬æ„å»ºå—ï¼Œç”¨äºå®šä¹‰ RPC
æ¶ˆæ¯æ¨¡å¼ã€‚ä¼ è¾“å±‚æä¾›äº†å°†ç‰¹å®šåºåˆ—åŒ–ç®—æ³•ç»‘å®šåˆ°ç«¯ç‚¹çš„è¾…åŠ©æ–¹æ³•ï¼Œç›®å‰æ”¯æŒ
JSON å’Œ HTTP åè®®ã€‚</p>
<p>Go-kitçš„æ¶æ„æ¥æºï¼šhttps://github.com/go-kit/kit</p>
<p>åŸºæœ¬çš„Go-kitçš„ä¸‰å±‚æ¶æ„</p>
<ol type="1">
<li><p>Transport</p>
<p>ä¸»è¦è´Ÿè´£ä¸HTTPã€gRPCã€thriftç­‰ç›¸å…³çš„é€»è¾‘ï¼Œæä¾›ç«¯åˆ°ç«¯çš„é€šä¿¡æœåŠ¡ï¼Œä¸åŒçš„ä¼ è¾“åè®®æ¥å®ç°è¿™äº›åŠŸèƒ½ï¼Œæœ€å¸¸è§çš„åè®®æ˜¯TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’ŒUDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ã€‚</p></li>
<li><p>Endpoint</p>
<p>å®šä¹‰Requestå’ŒResponseæ ¼å¼,å¹¶å¯ä»¥ä½¿ç”¨è£…é¥°å™¨åŒ…è£…å‡½æ•°ï¼Œä»¥æ­¤æ¥å®ç°å„ç§ä¸­é—´ä»¶åµŒå¥—ã€‚</p></li>
<li><p>Service</p>
<p>ä¸»è¦èŒè´£æ˜¯å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒåŠŸèƒ½å’Œè§„åˆ™ï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„ä¸šåŠ¡ç±»ã€æ¥å£ç­‰ã€‚</p></li>
</ol>
<h2 id="go-kitçš„demo">Go-kitçš„demo</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç»™å‡ºä¸€ä¸ªç®€å•çš„demoï¼ˆå¯¹è¾“å…¥çš„å­—ç¬¦ä¸²å¤§å†™è½¬æ¢å’Œå­—ç¬¦ä¸²ä¸ªæ•°è®¡æ•°çš„åŠŸèƒ½ï¼‰æ¥å¯¹Go-kitçš„åŸºæœ¬æ¶æ„çš„å®ç°å’ŒåŠŸèƒ½å±•ç¤ºï¼š</p>
<h3 id="serviceå±‚"><strong>Serviceå±‚</strong></h3>
<p>é¦–å…ˆè¿™ä¸ªå±‚ä¼šç»™å‡ºä¸šåŠ¡çš„é€»è¾‘å®ç°ï¼Œæ ¸å¿ƒåŠŸèƒ½å’Œè§„åˆ™</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> services<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;errors&quot;</span><br>	<span class="hljs-string">&quot;strings&quot;</span><br>)<br><br><span class="hljs-comment">// StringService å®šä¹‰äº†å­—ç¬¦ä¸²å¤„ç†æœåŠ¡çš„æ¥å£</span><br><span class="hljs-comment">// è¿™ä¸ªåœ°æ–¹ç»™å‡ºæ¥å£ï¼Œç›¸å½“äºæ˜¯è™šåŸºç±»ï¼Œåç»­çš„æ¥å£ç»§æ‰¿éœ€è¦å®ç°è¿™éƒ¨åˆ†çš„å‡½æ•°å†…å®¹</span><br><span class="hljs-keyword">type</span> StringService <span class="hljs-keyword">interface</span> &#123;<br>	Uppercase(<span class="hljs-type">string</span>) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) <span class="hljs-comment">//è¿”å›çš„å€¼æ˜¯ä¸€ä¸ªstringå’Œä¸€ä¸ªerror</span><br>	Count(<span class="hljs-type">string</span>) <span class="hljs-type">int</span><br>&#125;<br><br><span class="hljs-comment">// SStringService å®ç°äº† StringService æ¥å£</span><br><span class="hljs-keyword">type</span> SStringService <span class="hljs-keyword">struct</span>&#123;&#125;<br><br><span class="hljs-comment">// Uppercase å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(SStringService)</span></span> Uppercase(s <span class="hljs-type">string</span>) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-keyword">if</span> s == <span class="hljs-string">&quot;&quot;</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, errors.New(<span class="hljs-string">&quot;Input string is empty&quot;</span>)<br>	&#125;<br>	<span class="hljs-keyword">return</span> strings.ToUpper(s), <span class="hljs-literal">nil</span> <span class="hljs-comment">//ç›´æ¥è°ƒç”¨stringçš„åŠŸèƒ½æ¥å®ç°å¤§å°å†™è½¬æ¢</span><br>&#125;<br><br><span class="hljs-comment">// Count è¿”å›å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(SStringService)</span></span> Count(s <span class="hljs-type">string</span>) <span class="hljs-type">int</span> &#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(s)<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>å®ç°åŠŸèƒ½serviceçš„æ–¹å¼ä¸€èˆ¬æ€»ç»“æ¥è¯´æ˜¯ï¼š</p>
<ul>
<li>å®šä¹‰æœåŠ¡æ¥å£Interface{}ï¼Œå†å®šä¹‰ç»“æ„ä½“æ¥å®ç°è¿™ä¸ªæ¥å£çš„å‡½æ•°æ¥å®ç°ç»§æ‰¿</li>
<li>å…·ä½“çš„å‡½æ•°å†…å®¹å°±è¡¨ç¤ºäº†ä¸šåŠ¡çš„å®é™…åŠŸèƒ½</li>
</ul>
<h3 id="endpointå±‚"><strong>Endpointå±‚</strong></h3>
<p>è¿™éƒ¨åˆ†ä¼šç»™å‡ºä¸åŒçš„endpointæ¥å£çš„ç±»å‹å®šä¹‰ï¼Œä½¿ç”¨ä¸åŒçš„typeå®šä¹‰requestå’Œresponseçš„jsonæ ¼å¼ç±»å‹ï¼Œç”¨äºåç»­çš„å˜é‡çš„é€‰æ‹©å‘½å</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> endpoints<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;context&quot;</span><br>	<span class="hljs-string">&quot;github.com/go-kit/kit/endpoint&quot;</span><br>	<span class="hljs-string">&quot;go-kit-test/services&quot;</span><br>)<br><br><span class="hljs-comment">//è¿™ä¸ªåœ°æ–¹å€ŸåŠ©go-kitæ¥å®ç°endpointçš„å†…å®¹</span><br><span class="hljs-comment">// uppercaseRequest å’Œ uppercaseResponse ç”¨äº Uppercase ç«¯ç‚¹</span><br><span class="hljs-keyword">type</span> uppercaseRequest <span class="hljs-keyword">struct</span> &#123;<br>	S <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;s&quot;`</span><br>&#125;<br><br><span class="hljs-keyword">type</span> uppercaseResponse <span class="hljs-keyword">struct</span> &#123;<br>	V   <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;v&quot;`</span><br>	Err <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;err,omitempty&quot;`</span><br>&#125;<br><br><span class="hljs-comment">// countRequest å’Œ countResponse ç”¨äº Count ç«¯ç‚¹</span><br><span class="hljs-keyword">type</span> countRequest <span class="hljs-keyword">struct</span> &#123;<br>	S <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;s&quot;`</span><br>&#125;<br><br><span class="hljs-keyword">type</span> countResponse <span class="hljs-keyword">struct</span> &#123;<br>	V <span class="hljs-type">int</span> <span class="hljs-string">`json:&quot;v&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>å®šä¹‰æ€»çš„Endpointsæ¥å£ï¼Œ<code>type Endpoints</code>è¿™ä¸ªåœ°æ–¹å°†ä¼šç”¨äºåç»­çš„å¯¹è±¡çš„åˆ›å»ºï¼Œ<code>func MakeEndpoints</code>å‡½æ•°å°†è¢«å…¶ä»–çš„å‡½æ•°è¿›è¡Œè°ƒç”¨ç”¨äºåˆ›å»ºå†…éƒ¨çš„ç«¯ç‚¹å¯¹è±¡ï¼Œå…¶ä¸­åœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨ä»¥ä¸‹çš„å‡½æ•°æ¥åˆ†åˆ«åˆ›å»ºä¸¤ä¸ªåŠŸèƒ½çš„ç«¯å£ç±»å‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Endpoints <span class="hljs-keyword">struct</span> &#123;<br>	UppercaseEndpoint endpoint.Endpoint<br>	CountEndpoint     endpoint.Endpoint<br>&#125;<br><br><span class="hljs-comment">// MakeEndpoints åˆ›å»ºå¹¶è¿”å›æ‰€æœ‰æœåŠ¡ç«¯ç‚¹</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MakeEndpoints</span><span class="hljs-params">(svc services.StringService)</span></span> Endpoints &#123;<br>	<span class="hljs-keyword">return</span> Endpoints&#123;<br>		UppercaseEndpoint: MakeUppercaseEndpoint(svc),<br>		CountEndpoint:     MakeCountEndpoint(svc),<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">// MakeUppercaseEndpoint åˆ›å»º Uppercase ç«¯ç‚¹</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MakeUppercaseEndpoint</span><span class="hljs-params">(svc services.StringService)</span></span> endpoint.Endpoint &#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, request <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> (<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-type">error</span>) &#123;<br>		req := request.(uppercaseRequest)<br>		result, err := svc.Uppercase(req.S)<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			<span class="hljs-keyword">return</span> uppercaseResponse&#123;result, err.Error()&#125;, <span class="hljs-literal">nil</span><br>		&#125;<br>		<span class="hljs-keyword">return</span> uppercaseResponse&#123;result, <span class="hljs-string">&quot;&quot;</span>&#125;, <span class="hljs-literal">nil</span><br>	&#125;<br>&#125;<br><br><span class="hljs-comment">// MakeCountEndpoint åˆ›å»º Count ç«¯ç‚¹</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MakeCountEndpoint</span><span class="hljs-params">(svc services.StringService)</span></span> endpoint.Endpoint &#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, request <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> (<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-type">error</span>) &#123;<br>		req := request.(countRequest)<br>		result := svc.Count(req.S)<br>		<span class="hljs-keyword">return</span> countResponse&#123;result&#125;, <span class="hljs-literal">nil</span><br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="transportå±‚">Transportå±‚</h3>
<p>ä¸»ä½“çš„å®ç°æ¡†æ¶ï¼Œåˆ†åˆ«ç»™å‡ºäº†ä¸¤ä¸ªä¸åŒæœåŠ¡æ¥å£çš„<code>response</code>å’Œ<code>request</code>çš„æ•°æ®ç±»å‹è¿™éƒ¨åˆ†ç»™å‡º<code>json</code>æ ¼å¼</p>
<p><code>http.NewServeMux()</code>è¿”å›ä¸€ä¸ªæ–°çš„<code>http.ServeMux</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†HTTPè¯·æ±‚çš„è¯·æ±‚è½®è¯¢å™¨ï¼ˆrequest
routerï¼‰ã€‚æ¥ä¸‹æ¥ï¼Œä¸º<code>/uppercaseå’Œ/count</code>è·¯å¾„åˆ†åˆ«é…ç½®äº†æ–°çš„<code>httptransport.NewServer</code>æœåŠ¡</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> uppercaseRequest <span class="hljs-keyword">struct</span> &#123;<br>	S <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;s&quot;`</span><br>&#125;<br><br><span class="hljs-keyword">type</span> uppercaseResponse <span class="hljs-keyword">struct</span> &#123;<br>	V   <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;v&quot;`</span><br>	Err <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;err,omitempty&quot;`</span><br>&#125;<br><br><span class="hljs-comment">// countRequest å’Œ countResponse ç”¨äº Count ç«¯ç‚¹</span><br><span class="hljs-keyword">type</span> countRequest <span class="hljs-keyword">struct</span> &#123;<br>	S <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;s&quot;`</span><br>&#125;<br><br><span class="hljs-keyword">type</span> countResponse <span class="hljs-keyword">struct</span> &#123;<br>	V <span class="hljs-type">int</span> <span class="hljs-string">`json:&quot;v&quot;`</span><br>&#125;<br><span class="hljs-comment">// MakeHTTPHandler åˆ›å»º HTTP å¤„ç†ç¨‹åº</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MakeHTTPHandler</span><span class="hljs-params">(endpoints endpoints.Endpoints)</span></span> http.Handler &#123;<br>	options := []httptransport.ServerOption&#123;<br>		httptransport.ServerErrorEncoder(errorEncoder),<br>	&#125;<br>	<span class="hljs-comment">//http.NewServeMux()è¿”å›ä¸€ä¸ªæ–°çš„http.ServeMuxï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†HTTPè¯·æ±‚çš„è¯·æ±‚è½®è¯¢å™¨ï¼ˆrequest routerï¼‰ã€‚</span><br>	<span class="hljs-comment">//æ¥ä¸‹æ¥ï¼Œä¸º/uppercaseå’Œ/countè·¯å¾„åˆ†åˆ«é…ç½®äº†httptransport.NewServerï¼š</span><br>	m := http.NewServeMux()<br>	<span class="hljs-comment">//httptransport.NewServeræ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—å‡ ä¸ªå‚æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„HTTPæœåŠ¡å™¨ç«¯ç‚¹ï¼š</span><br>	m.Handle(<span class="hljs-string">&quot;/uppercase&quot;</span>, httptransport.NewServer(<br>		endpoints.UppercaseEndpoint,<br>		decodeUppercaseRequest,<br>		encodeResponse,<br>		options...,<br>	))<br>	m.Handle(<span class="hljs-string">&quot;/count&quot;</span>, httptransport.NewServer(<br>		endpoints.CountEndpoint,<br>		decodeCountRequest,<br>		encodeResponse,<br>		options...,<br>	))<br><br>	<span class="hljs-keyword">return</span> m<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>æ³¨æ„åœ¨å®šä¹‰endpointçš„æ—¶å€™ï¼Œè¦å¯¹requestç¼–ç ï¼Œå¯¹responseè§£ç </strong></p>
<p>å…·ä½“çš„è§£ç å’Œç¼–ç çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">decodeUppercaseRequest</span><span class="hljs-params">(_ context.Context, r *http.Request)</span></span> (<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-keyword">var</span> request uppercaseRequest<br>	<span class="hljs-keyword">if</span> err := json.NewDecoder(r.Body).Decode(&amp;request); err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br>	<span class="hljs-keyword">return</span> request, <span class="hljs-literal">nil</span><br>&#125;<br><br><span class="hljs-comment">// decodeCountRequest è§£ç  HTTP è¯·æ±‚å¹¶åˆ›å»º Count è¯·æ±‚ç»“æ„</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">decodeCountRequest</span><span class="hljs-params">(_ context.Context, r *http.Request)</span></span> (<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-keyword">var</span> request countRequest<br>	<span class="hljs-keyword">if</span> err := json.NewDecoder(r.Body).Decode(&amp;request); err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br>	<span class="hljs-keyword">return</span> request, <span class="hljs-literal">nil</span><br>&#125;<br><br><span class="hljs-comment">// encodeResponse å°†å“åº”ç¼–ç ä¸º JSON å¹¶å†™å…¥ HTTP å“åº”</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">encodeResponse</span><span class="hljs-params">(_ context.Context, w http.ResponseWriter, response <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> <span class="hljs-type">error</span> &#123;<br>	<span class="hljs-keyword">return</span> json.NewEncoder(w).Encode(response)<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="mainä¸»å±‚">Mainä¸»å±‚</h3>
<p>è¿™ä¸€å±‚æ˜¯æœ€å¤–å±‚çš„è°ƒç”¨å±‚ï¼š<code>go run main.go</code>ï¼Œè¿™ä¸€å±‚çš„é€»è¾‘å®ç°ä¸»è¦æ˜¯ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªserviceæœåŠ¡æ¥å£å¯¹è±¡</li>
<li>å°†æ¥å£å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥å¹¶ç”Ÿæˆendpointç›¸åº”çš„ç«¯ç‚¹</li>
<li><code>httpHandler := transports.MakeHTTPHandler(eps)</code>è¿™ä¸€æ­¥æ˜¯äº§ç”Ÿ<code>http</code>çš„æ ¹æ®æä¾›çš„Endpointé…ç½®æ¥åˆ›å»ºä¸€ä¸ªHTTPå¤„ç†ç¨‹åºï¼Œè¿™ä¸ªå¤„ç†ç¨‹åºè´Ÿè´£å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„HTTPè¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯</li>
<li>å¯¹äºä»»ä½•æ¥åˆ°æ ¹è·¯å¾„ï¼ˆ<code>"/"</code>ï¼‰çš„è¯·æ±‚ï¼Œéƒ½åº”è¯¥ç”±<code>httpHandler</code>æ¥å¤„ç†ã€‚httpHandleræ˜¯åœ¨ä¹‹å‰çš„æ­¥éª¤ä¸­åˆ›å»ºçš„HTTPå¤„ç†ç¨‹åºï¼Œå®ƒçŸ¥é“å¦‚ä½•å¤„ç†<code>HTTP</code>è¯·æ±‚å¹¶ç”Ÿæˆå“åº”ã€‚è¿™æ„å‘³ç€å½“ä½ è®¿é—®æœåŠ¡å™¨çš„æ ¹URL<code>ï¼ˆä¾‹å¦‚ï¼Œhttp://localhost:8080/ï¼‰</code>æ—¶ï¼ŒhttpHandlerä¸­å®šä¹‰çš„å¤„ç†é€»è¾‘å°†ä¼šè¢«æ‰§è¡Œ</li>
<li>å…¶ä¸­ç«¯å£8080å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡ŒæŒ‡å®š</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;go-kit-test/endpoints&quot;</span><br>	<span class="hljs-string">&quot;go-kit-test/services&quot;</span><br>	<span class="hljs-string">&quot;go-kit-test/transports&quot;</span><br>	<span class="hljs-string">&quot;net/http&quot;</span><br>	<span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	svc := services.SStringService&#123;&#125;    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯¹è±¡svc</span><br>	eps := endpoints.MakeEndpoints(svc) <span class="hljs-comment">//æ¥æ”¶svcä½œä¸ºè¾“å…¥ï¼Œåˆ›å»ºendpointç«¯ç‚¹</span><br>	httpHandler := transports.MakeHTTPHandler(eps)<br><br>	http.Handle(<span class="hljs-string">&quot;/&quot;</span>, httpHandler)<br>	port := <span class="hljs-string">&quot;:8080&quot;</span><br>	<span class="hljs-keyword">if</span> p := os.Getenv(<span class="hljs-string">&quot;PORT&quot;</span>); p != <span class="hljs-string">&quot;&quot;</span> &#123;<br>		port = <span class="hljs-string">&quot;:&quot;</span> + p<br>	&#125;<br><br>	<span class="hljs-built_in">println</span>(<span class="hljs-string">&quot;Service listening on port&quot;</span> + port)<br>	http.ListenAndServe(port, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="go-kitginæ¶æ„">Go-kit+Ginæ¶æ„</h1>
<p><strong>Go-kit</strong>æ˜¯ä¸€ä¸ªå¾®æœåŠ¡å·¥å…·é›†ï¼Œå®ƒæä¾›äº†æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è¯·æ±‚è¿½è¸ªã€æ—¥å¿—è®°å½•å’Œç›‘æ§ç­‰åŠŸèƒ½ï¼Œå¸®åŠ©å¼€å‘è€…æ„å»ºå¥å£®ã€å¯ç»´æŠ¤ã€å¯æµ‹è¯•çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
<p><strong>Gin</strong>æ˜¯ä¸€ä¸ªè½»é‡çº§çš„<strong>Go
Web</strong>æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªä¼˜é›…çš„APIå’Œä¸­é—´ä»¶æ”¯æŒï¼Œä½¿å¾—ç¼–å†™Webåº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ å¿«é€Ÿå’Œç®€å•</p>
<p><strong>å°†ä¸¤è€…è¿›è¡Œç»“åˆï¼š</strong>Ginè´Ÿè´£å¤„ç†HTTPè¯·æ±‚å’Œå“åº”ï¼Œæä¾›è·¯ç”±å’Œä¸­é—´ä»¶åŠŸèƒ½ï¼Œè€Œgo-kitåˆ™å¯ä»¥å¤„ç†æœåŠ¡é—´çš„é€šä¿¡ï¼Œæä¾›æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ç­‰åˆ†å¸ƒå¼ç³»ç»ŸåŠŸèƒ½ã€‚go-kitå’ŒGinçš„ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥ä½¿å¾—Go
Webåº”ç”¨çš„å¼€å‘æ›´åŠ é«˜æ•ˆå’Œæ¨¡å—åŒ–ï¼Œæœ‰åŠ©äºæ„å»ºé«˜æ€§èƒ½ã€å¯ä¼¸ç¼©ä¸”æ˜“äºç»´æŠ¤çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
<h2 id="apiserviceå®ç°">ApiServiceå®ç°</h2>
<p>æˆ‘ä»¬éœ€è¦åˆ©ç”¨ginå¯¹webç«¯çš„åº”ç”¨ç¨‹åºè¿›è¡Œå®ç°ï¼Œå› æ­¤åœ¨è¿™ä¸ªæ¶æ„ä¹‹ä¸‹æˆ‘ä»¬è®¾è®¡çš„æ¡†æ¶ä¸ºï¼š</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240127123105999.png" alt="Gin+Gokitæ¶æ„å›¾ç»“æ„" style="zoom:50%;" /></p>
<p>å…¶ä¸­<code>servicesã€endpointsã€transports</code>çš„åŠŸèƒ½å’ŒåŸæ¥çš„<code>go-kit</code>åŸºæœ¬ä¸€æ ·ï¼Œè€Œ<code>handler</code>ä¸»è¦å¤„ç†çš„æ˜¯ginçš„å…³äº<code>web</code>ç«¯å†…å®¹çš„æ§åˆ¶ï¼Œä¸‹é¢ç»™å‡ºå…·ä½“çš„å®ç°</p>
<h3 id="serviceå±‚-1">Serviceå±‚</h3>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> services<br><span class="hljs-keyword">type</span> IUserService <span class="hljs-keyword">interface</span> &#123;<br>	GetName(userId <span class="hljs-type">int</span>) <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-keyword">type</span> UserService <span class="hljs-keyword">struct</span> &#123;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s UserService)</span></span> GetName(userId <span class="hljs-type">int</span>) <span class="hljs-type">string</span> &#123;<br>	<span class="hljs-keyword">if</span> userId == <span class="hljs-number">101</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;calvin&quot;</span><br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;guest&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹ç»™å‡ºäº†å…·ä½“çš„ä¸šåŠ¡çš„å®ç°æ¥å£åŠŸèƒ½</p>
<h3 id="endpointå±‚-1">Endpointå±‚</h3>
<p>åœ¨å®ç°ç«¯å£çš„è¿‡ç¨‹ä¸­ä¸€èˆ¬éƒ½éœ€è¦å¯¹ç›¸å…³çš„<code>type</code>ç±»å‹è¿›è¡Œå®šä¹‰å’Œå¯¹åº”çš„<code>json</code>æ ¼å¼çš„æè¿°ï¼Œå‡½æ•°<code>GetUserEndPoint</code>è¿”å›ä¸€ä¸ª<code>endpoint.Endpoint</code>çš„ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°ç”¨äºåç»­çš„è°ƒç”¨äº§ç”Ÿ<code>endpoint</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs GO"><span class="hljs-keyword">package</span> endpoints<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;ApiService/services&quot;</span><br>	<span class="hljs-string">&quot;context&quot;</span><br>	<span class="hljs-string">&quot;github.com/go-kit/kit/endpoint&quot;</span><br>)<br><span class="hljs-keyword">type</span> UserRequest <span class="hljs-keyword">struct</span> &#123;<br>	Uid <span class="hljs-type">int</span> <span class="hljs-string">`json:&quot;uid&quot;`</span><br>&#125;<br><br><span class="hljs-keyword">type</span> UserResponse <span class="hljs-keyword">struct</span> &#123;<br>	Result <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;result&quot;`</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetUserEndPoint</span><span class="hljs-params">(userService services.IUserService)</span></span> endpoint.Endpoint &#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, request <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> (<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-type">error</span>) &#123;<br>		r := request.(UserRequest)<br>		result := userService.GetName(r.Uid)<br>		<span class="hljs-keyword">return</span> UserResponse&#123;Result: result&#125;, <span class="hljs-literal">nil</span><br>	&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="transportå±‚-1">Transportå±‚</h3>
<p>ä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯å¯¹<code>request</code>å’Œ<code>response</code>çš„è§£ç å’Œç¼–ç è¿‡ç¨‹ï¼Œå› ä¸ºé€šè¿‡å¯¹<code>request</code>çš„è§£ç æ‰èƒ½è½¬æ¢æˆèƒ½è¯†åˆ«çš„jsonæ ¼å¼ï¼Œæ‰èƒ½è¿›è¡Œä¸šåŠ¡ç«¯çš„ä½¿ç”¨ï¼Œè€Œåé¢çš„ç¼–ç æ˜¯ä¸ºäº†èƒ½å¤Ÿè¿›å…¥<code>web</code>ç«¯</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> transports<br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;ApiService/endpoints&quot;</span><br>	<span class="hljs-string">&quot;context&quot;</span><br>	<span class="hljs-string">&quot;errors&quot;</span><br>	httptransport <span class="hljs-string">&quot;github.com/go-kit/kit/transport/http&quot;</span><br>	<span class="hljs-string">&quot;net/http&quot;</span><br>	<span class="hljs-string">&quot;strconv&quot;</span><br>)<br><span class="hljs-comment">// è¯·æ±‚è§£ç å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DecodeUserRequest</span><span class="hljs-params">(ctx context.Context, r *http.Request)</span></span> (<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-comment">// é™å®šå‚æ•°æ¥æº,æˆ‘ä»¬ç›´æ¥ä»urlçš„paramsä¸­è·å–ç”¨æˆ·id</span><br>	<span class="hljs-comment">// è¯·æ±‚æ ¼å¼ç±»ä¼¼äºï¼šhttp://127.0.0.1?uid=101</span><br>	<span class="hljs-keyword">if</span> r.URL.Query().Get(<span class="hljs-string">&quot;uid&quot;</span>) != <span class="hljs-string">&quot;&quot;</span> &#123;<br>		uid, _ := strconv.Atoi(r.URL.Query().Get(<span class="hljs-string">&quot;uid&quot;</span>)) <span class="hljs-comment">//strconv.Atoi(...)å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°</span><br>		<span class="hljs-keyword">return</span> endpoints.UserRequest&#123;Uid: uid&#125;, <span class="hljs-literal">nil</span><br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errors.New(<span class="hljs-string">&quot;å‚æ•°é”™è¯¯&quot;</span>)<br>&#125;<br><br><span class="hljs-comment">// å“åº”ç¼–ç å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">EncodeUserResponse</span><span class="hljs-params">(ctx context.Context, w http.ResponseWriter, response <span class="hljs-keyword">interface</span>&#123;&#125;)</span></span> <span class="hljs-type">error</span> &#123;<br>	<span class="hljs-comment">// å°†è¿”å›ä½“bodyç½®ä¸ºjsonæ ¼å¼</span><br>	<span class="hljs-keyword">return</span> httptransport.EncodeJSONResponse(context.Background(), w, response)<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="handleå±‚">Handleå±‚</h3>
<p>è¿™ä¸€å±‚ä¸»è¦çš„ä½œç”¨å°±æ˜¯åˆ©ç”¨ginæ¥å¯¹webçš„å®ç°ï¼Œä¼ é€’çš„å‚æ•°åˆ†åˆ«æ˜¯</p>
<p><code>handler := httptransport.NewServer(endpoint, transports.DecodeUserRequest, transports.EncodeUserResponse)</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> handler<br><br><span class="hljs-keyword">import</span> (<br>	. <span class="hljs-string">&quot;ApiService/endpoints&quot;</span> <br>	. <span class="hljs-string">&quot;ApiService/services&quot;</span><br>	<span class="hljs-string">&quot;ApiService/transports&quot;</span><br>	<span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><br>	httptransport <span class="hljs-string">&quot;github.com/go-kit/kit/transport/http&quot;</span><br>)<br><span class="hljs-comment">// åˆ›å»º Gin è·¯ç”±</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MakeGinHandler</span><span class="hljs-params">(svc IUserService)</span></span> *gin.Engine &#123;<br>	<span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ªGinå¼•æ“ï¼Œå¹¶é…ç½®äº†ä¸€äº›ä¸­é—´ä»¶</span><br>	r := gin.New()<br>	r.Use(gin.Logger())   <span class="hljs-comment">//ç”¨äºè®°å½•æ¯ä¸ªè¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚è¯·æ±‚æ–¹æ³•ã€URLã€æ‰§è¡Œæ—¶é—´ç­‰</span><br>	r.Use(gin.Recovery()) <span class="hljs-comment">//åœ¨ç¨‹åºå‘ç”Ÿ panic æ—¶æ¢å¤è¿è¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ª500çš„HTTPçŠ¶æ€ç </span><br><br>	<span class="hljs-comment">// åˆ›å»º Go kit çš„ endpoint</span><br>	endpoint := GetUserEndPoint(svc)<br><br>	<span class="hljs-comment">// åˆ›å»º HTTP ä¼ è¾“å±‚å¤„ç†ç¨‹åº</span><br>	handler := httptransport.NewServer(endpoint, transports.DecodeUserRequest, transports.EncodeUserResponse)<br>	r.GET(<span class="hljs-string">&quot;/hello&quot;</span>, gin.WrapH(handler))<br>	<span class="hljs-keyword">return</span> r<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>æ³¨æ„åœ¨è°ƒç”¨åŒ…çš„æ—¶å€™ï¼š</p>
<ul>
<li><code>. "ApiService/endpoints"</code>
é‚£ä¹ˆåœ¨å¼•ç”¨å‡½æ•°çš„æ—¶å€™å°±ä¸éœ€è¦<code>endpoints.XXX()</code></li>
<li><code>"ApiService/transports"</code>é‚£ä¹ˆåœ¨å¼•ç”¨å‡½æ•°çš„æ—¶å€™éœ€è¦<code>transports.XXX()</code></li>
</ul>
<h3 id="mainå±‚">Mainå±‚</h3>
<p>è¿™ä¸€å±‚çš„å®ç°æ˜¯é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤å®ç°çš„ï¼š</p>
<ul>
<li><strong>åˆ›å»ºgo -kitæœåŠ¡</strong></li>
<li><strong>åˆ›å»ºginè·¯ç”±å¹¶ç»‘å®šæœåŠ¡</strong></li>
<li><strong>å¯åŠ¨ginæœåŠ¡å™¨</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs GO"><span class="hljs-keyword">package</span> main<br><span class="hljs-keyword">import</span> (<br>    . <span class="hljs-string">&quot;ApiService/handler&quot;</span><br>    . <span class="hljs-string">&quot;ApiService/services&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>)<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// åˆ›å»º Go kit æœåŠ¡</span><br>    userSvc := UserService&#123;&#125;<br>    <span class="hljs-comment">// åˆ›å»º Gin è·¯ç”±å¹¶ç»‘å®šæœåŠ¡</span><br>    r := MakeGinHandler(userSvc)<br>    <span class="hljs-comment">// å¯åŠ¨ Gin æœåŠ¡å™¨</span><br>    <span class="hljs-keyword">if</span> err := r.Run(<span class="hljs-string">&quot;:8080&quot;</span>); err != <span class="hljs-literal">nil</span> &#123;<br>       log.Fatal(err)<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">è¯´æ˜ï¼Œè¿™ä¸ªdemoè¿è¡Œåï¼Œæµè§ˆå™¨è¾“å…¥ http://127.0.0.1:8080/hello?uid=1999 å³å¯æµ‹è¯•ï¼Œè¿˜å¯ä»¥è¾“å…¥ä¸‹é¢çš„å†…å®¹è¿›è¡Œæµ‹è¯•ï¼š</span><br><span class="hljs-comment"> http://127.0.0.1:8080/hello</span><br><span class="hljs-comment"> http://127.0.0.1:8080</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure>
<h1 id="ginç»Ÿä¸€æ”¶é›†è·¯ç”±">Ginç»Ÿä¸€æ”¶é›†è·¯ç”±</h1>
<p>ç»Ÿä¸€æ”¶é›†è·¯ç”±ï¼ˆunified routing
collectionï¼‰é€šå¸¸æŒ‡çš„æ˜¯å°†æ‰€æœ‰çš„è·¯ç”±é…ç½®é›†ä¸­åˆ°ä¸€ä¸ªåœ°æ–¹ç®¡ç†ï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿åœ°ç®¡ç†å’Œç»´æŠ¤è·¯ç”±ã€‚Gin
æœ¬èº«å·²ç»æä¾›äº†ä¸€ä¸ªè·¯ç”±å™¨ï¼ˆRouterï¼‰å¯¹è±¡ï¼Œç”¨äºæ”¶é›†å’Œç®¡ç†æ‰€æœ‰çš„è·¯ç”±ã€‚ç»Ÿä¸€æ”¶é›†è·¯ç”±çš„å¥½å¤„åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ˜“äºç»´æŠ¤ï¼šæ‰€æœ‰çš„è·¯ç”±éƒ½åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä¾¿äºæŸ¥çœ‹å’Œä¿®æ”¹ã€‚</li>
<li>è·¯ç”±é‡ç”¨ï¼šå¯ä»¥å®šä¹‰å…¨å±€ä¸­é—´ä»¶ï¼Œè¿™äº›ä¸­é—´ä»¶ä¼šåœ¨æ‰€æœ‰è·¯ç”±ä¸Šåº”ç”¨ï¼Œè€Œä¸éœ€è¦åœ¨æ¯ä¸ªè·¯ç”±ä¸Šé‡å¤ç¼–å†™ã€‚</li>
<li>æ›´å¥½çš„é”™è¯¯å¤„ç†ï¼šå¯ä»¥åœ¨ç»Ÿä¸€çš„åœ°æ–¹å¤„ç†è·¯ç”±é”™è¯¯ï¼Œä¾‹å¦‚æœªæ‰¾åˆ°è·¯ç”±æˆ–æ–¹æ³•ä¸å…è®¸ç­‰ã€‚</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šGin è·¯ç”±å™¨ä¼šé¢„ç¼–è¯‘è·¯ç”±ï¼Œè¿™å¯ä»¥æé«˜å¤„ç†è¯·æ±‚çš„æ•ˆç‡</li>
</ul>
<h2 id="å±€éƒ¨çš„è·¯ç”±è§„åˆ™åˆå§‹åŒ–">å±€éƒ¨çš„è·¯ç”±è§„åˆ™åˆå§‹åŒ–</h2>
<p>é¦–å…ˆå®šä¹‰å±€éƒ¨çš„å…·ä½“è·¯ç”±è§„åˆ™ï¼Œè¿™é‡Œç»™å‡ºä¾‹å­
<code>GetUserRoutes</code>å’Œ<code>GetVideoRoutes</code>ï¼Œåœ¨ Gin
è·¯ç”±å™¨ä¸­æ³¨å†Œä¸è§†é¢‘ç›¸å…³çš„è·¯ç”±è§„åˆ™ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª<code>*gin.RouterGroup</code>å‚æ•°</p>
<p>å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å­è·¯ç”±ç»„
videoï¼Œè¿™æ˜¯é€šè¿‡è°ƒç”¨<code>route.Group("/videos")</code>å®ç°çš„ã€‚è¿™ä¸ªå­è·¯ç”±ç»„å°†ä¼šå¤„ç†æ‰€æœ‰ä»¥<code>/videos</code>
å¼€å¤´çš„è¯·æ±‚ã€‚</p>
<p>ç„¶åï¼Œ<code>video.GET("/getVideoId", handler.GetVideoId)</code>
è¿™è¡Œä»£ç ä¸ºè·¯å¾„<code>/videos/getVideoId</code> æ³¨å†Œäº†ä¸€ä¸ªæ–°çš„ GET
è¯·æ±‚å¤„ç†å‡½æ•°ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs Go"><span class="hljs-keyword">package</span> route<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;ApiService/handler&quot;</span><br>    <span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><br>)<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetUserRoutes</span><span class="hljs-params">(route *gin.RouterGroup)</span></span> &#123;<br>    user := route.Group(<span class="hljs-string">&quot;/users&quot;</span>)<br>    &#123;<br>       user.GET(<span class="hljs-string">&quot;/getUserId&quot;</span>, handler.GetUserId)<br>    &#125;<br>&#125;<br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;ApiService/handler&quot;</span><br>    <span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><br>)<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetVideoRoutes</span><span class="hljs-params">(route *gin.RouterGroup)</span></span> &#123;<br>    video := route.Group(<span class="hljs-string">&quot;/videos&quot;</span>)<br>    &#123;<br>       video.GET(<span class="hljs-string">&quot;/getVideoId&quot;</span>, handler.GetVideoId)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="å…¨å±€è·¯ç”±è§„åˆ™ç»Ÿä¸€">å…¨å±€è·¯ç”±è§„åˆ™ç»Ÿä¸€</h2>
<p>è®¾ç½®Ginè·¯ç”±<strong>ç»Ÿä¸€æ”¶é›†çš„</strong>
<strong><code>CollectRoute</code>çš„å‡½æ•°</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ä¸€ç³»åˆ—çš„è·¯ç”±è§„åˆ™æ³¨å†Œåˆ°
Gin è·¯ç”±å™¨å®ä¾‹ä¸­ã€‚r <strong>æ˜¯ Gin
çš„è·¯ç”±å™¨å®ä¾‹</strong>ï¼Œè¿™éƒ¨åˆ†å†…å®¹å¯ä»¥å¿½ç•¥ï¼ˆsvc
æ˜¯æŸä¸ªæœåŠ¡æ¥å£çš„å®ä¾‹ï¼Œè¿™é‡Œæ˜¯æŒ‡ IUserService æ¥å£çš„å®ä¾‹ï¼‰ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs Go"><span class="hljs-keyword">package</span> route<br><br><span class="hljs-keyword">import</span> (<br>    . <span class="hljs-string">&quot;ApiService/handler&quot;</span><br>    . <span class="hljs-string">&quot;ApiService/services&quot;</span><br>    <span class="hljs-string">&quot;ApiService/transports&quot;</span><br>    <span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><br>    httptransport <span class="hljs-string">&quot;github.com/go-kit/kit/transport/http&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">CollectRoute</span><span class="hljs-params">(r *gin.Engine, svc IUserService)</span></span> *gin.Engine &#123;<br>    r.Use(gin.Logger())<br>    r.Use(gin.Recovery())<br><br>    handler := httptransport.NewServer(MakeGinHandler(svc), transports.DecodeUserRequest, transports.EncodeUserResponse)<br>    api := r.Group(<span class="hljs-string">&quot;&quot;</span>)<br>    &#123;<br>       GetUserRoutes(api)<br>       GetVideoRoutes(api)<br>       api.GET(<span class="hljs-string">&quot;/hello&quot;</span>, gin.WrapH(handler))<br>    &#125;<br>    api.POST(<span class="hljs-string">&quot;/ping&quot;</span>, Ping)<br>    api.GET(<span class="hljs-string">&quot;/ping&quot;</span>, Ping)<br><br>    <span class="hljs-keyword">return</span> r<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="ä¸»å‡½æ•°åˆå§‹åŒ–è°ƒç”¨">ä¸»å‡½æ•°åˆå§‹åŒ–è°ƒç”¨</h2>
<p>åœ¨ Gin Web æ¡†æ¶ä¸­ï¼Œ<code>gin.Default()</code> åˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤çš„ Gin
è·¯ç”±å™¨å®ä¾‹</p>
<p><code>r = route.CollectRoute(r, userSvc)</code>è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†ä¸€ç³»åˆ—çš„è·¯ç”±è§„åˆ™æ³¨å†Œåˆ°
Gin è·¯ç”±å™¨å®ä¾‹ä¸­</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs Go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// åˆ›å»º Go kit æœåŠ¡</span><br>    userSvc := UserService&#123;&#125;<br>    <span class="hljs-comment">// åˆ›å»º Gin è·¯ç”±å¹¶ç»‘å®šæœåŠ¡</span><br>    r := gin.Default()<br>    r = route.CollectRoute(r, userSvc)<br>    <span class="hljs-comment">//r := MakeGinHandler(userSvc)</span><br>    <span class="hljs-comment">// å¯åŠ¨ Gin æœåŠ¡å™¨</span><br>    <span class="hljs-keyword">if</span> err := r.Run(<span class="hljs-string">&quot;:8080&quot;</span>); err != <span class="hljs-literal">nil</span> &#123;<br>       log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="å®é™…è¿è¡Œç»“æœ">å®é™…è¿è¡Œç»“æœ</h2>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240127180429934.png" alt="æ ¹æ®ä¸åŒçš„urlåœ°å€é€‰æ‹©ä¸åŒçš„è¾“å‡º" style="zoom:67%;" /></p>
]]></content>
      <categories>
        <category>åç«¯å¼€å‘</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€åç«¯å¼€å‘ã€‘ConsulæœåŠ¡ä¸é…ç½®</title>
    <url>/2024/02/02/consul/</url>
    <content><![CDATA[<meta name="referrer" content="no-referrer"/>
<h1 id="consulä»‹ç»">Consulä»‹ç»</h1>
<p>Consulæ˜¯hashicorpå…¬å¸æ¨å‡ºçš„å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®ã€‚
å†…ç½®äº†æœåŠ¡æ³¨å†Œä¸å‘ç°æ¡†æ¶ã€åˆ†å¸ƒä¸€è‡´æ€§åè®®å®ç°ã€å¥åº·æ£€æŸ¥ã€key/valueå­˜å‚¨ã€å¤šæ•°æ®ä¸­å¿ƒæ–¹æ¡ˆï¼Œä¸å†éœ€è¦ä¾èµ–å…¶å®ƒå·¥å…·ã€‚</p>
<p>Consulæ˜¯ä¸€ä¸ªæœåŠ¡ç½‘ç»œè§£å†³æ–¹æ¡ˆï¼Œå®ƒä½¿å›¢é˜Ÿèƒ½å¤Ÿç®¡ç†æœåŠ¡ä¹‹é—´ä»¥åŠè·¨å¤šäº‘ç¯å¢ƒå’Œè¿è¡Œæ—¶çš„å®‰å…¨ç½‘ç»œè¿æ¥ã€‚Consulæä¾›æœåŠ¡å‘ç°ã€åŸºäºèº«ä»½çš„æˆæƒã€L7æµé‡ç®¡ç†å’ŒæœåŠ¡åˆ°æœåŠ¡åŠ å¯†ã€‚</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240202225407197.png" alt="Consulç¤ºæ„å›¾" style="zoom:50%;" /></p>
<h1 id="consulè§’è‰²">Consulè§’è‰²</h1>
<p>æœåŠ¡å‘ç°å’Œæ³¨å†Œ</p>
<ul>
<li><strong>devï¼š</strong>å¼€å‘æ¨¡å¼</li>
<li><strong>clientï¼š</strong>å®¢æˆ·ç«¯ï¼Œæ¥å—è¯·æ±‚è½¬è¾¾ç»™æœåŠ¡ç«¯é›†ç¾¤ï¼Œå°†httpå’Œdnsæ¥å£è¯·æ±‚è½¬å‘ç»™å±€åŸŸç½‘å†…çš„æœåŠ¡ç«¯é›†ç¾¤ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªä»£ç†çš„è§’è‰²</li>
<li><strong>serverï¼š</strong>æœåŠ¡ç«¯ï¼Œä¿å­˜é…ç½®ä¿¡æ¯ï¼Œé«˜å¯ç”¨é›†ç¾¤ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒçš„serveræ•°æ®æ¨èä¸º3ä¸ªæˆ–5ä¸ª</li>
</ul>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240203112411765.png" alt="Consulå†…éƒ¨è§’è‰²ä»‹ç»" style="zoom:50%;" /></p>
<ul>
<li>ä¸ç®¡æ˜¯serverè¿˜æ˜¯<code>client</code>ï¼Œç»Ÿç§°ä¸º<code>agent</code></li>
<li><code>consul client</code>æ˜¯ç›¸å¯¹æ— çŠ¶æ€çš„ï¼Œåªè´Ÿè´£è½¬å‘<code>rpc</code>åˆ°<code>server</code>ï¼Œèµ„æºå¼€é”€å¾ˆå°‘</li>
<li><code>server</code>æ˜¯ä¸€ä¸ªæœ‰ä¸€ç»„æ‰©å±•åŠŸèƒ½çš„ä»£ç†ï¼Œè¿™äº›åŠŸèƒ½åŒ…æ‹¬å‚ä¸<code>raft</code>é€‰ä¸¾ï¼Œç»´æŠ¤é›†ç¾¤çŠ¶æ€ï¼Œå“åº”<code>rpc</code>æŸ¥è¯¢ï¼Œä¸å…¶å®ƒæ•°æ®ä¸­å¿ƒäº¤äº’<code>wan gossip</code>å’Œè½¬å‘æŸ¥è¯¢ç»™<code>leader</code>æˆ–è¿œç¨‹æ•°æ®ä¸­å¿ƒã€‚</li>
<li>æ¯ä¸ªæ•°æ®ä¸­å¿ƒï¼Œ<code>client</code>å’Œ<code>server</code>æ˜¯æ··åˆçš„ï¼Œä¸€èˆ¬å»ºæœ‰3-5å°<code>server</code></li>
</ul>
<h1 id="å®‰è£…consul">å®‰è£…Consul</h1>
<p>å®‰è£…åœ°å€ï¼š<a
href="https://www.consul.io/">https://www.consul.io/</a>ï¼Œè¿™é‡Œå»ºè®®å®‰è£…ç»ˆç«¯ç‰ˆæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">consul agent -dev -clinent=0.0.0.0<br><span class="hljs-comment">#-devè¡¨ç¤ºå¼€å‘æ¨¡å¼è¿è¡Œï¼Œ -serverè¡¨ç¤ºæœåŠ¡æ¨¡å¼è¿è¡Œ</span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#é»˜è®¤ç«¯å£</span><br>localhost:8500<br></code></pre></td></tr></table></figure>
<p>ç™»é™†è¿™ä¸ªé»˜è®¤çš„ç«¯å£å°±èƒ½çœ‹è§å¯è§†åŒ–çš„ç•Œé¢ <img
src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240202231921098.png"
alt="Consulçš„å¯è§†åŒ–ç•Œé¢" /></p>
<p>è¯¦ç»†çš„è¿è¡ŒæŒ‡ä»¤è§£æ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">consul agent -server -ui -bootstrap-expect=1 -client=0.0.0.0 -<span class="hljs-built_in">bind</span> 0.0.0.0 -data-dir /Users/lihaibin/Workspace/consuldata<br></code></pre></td></tr></table></figure>
<ul>
<li><code>-bootstrap-expect</code>ï¼šè®¾å®šä¸€ä¸ªæ•°æ®ä¸­å¿ƒéœ€è¦çš„æœåŠ¡èŠ‚ç‚¹æ•°ï¼Œå¯ä»¥ä¸è®¾ç½®ï¼Œè®¾ç½®çš„æ•°å­—å¿…é¡»å’Œå®é™…çš„æœåŠ¡èŠ‚ç‚¹æ•°åŒ¹é…ã€‚consulä¼šç­‰å¾…ç›´åˆ°æ•°æ®ä¸­å¿ƒä¸‹çš„æœåŠ¡èŠ‚ç‚¹æ»¡è¶³è®¾å®šæ‰ä¼šå¯åŠ¨é›†ç¾¤æœåŠ¡ã€‚åˆå§‹åŒ–leaderé€‰ä¸¾ï¼Œä¸èƒ½å’Œbootstr-
apæ··ç”¨ã€‚å¿…é¡»é…åˆ-serveré…ç½®ã€‚</li>
<li><code>-bindï¼š</code>ç»‘å®šçš„å†…éƒ¨é€šè®¯åœ°å€ï¼Œé»˜è®¤0.0.0.0ï¼Œå³ï¼Œæ‰€æœ‰çš„æœ¬åœ°åœ°å€ï¼Œä¼šå°†ç¬¬ä¸€ä¸ªå¯ç”¨çš„ipåœ°å€æ•£æ’­åˆ°é›†ç¾¤ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªå¯ç”¨çš„ipv4ï¼Œåˆ™consulå¯åŠ¨æŠ¥é”™ã€‚[::]ipv6ï¼ŒTCP
UDPåè®®ï¼Œç›¸åŒçš„ç«¯å£ã€‚é˜²ç«å¢™é…ç½®ã€‚</li>
<li><code>-clientï¼š</code>å®¢æˆ·ç«¯æ¨¡å¼ï¼Œhttp
dnsï¼Œé»˜è®¤127.0.0.1ï¼Œå›ç¯ä»¤ç‰Œç½‘å€</li>
<li><code>-data-dirï¼š</code>çŠ¶æ€æ•°æ®å­˜å‚¨æ–‡ä»¶å¤¹ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½éœ€è¦ã€‚æ–‡ä»¶å¤¹ä½ç½®éœ€è¦ä¸æ”¶consulèŠ‚ç‚¹é‡å¯å½±å“ï¼Œå¿…é¡»èƒ½å¤Ÿä½¿ç”¨æ“ä½œç³»ç»Ÿæ–‡ä»¶é”ï¼Œunix-basedç³»ç»Ÿä¸‹ï¼Œæ–‡ä»¶å¤¹æ–‡ä»¶æƒé™ä¸º0600ï¼Œæ³¨æ„åšå¥½è´¦æˆ·æƒé™æ§åˆ¶</li>
<li><code>-devï¼š</code>å¼€å‘æ¨¡å¼ï¼Œå»æ‰æ‰€æœ‰æŒä¹…åŒ–é€‰é¡¹ï¼Œå†…å­˜æœåŠ¡å™¨æ¨¡å¼ã€‚</li>
<li><code>-serverï¼š</code>æœåŠ¡ç«¯èŠ‚ç‚¹æ¨¡å¼ã€‚</li>
<li><code>-uiï¼š</code>å†…ç½®web uiç•Œé¢</li>
<li><code>-log-file</code>ï¼šæ—¥å¿—è®°å½•æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰æä¾›æ–‡ä»¶åï¼Œåˆ™é»˜è®¤Consul-æ—¶é—´æˆ³.log</li>
</ul>
<h1 id="consul-ä¸­é»˜è®¤çš„ç«¯å£å·"><strong>Consul
ä¸­é»˜è®¤çš„ç«¯å£å·</strong></h1>
<ol type="1">
<li><strong>æœåŠ¡å™¨RPCï¼ˆé»˜è®¤8300ï¼‰</strong>ï¼šç”±æœåŠ¡å™¨ç”¨æ¥å¤„ç†æ¥è‡ªå…¶ä»–ä»£ç†çš„ä¼ å…¥è¯·æ±‚ï¼Œä»…é™TCPã€‚</li>
<li><strong>Serf
LANï¼ˆé»˜è®¤8301ï¼‰</strong>ï¼šç”¨æ¥å¤„ç†å±€åŸŸç½‘ä¸­çš„å…«å¦ã€‚æ‰€æœ‰ä»£ç†éƒ½éœ€è¦ï¼ŒTCPå’ŒUDPã€‚</li>
<li><strong>Serf
WANï¼ˆé»˜è®¤8302ï¼‰</strong>ï¼šè¢«æœåŠ¡å™¨ç”¨æ¥åœ¨WANä¸Šé—²èŠåˆ°å…¶ä»–æœåŠ¡å™¨ï¼ŒTCPå’ŒUDPã€‚ä»Consul
0.8å¼€å§‹ï¼Œå»ºè®®é€šè¿‡ç«¯å£8302åœ¨LANæ¥å£ä¸Šä¸ºTCPå’ŒUDPå¯ç”¨æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼Œä»¥åŠWANåŠ å…¥æ³›æ»¥åŠŸèƒ½ã€‚</li>
<li><strong>HTTP APIï¼ˆé»˜è®¤8500ï¼‰</strong>ï¼šè¢«å®¢æˆ·ç”¨æ¥ä¸HTTP
APIäº¤è°ˆï¼Œä»…é™TCPã€‚</li>
<li><strong>DNSæ¥å£ï¼ˆé»˜è®¤8600ï¼‰</strong>ï¼šç”¨äºè§£æDNSæŸ¥è¯¢ï¼ŒTCPå’ŒUDPã€‚</li>
</ol>
<h1 id="consulå·¥ä½œåŸç†">Consulå·¥ä½œåŸç†</h1>
<p><strong><code>producer</code></strong>ï¼šæœåŠ¡æä¾›è€…</p>
<p><strong><code>consumer</code></strong>ï¼šæœåŠ¡æ¶ˆè´¹è€…</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240202230444248.png" alt="image-20240202230444248" style="zoom: 50%;" /></p>
<h2 id="æœåŠ¡å‘ç°ä¸æ³¨å†Œ">æœåŠ¡å‘ç°ä¸æ³¨å†Œ</h2>
<ul>
<li><strong>producer</strong>å¯åŠ¨æ—¶ï¼Œä¼šå°†è‡ªå·±çš„<strong><code>ip/host</code></strong>ç­‰ä¿¡æ¯é€šè¿‡å‘é€è¯·æ±‚å‘ŠçŸ¥<strong>consul</strong></li>
<li><strong>consul</strong>æ¥æ”¶åˆ°<strong>producer</strong>çš„æ³¨å†Œä¿¡æ¯åï¼Œæ¯éš”10ç§’ï¼ˆé»˜è®¤ï¼‰ä¼šå‘<strong>producer</strong>å‘é€ä¸€ä¸ªå¥åº·æ£€æŸ¥çš„è¯·æ±‚ï¼Œæ£€æŸ¥<strong>producer</strong>æ˜¯å¦å¤„äºå¯ç”¨çŠ¶æ€</li>
<li><strong><code>post</code></strong>
æœåŠ¡<strong><code>æ³¨å†Œ /health</code></strong>å¥åº·å®šæœŸæ£€æŸ¥</li>
</ul>
<h2 id="æœåŠ¡è°ƒç”¨">æœåŠ¡è°ƒç”¨</h2>
<ul>
<li>å½“<strong>consumer</strong>è¯·æ±‚<strong>product</strong>æ—¶ï¼Œä¼šå…ˆä»<strong><code>consul</code></strong>ä¸­æ‹¿å­˜å‚¨çš„<code>producer</code>æœåŠ¡çš„ipå’Œportçš„ä¸´æ—¶è¡¨ï¼ˆ<strong><code>temp table</code></strong>)ï¼Œä»è¡¨ä¸­ä»»é€‰ä¸€ä¸ª<code>producer</code>çš„ipå’Œ<code>port</code></li>
<li>æ ¹æ®è¿™ä¸ª<code>ip</code>å’Œ<code>port</code>,å‘é€è®¿é—®è¯·æ±‚</li>
<li>æ­¤è¡¨åªåŒ…å«é€šè¿‡å¥åº·æ£€æŸ¥çš„<strong><code>producer</code></strong>ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯éš”10ç§’æ›´æ–°</li>
<li><code>Temp table</code> æ‹‰å–æœåŠ¡åˆ—è¡¨
ä»ä¸´æ—¶è¡¨ä¸­æ‹¿<code>producer</code>çš„ipå’Œç«¯å£å‘é€è¯·æ±‚</li>
</ul>
<h1 id="consulgoå®ç°">Consul+Goå®ç°</h1>
<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­å¯¹äºåœ¨GOé¡¹ç›®ä¸­æ˜¯å¦‚ä½•ç»“åˆ<strong><code>Consul</code></strong>è¿›è¡Œä½¿ç”¨çš„</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240203143606479.png" alt="consulä¸­é—´ä»¶ç›®å½•" style="zoom:50%;" /></p>
<p>é¦–å…ˆç»™å‡º<code>consul</code>ä¸­é—´ä»¶çš„ç»“æ„ä½“å›¾ï¼Œè¿™é‡Œä¸»è¦å¯¹<code>consul</code>è¿›è¡Œäº†<code>sdk</code>çš„å°è£…ï¼ŒåŒ…å«äº†ä»¥ä¸‹çš„å†…å®¹ï¼š</p>
<ol type="1">
<li><code>consulclient</code>ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ¿å—</li>
<li><code>consulconfig</code>ï¼šä¸»è¦æ˜¯ä¸­å¿ƒåŒ–é…ç½®çš„å†…å®¹</li>
<li><code>consulsdk</code>ï¼šä¸»è¦æ˜¯å¯¹ä»¥ä¸Šçš„ä¸¤ä¸ªæ¿å—è¿›è¡Œäº†å°è£…</li>
<li><code>main_test</code>ï¼šæ˜¯ç»™å‡ºäº†ä¸€ä¸ªä¾‹å­å¯¹ä¸Šè¿°çš„å†…å®¹è¿›è¡Œæµ‹è¯•</li>
</ol>
<h3 id="consulclient">Consulclient</h3>
<p>è¿™éƒ¨åˆ†ç€é‡æ¥å†™å¦‚ä½•å®ç°å¯¹æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°çš„åŠŸèƒ½</p>
<ul>
<li><strong>å®šä¹‰ <code>ConsulClient</code> ç»“æ„ä½“</strong>ï¼š</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">goCopy code<br><span class="hljs-keyword">type</span> ConsulClient <span class="hljs-keyword">struct</span> &#123;<br>	client     *consulapi.Client<br>	serverPort <span class="hljs-type">int</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>ConsulClient</code> ç»“æ„ä½“åŒ…å«äº†ä¸€ä¸ª Consul
å®¢æˆ·ç«¯æŒ‡é’ˆå’Œä¸€ä¸ªæœåŠ¡ç«¯å£ã€‚</p>
<ul>
<li><strong>åˆ›å»ºæ–°çš„ Consul å®¢æˆ·ç«¯</strong>ï¼š</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewConsulClient</span><span class="hljs-params">(consulAddress <span class="hljs-type">string</span>, serverPort <span class="hljs-type">int</span>)</span></span> (*ConsulClient, <span class="hljs-type">error</span>) &#123;<br>	config := consulapi.DefaultConfig()<br>	config.Address = consulAddress<br>	client, err := consulapi.NewClient(config)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br>	<span class="hljs-keyword">return</span> &amp;ConsulClient&#123;client: client, serverPort: serverPort&#125;, <span class="hljs-literal">nil</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><code>NewConsulClient</code> å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ Consul
å®¢æˆ·ç«¯å®ä¾‹ã€‚å®ƒæ¥æ”¶ Consul æœåŠ¡å™¨çš„åœ°å€å’ŒæœåŠ¡ç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª
<code>ConsulClient</code> å®ä¾‹ä»¥åŠå¯èƒ½çš„é”™è¯¯ã€‚</p>
<ul>
<li><strong>æ³¨å†ŒæœåŠ¡</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *ConsulClient)</span></span> RegisterService(serviceID, serviceName, serviceHost <span class="hljs-type">string</span>, servicePort <span class="hljs-type">int</span>) <span class="hljs-type">error</span> &#123;<br>	service := &amp;consulapi.AgentServiceRegistration&#123;<br>		ID:      serviceID,<br>		Name:    serviceName,<br>		Address: serviceHost,<br>		Port:    servicePort,<br>	&#125;<br>	<span class="hljs-keyword">return</span> c.client.Agent().ServiceRegister(service)<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><code>RegisterService</code> æ–¹æ³•ç”¨äºå‘ Consul
æ³¨å†ŒæœåŠ¡ã€‚å®ƒæ¥æ”¶æœåŠ¡çš„IDã€åç§°ã€ä¸»æœºå’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶å‘ Consul
æ³¨å†Œè¯¥æœåŠ¡ã€‚</p>
<ul>
<li><strong>æœåŠ¡å‘ç°</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *ConsulClient)</span></span> DiscoverService(serviceName <span class="hljs-type">string</span>) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) &#123;<br>	services, _, err := c.client.Health().Service(serviceName, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">nil</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, err<br>	&#125;<br>	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(services) == <span class="hljs-number">0</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, fmt.Errorf(<span class="hljs-string">&quot;service not found&quot;</span>)<br>	&#125;<br><br>	<span class="hljs-comment">// éšæœºé€‰æ‹©ä¸€ä¸ªæœåŠ¡å®ä¾‹</span><br>	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(services) &gt; <span class="hljs-number">0</span> &#123;<br>		index := rand.Intn(<span class="hljs-built_in">len</span>(services))<br>		service := services[index].Service<br>		address := fmt.Sprintf(<span class="hljs-string">&quot;%v:%v&quot;</span>, service.Address, service.Port)<br>		<span class="hljs-keyword">return</span> address, <span class="hljs-literal">nil</span><br>	&#125;<br><br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, fmt.Errorf(<span class="hljs-string">&quot;no healthy instances found for service %s&quot;</span>, serviceName)<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><code>DiscoverService</code> æ–¹æ³•ç”¨äºä» Consul
ä¸­å‘ç°æœåŠ¡å®ä¾‹ã€‚å®ƒæ¥æ”¶æœåŠ¡åç§°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæœåŠ¡å®ä¾‹çš„åœ°å€ã€‚åœ¨å†…éƒ¨ï¼Œå®ƒé€šè¿‡å¥åº·æ£€æŸ¥æ¥è·å–å¯ç”¨çš„æœåŠ¡å®ä¾‹ï¼Œå¹¶éšæœºé€‰æ‹©ä¸€ä¸ªå¥åº·çš„å®ä¾‹è¿”å›å…¶åœ°å€ã€‚</p>
<h3 id="consulconfig">Consulconfig</h3>
<p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªåŸºæœ¬çš„ Consul é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯ï¼Œç”¨äºä» Consul
ä¸­è·å–ã€è®¾ç½®å’Œåˆ é™¤é”®å€¼å¯¹çš„é…ç½®ä¿¡æ¯ã€‚</p>
<ul>
<li><strong>å®šä¹‰ <code>ConsulConfigCenter</code> ç»“æ„ä½“</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> ConsulConfigCenter <span class="hljs-keyword">struct</span> &#123;<br>	client *consulapi.Client<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>åˆ›å»ºæ–°çš„ <code>Consul</code> é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewConsulConfigCenter</span><span class="hljs-params">(consulAddress <span class="hljs-type">string</span>)</span></span> (*ConsulConfigCenter, <span class="hljs-type">error</span>) &#123;<br>	config := consulapi.DefaultConfig()<br>	config.Address = consulAddress<br>	client, err := consulapi.NewClient(config)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br>	<span class="hljs-keyword">return</span> &amp;ConsulConfigCenter&#123;client: client&#125;, <span class="hljs-literal">nil</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>NewConsulConfigCenter</code> å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ Consul
é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯å®ä¾‹ã€‚å®ƒæ¥æ”¶ Consul æœåŠ¡å™¨çš„åœ°å€ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª
<code>ConsulConfigCenter</code> å®ä¾‹ä»¥åŠå¯èƒ½çš„é”™è¯¯</p>
<ul>
<li><strong>è·å–ç‰¹å®šé”®å¯¹åº”çš„å€¼</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(cc *ConsulConfigCenter)</span></span> GetValue(key <span class="hljs-type">string</span>) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) &#123;<br>	kv := cc.client.KV()<br>	pair, _, err := kv.Get(key, <span class="hljs-literal">nil</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, err<br>	&#125;<br>	<span class="hljs-keyword">if</span> pair == <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, fmt.Errorf(<span class="hljs-string">&quot;key &#x27;%s&#x27; not found&quot;</span>, key)<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(pair.Value), <span class="hljs-literal">nil</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>GetValue</code> æ–¹æ³•ç”¨äºä» Consul
ä¸­è·å–ç‰¹å®šé”®å¯¹åº”çš„å€¼ã€‚å®ƒæ¥æ”¶é”®åä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›é”®å¯¹åº”çš„å€¼ä»¥åŠå¯èƒ½çš„é”™è¯¯ã€‚</p>
<ul>
<li><strong>è®¾ç½®é”®å€¼å¯¹</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(cc *ConsulConfigCenter)</span></span> SetValue(key, value <span class="hljs-type">string</span>) <span class="hljs-type">error</span> &#123;<br>	kv := cc.client.KV()<br>	p := &amp;consulapi.KVPair&#123;Key: key, Value: []<span class="hljs-type">byte</span>(value)&#125;<br>	_, err := kv.Put(p, <span class="hljs-literal">nil</span>)<br>	<span class="hljs-keyword">return</span> err<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>SetValue</code> æ–¹æ³•ç”¨äºåœ¨ Consul
çš„é”®å€¼å­˜å‚¨ä¸­è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ã€‚å®ƒæ¥æ”¶é”®åå’Œå€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶è®¾ç½®åˆ° Consul
ä¸­ã€‚</p>
<ul>
<li><strong>åˆ é™¤é”®å€¼å¯¹</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(cc *ConsulConfigCenter)</span></span> DeleteValue(key <span class="hljs-type">string</span>) <span class="hljs-type">error</span> &#123;<br>	kv := cc.client.KV()<br>	_, err := kv.Delete(key, <span class="hljs-literal">nil</span>)<br>	<span class="hljs-keyword">return</span> err<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>DeleteValue</code> æ–¹æ³•ç”¨äºä» Consul
çš„é”®å€¼å­˜å‚¨ä¸­åˆ é™¤æŒ‡å®šçš„é”®å€¼å¯¹ã€‚å®ƒæ¥æ”¶é”®åä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å¯¹åº”çš„é”®å€¼å¯¹ä»
Consul ä¸­åˆ é™¤ã€‚</p>
<h3 id="consulsdk">ConsulSDK</h3>
<p>å®ç°äº†ä¸€ä¸ªåŸºäºå•ä¾‹æ¨¡å¼çš„ Consul SDKï¼Œç”¨äºç®¡ç† Consul
å®¢æˆ·ç«¯å’Œé…ç½®ä¸­å¿ƒã€‚è®©æˆ‘ä»¬é€æ®µè§£é‡Šä»£ç çš„åŠŸèƒ½</p>
<ul>
<li><strong>å®šä¹‰ <code>ConsulSDK</code> ç»“æ„ä½“</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> ConsulSDK <span class="hljs-keyword">struct</span> &#123;<br>	Client       *ConsulClient<br>	ConfigCenter *ConsulConfigCenter<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>ConsulSDK</code> ç»“æ„ä½“åŒ…å«äº† Consul å®¢æˆ·ç«¯å’Œé…ç½®ä¸­å¿ƒçš„å®ä¾‹</p>
<ul>
<li><strong>å®šä¹‰å…¨å±€å˜é‡å’Œ <code>sync.Once</code> å®ä¾‹</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> (<br>	instance *ConsulSDK<br>	once     sync.Once<br>)<br></code></pre></td></tr></table></figure>
<p>å®šä¹‰äº† <code>instance</code> å˜é‡ç”¨äºä¿å­˜ ConsulSDK
å®ä¾‹ï¼Œ<code>once</code> å˜é‡ç”¨äºç¡®ä¿ <code>GetInstance()</code>
å‡½æ•°åªè¢«æ‰§è¡Œä¸€æ¬¡</p>
<ul>
<li><strong>å®ç° <code>NewConsulSDK</code> å‡½æ•°</strong></li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewConsulSDK</span><span class="hljs-params">(consulAddress <span class="hljs-type">string</span>, serverPort <span class="hljs-type">int</span>)</span></span> (*ConsulSDK, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-comment">// åˆ›å»º Consul å®¢æˆ·ç«¯</span><br>	client, err := NewConsulClient(consulAddress, serverPort)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br><br>	<span class="hljs-comment">// åˆ›å»º Consul é…ç½®ä¸­å¿ƒ</span><br>	configCenter, err := NewConsulConfigCenter(consulAddress)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br><br>	<span class="hljs-comment">// è¿”å› ConsulSDK å®ä¾‹</span><br>	<span class="hljs-keyword">return</span> &amp;ConsulSDK&#123;<br>		Client:       client,<br>		ConfigCenter: configCenter,<br>	&#125;, <span class="hljs-literal">nil</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>NewConsulSDK</code> å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ ConsulSDK å®ä¾‹ï¼Œå®ƒæ¥æ”¶
Consul æœåŠ¡å™¨åœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª ConsulSDK
å®ä¾‹ä»¥åŠå¯èƒ½çš„é”™è¯¯</p>
<ul>
<li><strong>å®ç° <code>GetInstance()</code> å‡½æ•°</strong>ï¼š</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetInstance</span><span class="hljs-params">()</span></span> *ConsulSDK &#123;<br>	<span class="hljs-comment">// ä¿è¯åªæ‰§è¡Œä¸€æ¬¡</span><br>	once.Do(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>		consulAddress := <span class="hljs-string">&quot;127.0.0.1:8500&quot;</span><br>		serverPort := <span class="hljs-number">8080</span><br><br>		<span class="hljs-comment">// åˆ›å»º Consul å®¢æˆ·ç«¯</span><br>		client, err := NewConsulClient(consulAddress, serverPort)<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			fmt.Println(<span class="hljs-string">&quot;Failed to create Consul client:&quot;</span>, err)<br>			os.Exit(<span class="hljs-number">1</span>)<br>		&#125;<br><br>		<span class="hljs-comment">// åˆ›å»º Consul é…ç½®ä¸­å¿ƒ</span><br>		configCenter, err := NewConsulConfigCenter(consulAddress)<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			fmt.Println(<span class="hljs-string">&quot;Failed to create Consul config center:&quot;</span>, err)<br>			os.Exit(<span class="hljs-number">1</span>)<br>		&#125;<br><br>		<span class="hljs-comment">// åˆå§‹åŒ– ConsulSDK å®ä¾‹</span><br>		instance = &amp;ConsulSDK&#123;<br>			Client:       client,<br>			ConfigCenter: configCenter,<br>		&#125;<br>	&#125;)<br>	<span class="hljs-keyword">return</span> instance<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>GetInstance()</code> å‡½æ•°ç”¨äºè·å– ConsulSDK çš„å•ä¾‹å®ä¾‹ã€‚å®ƒé€šè¿‡
<code>once.Do()</code> ç¡®ä¿<strong>åªæ‰§è¡Œä¸€æ¬¡</strong>ï¼Œåˆ›å»º Consul
å®¢æˆ·ç«¯å’Œé…ç½®ä¸­å¿ƒï¼Œå¹¶å°†å…¶ä¿å­˜åˆ°å…¨å±€å˜é‡ <code>instance</code>
ä¸­ï¼Œç„¶åè¿”å›è¯¥å®ä¾‹</p>
<h3 id="main_test.go">Main_test.go</h3>
<p>è¿™ä¸ªéƒ¨åˆ†ä¸»è¦å¯¹ä¸Šè¿°çš„sdkæ¥å£ç»™å‡ºäº†ä¸€ä¸ªå…·ä½“çš„æµ‹è¯•ç”¨ä¾‹</p>
<p>æ³¨æ„åœ¨ç»ˆç«¯è¿è¡Œçš„æ—¶å€™çš„è¿è¡Œä¸ºï¼š<strong><code>go test</code>
goé»˜è®¤å¯¹<code>_test</code>ä¼šè¿›è¡Œæµ‹è¯•</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> consul<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;os&quot;</span><br>	<span class="hljs-string">&quot;testing&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestConsul</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br>	<span class="hljs-comment">//åˆ›å»ºæ–°çš„ consul sdk</span><br>	sdk := GetInstance()<br><br>	<span class="hljs-comment">// æ³¨å†ŒæœåŠ¡</span><br>	serviceID := <span class="hljs-string">&quot;my_service&quot;</span><br>	serviceName := <span class="hljs-string">&quot;my_service&quot;</span><br>	serviceHost := <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>	servicePort := <span class="hljs-number">8080</span><br><br>	err := sdk.Client.RegisterService(serviceID, serviceName, serviceHost, servicePort)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Printf(<span class="hljs-string">&quot;Error registering service: %v\n&quot;</span>, err)<br>		os.Exit(<span class="hljs-number">1</span>)<br>	&#125;<br><br>	<span class="hljs-comment">// å‘ç°æœåŠ¡</span><br>	serviceAddress, err := sdk.Client.DiscoverService(serviceName)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Printf(<span class="hljs-string">&quot;Error discovering service: %v\n&quot;</span>, err)<br>		os.Exit(<span class="hljs-number">1</span>)<br>	&#125;<br>	fmt.Printf(<span class="hljs-string">&quot;Discovered service address: %s\n&quot;</span>, serviceAddress)<br><br>	<span class="hljs-comment">//ä½¿ç”¨ ConsulConfig è·å–é”®å¯¹åº”çš„å€¼</span><br>	value, err := sdk.ConfigCenter.GetValue(<span class="hljs-string">&quot;test&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;Failed to get value:&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	fmt.Println(<span class="hljs-string">&quot;Value:&quot;</span>, value)<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h1 id="consulæŒä¹…æ€§">ConsulæŒä¹…æ€§</h1>
<p>åœ¨Consulä¸­ï¼Œ<strong>æŒä¹…æ€§æ˜¯æŒ‡å­˜å‚¨çš„æ•°æ®åœ¨æœåŠ¡é‡å¯æˆ–è€…é›†ç¾¤é‡æ–°é€‰ä¸¾ç­‰æƒ…å†µä¸‹ä»ç„¶èƒ½å¤Ÿä¿æŒä¸å˜çš„ç‰¹æ€§</strong>ã€‚Consulæä¾›äº†æŒä¹…åŒ–å­˜å‚¨åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·å°†é‡è¦çš„é”®å€¼å¯¹æ•°æ®å­˜å‚¨åœ¨é›†ç¾¤ä¸­ï¼Œå¹¶ç¡®ä¿<strong>==è¿™äº›æ•°æ®å³ä½¿åœ¨ConsulæœåŠ¡é‡å¯åä¹Ÿèƒ½è¢«ä¿ç•™==</strong>ã€‚</p>
<ol type="1">
<li><strong>Catalogæ•°æ®æŒä¹…åŒ–</strong>ï¼š
Consulçš„Catalogå­˜å‚¨äº†æœ‰å…³æœåŠ¡ã€èŠ‚ç‚¹å’Œæ•°æ®ä¸­å¿ƒæˆå‘˜çš„ä¿¡æ¯ã€‚è¿™äº›æ•°æ®è¢«ç”¨äºæœåŠ¡å‘ç°ã€å¥åº·æ£€æŸ¥å’Œè·¯ç”±ç­‰åŠŸèƒ½ã€‚Catalogæ•°æ®çš„æŒä¹…åŒ–ç¡®ä¿äº†åœ¨ConsulæœåŠ¡é‡å¯åè¿™äº›å…³é”®ä¿¡æ¯ä¸ä¼šä¸¢å¤±ã€‚</li>
<li><strong>å¥åº·æ£€æŸ¥çŠ¶æ€æŒä¹…åŒ–</strong>ï¼š
Consulæ”¯æŒå¯¹æ³¨å†Œçš„æœåŠ¡è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œä»¥ç¡®ä¿æœåŠ¡çš„å¯ç”¨æ€§ã€‚å¥åº·æ£€æŸ¥çŠ¶æ€ä¹Ÿæ˜¯Consulçš„æŒä¹…åŒ–æ•°æ®ä¹‹ä¸€ã€‚æŒä¹…åŒ–å¥åº·æ£€æŸ¥çŠ¶æ€ç¡®ä¿äº†å³ä½¿ConsulæœåŠ¡é‡å¯ï¼Œä¹‹å‰çš„å¥åº·æ£€æŸ¥çŠ¶æ€ä»ç„¶æœ‰æ•ˆã€‚</li>
<li><strong>ACLï¼ˆAccess Control Listï¼‰é…ç½®æŒä¹…åŒ–</strong>ï¼š
ACLæ˜¯Consulä¸­ç”¨äºè®¿é—®æ§åˆ¶çš„é‡è¦åŠŸèƒ½ã€‚ACLé…ç½®åŒ…æ‹¬ç”¨æˆ·ã€è§’è‰²ã€æƒé™å’Œä»¤ç‰Œç­‰ä¿¡æ¯ã€‚è¿™äº›é…ç½®çš„æŒä¹…åŒ–ç¡®ä¿äº†åœ¨Consulé‡å¯åACLé…ç½®ä»ç„¶æœ‰æ•ˆï¼Œä¿éšœäº†å®‰å…¨è®¿é—®ã€‚</li>
<li><strong>äº‹ä»¶æ—¥å¿—æŒä¹…åŒ–</strong>ï¼šConsulè®°å½•äº†å„ç§äº‹ä»¶æ—¥å¿—ï¼ŒåŒ…æ‹¬æœåŠ¡æ³¨å†Œã€å¥åº·æ£€æŸ¥çŠ¶æ€å˜åŒ–ã€æˆå‘˜å˜åŒ–ç­‰ã€‚äº‹ä»¶æ—¥å¿—çš„æŒä¹…åŒ–ç¡®ä¿äº†å³ä½¿ConsulæœåŠ¡é‡å¯ï¼Œä¹‹å‰çš„äº‹ä»¶è®°å½•ä¸ä¼šä¸¢å¤±</li>
</ol>
<p>æŒä¹…æ€§å­˜å‚¨é€šå¸¸æ˜¯é€šè¿‡åœ¨ConsulæœåŠ¡å™¨ä¸Š<strong>å°†æ•°æ®å†™å…¥ç£ç›˜</strong>æ¥å®ç°çš„ï¼Œè¿™æ ·å³ä½¿ConsulæœåŠ¡åœæ­¢è¿è¡Œï¼Œæ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p>
<ul>
<li><p>ç¬¬ä¸€æ­¥éœ€è¦æŒ‡å®š<strong>å­˜å‚¨æ•°æ®çš„ç£ç›˜æ–‡ä»¶å¤¹ä½ç½®</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">consul agent -server -ui -bootstrap-expect=<span class="hljs-number">1</span> -client=<span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> -bind <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> -data-dir /Users/lihaibin/Workspace/consuldata<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­
<code>-data-dir /Users/lihaibin/Workspace/consuldata</code>å°±æ˜¯åœ¨æŒ‡å®šéœ€è¦æŒä¹…æ€§å­˜å‚¨æ•°æ®çš„æ–‡ä»¶å¤¹ä½ç½®ï¼Œ<u><strong>äº‹å®ä¸Šåªéœ€è¦å¯¹data-dirä½ç½®è¿›è¡Œäº†æŒ‡å®šå°±èƒ½å®ç°å¯¹æ•°æ®çš„æŒä¹…æ€§å­˜å‚¨</strong>ï¼Œ<strong>å…³é”®å°±åœ¨äºåœ¨å¯åŠ¨consulçš„æ—¶å€™æœ‰æ²¡æœ‰æŒ‡å®š</strong></u></p></li>
<li><p>ç¬¬äºŒæ­¥<strong>ä»£ç æŒ‡å®šæ•°æ®å­˜å‚¨</strong></p></li>
</ul>
<p>è¿™é‡Œç»™å‡ºä¸€ä¸ªæŒä¹…æ€§å­˜å‚¨çš„å®ä¾‹ä»£ç ï¼ˆKVå­˜å‚¨ï¼‰ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	consulapi <span class="hljs-string">&quot;github.com/hashicorp/consul/api&quot;</span><br>)<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-comment">// åˆ›å»º Consul å®¢æˆ·ç«¯</span><br>	config := consulapi.DefaultConfig()<br>	config.Address = <span class="hljs-string">&quot;localhost:8500&quot;</span><br>	client, err := consulapi.NewClient(config)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;Failed to create Consul client:&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-comment">// è·å– Consul KV å­˜å‚¨</span><br>	kv := client.KV()<br></code></pre></td></tr></table></figure>
<p><strong>KV å­˜å‚¨</strong>æ˜¯ Consul
ä¸­ç”¨äºæŒä¹…åŒ–å­˜å‚¨é”®å€¼å¯¹æ•°æ®çš„ä¸€ç§æœºåˆ¶ï¼Œè€Œè¿™ç§æŒä¹…åŒ–å­˜å‚¨æ­£æ˜¯ä¸ Consul
çš„æŒä¹…æ€§å¯†åˆ‡ç›¸å…³çš„</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å†™å…¥æ•°æ®åˆ° Consul</span><br>	key := <span class="hljs-string">&quot;example/key&quot;</span><br>	value := []<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;example value&quot;</span>)<br>	p := &amp;consulapi.KVPair&#123;Key: key, Value: value&#125;<br>	_, err = kv.Put(p, <span class="hljs-literal">nil</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;Failed to write data to Consul:&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†æŒ‡å®šçš„é”®å€¼å¯¹å†™å…¥åˆ°Consulçš„é”®å€¼å­˜å‚¨ä¸­ï¼Œä»è€Œå®ç°æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240203235939898.png" alt="KVå­˜å‚¨çš„ç¤ºæ„å›¾" style="zoom:67%;" /></p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// ä» Consul è¯»å–æ•°æ®</span><br>	pair, _, err := kv.Get(key, <span class="hljs-literal">nil</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;Failed to read data from Consul:&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">if</span> pair == <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;Key not found in Consul&quot;</span>)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	fmt.Printf(<span class="hljs-string">&quot;Key: %s, Value: %s\n&quot;</span>, pair.Key, pair.Value)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯ä»Consulä¸­è¯»å–æŒ‡å®šé”®çš„å€¼ï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥</p>
<p>é€šè¿‡å®éªŒä¹Ÿå¯ä»¥çœ‹å‡ºå…³é—­äº†Consulä¹‹åé‡æ–°æ‰“å¼€ä»ç„¶èƒ½å¤Ÿè®©è®¾ç½®çš„KVæ•°æ®èƒ½å­˜å‚¨åœ¨æŒ‡å®šçš„ä½ç½®ä¸Š</p>
<p><img src="https://gitee.com/lihaibineric/picgo/raw/master/pic/image-20240204001705796.png" alt="æŒä¹…æ€§ä¿æŒ" style="zoom:67%;" /></p>
]]></content>
      <categories>
        <category>åç«¯å¼€å‘</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
        <tag>goå¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>deepl</title>
    <url>/2024/01/30/deepl/</url>
    <content><![CDATA[<p><a
href="https://blog.csdn.net/weixin_42693876/article/details/120345924">https://blog.csdn.net/weixin_42693876/article/details/120345924</a></p>
<p><a
href="https://zhuanlan.zhihu.com/p/560482252">https://zhuanlan.zhihu.com/p/560482252</a></p>
<p><a
href="https://zhuanlan.zhihu.com/p/667048896">https://zhuanlan.zhihu.com/p/667048896</a></p>
]]></content>
  </entry>
</search>
